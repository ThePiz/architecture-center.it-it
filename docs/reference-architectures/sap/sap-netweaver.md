---
title: Distribuire SAP NetWeaver (Windows) per AnyDB in macchine virtuali di Azure
description: Procedure consolidate per l'esecuzione di SAP S/4HANA in un ambiente Linux su Azure con disponibilità elevata.
author: lbrader
ms.date: 05/11/2018
ms.openlocfilehash: f4a33e7a3f30bdd6d8bdd41599a5e3b47501b874
ms.sourcegitcommit: c4106b58ad08f490e170e461009a4693578294ea
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 08/10/2018
ms.locfileid: "43016070"
---
# <a name="deploy-sap-netweaver-windows-for-anydb-on-azure-virtual-machines"></a><span data-ttu-id="2dc0b-103">Distribuire SAP NetWeaver (Windows) per AnyDB in macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="2dc0b-103">Deploy SAP NetWeaver (Windows) for AnyDB on Azure Virtual Machines</span></span>

<span data-ttu-id="2dc0b-104">Questa architettura di riferimento mostra un set di procedure consolidate per l'esecuzione di SAP NetWeaver in un ambiente Windows su Azure con disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-104">This reference architecture shows a set of proven practices for running SAP NetWeaver in a Windows environment on Azure with high availability.</span></span> <span data-ttu-id="2dc0b-105">Il database è AnyDB, il termine SAP che indica qualsiasi DBMS supportato oltre a SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-105">The database is AnyDB, the SAP term for any supported DBMS besides SAP HANA.</span></span> <span data-ttu-id="2dc0b-106">Questa architettura viene distribuita con dimensioni di macchina virtuale (VM) specifiche, che possono essere modificate in base alle esigenze dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-106">This architecture is deployed with specific virtual machine (VM) sizes that can be changed to accommodate your organization's needs.</span></span>

![](./images/sap-netweaver.png)

<span data-ttu-id="2dc0b-107">*Scaricare un [file Visio][visio-download] di questa architettura.*</span><span class="sxs-lookup"><span data-stu-id="2dc0b-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE] 
> <span data-ttu-id="2dc0b-108">La distribuzione di questa architettura di riferimento richiede una licenza adeguata dei prodotti SAP e altre tecnologie non Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span>

## <a name="architecture"></a><span data-ttu-id="2dc0b-109">Architettura</span><span class="sxs-lookup"><span data-stu-id="2dc0b-109">Architecture</span></span>
<span data-ttu-id="2dc0b-110">L'architettura è costituita dall'infrastruttura e dai principali componenti software seguenti.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-110">The architecture consists of the following infrastructure and key software components.</span></span>

<span data-ttu-id="2dc0b-111">**Rete virtuale**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-111">**Virtual network**.</span></span> <span data-ttu-id="2dc0b-112">Il servizio Rete virtuale di Azure connette in modo sicuro tra loro le risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-112">The Azure Virtual Network service securely connects Azure resources to each other.</span></span> <span data-ttu-id="2dc0b-113">In questa architettura la rete virtuale si connette a un ambiente locale tramite un gateway VPN distribuito nell'hub di una topologia [hub-spoke](../hybrid-networking/hub-spoke.md).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-113">In this architecture, the virtual network connects to an on-premises environment through a VPN gateway deployed in the hub of a [hub-spoke](../hybrid-networking/hub-spoke.md).</span></span> <span data-ttu-id="2dc0b-114">Lo spoke è la rete virtuale usata per le applicazioni SAP e il livello database.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-114">The spoke is the virtual network used for the SAP applications and database tier.</span></span>

<span data-ttu-id="2dc0b-115">**Subnet**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-115">**Subnets**.</span></span> <span data-ttu-id="2dc0b-116">La rete virtuale è suddivisa in subnet separate per ogni livello: applicazione (SAP NetWeaver), database, servizi condivisi (il jumpbox) e Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-116">The virtual network is subdivided into separate subnets for each tier: application (SAP NetWeaver), database, shared services (the jumpbox), and Active Directory.</span></span>
    
<span data-ttu-id="2dc0b-117">**Macchine virtuali**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-117">**Virtual machines**.</span></span> <span data-ttu-id="2dc0b-118">Questa architettura usa macchine virtuali per il livello applicazione e il livello database, raggruppate in questo modo:</span><span class="sxs-lookup"><span data-stu-id="2dc0b-118">This architecture uses virtual machines for the application tier and database tier, grouped as follows:</span></span>

- <span data-ttu-id="2dc0b-119">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="2dc0b-120">Il livello applicazione usa macchine virtuali Windows ed esegue SAP Central Services e i server applicazioni SAP.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-120">The application tier uses Windows virtual machines and runs SAP Central Services and SAP application servers.</span></span> <span data-ttu-id="2dc0b-121">Le macchine virtuali che eseguono Central Services sono configurate come ambiente Windows Server Failover Cluster per la disponibilità elevata, supportato da SIOS DataKeeper Cluster Edition.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-121">The VMs that run Central Services are configured as a Windows Server Failover Cluster for high availability, supported by SIOS DataKeeper Cluster Edition.</span></span>
- <span data-ttu-id="2dc0b-122">**AnyDB**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-122">**AnyDB**.</span></span> <span data-ttu-id="2dc0b-123">Il livello database esegue AnyDB come database di origine, ad esempio Microsoft SQL Server, Oracle o IBM DB2.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-123">The database tier runs AnyDB as the source database, such as Microsoft SQL Server, Oracle, or IBM DB2.</span></span>
- <span data-ttu-id="2dc0b-124">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-124">**Jumpbox**.</span></span> <span data-ttu-id="2dc0b-125">Detto anche bastion host.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-125">Also called a bastion host.</span></span> <span data-ttu-id="2dc0b-126">È una macchina virtuale sicura in rete usata dagli amministratori per connettersi alle altre macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-126">This is a secure virtual machine on the network that administrators use to connect to the other virtual machines.</span></span>
- <span data-ttu-id="2dc0b-127">**Controller di dominio Active Directory di Windows Server**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-127">**Windows Server Active Directory domain controllers**.</span></span> <span data-ttu-id="2dc0b-128">I controller di dominio vengono usati in tutte le macchine virtuali e tutti gli utenti nel dominio.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-128">The domain controllers are used on all VMs and users in the domain.</span></span>

<span data-ttu-id="2dc0b-129">**Servizi di bilanciamento del carico**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-129">**Load balancers**.</span></span> <span data-ttu-id="2dc0b-130">Le istanze di [Azure Load Balancer](/azure/load-balancer/load-balancer-overview) vengono usate per distribuire il carico alle macchine virtuali nella subnet del livello applicazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-130">[Azure Load Balancer](/azure/load-balancer/load-balancer-overview) instances are used to distribute traffic to virtual machines in the application tier subnet.</span></span> <span data-ttu-id="2dc0b-131">Al livello dati è possibile ottenere la disponibilità elevata usando i servizi di bilanciamento del carico SAP predefiniti, Azure Load Balancer o altri meccanismi, a seconda del sistema di gestione database.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-131">At the data tier, high availability may be achieved using built-in SAP load balancers, Azure Load Balancer, or other mechanisms, depending on the DBMS.</span></span> <span data-ttu-id="2dc0b-132">Per altre informazioni, vedere [Distribuzione DBMS di Macchine virtuali di Azure per SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-132">For more information, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span> 

<span data-ttu-id="2dc0b-133">**Set di disponibilità**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-133">**Availability sets**.</span></span> <span data-ttu-id="2dc0b-134">Le macchine virtuali per i ruoli SAP Web Dispatcher, server applicazioni SAP e (A)SCS sono raggruppate in [set di disponibilità](/azure/virtual-machines/windows/tutorial-availability-sets) e viene effettuato il provisioning di almeno due macchine virtuali per ogni ruolo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-134">Virtual machines for the SAP Web Dispatcher, SAP application server, and (A)SCS, roles are grouped into separate [availability sets](/azure/virtual-machines/windows/tutorial-availability-sets), and at least two virtual machines are provisioned per role.</span></span> <span data-ttu-id="2dc0b-135">Questo approccio rende le macchine virtuali idonee per un [contratto di servizio](https://azure.microsoft.com/support/legal/sla/virtual-machines) di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-135">This makes the virtual machines eligible for a higher [service level agreement](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span></span>

<span data-ttu-id="2dc0b-136">**Schede di rete**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-136">**NICs**.</span></span> <span data-ttu-id="2dc0b-137">Le [schede di interfaccia di rete](/azure/virtual-network/virtual-network-network-interface) (NIC) permettono tutta la comunicazione delle macchine virtuali in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-137">[Network interface cards](/azure/virtual-network/virtual-network-network-interface) (NICs) enable all communication of virtual machines on a virtual network.</span></span>

<span data-ttu-id="2dc0b-138">**Gruppi di sicurezza di rete**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-138">**Network security groups**.</span></span> <span data-ttu-id="2dc0b-139">Per limitare il traffico in ingresso, in uscita e tra subnet nella rete virtuale, è possibile creare [gruppi di sicurezza di rete](/azure/virtual-network/virtual-networks-nsg).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-139">To restrict incoming, outgoing, and intra-subnet traffic in the virtual network, you can create [network security groups](/azure/virtual-network/virtual-networks-nsg) (NSGs).</span></span>

<span data-ttu-id="2dc0b-140">**Gateway**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-140">**Gateway**.</span></span> <span data-ttu-id="2dc0b-141">Un gateway estende la rete locale alla rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-141">A gateway extends your on-premises network to the Azure virtual network.</span></span> <span data-ttu-id="2dc0b-142">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) è il servizio di Azure consigliato per creare connessioni private che non passano attraverso la rete Internet pubblica, ma è possibile usare anche una connessione [da sito a sito](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-142">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) is the recommended Azure service for creating private connections that do not go over the public Internet, but a [Site-to-Site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal) connection can also be used.</span></span>

<span data-ttu-id="2dc0b-143">**Archiviazione di Azure**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-143">**Azure Storage**.</span></span> <span data-ttu-id="2dc0b-144">Per fornire l'archiviazione permanente di un disco rigido virtuale di una macchina virtuale, è necessario usare [Archiviazione di Azure](/azure/storage/storage-standard-storage).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-144">To provide persistent storage of a virtual machine's virtual hard disk (VHD), [Azure Storage](/azure/storage/storage-standard-storage) is required.</span></span> <span data-ttu-id="2dc0b-145">Il servizio viene usato anche da [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) per implementare un'operazione del cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-145">It is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to implement a failover cluster operation.</span></span> 

## <a name="recommendations"></a><span data-ttu-id="2dc0b-146">Consigli</span><span class="sxs-lookup"><span data-stu-id="2dc0b-146">Recommendations</span></span>
<span data-ttu-id="2dc0b-147">I requisiti della propria organizzazione potrebbero essere diversi da quelli dell'architettura descritta in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-147">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="2dc0b-148">Usare queste indicazioni come punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-148">Use these recommendations as a starting point.</span></span>

### <a name="sap-web-dispatcher-pool"></a><span data-ttu-id="2dc0b-149">Pool di componenti SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="2dc0b-149">SAP Web Dispatcher pool</span></span>

<span data-ttu-id="2dc0b-150">Il componente Web Dispatcher viene usato come servizio di bilanciamento del carico per il traffico SAP tra i server applicazioni SAP.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-150">The Web Dispatcher component is used as a load balancer for SAP traffic among the SAP application servers.</span></span> <span data-ttu-id="2dc0b-151">Per ottenere la disponibilità elevata per il componente Web Dispatcher, viene usato Azure Load Balancer per implementare la configurazione di Web Dispatcher parallela.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-151">To achieve high availability for the Web Dispatcher component, Azure Load Balancer is used to implement the parallel Web Dispatcher setup.</span></span> <span data-ttu-id="2dc0b-152">Web Dispatcher usa una configurazione round robin per la distribuzione del traffico HTTP(S) tra i componenti Web Dispatcher disponibili nel pool di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-152">Web Dispatcher uses in a round-robin configuration for HTTP(S) traffic distribution among the available Web Dispatchers in the balancers pool.</span></span>

<span data-ttu-id="2dc0b-153">Per informazioni dettagliate sull'esecuzione di SAP NetWeaver in macchine virtuali di Azure, vedere [Guida alla pianificazione e all'implementazione di macchine virtuali di Azure per SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-153">For details about running SAP NetWeaver in Azure VMs, see [Azure Virtual Machines planning and implementation for SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span></span>

### <a name="application-servers-pool"></a><span data-ttu-id="2dc0b-154">Pool di server applicazioni</span><span class="sxs-lookup"><span data-stu-id="2dc0b-154">Application servers pool</span></span>

<span data-ttu-id="2dc0b-155">Per gestire i gruppi di accesso per i server applicazioni ABAP, viene usata la transazione SMLG.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-155">To manage logon groups for ABAP application servers, the SMLG transaction is used.</span></span> <span data-ttu-id="2dc0b-156">Questa usa la funzione di bilanciamento del carico nel server messaggi di Central Services per distribuire il carico di lavoro nel pool di server applicazioni SAP per le interfacce utente grafiche di SAP e il traffico RFC.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-156">It uses the load balancing function within the message server of the Central Services to distribute workload among SAP application servers pool for SAPGUIs and RFC traffic.</span></span> <span data-ttu-id="2dc0b-157">La connessione del server applicazioni a Central Services con disponibilità elevata avviene tramite il nome di rete virtuale del cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-157">The application server connection to the highly available Central Services is through the cluster virtual network name.</span></span>

### <a name="sap-central-services-cluster"></a><span data-ttu-id="2dc0b-158">Cluster SAP Central Services</span><span class="sxs-lookup"><span data-stu-id="2dc0b-158">SAP Central Services cluster</span></span>

<span data-ttu-id="2dc0b-159">Questa architettura di riferimento esegue Central Services in macchine virtuali nel livello applicazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-159">This reference architecture runs Central Services on VMs in the application tier.</span></span> <span data-ttu-id="2dc0b-160">Central Services è un singolo punto di errore potenziale se distribuito in un'unica macchina virtuale, che è la distribuzione tipica quando la disponibilità elevata non è un requisito.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-160">The Central Services is a potential single point of failure (SPOF) when deployed to a single VM—typical deployment when high availability is not a requirement.</span></span> <span data-ttu-id="2dc0b-161">Per implementare una soluzione a disponibilità elevata, è possibile usare un cluster di dischi condivisi o un cluster di condivisioni file.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-161">To implement a high availability solution, either a shared disk cluster or a file share cluster can be used.</span></span>

<span data-ttu-id="2dc0b-162">Per configurare le macchine virtuali per un cluster di dischi condivisi, usare [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-162">To configure VMs for a shared disk cluster, use [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span></span> <span data-ttu-id="2dc0b-163">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) è consigliato come quorum di controllo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-163">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) is recommended as a quorum witness.</span></span> <span data-ttu-id="2dc0b-164">Per supportare l'ambiente cluster di failover, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) svolge la funzione di volume condiviso del cluster replicando i dischi indipendenti di proprietà dei nodi del cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-164">To support the failover cluster environment, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) performs the cluster shared volume function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="2dc0b-165">Azure non supporta in modo nativo i dischi condivisi e di conseguenza richiede soluzioni fornite da SIOS.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-165">Azure does not natively support shared disks and therefore requires solutions provided by SIOS.</span></span>

<span data-ttu-id="2dc0b-166">Per informazioni dettagliate, vedere</span><span class="sxs-lookup"><span data-stu-id="2dc0b-166">For details, see "3.</span></span> <span data-ttu-id="2dc0b-167">la sezione sull'aggiornamento importante per i clienti SAP che eseguono ASCS su SIOS in Azure in [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Esecuzione di applicazioni SAP nella piattaforma Microsoft).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-167">Important Update for SAP Customers Running ASCS on SIOS on Azure” at [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/).</span></span>

<span data-ttu-id="2dc0b-168">Un altro modo di gestire il clustering consiste nell'implementare un cluster di condivisioni file tramite Windows Server Failover Cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-168">Another way to handle clustering is to implement a file share cluster using Windows Server Failover Cluster.</span></span> <span data-ttu-id="2dc0b-169">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) ha di recente modificato il modello di distribuzione di Central Services in modo da permettere l'accesso alle directory globali /sapmnt tramite un percorso UNC.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-169">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) recently modified the Central Services deployment pattern to access the /sapmnt global directories via a UNC path.</span></span> <span data-ttu-id="2dc0b-170">Questa modifica [elimina il requisito](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) relativo a SIOS o ad altre soluzioni con dischi condivisi nelle macchine virtuali di Central Services.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-170">This change [removes the requirement](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) for SIOS or other shared disk solutions on the Central Services VMs.</span></span> <span data-ttu-id="2dc0b-171">È comunque consigliabile assicurarsi che la condivisione UNC /sapmnt abbia [disponibilità elevata](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-171">It is still recommended to ensure that the /sapmnt UNC share is [highly available](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span></span> <span data-ttu-id="2dc0b-172">A questo scopo, nell'istanza di Central Services usare Windows Server Failover Cluster con [File server di scalabilità orizzontale](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) e la funzionalità [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) in Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-172">This can be done on the Central Services instance by using Windows Server Failover Cluster with [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) and the [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) (S2D) feature in Windows Server 2016.</span></span> 

### <a name="availability-sets"></a><span data-ttu-id="2dc0b-173">Set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2dc0b-173">Availability sets</span></span>

<span data-ttu-id="2dc0b-174">I set di disponibilità distribuiscono i server in un'infrastruttura fisica diversa e aggiornano i gruppi per migliorare la disponibilità del servizio.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-174">Availability sets distribute servers to different physical infrastructure and update groups to improve service availability.</span></span> <span data-ttu-id="2dc0b-175">Inserire le macchine virtuali che eseguono lo stesso ruolo in un set di disponibilità per prevenire il tempo di inattività causato dalla manutenzione dell'infrastruttura di Azure e soddisfare i [contratti di servizio](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-175">Put virtual machines that perform the same role into an availability sets to help guard against downtime caused by Azure infrastructure maintenance and to meet [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLAs).</span></span> <span data-ttu-id="2dc0b-176">Sono consigliate due o più macchine virtuali per ogni set di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-176">Two or more virtual machines per availability set is recommended.</span></span>

<span data-ttu-id="2dc0b-177">Tutte le macchine virtuali in un set devono eseguire lo stesso ruolo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-177">All virtual machines in a set must perform the same role.</span></span> <span data-ttu-id="2dc0b-178">Non inserire server di ruoli diversi nello stesso set di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-178">Do not mix servers of different roles in the same availability set.</span></span> <span data-ttu-id="2dc0b-179">Ad esempio, non inserire un nodo Central Services nello stesso set di disponibilità del server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-179">For example, don't place a Central Services node in the same availability set with the application server.</span></span>

### <a name="nics"></a><span data-ttu-id="2dc0b-180">Schede di interfaccia di rete</span><span class="sxs-lookup"><span data-stu-id="2dc0b-180">NICs</span></span>

<span data-ttu-id="2dc0b-181">Le tradizionali distribuzioni SAP locali implementano più schede di interfaccia di rete (NIC) per ogni macchina per segregare il traffico amministrativo rispetto al traffico aziendale.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-181">Traditional on-premises SAP deployments implement multiple network interface cards (NICs) per machine to segregate administrative traffic from business traffic.</span></span> <span data-ttu-id="2dc0b-182">In Azure la rete virtuale è una rete software-defined che invia tutto il traffico attraverso la stessa infrastruttura di rete.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-182">On Azure, the virtual network is a software-defined network that sends all traffic through the same network fabric.</span></span> <span data-ttu-id="2dc0b-183">Di conseguenza, l'uso di più schede di interfaccia di rete non è necessario.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-183">Therefore, the use of multiple NICs is unnecessary.</span></span> <span data-ttu-id="2dc0b-184">Tuttavia, se l'organizzazione deve segregare il traffico, è possibile distribuire più schede di interfaccia di rete per ogni macchina virtuale, connettere ogni scheda di interfaccia di rete a una subnet diversa e quindi usare i gruppi di sicurezza di rete per applicare diversi criteri di controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-184">However, if your organization needs to segregate traffic, you can deploy multiple NICs per VM, connect each NIC to a different subnet, and then use NSGs to enforce different access control policies.</span></span>

### <a name="subnets-and-nsgs"></a><span data-ttu-id="2dc0b-185">Subnet e gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="2dc0b-185">Subnets and NSGs</span></span>

<span data-ttu-id="2dc0b-186">Questa architettura suddivide lo spazio degli indirizzi delle rete virtuale in subnet.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-186">This architecture subdivides the virtual network address space into subnets.</span></span> <span data-ttu-id="2dc0b-187">Questa architettura di riferimento è incentrata prevalentemente sulla subnet del livello applicazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-187">This reference architecture focuses primarily on the application tier subnet.</span></span> <span data-ttu-id="2dc0b-188">Ogni subnet può essere associata a un gruppo di sicurezza di rete che definisce i criteri di accesso per la subnet.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-188">Each subnet can be associated with a NSG that defines the access policies for the subnet.</span></span> <span data-ttu-id="2dc0b-189">Posizionare i server applicazioni in una subnet separata in modo da proteggerli più facilmente gestendo i criteri di sicurezza della subnet anziché i singoli server.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-189">Place application servers on a separate subnet so you can secure them more easily by managing the subnet security policies, not the individual servers.</span></span>

<span data-ttu-id="2dc0b-190">Quando un gruppo di sicurezza di rete viene associato a una subnet, viene applicato a tutti i server all'interno della subnet.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-190">When a NSG is associated with a subnet, it applies to all the servers within the subnet.</span></span> <span data-ttu-id="2dc0b-191">Per altre informazioni sull'uso di gruppi di sicurezza di rete per il controllo granulare dei server in una subnet, vedere [Filtrare il traffico di rete con gruppi di sicurezza di rete](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-191">For more information about using NSGs for fine-grained control over the servers in a subnet, see [Filter network traffic with network security groups](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span></span>

### <a name="load-balancers"></a><span data-ttu-id="2dc0b-192">Servizi di bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="2dc0b-192">Load balancers</span></span>

<span data-ttu-id="2dc0b-193">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) gestisce il bilanciamento del carico del traffico HTTP(S) in un pool di server applicazioni SAP.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-193">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) handles load balancing of HTTP(S) traffic to a pool of SAP application servers.</span></span>

<span data-ttu-id="2dc0b-194">Per il traffico proveniente dai client con interfaccia utente grafica SAP che si connettono a un server SAP tramite il protocollo DIAG o Remote Function Call (RFC), il server messaggi Central Services bilancia il carico tramite [gruppi di accesso](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing) del server applicazioni SAP e di conseguenza non è necessario bilanciamento del carico aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-194">For traffic from SAP GUI clients connecting a SAP server via DIAG protocol or Remote Function Calls (RFC), the Central Services message server balances the load through SAP application server [logon groups](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), so no additional load balancer is needed.</span></span>

### <a name="azure-storage"></a><span data-ttu-id="2dc0b-195">Archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="2dc0b-195">Azure Storage</span></span>

<span data-ttu-id="2dc0b-196">Per tutte le macchine virtuali del server di database, è consigliabile usare Archiviazione Premium di Azure per ottenere una latenza di lettura/scrittura coerente.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-196">For all database server virtual machines, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="2dc0b-197">Per qualsiasi macchina virtuale a istanza singola che usa Archiviazione Premium per tutti i dischi del sistema operativo e i dischi dati, vedere [Contratto di servizio per Macchine virtuali](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-197">For any single instance virtual machine using Premium Storage for all operating system disks and data disks, see [SLA for Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span></span> <span data-ttu-id="2dc0b-198">Inoltre, per i sistemi SAP di produzione è consigliabile usare [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) Premium in tutti i casi.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-198">Also, for production SAP systems, we recommend using Premium [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) in all cases.</span></span> <span data-ttu-id="2dc0b-199">Ai fini dell'affidabilità, viene usato Azure Managed Disks per gestire i file VHD per i dischi.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-199">For reliability, Managed Disks are used to manage the VHD files for the disks.</span></span> <span data-ttu-id="2dc0b-200">Managed Disks garantisce l'isolamento dei dischi per le macchine virtuali all'interno di un set di disponibilità, in modo da evitare singoli punti di errore.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-200">Managed disks ensure that the disks for virtual machines within an availability set are isolated to avoid single points of failure.</span></span>

<span data-ttu-id="2dc0b-201">Per i server applicazioni SAP, tra cui le macchine virtuali di Central Services, è possibile usare Archiviazione Standard di Azure per ridurre i costi, perché l'esecuzione delle applicazioni avviene in memoria e i dischi vengono usati solo per la registrazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-201">For SAP application servers, including the Central Services virtual machines, you can use Azure Standard Storage to reduce cost, because application execution takes place in memory and disks are used for logging only.</span></span> <span data-ttu-id="2dc0b-202">Tuttavia, attualmente Archiviazione Standard è certificato solo per l'archiviazione non gestita.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-202">However, at this time, Standard Storage is only certified for unmanaged storage.</span></span> <span data-ttu-id="2dc0b-203">Poiché i server applicazioni non ospitano dati, è possibile usare i dischi di Archiviazione Premium P4 e P6 di dimensioni minori per ridurre i costi.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-203">Since application servers do not host any data, you can also use the smaller P4 and P6 Premium Storage disks to help minimize cost.</span></span>

<span data-ttu-id="2dc0b-204">Archiviazione di Azure viene usato anche da [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) per mantenere il quorum con un dispositivo in un'area di Azure remota lontano dall'area primaria in cui si trova il cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-204">Azure Storage is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to maintain quorum with a device in a remote Azure region away from the primary region where the cluster resides.</span></span>

<span data-ttu-id="2dc0b-205">Per l'archivio dati di backup, è consigliabile usare il [livello ad accesso sporadico](/azure/storage/storage-blob-storage-tiers) e il [livello di accesso archivio](/azure/storage/storage-blob-storage-tiers) di Azure per l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-205">For the backup data store, we recommend using Azure [coolaccess tier](/azure/storage/storage-blob-storage-tiers) and [archive access tier storage](/azure/storage/storage-blob-storage-tiers).</span></span> <span data-ttu-id="2dc0b-206">Questi livelli di archiviazione sono convenienti per archiviare dati di durata elevata cui si accede meno di frequente.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-206">These storage tiers are cost-effective ways to store long-lived data that is infrequently accessed.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="2dc0b-207">Considerazioni sulle prestazioni</span><span class="sxs-lookup"><span data-stu-id="2dc0b-207">Performance considerations</span></span>

<span data-ttu-id="2dc0b-208">I server applicazioni SAP svolgono comunicazioni costanti con i server di database.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-208">SAP application servers carry on constant communications with the database servers.</span></span> <span data-ttu-id="2dc0b-209">Per le applicazioni critiche a livello di prestazioni in esecuzione in qualsiasi piattaforma di database, tra cui SAP HANA, provare ad abilitare l'[acceleratore di scrittura](/azure/virtual-machines/linux/how-to-enable-write-accelerator) per migliorare la latenza di scrittura dei log.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-209">For performance-critical applications running on any database platforms, including SAP HANA, consider enabling [Write Accelerator](/azure/virtual-machines/linux/how-to-enable-write-accelerator) to improve log write latency.</span></span> <span data-ttu-id="2dc0b-210">Per ottimizzare le comunicazioni tra server, usare la [rete accelerata](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-210">To optimize inter-server communications, use the [Accelerated Network](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span></span> <span data-ttu-id="2dc0b-211">Notare che questi acceleratori sono disponibili solo per determinate serie di macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-211">Note that these accelerators are available only for certain VM series.</span></span>

<span data-ttu-id="2dc0b-212">Per ottenere valori elevati per le operazioni di I/O al secondo e la velocità effettiva della larghezza di banda dei dischi, vengono usate le procedure comuni per l'[ottimizzazione delle prestazioni](/azure/virtual-machines/windows/premium-storage-performance) dei volumi di archiviazione per il layout di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-212">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume [performance optimization](/azure/virtual-machines/windows/premium-storage-performance) apply to Azure storage layout.</span></span> <span data-ttu-id="2dc0b-213">Ad esempio, la combinazione di più dischi per creare un volume di dischi con striping migliora le prestazioni di I/O.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-213">For example, combining multiple disks together to create a striped disk volume improves IO performance.</span></span> <span data-ttu-id="2dc0b-214">L'abilitazione della cache di lettura sul contenuto di archiviazione che viene modificato raramente migliora la velocità di recupero di dati.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-214">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span>

<span data-ttu-id="2dc0b-215">Per SAP su SQL, il blog [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) (10 principali considerazioni per la distribuzione di applicazioni SAP in Azure) offre ottimi consigli per l'ottimizzazione dell'archiviazione di Azure per carichi di lavoro SAP in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-215">For SAP on SQL, the [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) blog offers excellent advice on optimizing Azure storage for SAP workloads on SQL Server.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="2dc0b-216">Considerazioni sulla scalabilità</span><span class="sxs-lookup"><span data-stu-id="2dc0b-216">Scalability considerations</span></span>

<span data-ttu-id="2dc0b-217">A livello dell'applicazione SAP, Azure offre un'ampia gamma di dimensioni di macchina virtuale per la scalabilità verticale e orizzontale. Per un elenco completo, vedere la [nota SAP 1928533](https://launchpad.support.sap.com/#/notes/1928533) sulle applicazioni SAP in Azure e sui prodotti e i tipi di macchina virtuale di Azure supportati.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-217">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up and scaling out. For an inclusive list, see [SAP note 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types.</span></span> <span data-ttu-id="2dc0b-218">Per l'accesso, è necessario un account di SAP Service Marketplace.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-218">(SAP Service Marketplace account required for access).</span></span> <span data-ttu-id="2dc0b-219">I server applicazioni SAP e i cluster Central Services possono essere ridimensionati aggiungendo più istanze.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-219">SAP application servers and the Central Services clusters can scale up/down or scale out by adding more instances.</span></span> <span data-ttu-id="2dc0b-220">Il database AnyDB può essere aumentato o ridotto, ma non può essere scalato orizzontalmente. Il contenitore di database SAP per AnyDB non supporta il partizionamento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-220">The AnyDB database can scale up/down but does not scale out. The SAP database container for AnyDB does not support sharding.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="2dc0b-221">Considerazioni sulla disponibilità</span><span class="sxs-lookup"><span data-stu-id="2dc0b-221">Availability considerations</span></span>

<span data-ttu-id="2dc0b-222">La ridondanza delle risorse è il tema generale nelle soluzioni di infrastruttura a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-222">Resource redundancy is the general theme in highly available infrastructure solutions.</span></span> <span data-ttu-id="2dc0b-223">Per le organizzazioni che hanno contratti di servizio meno rigorosi, le macchine virtuali di Azure a istanza singola offrono un contratto di servizio per il tempo di attività.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-223">For enterprises that have a less stringent SLA, single-instance Azure VMs offer an uptime SLA.</span></span> <span data-ttu-id="2dc0b-224">Per altre informazioni, vedere [Contratti di servizio di Azure](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-224">For more information, see [Azure Service Level Agreement](https://azure.microsoft.com/support/legal/sla/).</span></span>

<span data-ttu-id="2dc0b-225">In questa installazione distribuita dell'applicazione SAP l'installazione di base viene replicata per ottenere la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-225">In this distributed installation of the SAP application, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="2dc0b-226">Per ogni livello dell'architettura, la progettazione a disponibilità elevata varia.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-226">For each layer of the architecture, the high availability design varies.</span></span>

### <a name="application-tier"></a><span data-ttu-id="2dc0b-227">Livello applicazione</span><span class="sxs-lookup"><span data-stu-id="2dc0b-227">Application tier</span></span>

<span data-ttu-id="2dc0b-228">La disponibilità elevata per SAP Web Dispatcher viene ottenuta con istanze ridondanti.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-228">High availability for SAP Web Dispatcher is achieved with redundant instances.</span></span> <span data-ttu-id="2dc0b-229">Vedere [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) nella documentazione di SAP.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-229">See [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) in the SAP Documentation.</span></span>

<span data-ttu-id="2dc0b-230">La disponibilità elevata di Central Services viene implementata con Windows Server Failover Cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-230">High availability of the Central Services is implemented with Windows Server Failover Cluster.</span></span> <span data-ttu-id="2dc0b-231">Se distribuita in Azure, l'archiviazione cluster per il cluster di failover può essere configurata usando due approcci: un volume condiviso in cluster o una condivisione file.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-231">When deployed on Azure, the cluster storage for the failover cluster can be configured using two approaches: either a clustered shared volume or a file share.</span></span>

<span data-ttu-id="2dc0b-232">Poiché i dischi condivisi non sono possibili in Azure, viene usato SIOS Datakeeper per replicare il contenuto dei dischi indipendenti collegati ai nodi del cluster e per astrarre le unità come volume condiviso del cluster per la gestione dei cluster.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-232">Since shared disks are not possible on Azure, SIOS Datakeeper is used to replicate the content of independent disks attached to the cluster nodes and to abstract the drives as a cluster shared volume for the cluster manager.</span></span> <span data-ttu-id="2dc0b-233">Per informazioni dettagliate sull'implementazione, vedere [Clustering SAP ASCS in Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/) (Clustering di SAP ASCS in Azure).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-233">For implementation details, see [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/).</span></span>

<span data-ttu-id="2dc0b-234">Un'altra opzione consiste nell'usare una condivisione file distribuita tramite [File server di scalabilità orizzontale](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-234">Another option is to use a file share served up by the [Scale Out Fileserver](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span></span> <span data-ttu-id="2dc0b-235">La funzionalità File server di scalabilità orizzontale offre condivisioni file resilienti che è possibile usare come volume condiviso del cluster per il cluster di Windows.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-235">SOFS offers resilient file shares you can use as a cluster shared volume for the Windows cluster.</span></span> <span data-ttu-id="2dc0b-236">Un cluster File server di scalabilità orizzontale può essere condiviso tra più nodi Central Services.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-236">A SOFS cluster can be shared among multiple Central Services nodes.</span></span> <span data-ttu-id="2dc0b-237">Al momento della redazione di questo articolo, la funzionalità File server di scalabilità orizzontale viene usata solo per una progettazione a disponibilità elevata, perché il cluster File server di scalabilità orizzontale non si estende tra aree per fornire supporto per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-237">As of this writing, SOFS is used only for high availability design, because the SOFS cluster does not extend across regions to provide disaster recovery support.</span></span>

<span data-ttu-id="2dc0b-238">La disponibilità elevata per i server applicazioni SAP viene ottenuta bilanciando il carico del traffico all'interno di un pool di server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-238">High availability for the SAP application servers is achieved by load balancing traffic within a pool of application servers.</span></span>
<span data-ttu-id="2dc0b-239">Vedere [Configurazioni e certificazioni SAP in esecuzione su Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-239">See [SAP certifications and configurations running on Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span></span>

### <a name="database-tier"></a><span data-ttu-id="2dc0b-240">Livello database</span><span class="sxs-lookup"><span data-stu-id="2dc0b-240">Database tier</span></span>

<span data-ttu-id="2dc0b-241">Questa architettura di riferimento presuppone che il database di origine venga eseguito in AnyDB, ovvero un DBMS come SQL Server, SAP ASE, IBM DB2 o Oracle.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-241">This reference architecture assumes the source database is running on AnyDB—that is, a DBMS such as SQL Server, SAP ASE, IBM DB2, or Oracle.</span></span> <span data-ttu-id="2dc0b-242">La funzionalità di replica nativa del livello database offre failover manuale o automatico tra i nodi replicati.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-242">The database tier's native replication feature provides either manual or automatic failover between replicated nodes.</span></span>

<span data-ttu-id="2dc0b-243">Per informazioni di implementazione dettagliate per sistemi di database specifici, vedere [Distribuzione DBMS di Macchine virtuali di Azure per SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-243">For implementation details about specific database systems, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

## <a name="disaster-recovery-considerations"></a><span data-ttu-id="2dc0b-244">Considerazioni sul ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="2dc0b-244">Disaster recovery considerations</span></span>

<span data-ttu-id="2dc0b-245">Per il ripristino di emergenza, è necessario essere in grado di eseguire il failover in un'area secondaria.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-245">For disaster recovery (DR), you must be able to fail over to a secondary region.</span></span> <span data-ttu-id="2dc0b-246">Ogni livello usa una strategia diversa per fornire una protezione con ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-246">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="2dc0b-247">**Livello server applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-247">**Application servers tier**.</span></span> <span data-ttu-id="2dc0b-248">I server applicazioni SAP non contengono dati aziendali.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-248">SAP application servers do not contain business data.</span></span> <span data-ttu-id="2dc0b-249">In Azure, una semplice strategia di ripristino di emergenza consiste nel creare server applicazioni SAP nell'area secondaria e quindi arrestarli.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-249">On Azure, a simple DR strategy is to create SAP application servers in the secondary region, then shut them down.</span></span> <span data-ttu-id="2dc0b-250">In caso di modifiche di configurazione o aggiornamenti del kernel nel server applicazioni primario, le stesse modifiche devono essere copiate nelle macchine virtuali nell'area secondaria.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-250">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to the virtual machines in the secondary region.</span></span> <span data-ttu-id="2dc0b-251">Ad esempio, gli eseguibili del kernel copiati nelle macchine virtuali di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-251">For example, the kernel executables copied to the DR virtual machines.</span></span> <span data-ttu-id="2dc0b-252">Per la replica automatica dei server applicazioni in un'area secondaria, la soluzione consigliata è [Azure Site Recovery](/azure/site-recovery/site-recovery-overview).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-252">For automatic replication of application servers to a secondary region, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) is the recommended solution.</span></span>

- <span data-ttu-id="2dc0b-253">**Central Services**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-253">**Central Services**.</span></span> <span data-ttu-id="2dc0b-254">Anche questo componente dello stack di applicazioni SAP non salva in modo permanente i dati aziendali.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-254">This component of the SAP application stack also does not persist business data.</span></span> <span data-ttu-id="2dc0b-255">È possibile compilare una macchina virtuale nell'area di ripristino di emergenza per eseguire il ruolo Central Services.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-255">You can build a VM in the disaster recovery region to run the Central Services role.</span></span> <span data-ttu-id="2dc0b-256">L'unico contenuto dal nodo Central Services primario per la sincronizzazione è il contenuto della condivisione /sapmnt.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-256">The only content from the primary Central Services node to synchronize is the /sapmnt share content.</span></span> <span data-ttu-id="2dc0b-257">Inoltre, se le modifiche di configurazione o gli aggiornamenti del kernel avvengono nei server Central Services primari, devono essere ripetuti nella macchina virtuale nell'area di ripristino di emergenza che esegue Central Services.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-257">Also, if configuration changes or kernel updates take place on the primary Central Services servers, they must be repeated on the VM in the disaster recovery region running Central Services.</span></span> <span data-ttu-id="2dc0b-258">Per sincronizzare i due server, è possibile usare Azure Site Recovery per replicare i nodi del cluster oppure è sufficiente usare un processo di copia pianificato regolarmente per copiare /sapmnt nell'area di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-258">To synchronize the two servers, you can use either Azure Site Recovery to replicate the cluster nodes or simply use a regularly scheduled copy job to copy /sapmnt to the disaster recovery region.</span></span> <span data-ttu-id="2dc0b-259">Per informazioni dettagliate sul processo di failover di compilazione, copia e test di questo semplice metodo di replica, scaricare [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx) (SAP NetWeaver: Compilazione di una soluzione di ripristino di emergenza basata su Hyper-V e Microsoft) e fare riferimento alla sezione "4.3.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-259">For details about this simple replication method's build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx), and refer to "4.3.</span></span> <span data-ttu-id="2dc0b-260">Livello di SPOF SAP (ASCS)."</span><span class="sxs-lookup"><span data-stu-id="2dc0b-260">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="2dc0b-261">**Livello database**.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-261">**Database tier**.</span></span> <span data-ttu-id="2dc0b-262">Il ripristino di emergenza viene implementato in modo ottimale con la tecnologia di replica integrata propria del database.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-262">DR is best implemented with the database's own integrated replication technology.</span></span> <span data-ttu-id="2dc0b-263">Nel caso di SQL Server, ad esempio, è consigliabile usare un gruppo di disponibilità AlwaysOn per definire una replica in un'area remota, replicando le transazioni in modo asincrono con il failover manuale.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-263">In the case of SQL Server, for example, we recommend using AlwaysOn Availability Group to establish a replica in a remote region, replicating transactions asynchronously with manual failover.</span></span> <span data-ttu-id="2dc0b-264">La replica asincrona non influisce sulle prestazioni dei carichi di lavoro interattivi nel sito primario.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-264">Asynchronous replication avoids an impact to the performance of interactive workloads at the primary site.</span></span> <span data-ttu-id="2dc0b-265">Il failover manuale permette a un utente di valutare l'impatto del ripristino di emergenza e scegliere se è giustificato operare dal sito di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-265">Manual failover offers the opportunity for a person to evaluate the DR impact and decide if operating from the DR site is justified.</span></span>

<span data-ttu-id="2dc0b-266">Per usare Azure Site Recovery in modo da compilare automaticamente un sito di produzione completamente replicato del sito originale, è necessario eseguire [script di distribuzione](/azure/site-recovery/site-recovery-runbook-automation) personalizzati.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-266">To use Azure Site Recovery to automatically build out a fully replicated production site of your original, you must run customized [deployment scripts](/azure/site-recovery/site-recovery-runbook-automation).</span></span> <span data-ttu-id="2dc0b-267">Site Recovery distribuisce prima di tutto le macchine virtuali nei set di disponibilità e quindi esegue gli script per aggiungere risorse, come i servizi di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-267">Site Recovery first deploys the VMs in availability sets, then runs scripts to add resources such as load balancers.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="2dc0b-268">Considerazioni sulla gestibilità</span><span class="sxs-lookup"><span data-stu-id="2dc0b-268">Manageability considerations</span></span>

<span data-ttu-id="2dc0b-269">Azure offre diverse funzioni per [monitoraggio e diagnostica](/azure/architecture/best-practices/monitoring) dell'infrastruttura complessiva.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-269">Azure provides several functions for [monitoring and diagnostics](/azure/architecture/best-practices/monitoring) of the overall infrastructure.</span></span> <span data-ttu-id="2dc0b-270">Inoltre, il monitoraggio avanzato delle macchine virtuali di Azure viene gestito da Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-270">Also, enhanced monitoring of Azure virtual machines is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="2dc0b-271">Per fornire il monitoraggio basato su SAP delle risorse e delle prestazioni del servizio dell'infrastruttura SAP, viene usata l'estensione [Azure Enhanced Monitoring SAP](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-271">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, the [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) extension is used.</span></span> <span data-ttu-id="2dc0b-272">Questa estensione aumenta le statistiche di monitoraggio nell'applicazione SAP per il monitoraggio del sistema operativo e le funzioni del Pannello di controllo DBA.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-272">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="2dc0b-273">Considerazioni relative alla sicurezza</span><span class="sxs-lookup"><span data-stu-id="2dc0b-273">Security considerations</span></span>

<span data-ttu-id="2dc0b-274">SAP dispone del proprio motore di gestione di utenti (UME) per controllare l'accesso basato sui ruoli e l'autorizzazione all'interno dell'applicazione SAP.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-274">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="2dc0b-275">Per informazioni dettagliate, vedere [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/doc/7b932ef4728810148a4b1a83b0e91070/1610 001/en-US/frameset.htm?4dde53b3e9142e51e10000000a42189c.html) (Guida alla sicurezza del server applicazioni SAP NetWeaver per ABAP) e [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm) (Guida alla sicurezza in Java del server applicazioni SAP NetWeaver).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-275">For details, see [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/doc/7b932ef4728810148a4b1a83b0e91070/1610 001/en-US/frameset.htm?4dde53b3e9142e51e10000000a42189c.html) and [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm).</span></span>

<span data-ttu-id="2dc0b-276">Per ottenere sicurezza di rete aggiuntiva, valutare se implementare una [rete perimetrale](../dmz/secure-vnet-hybrid.md), che usa un'appliance di rete virtuale per creare un firewall davanti alla subnet per Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-276">For additional network security, consider implementing a [network DMZ](../dmz/secure-vnet-hybrid.md), which uses a network virtual appliance to create a firewall in front of the subnet for Web Dispatcher.</span></span>

<span data-ttu-id="2dc0b-277">Per la sicurezza dell'infrastruttura, vengono crittografati sia i dati in transito sia quelli inattivi.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-277">For infrastructure security, data is encrypted in transit and at rest.</span></span> <span data-ttu-id="2dc0b-278">La sezione "Considerazioni relative alla sicurezza" di [Guida alla pianificazione e all'implementazione di macchine virtuali di Azure per SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide) presenta alcune informazioni iniziali per soddisfare la sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-278">The "Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) begins to address network security.</span></span> <span data-ttu-id="2dc0b-279">La guida specifica anche le porte di rete che devono essere aperte sui firewall per consentire la comunicazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-279">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span>

<span data-ttu-id="2dc0b-280">Per crittografare dischi di macchine virtuali di Azure, è possibile usare [Crittografia dischi di Azure](/azure/security/azure-security-disk-encryption).</span><span class="sxs-lookup"><span data-stu-id="2dc0b-280">To encrypt Windows virtual machine disks, you can use [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span></span> <span data-ttu-id="2dc0b-281">Questo servizio usa la funzionalità BitLocker di Windows per fornire la crittografia del volume per i dischi dati e del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-281">It uses the BitLocker feature of Windows to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="2dc0b-282">La soluzione può essere usata anche con Azure Key Vault per semplificare il controllo e la gestione dei segreti e delle chiavi di crittografia dei dischi nella sottoscrizione dell'insieme di credenziali delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-282">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your key vault subscription.</span></span> <span data-ttu-id="2dc0b-283">I dati nei dischi delle macchine virtuali vengano crittografati quando inattivi in Archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-283">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

## <a name="communities"></a><span data-ttu-id="2dc0b-284">Community</span><span class="sxs-lookup"><span data-stu-id="2dc0b-284">Communities</span></span>

<span data-ttu-id="2dc0b-285">Le community possono rispondere alle domande ed essere utili per configurare correttamente la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="2dc0b-285">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="2dc0b-286">Valutare gli aspetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="2dc0b-286">Consider the following:</span></span>

- <span data-ttu-id="2dc0b-287">Blog [Running SAP Applications on the Microsoft Platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/) (Esecuzione di applicazioni SAP nella piattaforma Microsoft)</span><span class="sxs-lookup"><span data-stu-id="2dc0b-287">[Running SAP Applications on the Microsoft Platform Blog](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/)</span></span>
- [<span data-ttu-id="2dc0b-288">Supporto della community di Azure</span><span class="sxs-lookup"><span data-stu-id="2dc0b-288">Azure Community Support</span></span>](https://azure.microsoft.com/support/community/)
- [<span data-ttu-id="2dc0b-289">Community SAP</span><span class="sxs-lookup"><span data-stu-id="2dc0b-289">SAP Community</span></span>](https://www.sap.com/community.html)
- [<span data-ttu-id="2dc0b-290">Stack Overflow</span><span class="sxs-lookup"><span data-stu-id="2dc0b-290">Stack Overflow</span></span>](https://stackoverflow.com/tags/sap/)

[visio-download]: https://archcenter.blob.core.windows.net/cdn/sap-reference-architectures.vsdx

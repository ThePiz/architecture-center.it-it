---
title: Integrazione aziendale con code ed eventi di messaggi - Servizi di integrazione di Azure
description: Questa guida di riferimento sull'architettura descrive come implementare un modello di integrazione aziendale usando App per la logica di Azure, Gestione API di Azure, bus di servizio di Azure e Griglia di eventi di Azure
author: mattfarm
ms.author: mattfarm
ms.reviewer: jonfan, estfan, LADocs
ms.topic: article
ms.date: 12/03/2018
ms.openlocfilehash: 6a4d7ce81dfae48f760693a4fc875d5ad59abe3a
ms.sourcegitcommit: e7e0e0282fa93f0063da3b57128ade395a9c1ef9
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 12/05/2018
ms.locfileid: "52919094"
---
# <a name="enterprise-integration-on-azure-using-message-queues-and-events"></a><span data-ttu-id="6aea0-103">Integrazione aziendale in Azure con code ed eventi di messaggi</span><span class="sxs-lookup"><span data-stu-id="6aea0-103">Enterprise integration on Azure using message queues and events</span></span>

<span data-ttu-id="6aea0-104">Questa architettura integra i sistemi back-end aziendali mediante code ed eventi di messaggi per disaccoppiare i servizi per una maggiore scalabilità e affidabilità.</span><span class="sxs-lookup"><span data-stu-id="6aea0-104">This architecture integrates enterprise backend systems, using message queues and events to decouple services for greater scalability and reliability.</span></span> <span data-ttu-id="6aea0-105">I sistemi back-end possono includere sistemi software come un servizio (SaaS), servizi di Azure e servizi Web esistenti nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="6aea0-105">The backend systems may include software as a service (SaaS) systems, Azure services, and existing web services in your enterprise.</span></span>

![Diagramma dell'architettura: integrazione aziendale con code ed eventi](./_images/enterprise-integration-queues-events.png)

## <a name="architecture"></a><span data-ttu-id="6aea0-107">Architettura</span><span class="sxs-lookup"><span data-stu-id="6aea0-107">Architecture</span></span>

<span data-ttu-id="6aea0-108">L'architettura illustrata in questo articolo si basa su un'architettura più semplice illustrata nell'articolo [Integrazione aziendale di base][basic-enterprise-integration].</span><span class="sxs-lookup"><span data-stu-id="6aea0-108">The architecture shown here builds on a simpler architecture that is shown in [Basic enterprise integration][basic-enterprise-integration].</span></span> <span data-ttu-id="6aea0-109">Questa architettura usa [App per la logica][logic-apps] per orchestrare i flussi di lavoro e [Gestione API][apim] per creare cataloghi di API.</span><span class="sxs-lookup"><span data-stu-id="6aea0-109">That architecture uses [Logic Apps][logic-apps] to orchestrate workflows and [API Management][apim] to create catalogs of APIs.</span></span>

<span data-ttu-id="6aea0-110">Questa versione dell'architettura aggiunge due componenti che contribuiscono a rendere il sistema più affidabile e scalabile:</span><span class="sxs-lookup"><span data-stu-id="6aea0-110">This version of the architecture adds two components that help make the system more reliable and scalable:</span></span>

- <span data-ttu-id="6aea0-111">**[Bus di servizio di Azure][service-bus]**.</span><span class="sxs-lookup"><span data-stu-id="6aea0-111">**[Azure Service Bus][service-bus]**.</span></span> <span data-ttu-id="6aea0-112">Il bus di servizio è un broker di messaggi sicuro e affidabile.</span><span class="sxs-lookup"><span data-stu-id="6aea0-112">Service Bus is a secure, reliable message broker.</span></span>  

- <span data-ttu-id="6aea0-113">**[Griglia di eventi di Azure][event-grid]**.</span><span class="sxs-lookup"><span data-stu-id="6aea0-113">**[Azure Event Grid][event-grid]**.</span></span> <span data-ttu-id="6aea0-114">Griglia di eventi è un servizio di routing di eventi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-114">Event Grid is an event routing service.</span></span> <span data-ttu-id="6aea0-115">Usa un modello di gestione degli eventi di pubblicazione/sottoscrizione (pub/sub).</span><span class="sxs-lookup"><span data-stu-id="6aea0-115">It uses a publish/subscribe (pub/sub) eventing model.</span></span>

<span data-ttu-id="6aea0-116">La comunicazione asincrona tramite un broker di messaggi offre una serie di vantaggi rispetto alle chiamate sincrone dirette ai servizi back-end:</span><span class="sxs-lookup"><span data-stu-id="6aea0-116">Asynchronous communication using a message broker provides a number of advantages over making direct, synchronous calls to backend services:</span></span>

- <span data-ttu-id="6aea0-117">Fornisce il livellamento del carico per gestire i picchi di carichi di lavoro usando lo [Schema di livellamento del carico basato sulle code](../../patterns/queue-based-load-leveling.md).</span><span class="sxs-lookup"><span data-stu-id="6aea0-117">Provides load-leveling to handle bursts in workloads, using the [Queue-Based Load Leveling pattern](../../patterns/queue-based-load-leveling.md).</span></span>
- <span data-ttu-id="6aea0-118">Tiene traccia in modo affidabile dello stato di avanzamento dei flussi di lavoro a esecuzione prolungata che coinvolgono più fasi o più applicazioni.</span><span class="sxs-lookup"><span data-stu-id="6aea0-118">Reliably tracks the progress of long-running workflows that involve multiple steps or multiple applications.</span></span>
- <span data-ttu-id="6aea0-119">Consente di disaccoppiare le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="6aea0-119">Helps to decouple applications.</span></span>
- <span data-ttu-id="6aea0-120">Si integra con i sistemi di messaggistica esistenti.</span><span class="sxs-lookup"><span data-stu-id="6aea0-120">Integrates with existing message-based systems.</span></span>
- <span data-ttu-id="6aea0-121">Consente di mettere in coda un lavoro quando non è disponibile un sistema back-end.</span><span class="sxs-lookup"><span data-stu-id="6aea0-121">Allows work to be queued when a backend system is not available.</span></span>

<span data-ttu-id="6aea0-122">Griglia di eventi consente ai vari componenti del sistema di reagire agli eventi man mano che si verificano, anziché basarsi su attività pianificate o di polling.</span><span class="sxs-lookup"><span data-stu-id="6aea0-122">Event Grid enables the various components in the system to react to events as they happen, rather than relying on polling or scheduled tasks.</span></span> <span data-ttu-id="6aea0-123">Come per una coda di messaggi, consente di disaccoppiare applicazioni e servizi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-123">As with a message queue, it helps decouple applications and services.</span></span> <span data-ttu-id="6aea0-124">Un'applicazione o un servizio può pubblicare eventi e i sottoscrittori interessati riceveranno una notifica.</span><span class="sxs-lookup"><span data-stu-id="6aea0-124">An application or service can publish events, and any interested subscribers will be notified.</span></span> <span data-ttu-id="6aea0-125">È possibile aggiungere nuovi sottoscrittori senza aggiornare il mittente.</span><span class="sxs-lookup"><span data-stu-id="6aea0-125">New subscribers can be added without updating the sender.</span></span>

<span data-ttu-id="6aea0-126">Molti servizi di Azure seguenti supportano l'invio degli eventi a Griglia di eventi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-126">Many Azure services support sending events to Event Grid.</span></span> <span data-ttu-id="6aea0-127">Ad esempio, un'app per la logica può essere in ascolto di un evento quando nuovi file vengono aggiunti a un archivio BLOB.</span><span class="sxs-lookup"><span data-stu-id="6aea0-127">For example, a logic app can listen for an event when new files are added to a blob store.</span></span> <span data-ttu-id="6aea0-128">Questo modello consente flussi di lavoro reattivi, in cui il caricamento di un file o l'inserimento di un messaggio in coda dà il via a una serie di processi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-128">This pattern enables reactive workflows, where uploading a file or putting a message on a queue kicks off a series of processes.</span></span> <span data-ttu-id="6aea0-129">I processi possono essere eseguiti in parallelo o in una sequenza specifica.</span><span class="sxs-lookup"><span data-stu-id="6aea0-129">The processes might be executed in parallel or in a specific sequence.</span></span> 

## <a name="recommendations"></a><span data-ttu-id="6aea0-130">Consigli</span><span class="sxs-lookup"><span data-stu-id="6aea0-130">Recommendations</span></span>

<span data-ttu-id="6aea0-131">A questa architettura si applicano i consigli descritti in [Integrazione aziendale di base][basic-enterprise-integration].</span><span class="sxs-lookup"><span data-stu-id="6aea0-131">The recommendations described in [Basic enterprise integration][basic-enterprise-integration] apply to this architecture.</span></span> <span data-ttu-id="6aea0-132">Si applicano anche i consigli seguenti:</span><span class="sxs-lookup"><span data-stu-id="6aea0-132">The following recommendations also apply:</span></span>

### <a name="service-bus"></a><span data-ttu-id="6aea0-133">Bus di servizio</span><span class="sxs-lookup"><span data-stu-id="6aea0-133">Service Bus</span></span> 

<span data-ttu-id="6aea0-134">Il bus di servizio supporta due modalità di recapito: *pull* o *push*.</span><span class="sxs-lookup"><span data-stu-id="6aea0-134">Service Bus has two delivery modes, *pull* or *push*.</span></span> <span data-ttu-id="6aea0-135">Nel modello pull il ricevitore esegue continuamente il polling di nuovi messaggi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-135">In the pull model, the receiver continuously polls for new messages.</span></span> <span data-ttu-id="6aea0-136">Il polling può risultare inefficiente, soprattutto se si hanno molte code ognuna delle quali riceve pochi messaggi o se intercorre molto tempo tra un messaggio e l'altro.</span><span class="sxs-lookup"><span data-stu-id="6aea0-136">Polling can be inefficient, especially if you have many queues that each receive a few messages, or if there a lot of time between messages.</span></span> <span data-ttu-id="6aea0-137">Nel modello push il bus di servizio invia un evento tramite Griglia di eventi quando sono presenti nuovi messaggi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-137">In the push model, Service Bus sends an event through Event Grid when there are new messages.</span></span> <span data-ttu-id="6aea0-138">Il ricevitore sottoscrive l'evento.</span><span class="sxs-lookup"><span data-stu-id="6aea0-138">The receiver subscribes to the event.</span></span> <span data-ttu-id="6aea0-139">Quando viene attivato l'evento, il ricevitore eseguire il pull del successivo batch di messaggi dal bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="6aea0-139">When the event is triggered, the receiver pulls the next batch of messages from Service Bus.</span></span> 

<span data-ttu-id="6aea0-140">Quando si crea un'app per la logica per utilizzare i messaggi del bus di servizio, è consigliabile usare il modello push con l'integrazione di Griglia di eventi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-140">When you create a logic app to consume Service Bus messages, we recommend using the push model with Event Grid integration.</span></span> <span data-ttu-id="6aea0-141">Spesso è più efficiente in termini di costi, perché l'app per la logica non deve eseguire il polling del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="6aea0-141">It's often more cost efficient, because the logic app doesn't need to poll Service Bus.</span></span> <span data-ttu-id="6aea0-142">Per altre informazioni, vedere [Panoramica dell'integrazione del bus di servizio di Azure in Griglia di eventi](/azure/service-bus-messaging/service-bus-to-event-grid-integration-concept).</span><span class="sxs-lookup"><span data-stu-id="6aea0-142">For more information, see [Azure Service Bus to Event Grid integration overview](/azure/service-bus-messaging/service-bus-to-event-grid-integration-concept).</span></span> <span data-ttu-id="6aea0-143">Attualmente, è necessario il [livello Premium](https://azure.microsoft.com/pricing/details/service-bus/) del bus di servizio per le notifiche di Griglia di eventi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-143">Currently, Service Bus [Premium tier](https://azure.microsoft.com/pricing/details/service-bus/) is required for Event Grid notifications.</span></span>

<span data-ttu-id="6aea0-144">Usare [PeekLock](/azure/service-bus-messaging/service-bus-messaging-overview#queues) per accedere a un gruppo di messaggi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-144">Use [PeekLock](/azure/service-bus-messaging/service-bus-messaging-overview#queues) for accessing a group of messages.</span></span> <span data-ttu-id="6aea0-145">Con PeekLock, l'app per la logica può eseguire i passaggi per convalidare ogni messaggio prima di completarlo o abbandonarlo.</span><span class="sxs-lookup"><span data-stu-id="6aea0-145">When you use PeekLock, the logic app can perform steps to validate each message before completing or abandoning the message.</span></span> <span data-ttu-id="6aea0-146">Questo approccio protegge dalla perdita accidentale dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-146">This approach protects against accidental message loss.</span></span>

### <a name="event-grid"></a><span data-ttu-id="6aea0-147">Griglia di eventi</span><span class="sxs-lookup"><span data-stu-id="6aea0-147">Event Grid</span></span> 

<span data-ttu-id="6aea0-148">Quando viene attivato un trigger di Griglia di eventi, significa che si è verificato *almeno* un evento.</span><span class="sxs-lookup"><span data-stu-id="6aea0-148">When an Event Grid trigger fires, it means *at least one* event happened.</span></span> <span data-ttu-id="6aea0-149">Ad esempio, quando un'app per la logica riceve un trigger di Griglia di eventi per un messaggio del bus di servizio, dovrebbe presumere che diversi messaggi potrebbero essere disponibili per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="6aea0-149">For example, when a logic app gets an Event Grid triggers for a Service Bus message, it should assume that several messages might be available to process.</span></span>

<span data-ttu-id="6aea0-150">Griglia di eventi usa un modello senza server.</span><span class="sxs-lookup"><span data-stu-id="6aea0-150">Event Grid uses a serverless model.</span></span> <span data-ttu-id="6aea0-151">La fatturazione viene calcolata in base al numero di operazioni (esecuzioni di eventi).</span><span class="sxs-lookup"><span data-stu-id="6aea0-151">Billing is calculated based on the number of operations (event executions).</span></span> <span data-ttu-id="6aea0-152">Per altre informazioni, vedere [Prezzi di Griglia di eventi](https://azure.microsoft.com/pricing/details/event-grid/).</span><span class="sxs-lookup"><span data-stu-id="6aea0-152">For more information, see [Event Grid pricing](https://azure.microsoft.com/pricing/details/event-grid/).</span></span> <span data-ttu-id="6aea0-153">Attualmente non sono previste indicazioni per la scelta del piano tariffario per Griglia di eventi.</span><span class="sxs-lookup"><span data-stu-id="6aea0-153">Currently, there are no tier considerations for Event Grid.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="6aea0-154">Considerazioni sulla scalabilità</span><span class="sxs-lookup"><span data-stu-id="6aea0-154">Scalability considerations</span></span>

<span data-ttu-id="6aea0-155">Il piano Premium del bus di servizio consente di aumentare il numero di unità di messaggistica per offrire una maggiore scalabilità.</span><span class="sxs-lookup"><span data-stu-id="6aea0-155">To achieve higher scalability, the Service Bus Premium tier can scale out the number of messaging units.</span></span> <span data-ttu-id="6aea0-156">Le configurazioni del piano Premium possono prevedere una, due o quattro unità di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="6aea0-156">Premium tier configurations can have one, two, or four messaging units.</span></span> <span data-ttu-id="6aea0-157">Per altre informazioni sul ridimensionamento del bus di servizio, vedere [Procedure consigliate per il miglioramento delle prestazioni tramite la messaggistica del bus di servizio](/azure/service-bus-messaging/service-bus-performance-improvements).</span><span class="sxs-lookup"><span data-stu-id="6aea0-157">For more information about scaling Service Bus, see [Best practices for performance improvements by using Service Bus Messaging](/azure/service-bus-messaging/service-bus-performance-improvements).</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="6aea0-158">Considerazioni sulla disponibilità</span><span class="sxs-lookup"><span data-stu-id="6aea0-158">Availability considerations</span></span>

<span data-ttu-id="6aea0-159">Esaminare il contratto per ogni servizio:</span><span class="sxs-lookup"><span data-stu-id="6aea0-159">Review the SLA for each service:</span></span>

- <span data-ttu-id="6aea0-160">[Contratto di servizio di Gestione API][apim-sla]</span><span class="sxs-lookup"><span data-stu-id="6aea0-160">[API Management SLA][apim-sla]</span></span>
- <span data-ttu-id="6aea0-161">[Contratto di Servizio per Griglia di eventi][event-grid-sla]</span><span class="sxs-lookup"><span data-stu-id="6aea0-161">[Event Grid SLA][event-grid-sla]</span></span>
- <span data-ttu-id="6aea0-162">[Contratto di servizio di App per la logica][logic-apps-sla]</span><span class="sxs-lookup"><span data-stu-id="6aea0-162">[Logic Apps SLA][logic-apps-sla]</span></span>
- <span data-ttu-id="6aea0-163">[Contratto di Servizio per Bus di servizio][sb-sla]</span><span class="sxs-lookup"><span data-stu-id="6aea0-163">[Service Bus SLA][sb-sla]</span></span>

<span data-ttu-id="6aea0-164">Nell'ambito del piano Premium del bus di servizio è consigliabile implementare il ripristino di emergenza geografico per abilitare il failover in caso di grave interruzione.</span><span class="sxs-lookup"><span data-stu-id="6aea0-164">To enable failover if a serious outage occurs, consider implementing geo-disaster recovery in Service Bus Premium.</span></span> <span data-ttu-id="6aea0-165">Per altre informazioni, vedere [Ripristino di emergenza geografico per il bus di servizio di Azure](/azure/service-bus-messaging/service-bus-geo-dr).</span><span class="sxs-lookup"><span data-stu-id="6aea0-165">For more information, see [Azure Service Bus geo-disaster recovery](/azure/service-bus-messaging/service-bus-geo-dr).</span></span>

## <a name="security-considerations"></a><span data-ttu-id="6aea0-166">Considerazioni relative alla sicurezza</span><span class="sxs-lookup"><span data-stu-id="6aea0-166">Security considerations</span></span>

<span data-ttu-id="6aea0-167">Per proteggere il bus di servizio, usare una firma di accesso condiviso (SAS).</span><span class="sxs-lookup"><span data-stu-id="6aea0-167">To secure Service Bus, use shared access signature (SAS).</span></span> <span data-ttu-id="6aea0-168">È possibile usare l'[autenticazione basata sulla firma di accesso condiviso](/azure/service-bus-messaging/service-bus-sas) per concedere agli utenti l'accesso alle risorse del bus di servizio con diritti specifici.</span><span class="sxs-lookup"><span data-stu-id="6aea0-168">You can grant a user access to Service Bus resources with specific rights by using [SAS authentication](/azure/service-bus-messaging/service-bus-sas).</span></span> <span data-ttu-id="6aea0-169">Per altre informazioni, vedere [Autenticazione e autorizzazione del bus di servizio](/azure/service-bus-messaging/service-bus-authentication-and-authorization).</span><span class="sxs-lookup"><span data-stu-id="6aea0-169">For more information, see [Service Bus authentication and authorization](/azure/service-bus-messaging/service-bus-authentication-and-authorization).</span></span>

<span data-ttu-id="6aea0-170">Se è necessario esporre una coda del bus di servizio come endpoint HTTP, ad esempio per la pubblicazione nuovi messaggi, utilizzare Gestione API per proteggere la coda mettendo al sicuro l'endpoint.</span><span class="sxs-lookup"><span data-stu-id="6aea0-170">If you need to expose a Service Bus queue as an HTTP endpoint, for example, to post new messages, use API Management to secure the queue by fronting the endpoint.</span></span> <span data-ttu-id="6aea0-171">L'endpoint può quindi essere protetto tramite certificati o autenticazione OAuth, a seconda delle esigenze.</span><span class="sxs-lookup"><span data-stu-id="6aea0-171">You can then secure the endpoint with certificates or OAuth authentication as appropriate.</span></span> <span data-ttu-id="6aea0-172">Il modo più semplice per proteggere un endpoint è quello di usare un'app per la logica con un trigger di richiesta/risposta HTTP come intermediario.</span><span class="sxs-lookup"><span data-stu-id="6aea0-172">The easiest way to secure an endpoint is using a logic app with an HTTP request/response trigger as an intermediary.</span></span>

<span data-ttu-id="6aea0-173">Il servizio Griglia di eventi consente di proteggere il recapito dell'evento tramite un codice di convalida.</span><span class="sxs-lookup"><span data-stu-id="6aea0-173">The Event Grid service secures event delivery through a validation code.</span></span> <span data-ttu-id="6aea0-174">Se si usa App per la logica per gestire l'evento, la convalida viene eseguita automaticamente.</span><span class="sxs-lookup"><span data-stu-id="6aea0-174">If you use Logic Apps to consume the event, validation is automatically performed.</span></span> <span data-ttu-id="6aea0-175">Per altre informazioni, vedere [Event Grid security and authentication](/azure/event-grid/security-authentication) (Sicurezza e autenticazione di Griglia di eventi).</span><span class="sxs-lookup"><span data-stu-id="6aea0-175">For more information, see [Event Grid security and authentication](/azure/event-grid/security-authentication).</span></span>


[apim]: /azure/api-management
[apim-sla]: https://azure.microsoft.com/support/legal/sla/api-management/
[event-grid]: /azure/event-grid/
[event-grid-sla]: https://azure.microsoft.com/support/legal/sla/event-grid
[logic-apps]: /azure/logic-apps/logic-apps-overview
[logic-apps-sla]: https://azure.microsoft.com/support/legal/sla/logic-apps
[sb-sla]: https://azure.microsoft.com/support/legal/sla/service-bus/
[service-bus]: /azure/service-bus-messaging/
[basic-enterprise-integration]: ./basic-enterprise-integration.md
---
title: Elenco di controllo della disponibilità
titleSuffix: Azure Design Review Framework
description: Elenco di controllo in cui vengono fornite le linee guida per i problemi di disponibilità durante la progettazione.
author: dragon119
ms.date: 11/26/2018
ms.topic: checklist
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.custom: checklist
ms.openlocfilehash: 2e0c337cb0a5f343ae3dd94ae209d01f063cab35
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 01/23/2019
ms.locfileid: "54483585"
---
# <a name="availability-checklist"></a>Elenco di controllo della disponibilità

La disponibilità è la percentuale di tempo in cui un sistema è funzionante ed è uno dei [punti chiave della qualità del software](../guide/pillars.md). Usare questo elenco di controllo per esaminare l'architettura delle applicazioni in relazione alla disponibilità.

## <a name="application-design"></a>Progettazione di applicazioni

**Evitare i singoli punti di errore.**  Tutti i componenti, i servizi, le risorse e le istanze di calcolo devono essere distribuiti come istanze multiple, per impedire che un singolo punto di errore influisca sulla disponibilità. Sono inclusi i meccanismi di autenticazione. Progettare l'applicazione in modo che possa essere configurata per utilizzare più istanze e per rilevare gli errori e reindirizzare le richieste a istanze senza errori, nei casi in cui la piattaforma non esegue questa operazione automaticamente.

**Scomporre i carichi di lavoro in base all'obiettivo a livello di servizio.**  Se un servizio è composto da carichi di lavoro critici e meno critici, gestirli in modo diverso e specificare le funzionalità del servizio e il numero di istanze per soddisfare i rispettivi requisiti di disponibilità.

**Ridurre al minimo e comprendere le dipendenze del servizio.**  Ridurre al minimo il numero dei servizi diversi utilizzati laddove possibile e assicurarsi di comprendere tutte le dipendenze di funzionalità e servizi presenti nel sistema. Ciò include la natura di tali dipendenze e l'impatto dell’errore o del peggioramento delle prestazioni in ciascuna di esse sull’applicazione globale.

**Progettare attività e messaggi in modo che siano idempotenti, se possibile**. Un'operazione è idempotente se può essere ripetuta più volte producendo lo stesso risultato. L'idempotenza può garantire che richieste duplicate non causino problemi. I consumer di messaggi e le operazioni da essi effettuate devono essere idempotenti, affinché la ripetizione di un'operazione eseguita in precedenza non invalidi i risultati. Ciò potrebbe significare rilevamento di messaggi duplicati, oppure la garanzia di coerenza tramite un approccio ottimistico alla gestione dei conflitti.

**Utilizzare un gestore dei messaggi che implementa l’elevata disponibilità per le transazioni critiche.** Molte applicazioni cloud usano la messaggistica per avviare attività eseguite in modo asincrono. Per garantire il recapito dei messaggi, il sistema di messaggistica deve garantire un'elevata disponibilità. La [messaggistica del bus di servizio di Azure](/azure/service-bus-messaging) implementa la semantica di tipo *At-Least-Once*. In questo modo, un messaggio inviato a una coda non andrà perso, anche se in alcune circostanze potrebbero essere recapitate copie duplicate. Se l'elaborazione dei messaggi è idempotente (vedere la voce precedente), il recapito ripetuto non dovrebbe essere un problema.

**Progettare le applicazioni in modo che le prestazioni si riducano in modo non drastico.** Il carico su un'applicazione può superare la capacità di una o più parti e causare così una riduzione della disponibilità ed errori di connessione. Il ridimensionamento consente di ovviare a questo problema, ma può raggiungere un limite imposto da altri fattori quali la disponibilità delle risorse o costi. Quando un'applicazione raggiunge il limite di una risorsa, deve eseguire le operazioni necessarie per ridurre al minimo l'impatto per l'utente. In un sistema di e-commerce, ad esempio, se il sottosistema di elaborazione degli ordini è sotto pressione o in errore, è possibile disabilitare temporaneamente tale sottosistema supportando al tempo stesso altre funzionalità, come l'esplorazione del catalogo prodotti. Potrebbe essere opportuno posticipare le richieste a un sottosistema in errore, ad esempio consentendo comunque agli utenti di inviare ordini ma salvandoli per l'elaborazione successiva quando il sottosistema di ordini è nuovamente disponibile.

**Gestire correttamente gli eventi burst rapidi.** La maggior parte delle applicazioni deve gestire carichi di lavoro variabili nel tempo. La scalabilità automatica consente di gestire il carico, ma potrebbe richiedere tempo per portare online istanze aggiuntive e gestire le richieste. Evitare che picchi di attività improvvisi e inattesi causino il sovraccarico dell'applicazione progettando quest'ultima in modo che accodi le richieste ai servizi che usa e riduca le prestazioni in modo non drastico quando le code sono vicine alla capacità completa. Assicurarsi che le prestazioni e la capacità disponibili siano sufficienti in condizioni di non burst a svuotare le code e gestire le richieste in sospeso. Per ulteriori informazioni, vedere il [modello di livellamento dei carichi basato sulle code](../patterns/queue-based-load-leveling.md).

## <a name="deployment-and-maintenance"></a>Distribuzione e manutenzione

**Distribuire più istanze di servizi.** Se l'applicazione dipende da una singola istanza di un servizio, crea un singolo punto di errore. Il provisioning di più istanze migliora sia la resilienza che la scalabilità. Per [Servizio app di Azure](/azure/app-service/app-service-value-prop-what-is/) selezionare un [Piano di servizio app](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) che offra più istanze. Per Servizi cloud di Azure, configurare ognuno dei ruoli in modo da usare [più istanze](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management). Per [Macchine virtuali di Microsoft Azure](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), verificare che l'architettura VM includa più macchine virtuali e che ogni macchina virtuale sia inclusa in un [set di disponibilità][availability-sets].

**Considerare di distribuire l'applicazione tra più aree.** Se l'applicazione è distribuita in un'unica area, nel raro caso in cui l'intera area diventi non disponibile, anche l'applicazione diventa non disponibile. Questa circostanza potrebbe essere inaccettabile in base alle condizioni del contratto di servizio dell'applicazione. In questo caso, occorre considerare la possibilità di distribuire l'applicazione e i relativi servizi tra più aree.

**Automatizzare ed eseguire il test delle attività di distribuzione e manutenzione.**  Le applicazioni distribuite sono costituite da più parti che devono interagire tra loro. La distribuzione deve essere automatizzata, con meccanismi testati e collaudati come gli script. È necessario inoltre utilizzare tecniche automatizzate per eseguire aggiornamenti di tutte le applicazioni o di parte di esse. Usare [modelli di Azure Resource Manager](/azure/azure-resource-manager/resource-group-authoring-templates) per effettuare il provisioning della risorsa di Azure e tecniche automatizzate per eseguire gli aggiornamenti dell'applicazione. Tutti gli strumenti di distribuzione devono disporre di limitazioni della sicurezza appropriati per proteggere l'applicazione distribuita. Definire e applicare i criteri di distribuzione con attenzione e ridurre al minimo la necessità dell’intervento umano.

**Usare le funzionalità di staging e di produzione della piattaforma.**. Il servizio app di Azure, ad esempio, supporta [slot di distribuzione](/azure/app-service/web-sites-staged-publishing) che possono essere usati per lo staging di una distribuzione prima dell'implementazione nell'ambiente di produzione. Azure Service Fabric supporta [aggiornamenti in sequenza](/azure/service-fabric/service-fabric-application-upgrade) dei servizi dell'applicazione.

**Inserire le macchine virtuali (VM) in un set di disponibilità.** Per ottimizzare la disponibilità, creare più istanze di ogni ruolo VM e inserire tali istanze nello stesso set di disponibilità. Se sono presenti più macchine virtuali per ruoli differenti, ad esempio diversi livelli dell'applicazione, creare un set di disponibilità per ogni ruolo macchina virtuale. Ad esempio, creare un set di disponibilità per il livello Web e un altro per il livello dati.

**Replicare le macchine virtuali con Azure Site Recovery.** Per ottimizzare la disponibilità, replicare tutte le macchine virtuali in un'altra area di Azure usando [Site Recovery][site-recovery]. Assicurarsi che tutte le macchine virtuali in tutti i livelli dell'applicazione vengono replicate. Se si verifica un'interruzione nell'area di origine, è possibile eseguire il failover delle macchine virtuali nell'altra area entro pochi minuti.

## <a name="data-management"></a>Gestione dei dati

**Dati di replica geografica in Archiviazione di Azure**. I dati in Archiviazione di Azure vengono replicati automaticamente in un datacenter. Per una disponibilità ancora maggiore, usare l'Archiviazione con ridondanza geografica e accesso in lettura, che replica i dati in un'area secondaria e fornisce l'accesso in sola lettura ai dati nella posizione secondaria. I dati sono presenti anche in caso di interruzione totale nell'area o in caso di emergenza. Per altre informazioni, vedere [Replica di Archiviazione di Azure](/azure/storage/storage-redundancy).

**Eseguire la replica geografica dei dati**. Database SQL di Azure e Cosmos DB supportano entrambi la replica geografica che consente di configurare le repliche del database secondario in altre aree. Sono disponibili database secondari per l'esecuzione di query e il failover in caso di interruzione di un data center o dell'impossibilità di connettersi al database primario. Per altre informazioni, vedere [Gruppi di failover e replica geografica attiva](/azure/sql-database/sql-database-geo-replication-overview) (Database SQL) e [Come distribuire i dati a livello globale con Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).

**Usare la concorrenza ottimistica e la coerenza finale**. Le transazioni che bloccano l'accesso alle risorse tramite il blocco (concorrenza pessimistica) possono influire negativamente sulle prestazioni e ridurre notevolmente la disponibilità. Questi problemi possono diventare particolarmente gravi nei sistemi distribuiti. In molti casi, un'attenta progettazione e tecniche come il partizionamento possono ridurre al minimo il rischio del verificarsi di conflitti tra gli aggiornamenti. Quando i dati vengono replicati o vengono letti da un archivio aggiornato separatamente, i dati saranno coerenti solo alla fine. I vantaggi superano in genere notevolmente l'impatto sulla disponibilità rispetto all'uso di transazioni per assicurare la coerenza immediata.

**Usare il backup periodico e il ripristino temporizzato**. Eseguire il backup automatico regolare dei dati non viene mantenuti in un'altra posizione e verificare che sia possibile ripristinare i dati e l'applicazione stessa in modo affidabile nel caso in cui si verifichi un errore. Verificare che i backup soddisfino l'obiettivo del punto di ripristino (RPO). La replica dei dati non è una funzionalità di backup, perché operazioni dannose o errori umani possono danneggiare i dati in tutte le repliche. Il processo di backup deve essere sicuro, per proteggere i dati in transito e nel servizio di archiviazione. I database o le parti di un archivio dati possono essere generalmente recuperati a un punto precedente nel tempo utilizzando i log delle transazioni. Per altre informazioni, vedere [Ripristino dal danneggiamento o dall'eliminazione accidentale dei dati](../resiliency/recovery-data-corruption.md).

**Replicare i dischi della macchina virtuale con Azure Site Recovery.** Quando si esegue la replica di macchine virtuali di Azure usando [Site Recovery][site-recovery], tutti i dischi delle macchine virtuali vengono replicati nell'area di destinazione in modo continuativo e asincrono. I punti di ripristino vengono creati a intervalli di pochi minuti. In tal modo, si ottiene un RPO nell'ordine di minuti.

## <a name="errors-and-failures"></a>Errori e operazioni non riuscite

**Configurare i timeout delle richieste.**  Servizi e risorse possono diventare non disponibili, causando la mancata riuscita delle richieste. Assicurarsi che i timeout applicati siano appropriati per ogni servizio o risorsa, oltre che per il client che vi accede. In alcuni casi si potrebbe consentire un timeout più lungo per una determinata istanza di un client, in base al contesto e alle altre azioni eseguite dal client. I timeout molto brevi potrebbero provocare un numero eccessivo di nuovi tentativi per i servizi e le risorse con latenza notevole. I timeout molto lunghi possono provocare il blocco se viene accodato un numero elevato di richieste, in attesa della risposta di un servizio o di una risorsa.

**Riprovare a eseguire operazioni non riuscite causate da errori temporanei.**  Progettare una strategia di tentativi per l'accesso a tutti i servizi e risorse se non supportano i tentativi di connessione automatica. Usare una strategia che includa l'aumento del ritardo tra i tentativi in proporzione all'aumento del numero di errori per impedire il sovraccarico della risorsa e consentire il ripristino e la gestione normali delle richieste in coda. Tentativi continui con ritardi molto brevi possono aggravare il problema. Per altre informazioni, vedere [Retry guidance for specific services](../best-practices/retry-service-specific.md) (Linee guida per la ripetizione dei tentativi per servizi specifici).

**Implementare l'interruzione del circuito per evitare errori a catena.** In alcune situazioni, errori temporanei o altri errori, dalla perdita parziale di connettività al guasto completo di un servizio, richiedono tempi più lunghi del previsto per tornare alla normalità. Se un servizio è molto occupato, un errore in una parte del sistema può causare errori a catena e far sì che molte operazioni restino bloccate pur continuando a usare risorse di sistema critiche come memoria, thread e connessioni di database. Anziché riprovare continuamente a eseguire un'operazione che è improbabile venga eseguita correttamente, l'applicazione deve accettare rapidamente che l'operazione non riesce e gestire correttamente l'errore. Usare il modello a interruttore per rifiutare le richieste per operazioni specifiche per periodi definiti. Per altre informazioni, vedere il [modello a interruttore](../patterns/circuit-breaker.md).

**Comporre più componenti o eseguire il fallback.** Progettare le applicazioni in modo da usare più istanze senza impatto sul funzionamento e sulle connessioni esistenti, se possibile. Per ottimizzare la disponibilità, usare più istanze e distribuire le richieste tra di esse, rilevare ed evitare l'invio di richieste a istanze non riuscite.

**Eseguire il fallback a un altro servizio o flusso di lavoro.** Se la scrittura nel database SQL ha esito negativo, ad esempio, archiviare temporaneamente i dati nell'archivio BLOB o nella cache Redis. Fornire un modo per ripetere le scritture nel database SQL quando il servizio risulta disponibile. In alcuni casi, un'operazione non riuscita può avere un'azione alternativa che consente all'applicazione di continuare a funzionare persino in caso di errore di un componente o di un servizio. Se possibile, rilevare gli errori e reindirizzare le richieste ad altri servizi in grado di offrire una funzionalità alternativa adatta, o per eseguire il backup o ridurre le istanze di funzionalità in grado di gestire operazioni di base mentre il servizio primario è offline.

## <a name="monitoring-and-disaster-recovery"></a>Monitoraggio e ripristino di emergenza

**Fornire strumenti avanzati per probabili errori ed eventi di errore** per segnalare la situazione al personale addetto alle operazioni. Per gli errori che sono probabili ma che non si sono ancora verificati, fornire i dati sufficienti per consentire al personale addetto alle operazioni di determinare la causa, ridurre la situazione e garantire che il sistema rimanga disponibile. Per gli errori che si sono già verificati, l'applicazione deve restituire all'utente un messaggio di errore appropriato, ma deve provare a continuare l'esecuzione, sebbene con funzionalità ridotte. In tutti i casi, il sistema di monitoraggio deve acquisire i dettagli completi per consentire al personale addetto alle operazioni di effettuare un ripristino rapido e, se necessario per progettisti e sviluppatori, di modificare il sistema per impedire che si verifichi nuovamente la situazione.

**Monitorare l'integrità di sistema mediante l'implementazione di funzioni di controllo.**  L'integrità e le prestazioni di un'applicazione possono peggiorare nel tempo senza che il peggioramento sia evidente, fino a quando non si verificano degli errori. Implementare funzioni di tipo probe o di controllo che vengono eseguite regolarmente dall'esterno dell'applicazione. Questi controlli possono essere semplici come la misurazione del tempo di risposta per l'intera applicazione, per le singole parti dell'applicazione, per i singoli servizi utilizzati dall'applicazione o per i singoli componenti. Le funzioni di controllo possono eseguire processi per garantire la produzione di risultati validi, misurare la latenza, controllare la disponibilità ed estrarre informazioni dal sistema.

**Testare regolarmente tutti i sistemi di failover e fallback.** Le modifiche ai sistemi e alle operazioni possono influire sulle funzioni di fallback e failover, ma l'impatto potrebbe non essere rilevato fino a quando si verifica un errore nel sistema principale o finché questo non è in overload. Eseguire il test del sistema prima che divenga necessario per risolvere un problema in tempo reale in fase di esecuzione. Se si usa [Azure Site Recovery] [ site-recovery] per replicare le macchine virtuali, eseguire periodicamente esercitazioni sul ripristino di emergenza con un failover di test. Per altre informazioni, vedere [Eseguire un'esercitazione sul ripristino di emergenza in Azure][site-recovery-test].

**Eseguire il test dei sistemi di monitoraggio.**  I sistemi automatizzati di failover e fallback e la visualizzazione manuale dell'integrità e delle prestazioni del sistema tramite i dashboard dipendono tutti dal funzionamento corretto del monitoraggio e della strumentazione. In caso di errore di questi elementi, in assenza di informazioni importanti o in caso di segnalazione di dati non precisi, un operatore potrebbe non rendersi conto che il sistema è danneggiato o guasto.

**Tenere traccia dello stato di avanzamento dei flussi di lavoro a esecuzione prolungata e riprovare in caso di errore.** I flussi di lavoro con esecuzione prolungata sono spesso costituiti da più passaggi. Assicurarsi che ogni passaggio sia indipendente e possa essere ripetuto per ridurre al minimo le probabilità della necessità di un rollback dell'intero flusso di lavoro o dell'esecuzione di più transazioni di compensazione. Monitorare e gestire lo stato dei flussi di lavoro a esecuzione prolungata implementando un modello come il [modello supervisore dell'agente dell'utilità di pianificazione](../patterns/scheduler-agent-supervisor.md).

**Pianificare il ripristino di emergenza** Creare un piano accettato e interamente testato per qualsiasi tipo di errore che potrebbe influire sulla disponibilità del sistema. Scegliere un'architettura di ripristino di emergenza multisito per tutte le applicazioni di importanza critica. Identificare un proprietario specifico per il piano di ripristino di emergenza che comprende l'automazione e i test. Verificare che il piano sia ben documentato e automatizzare il processo il più possibile. Stabilire una strategia di backup per tutti i dati di riferimento e transazionali e testare il ripristino di questi backup in modo regolare. Eseguire il training del personale addetto alle operazioni di esecuzione del piano ed eseguire simulazioni regolari per convalidare e migliorare il piano. Se si usa [Azure Site Recovery][site-recovery] per replicare le macchine virtuali, creare un piano di ripristino completamente automatizzato per eseguire il failover dell'intera applicazione in pochi minuti.

<!-- links -->
[availability-sets]:/azure/virtual-machines/virtual-machines-windows-manage-availability/
[site-recovery]: /azure/site-recovery/
[site-recovery-test]: /azure/site-recovery/site-recovery-test-failover-to-azure

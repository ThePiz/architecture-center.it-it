---
title: Progettazione per la correzione automatica
titleSuffix: Azure Application Architecture Guide
description: In caso di guasto, le applicazioni resilienti possono essere ripristinate senza alcun intervento manuale.
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19
ms.openlocfilehash: 84bc6e5c8d78517e3dc1dc0ee8d250346a33ce43
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/17/2019
ms.locfileid: "59641196"
---
# <a name="design-for-self-healing"></a><span data-ttu-id="374c6-103">Progettazione per la correzione automatica</span><span class="sxs-lookup"><span data-stu-id="374c6-103">Design for self healing</span></span>

## <a name="design-your-application-to-be-self-healing-when-failures-occur"></a><span data-ttu-id="374c6-104">Progettare l'applicazione in modo che sia in grado di eseguire la correzione automatica dei propri errori</span><span class="sxs-lookup"><span data-stu-id="374c6-104">Design your application to be self healing when failures occur</span></span>

<span data-ttu-id="374c6-105">In un sistema distribuito possono verificarsi errori.</span><span class="sxs-lookup"><span data-stu-id="374c6-105">In a distributed system, failures happen.</span></span> <span data-ttu-id="374c6-106">Gli hardware possono danneggiarsi.</span><span class="sxs-lookup"><span data-stu-id="374c6-106">Hardware can fail.</span></span> <span data-ttu-id="374c6-107">La rete, poi, può avere errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="374c6-107">The network can have transient failures.</span></span> <span data-ttu-id="374c6-108">Raramente un intero servizio o area può subire delle interruzioni, tuttavia è necessario pianificare anche questo tipo di problemi.</span><span class="sxs-lookup"><span data-stu-id="374c6-108">Rarely, an entire service or region may experience a disruption, but even those must be planned for.</span></span>

<span data-ttu-id="374c6-109">A tal fine, è consigliabile progettare l'applicazione in modo che sia in grado di eseguire la correzione automatica dei propri errori.</span><span class="sxs-lookup"><span data-stu-id="374c6-109">Therefore, design an application to be self healing when failures occur.</span></span> <span data-ttu-id="374c6-110">Ciò richiede un approccio a tre fasi:</span><span class="sxs-lookup"><span data-stu-id="374c6-110">This requires a three-pronged approach:</span></span>

- <span data-ttu-id="374c6-111">Rilevamento degli errori.</span><span class="sxs-lookup"><span data-stu-id="374c6-111">Detect failures.</span></span>
- <span data-ttu-id="374c6-112">Risposta graduale agli errori.</span><span class="sxs-lookup"><span data-stu-id="374c6-112">Respond to failures gracefully.</span></span>
- <span data-ttu-id="374c6-113">Acquisizione di informazioni operative tramite la registrazione e il monitoraggio degli errori.</span><span class="sxs-lookup"><span data-stu-id="374c6-113">Log and monitor failures, to give operational insight.</span></span>

<span data-ttu-id="374c6-114">La modalità di risposta a un determinato tipo di errore può dipendere dai requisiti di disponibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="374c6-114">How you respond to a particular type of failure may depend on your application's availability requirements.</span></span> <span data-ttu-id="374c6-115">Quando è richiesta una disponibilità elevata, ad esempio, è consigliabile effettuare il failover automatico in un'area secondaria in caso di interruzione in un'area.</span><span class="sxs-lookup"><span data-stu-id="374c6-115">For example, if you require very high availability, you might automatically fail over to a secondary region during a regional outage.</span></span> <span data-ttu-id="374c6-116">Ciò tuttavia comporta un costo superiore rispetto alla distribuzione in una singola area.</span><span class="sxs-lookup"><span data-stu-id="374c6-116">However, that will incur a higher cost than a single-region deployment.</span></span>

<span data-ttu-id="374c6-117">È bene inoltre non valutare solo eventi importanti come le interruzioni a livello di area, in genere rare.</span><span class="sxs-lookup"><span data-stu-id="374c6-117">Also, don't just consider big events like regional outages, which are generally rare.</span></span> <span data-ttu-id="374c6-118">È consigliabile invece concentrarsi sulla gestione degli errori locali e di breve durata, ad esempio gli errori di connettività di rete o le connessioni di database non riuscite.</span><span class="sxs-lookup"><span data-stu-id="374c6-118">You should focus as much, if not more, on handling local, short-lived failures, such as network connectivity failures or failed database connections.</span></span>

## <a name="recommendations"></a><span data-ttu-id="374c6-119">Consigli</span><span class="sxs-lookup"><span data-stu-id="374c6-119">Recommendations</span></span>

<span data-ttu-id="374c6-120">**Ritentare le operazioni non riuscite**.</span><span class="sxs-lookup"><span data-stu-id="374c6-120">**Retry failed operations**.</span></span> <span data-ttu-id="374c6-121">Gli errori temporanei possono dipendere da una perdita momentanea della connettività di rete, da una connessione a un database eliminato o da un timeout che si verifica quando un servizio è occupato.</span><span class="sxs-lookup"><span data-stu-id="374c6-121">Transient failures may occur due to momentary loss of network connectivity, a dropped database connection, or a timeout when a service is busy.</span></span> <span data-ttu-id="374c6-122">Per gestire gli errori temporanei, nell'applicazione va prevista una logica di ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="374c6-122">Build retry logic into your application to handle transient failures.</span></span> <span data-ttu-id="374c6-123">In molti servizi di Azure, l'SDK client implementa i tentativi automatici.</span><span class="sxs-lookup"><span data-stu-id="374c6-123">For many Azure services, the client SDK implements automatic retries.</span></span> <span data-ttu-id="374c6-124">Per altre informazioni, vedere [Gestione degli errori temporanei][transient-fault-handling] e [Modello di ripetizione dei tentativi][retry].</span><span class="sxs-lookup"><span data-stu-id="374c6-124">For more information, see [Transient fault handling][transient-fault-handling] and the [Retry pattern][retry].</span></span>

<span data-ttu-id="374c6-125">**Proteggere dagli errori i servizi remoti (Interruttore)**.</span><span class="sxs-lookup"><span data-stu-id="374c6-125">**Protect failing remote services (Circuit Breaker)**.</span></span> <span data-ttu-id="374c6-126">Effettuare un tentativo dopo un errore temporaneo è un metodo valido, ma se il problema persiste può accadere che si ricevano segnalazioni di malfunzionamento del servizio da un numero eccessivo di chiamanti.</span><span class="sxs-lookup"><span data-stu-id="374c6-126">It's good to retry after a transient failure, but if the failure persists, you can end up with too many callers hammering a failing service.</span></span> <span data-ttu-id="374c6-127">Il sommarsi delle richieste può innescare errori a catena.</span><span class="sxs-lookup"><span data-stu-id="374c6-127">This can lead to cascading failures, as requests back up.</span></span> <span data-ttu-id="374c6-128">Usare il [modello a interruttore][circuit-breaker] per fallire e rispondere immediatamente agli errori, senza chiamata remota, quando un'operazione avrà probabilmente esito negativo.</span><span class="sxs-lookup"><span data-stu-id="374c6-128">Use the [Circuit Breaker pattern][circuit-breaker] to fail fast (without making the remote call) when an operation is likely to fail.</span></span>

<span data-ttu-id="374c6-129">**Isolare le risorse critiche (A scomparti)**.</span><span class="sxs-lookup"><span data-stu-id="374c6-129">**Isolate critical resources (Bulkhead)**.</span></span> <span data-ttu-id="374c6-130">Gli errori in un sottosistema possono propagarsi.</span><span class="sxs-lookup"><span data-stu-id="374c6-130">Failures in one subsystem can sometimes cascade.</span></span> <span data-ttu-id="374c6-131">Questa situazione può verificarsi se un errore fa sì che alcune risorse, come i thread o i socket, non siano liberate in modo tempestivo, causandone l'esaurimento.</span><span class="sxs-lookup"><span data-stu-id="374c6-131">This can happen if a failure causes some resources, such as threads or sockets, not to get freed in a timely manner, leading to resource exhaustion.</span></span> <span data-ttu-id="374c6-132">Per evitare questo problema, è possibile suddividere un sistema in gruppi isolati, in modo che un errore in una partizione non causi l'arresto dell'intero sistema.</span><span class="sxs-lookup"><span data-stu-id="374c6-132">To avoid this, partition a system into isolated groups, so that a failure in one partition does not bring down the entire system.</span></span>

<span data-ttu-id="374c6-133">**Adottare il livellamento del carico**.</span><span class="sxs-lookup"><span data-stu-id="374c6-133">**Perform load leveling**.</span></span> <span data-ttu-id="374c6-134">Nelle applicazioni possono verificarsi picchi improvvisi di traffico sovraccaricano i servizi nel back-end.</span><span class="sxs-lookup"><span data-stu-id="374c6-134">Applications may experience sudden spikes in traffic that can overwhelm services on the backend.</span></span> <span data-ttu-id="374c6-135">Per evitare questo problema, usare lo [schema di livellamento del carico basato sulle code] [load-level] per inserire in coda gli elementi di lavoro per l'esecuzione asincrona.</span><span class="sxs-lookup"><span data-stu-id="374c6-135">To avoid this, use the [Queue-Based Load Leveling pattern][load-level] to queue work items to run asynchronously.</span></span> <span data-ttu-id="374c6-136">La coda si comporta come un buffer che contiene i picchi di carico.</span><span class="sxs-lookup"><span data-stu-id="374c6-136">The queue acts as a buffer that smooths out peaks in the load.</span></span>

<span data-ttu-id="374c6-137">**Effettuare il failover**.</span><span class="sxs-lookup"><span data-stu-id="374c6-137">**Fail over**.</span></span> <span data-ttu-id="374c6-138">Se un'istanza non è raggiungibile, effettuare il failover su un'altra istanza.</span><span class="sxs-lookup"><span data-stu-id="374c6-138">If an instance can't be reached, fail over to another instance.</span></span> <span data-ttu-id="374c6-139">Per gli elementi senza stato, ad esempio un server Web, inserire più istanze dietro a un servizio di bilanciamento del carico o di gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="374c6-139">For things that are stateless, like a web server, put several instances behind a load balancer or traffic manager.</span></span> <span data-ttu-id="374c6-140">Per elementi che archiviano lo stato, ad esempio un database, usare le repliche e il failover.</span><span class="sxs-lookup"><span data-stu-id="374c6-140">For things that store state, like a database, use replicas and fail over.</span></span> <span data-ttu-id="374c6-141">A seconda dell'archivio dati e della relativa modalità di replica, ciò può richiedere all'applicazione di gestire la coerenza.</span><span class="sxs-lookup"><span data-stu-id="374c6-141">Depending on the data store and how it replicates, this may require the application to deal with eventual consistency.</span></span>

<span data-ttu-id="374c6-142">**Compensare le transazioni non riuscite**.</span><span class="sxs-lookup"><span data-stu-id="374c6-142">**Compensate failed transactions**.</span></span> <span data-ttu-id="374c6-143">In generale è consigliabile evitare le transazioni distribuite, in quanto richiedono il coordinamento tra servizi e risorse.</span><span class="sxs-lookup"><span data-stu-id="374c6-143">In general, avoid distributed transactions, as they require coordination across services and resources.</span></span> <span data-ttu-id="374c6-144">In alternativa, creare un'operazione costituita da singole transazioni più piccole.</span><span class="sxs-lookup"><span data-stu-id="374c6-144">Instead, compose an operation from smaller individual transactions.</span></span> <span data-ttu-id="374c6-145">Se l'operazione si interrompe prima del termine, usare il modello [Transazioni di compensazione] [ compensating-transactions] per annullare qualsiasi passaggio già completato.</span><span class="sxs-lookup"><span data-stu-id="374c6-145">If the operation fails midway through, use [Compensating Transactions][compensating-transactions] to undo any step that already completed.</span></span>

<span data-ttu-id="374c6-146">**Eseguire il checkpoint delle transazioni con esecuzione prolungata**.</span><span class="sxs-lookup"><span data-stu-id="374c6-146">**Checkpoint long-running transactions**.</span></span> <span data-ttu-id="374c6-147">I checkpoint possono fornire resilienza qualora un'operazione con esecuzione prolungata non riesca.</span><span class="sxs-lookup"><span data-stu-id="374c6-147">Checkpoints can provide resiliency if a long-running operation fails.</span></span> <span data-ttu-id="374c6-148">Quando l'operazione si riavvia (ad esempio, viene prelevata da un'altra macchina virtuale), può essere ripresa a partire dall'ultimo checkpoint.</span><span class="sxs-lookup"><span data-stu-id="374c6-148">When the operation restarts (for example, it is picked up by another VM), it can be resumed from the last checkpoint.</span></span>

<span data-ttu-id="374c6-149">**Ridurre le prestazioni in modo graduale**.</span><span class="sxs-lookup"><span data-stu-id="374c6-149">**Degrade gracefully**.</span></span> <span data-ttu-id="374c6-150">In alcuni casi non è possibile risolvere un problema, ma è può risultare comunque utile offrire funzionalità ridotte.</span><span class="sxs-lookup"><span data-stu-id="374c6-150">Sometimes you can't work around a problem, but you can provide reduced functionality that is still useful.</span></span> <span data-ttu-id="374c6-151">Si consideri un'applicazione in cui viene visualizzato un catalogo di libri.</span><span class="sxs-lookup"><span data-stu-id="374c6-151">Consider an application that shows a catalog of books.</span></span> <span data-ttu-id="374c6-152">Nel caso in cui l'applicazione non possa recuperare l'immagine di anteprima di una copertina, si potrebbe visualizzare un'immagine segnaposto.</span><span class="sxs-lookup"><span data-stu-id="374c6-152">If the application can't retrieve the thumbnail image for the cover, it might show a placeholder image.</span></span> <span data-ttu-id="374c6-153">Interi sottosistemi possono non essere critici per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="374c6-153">Entire subsystems might be noncritical for the application.</span></span> <span data-ttu-id="374c6-154">Ad esempio, in un sito di e-commerce la visualizzazione dei consigli sui prodotti è probabilmente meno importante dell'elaborazione degli ordini.</span><span class="sxs-lookup"><span data-stu-id="374c6-154">For example, in an e-commerce site, showing product recommendations is probably less critical than processing orders.</span></span>

<span data-ttu-id="374c6-155">**Limitare i client**.</span><span class="sxs-lookup"><span data-stu-id="374c6-155">**Throttle clients**.</span></span> <span data-ttu-id="374c6-156">A volte un numero ridotto di utenti crea un carico eccessivo che può ridurre la disponibilità dell'applicazione per gli altri utenti.</span><span class="sxs-lookup"><span data-stu-id="374c6-156">Sometimes a small number of users create excessive load, which can reduce your application's availability for other users.</span></span> <span data-ttu-id="374c6-157">In questo caso, è utile limitare il client per un determinato periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="374c6-157">In this situation, throttle the client for a certain period of time.</span></span> <span data-ttu-id="374c6-158">Vedere [Modello Limitazione][throttle].</span><span class="sxs-lookup"><span data-stu-id="374c6-158">See the [Throttling pattern][throttle].</span></span>

<span data-ttu-id="374c6-159">**Bloccare gli utenti malintenzionati**.</span><span class="sxs-lookup"><span data-stu-id="374c6-159">**Block bad actors**.</span></span> <span data-ttu-id="374c6-160">Applicare una limitazione a un client non implica necessariamente che questi abbia agito con cattive intenzioni.</span><span class="sxs-lookup"><span data-stu-id="374c6-160">Just because you throttle a client, it doesn't mean client was acting maliciously.</span></span> <span data-ttu-id="374c6-161">Significa semplicemente che ha superato la propria quota del servizio.</span><span class="sxs-lookup"><span data-stu-id="374c6-161">It just means the client exceeded their service quota.</span></span> <span data-ttu-id="374c6-162">Tuttavia, se un client supera spesso la propria quota o mostra un comportamento errato, è possibile bloccarlo.</span><span class="sxs-lookup"><span data-stu-id="374c6-162">But if a client consistently exceeds their quota or otherwise behaves badly, you might block them.</span></span> <span data-ttu-id="374c6-163">Definire un processo fuori banda affinché l'utente possa richiedere lo sblocco.</span><span class="sxs-lookup"><span data-stu-id="374c6-163">Define an out-of-band process for user to request getting unblocked.</span></span>

<span data-ttu-id="374c6-164">**Usare il modello Designazione leader**.</span><span class="sxs-lookup"><span data-stu-id="374c6-164">**Use leader election**.</span></span> <span data-ttu-id="374c6-165">Quando è necessario coordinare un'attività, usare il modello [Designazione leader] [ leader-election] per selezionare un coordinatore.</span><span class="sxs-lookup"><span data-stu-id="374c6-165">When you need to coordinate a task, use [Leader Election][leader-election] to select a coordinator.</span></span> <span data-ttu-id="374c6-166">In questo modo, il coordinatore non rappresenta un singolo punto di guasto.</span><span class="sxs-lookup"><span data-stu-id="374c6-166">That way, the coordinator is not a single point of failure.</span></span> <span data-ttu-id="374c6-167">In caso di errore, ne viene selezionato un altro.</span><span class="sxs-lookup"><span data-stu-id="374c6-167">If the coordinator fails, a new one is selected.</span></span> <span data-ttu-id="374c6-168">Se non si vuole implementare un algoritmo di designazione leader da zero, è possibile prendere in considerazione una soluzione preconfigurata, ad esempio Zookeeper.</span><span class="sxs-lookup"><span data-stu-id="374c6-168">Rather than implement a leader election algorithm from scratch, consider an off-the-shelf solution such as Zookeeper.</span></span>

<span data-ttu-id="374c6-169">**Eseguire i test di inserimento degli errori**.</span><span class="sxs-lookup"><span data-stu-id="374c6-169">**Test with fault injection**.</span></span> <span data-ttu-id="374c6-170">Accade spesso che venga testato il percorso di riuscita ma non il percorso di errore.</span><span class="sxs-lookup"><span data-stu-id="374c6-170">All too often, the success path is well tested but not the failure path.</span></span> <span data-ttu-id="374c6-171">Un sistema può essere eseguito nell'ambiente di produzione per lungo tempo prima che venga rilevato un percorso di errore.</span><span class="sxs-lookup"><span data-stu-id="374c6-171">A system could run in production for a long time before a failure path is exercised.</span></span> <span data-ttu-id="374c6-172">Usare i test di inserimento degli errori per testare la resilienza del sistema sia attivando errori reali sia simulandoli.</span><span class="sxs-lookup"><span data-stu-id="374c6-172">Use fault injection to test the resiliency of the system to failures, either by triggering actual failures or by simulating them.</span></span>

<span data-ttu-id="374c6-173">**Adottare l'ingegneria del caos**.</span><span class="sxs-lookup"><span data-stu-id="374c6-173">**Embrace chaos engineering**.</span></span> <span data-ttu-id="374c6-174">L'ingegneria del caos estende il concetto di inserimento degli errori inserendo nelle istanze di produzione errori o condizioni anormali in modo casuale.</span><span class="sxs-lookup"><span data-stu-id="374c6-174">Chaos engineering extends the notion of fault injection, by randomly injecting failures or abnormal conditions into production instances.</span></span>

<span data-ttu-id="374c6-175">Per un approccio strutturato per rendere le applicazioni riparazione automatica, vedere [progettazione di applicazioni affidabili per Azure][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="374c6-175">For a structured approach to making your applications self healing, see [Design reliable applications for Azure][resiliency-overview].</span></span>

<!-- links -->

[circuit-breaker]: ../../patterns/circuit-breaker.md
[compensating-transactions]: ../../patterns/compensating-transaction.md
[leader-election]: ../../patterns/leader-election.md
[load-level]: ../../patterns/queue-based-load-leveling.md
[resiliency-overview]: ../../reliability/index.md
[retry]: ../../patterns/retry.md
[throttle]: ../../patterns/throttling.md
[transient-fault-handling]: ../../best-practices/transient-faults.md

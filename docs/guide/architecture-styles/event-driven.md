---
title: Stile di architettura guidato dagli eventi
description: Descrive i vantaggi, le problematiche e le procedure consigliate per le architetture guidate dagli eventi e IoT in Azure
author: MikeWasson
ms.openlocfilehash: ff7f936ceabefe7079a1ebbfa717ff4095bf133b
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/14/2017
---
# <a name="event-driven-architecture-style"></a><span data-ttu-id="2945a-103">Stile di architettura guidato dagli eventi</span><span class="sxs-lookup"><span data-stu-id="2945a-103">Event-driven architecture style</span></span>

<span data-ttu-id="2945a-104">Un'architettura guidata dagli eventi è costituita da **producer eventi** che generano un flusso di eventi e **consumer eventi** che sono in ascolto degli eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-104">An event-driven architecture consists of **event producers** that generate a stream of events, and **event consumers** that listen for the events.</span></span> 

![](./images/event-driven.svg)

<span data-ttu-id="2945a-105">Gli eventi vengono recapitati praticamente in tempo reale, in modo che i consumer possano rispondervi immediatamente non appena si verificano.</span><span class="sxs-lookup"><span data-stu-id="2945a-105">Events are delivered in near real time, so consumers can respond immediately to events as they occur.</span></span> <span data-ttu-id="2945a-106">I producer sono separati dai consumer: un producer è all'oscuro dei consumer in ascolto.</span><span class="sxs-lookup"><span data-stu-id="2945a-106">Producers are decoupled from consumers &mdash; a producer doesn't know which consumers are listening.</span></span> <span data-ttu-id="2945a-107">Anche i consumer sono separati tra loro e ognuno visualizza tutti gli eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-107">Consumers are also decoupled from each other, and every consumer sees all of the events.</span></span> <span data-ttu-id="2945a-108">Questo comportamento differisce da un modello con [consumer concorrenti][competing-consumers], in cui i consumer eseguono il pull di messaggi da una coda e un messaggio viene elaborato solo una volta (presupponendo l'assenza di errori).</span><span class="sxs-lookup"><span data-stu-id="2945a-108">This differs from a [Competing Consumers][competing-consumers] pattern, where consumers pull messages from a queue and a message is processed just once (assuming no errors).</span></span> <span data-ttu-id="2945a-109">In alcuni sistemi, ad esempio nei sistemi IoT, gli eventi devono essere inseriti a volumi molto elevati.</span><span class="sxs-lookup"><span data-stu-id="2945a-109">In some systems, such as IoT, events must be ingested at very high volumes.</span></span>

<span data-ttu-id="2945a-110">Un'architettura guidata dagli eventi può usare un modello di pubblicazione/sottoscrizione o un modello di flusso di eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-110">An event driven architecture can use a pub/sub model or an event stream model.</span></span> 

- <span data-ttu-id="2945a-111">**Pubblicazione/sottoscrizione**: l'infrastruttura di messaggistica tiene traccia delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="2945a-111">**Pub/sub**: The messaging infrastructure keeps track of subscriptions.</span></span> <span data-ttu-id="2945a-112">Quando viene pubblicato un evento, il modello lo invia a ogni sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="2945a-112">When an event is published, it sends the event to each subscriber.</span></span> <span data-ttu-id="2945a-113">Quando viene ricevuto un evento, non può essere riprodotto e i nuovi sottoscrittori non possono visualizzarlo.</span><span class="sxs-lookup"><span data-stu-id="2945a-113">After an event is received, it cannot be replayed, and new subscribers do not see the event.</span></span> 

- <span data-ttu-id="2945a-114">**Flusso di eventi**: gli eventi vengono scritti in un log.</span><span class="sxs-lookup"><span data-stu-id="2945a-114">**Event streaming**: Events are written to a log.</span></span> <span data-ttu-id="2945a-115">Gli eventi sono rigorosamente ordinati (in una partizione) e durevoli.</span><span class="sxs-lookup"><span data-stu-id="2945a-115">Events are strictly ordered (within a partition) and durable.</span></span> <span data-ttu-id="2945a-116">I client non sottoscrivono il flusso, ma un client può invece leggere da qualsiasi parte del flusso.</span><span class="sxs-lookup"><span data-stu-id="2945a-116">Clients don't subscribe to the stream, instead a client can read from any part of the stream.</span></span> <span data-ttu-id="2945a-117">Il client è responsabile di far avanzare la propria posizione nel flusso.</span><span class="sxs-lookup"><span data-stu-id="2945a-117">The client is responsible for advancing its position in the stream.</span></span> <span data-ttu-id="2945a-118">Questo significa che un client può aggiungersi in qualsiasi momento e può riprodurre gli eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-118">That means a client can join at any time, and can replay events.</span></span>

<span data-ttu-id="2945a-119">Sul lato consumer si applicano alcune variazioni comuni:</span><span class="sxs-lookup"><span data-stu-id="2945a-119">On the consumer side, there are some common variations:</span></span>

- <span data-ttu-id="2945a-120">**Elaborazione semplice degli eventi**.</span><span class="sxs-lookup"><span data-stu-id="2945a-120">**Simple event processing**.</span></span> <span data-ttu-id="2945a-121">Un evento attiva immediatamente un'azione nel consumer.</span><span class="sxs-lookup"><span data-stu-id="2945a-121">An event immediately triggers an action in the consumer.</span></span> <span data-ttu-id="2945a-122">Ad esempio, è possibile usare Funzioni di Azure con un trigger del bus di servizio, in modo da eseguire una funzione ogni volta che viene pubblicato un messaggio in un argomento del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="2945a-122">For example, you could use Azure Functions with a Service Bus trigger, so that a function executes whenever a message is published to a Service Bus topic.</span></span>

- <span data-ttu-id="2945a-123">**Elaborazione complessa degli eventi**.</span><span class="sxs-lookup"><span data-stu-id="2945a-123">**Complex event processing**.</span></span> <span data-ttu-id="2945a-124">Un consumer elabora una serie di eventi, cercando i modelli nei dati di evento, tramite una tecnologia come Analisi di flusso di Azure o Apache Storm.</span><span class="sxs-lookup"><span data-stu-id="2945a-124">A consumer processes a series of events, looking for patterns in the event data, using a technology such as Azure Stream Analytics or Apache Storm.</span></span> <span data-ttu-id="2945a-125">Ad esempio, è possibile aggregare letture da un dispositivo incorporato in base a un intervallo di tempo e quindi generare una notifica se la media mobile supera una determinata soglia.</span><span class="sxs-lookup"><span data-stu-id="2945a-125">For example, you could aggregate readings from an embedded device over a time window, and generate a notification if the moving average crosses a certain threshold.</span></span> 

- <span data-ttu-id="2945a-126">**Elaborazione di flussi di eventi**.</span><span class="sxs-lookup"><span data-stu-id="2945a-126">**Event stream processing**.</span></span> <span data-ttu-id="2945a-127">Usare una piattaforma di flussi di dati, come l'hub IoT di Azure o Apache Kafka, come pipeline per inserire gli eventi e fornirli agli elaboratori di flussi.</span><span class="sxs-lookup"><span data-stu-id="2945a-127">Use a data streaming platform, such as Azure IoT Hub or Apache Kafka, as a pipeline to ingest events and feed them to stream processors.</span></span> <span data-ttu-id="2945a-128">Gli elaboratori di flussi intervengono per elaborare o trasformare il flusso.</span><span class="sxs-lookup"><span data-stu-id="2945a-128">The stream processors act to process or transform the stream.</span></span> <span data-ttu-id="2945a-129">Possono essere presenti più elaboratori di flussi per sottosistemi diversi nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2945a-129">There may be multiple stream processors for different subsystems of the application.</span></span> <span data-ttu-id="2945a-130">Questo approccio è ideale per i carichi di lavoro IoT.</span><span class="sxs-lookup"><span data-stu-id="2945a-130">This approach is a good fit for IoT workloads.</span></span>

<span data-ttu-id="2945a-131">L'origine degli eventi può essere esterna al sistema, ad esempio può essere costituita da dispositivi fisici in una soluzione IoT.</span><span class="sxs-lookup"><span data-stu-id="2945a-131">The source of the events may be external to the system, such as physical devices in an IoT solution.</span></span> <span data-ttu-id="2945a-132">In questo caso, il sistema deve essere in grado di inserire i dati in base alla velocità effettiva e al volume richiesti dall'origine dati.</span><span class="sxs-lookup"><span data-stu-id="2945a-132">In that case, the system must be able to ingest the data at the volume and throughput that is required by the data source.</span></span>

<span data-ttu-id="2945a-133">Nel diagramma logico raffigurato sopra ogni tipo di consumer viene mostrato come singola casella.</span><span class="sxs-lookup"><span data-stu-id="2945a-133">In the logical diagram above, each type of consumer is shown as a single box.</span></span> <span data-ttu-id="2945a-134">In pratica, è prassi comune definire più istanze di un consumer, per evitare che il consumer diventi un singolo punto di guasto nel sistema.</span><span class="sxs-lookup"><span data-stu-id="2945a-134">In practice, it's common to have multiple instances of a consumer, to avoid having the consumer become a single point of failure in system.</span></span> <span data-ttu-id="2945a-135">Possono essere necessarie più istanze anche per gestire il volume e la frequenza degli eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-135">Multiple instances might also be necessary to handle the volume and frequency of events.</span></span> <span data-ttu-id="2945a-136">Inoltre, un singolo consumer può elaborare gli eventi in più thread.</span><span class="sxs-lookup"><span data-stu-id="2945a-136">Also, a single consumer might process events on multiple threads.</span></span> <span data-ttu-id="2945a-137">Questo approccio può rivelarsi problematico se gli eventi devono essere elaborati in ordine o se richiedono una semantica di recapito effettuato esattamente una volta.</span><span class="sxs-lookup"><span data-stu-id="2945a-137">This can create challenges if events must be processed in order, or require exactly-once semantics.</span></span> <span data-ttu-id="2945a-138">Vedere [Ridurre al minimo il coordinamento][minimize-coordination].</span><span class="sxs-lookup"><span data-stu-id="2945a-138">See [Minimize Coordination][minimize-coordination].</span></span> 

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="2945a-139">Quando usare questa architettura</span><span class="sxs-lookup"><span data-stu-id="2945a-139">When to use this architecture</span></span>

- <span data-ttu-id="2945a-140">Più sottosistemi devono elaborare gli stessi eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-140">Multiple subsystems must process the same events.</span></span> 
- <span data-ttu-id="2945a-141">Elaborazione in tempo reale con ritardo minimo.</span><span class="sxs-lookup"><span data-stu-id="2945a-141">Real-time processing with minimum time lag.</span></span>
- <span data-ttu-id="2945a-142">Elaborazione complessa degli eventi, ad esempio con criteri di ricerca o aggregazione in base a intervalli di tempo.</span><span class="sxs-lookup"><span data-stu-id="2945a-142">Complex event processing, such as pattern matching or aggregation over time windows.</span></span>
- <span data-ttu-id="2945a-143">Volume elevato e alta velocità dei dati, ad esempio in sistemi IoT.</span><span class="sxs-lookup"><span data-stu-id="2945a-143">High volume and high velocity of data, such as IoT.</span></span>

## <a name="benefits"></a><span data-ttu-id="2945a-144">Vantaggi</span><span class="sxs-lookup"><span data-stu-id="2945a-144">Benefits</span></span>

- <span data-ttu-id="2945a-145">I producer e i consumer sono separati.</span><span class="sxs-lookup"><span data-stu-id="2945a-145">Producers and consumers are decoupled.</span></span>
- <span data-ttu-id="2945a-146">Nessuna integrazione da punto a punto.</span><span class="sxs-lookup"><span data-stu-id="2945a-146">No point-to point-integrations.</span></span> <span data-ttu-id="2945a-147">È facile aggiungere nuovi consumer al sistema.</span><span class="sxs-lookup"><span data-stu-id="2945a-147">It's easy to add new consumers to the system.</span></span>
- <span data-ttu-id="2945a-148">I consumer possono rispondere agli eventi immediatamente, non appena arrivano.</span><span class="sxs-lookup"><span data-stu-id="2945a-148">Consumers can respond to events immediately as they arrive.</span></span> 
- <span data-ttu-id="2945a-149">Scalabilità e distribuzione elevate.</span><span class="sxs-lookup"><span data-stu-id="2945a-149">Highly scalable and distributed.</span></span> 
- <span data-ttu-id="2945a-150">I sottosistemi hanno viste indipendenti del flusso di eventi.</span><span class="sxs-lookup"><span data-stu-id="2945a-150">Subsystems have independent views of the event stream.</span></span>

## <a name="challenges"></a><span data-ttu-id="2945a-151">Problematiche</span><span class="sxs-lookup"><span data-stu-id="2945a-151">Challenges</span></span>

- <span data-ttu-id="2945a-152">Recapito garantito.</span><span class="sxs-lookup"><span data-stu-id="2945a-152">Guaranteed delivery.</span></span> <span data-ttu-id="2945a-153">In alcuni sistemi, in particolare in scenari IoT, è essenziale garantire che gli eventi vengano recapitati.</span><span class="sxs-lookup"><span data-stu-id="2945a-153">In some systems, especially in IoT scenarios, it's crucial to guarantee that events are delivered.</span></span>
- <span data-ttu-id="2945a-154">Elaborazione degli eventi in ordine o esattamente una volta.</span><span class="sxs-lookup"><span data-stu-id="2945a-154">Processing events in order or exactly once.</span></span> <span data-ttu-id="2945a-155">In genere, ogni tipo di consumer viene eseguito in più istanze, per motivi di resilienza e scalabilità.</span><span class="sxs-lookup"><span data-stu-id="2945a-155">Each consumer type typically runs in multiple instances, for resiliency and scalability.</span></span> <span data-ttu-id="2945a-156">Questo approccio può rivelarsi problematico se gli eventi devono essere elaborati in ordine (all'interno di un tipo di consumer) o se la logica di elaborazione non è idempotente.</span><span class="sxs-lookup"><span data-stu-id="2945a-156">This can create a challenge if the events must be processed in order (within a consumer type), or if the processing logic is not idempotent.</span></span>

## <a name="iot-architecture"></a><span data-ttu-id="2945a-157">Architettura IoT</span><span class="sxs-lookup"><span data-stu-id="2945a-157">IoT architecture</span></span>

<span data-ttu-id="2945a-158">Le architetture guidate dagli eventi sono centrali per le soluzioni IoT.</span><span class="sxs-lookup"><span data-stu-id="2945a-158">Event-driven architectures are central to IoT solutions.</span></span> <span data-ttu-id="2945a-159">Il diagramma seguente mostra una possibile architettura logica per IoT.</span><span class="sxs-lookup"><span data-stu-id="2945a-159">The following diagram shows a possible logical architecture for IoT.</span></span> <span data-ttu-id="2945a-160">Il diagramma evidenzia i componenti del flusso di eventi dell'architettura.</span><span class="sxs-lookup"><span data-stu-id="2945a-160">The diagram emphasizes the event-streaming components of the architecture.</span></span>

![](./images/iot.png)

<span data-ttu-id="2945a-161">Il **gateway cloud** inserisce gli eventi di dispositivo in corrispondenza dei limiti del cloud, usando un sistema di messaggistica a bassa latenza affidabile.</span><span class="sxs-lookup"><span data-stu-id="2945a-161">The **cloud gateway** ingests device events at the cloud boundary, using a reliable, low latency messaging system.</span></span>

<span data-ttu-id="2945a-162">I dispositivi possono inviare eventi direttamente al gateway cloud oppure attraverso un **gateway sul campo**.</span><span class="sxs-lookup"><span data-stu-id="2945a-162">Devices might send events directly to the cloud gateway, or through a **field gateway**.</span></span> <span data-ttu-id="2945a-163">Un gateway sul campo è un dispositivo o un software specializzato che si trova in genere nella stessa posizione dei dispositivi e che riceve gli eventi e li inoltra al gateway cloud.</span><span class="sxs-lookup"><span data-stu-id="2945a-163">A field gateway is a specialized device or software, usually colocated with the devices, that receives events and forwards them to the cloud gateway.</span></span> <span data-ttu-id="2945a-164">Il gateway sul campo può anche pre-elaborare gli eventi di dispositivo non elaborati, eseguendo funzioni come l'applicazione di filtri, l'aggregazione o la trasformazione del protocollo.</span><span class="sxs-lookup"><span data-stu-id="2945a-164">The field gateway might also preprocess the raw device events, performing functions such as filtering, aggregation, or protocol transformation.</span></span>

<span data-ttu-id="2945a-165">Dopo l'inserimento, gli eventi passano da uno o più **elaboratori di flussi**, che possono instradare i dati (ad esempio all'archiviazione) o eseguire analisi e altri tipi di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="2945a-165">After ingestion, events go through one or more **stream processors** that can route the data (for example, to storage) or perform analytics and other processing.</span></span>

<span data-ttu-id="2945a-166">Di seguito vengono indicati alcuni tipi comuni di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="2945a-166">The following are some common types of processing.</span></span> <span data-ttu-id="2945a-167">Naturalmente, l'elenco non è esaustivo.</span><span class="sxs-lookup"><span data-stu-id="2945a-167">(This list is certainly not exhaustive.)</span></span>

- <span data-ttu-id="2945a-168">Scrittura dei dati di evento nell'archiviazione offline sicura per l'analisi batch.</span><span class="sxs-lookup"><span data-stu-id="2945a-168">Writing event data to cold storage, for archiving or batch analytics.</span></span>

- <span data-ttu-id="2945a-169">Analisi Percorso critico, che analizza il flusso di eventi (quasi) in tempo reale, per rilevare le anomalie, riconoscere i modelli in base a intervalli di tempo ricorrenti o attivare avvisi quando si verifica una condizione specifica nel flusso.</span><span class="sxs-lookup"><span data-stu-id="2945a-169">Hot path analytics, analyzing the event stream in (near) real time, to detect anomalies, recognize patterns over rolling time windows, or trigger alerts when a specific condition occurs in the stream.</span></span> 

- <span data-ttu-id="2945a-170">Gestione di tipi speciali di messaggi non di telemetria dai dispositivi, come le notifiche e gli allarmi.</span><span class="sxs-lookup"><span data-stu-id="2945a-170">Handling special types of non-telemetry messages from devices, such as notifications and alarms.</span></span> 

- <span data-ttu-id="2945a-171">Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="2945a-171">Machine learning.</span></span>

<span data-ttu-id="2945a-172">Le caselle in grigio mostrano i componenti di un sistema IoT non direttamente correlati al flusso di eventi, ma che sono stati inclusi per completezza.</span><span class="sxs-lookup"><span data-stu-id="2945a-172">The boxes that are shaded gray show components of an IoT system that are not directly related to event streaming, but are included here for completeness.</span></span>

- <span data-ttu-id="2945a-173">Il **registro dei dispositivi** è un database dei dispositivi di cui è stato effettuato il provisioning e include gli ID dispositivo e in genere i metadati dei dispositivi, come la posizione.</span><span class="sxs-lookup"><span data-stu-id="2945a-173">The **device registry** is a database of the provisioned devices, including the device IDs and usually device metadata, such as location.</span></span>

- <span data-ttu-id="2945a-174">L'**API di provisioning** è un'interfaccia esterna comune per il provisioning e la registrazione di nuovi dispositivi.</span><span class="sxs-lookup"><span data-stu-id="2945a-174">The **provisioning API** is a common external interface for provisioning and registering new devices.</span></span>

- <span data-ttu-id="2945a-175">Alcune soluzioni IoT consentono l'invio di **messaggi di comando e controllo** ai dispositivi.</span><span class="sxs-lookup"><span data-stu-id="2945a-175">Some IoT solutions allow **command and control messages** to be sent to devices.</span></span>

> <span data-ttu-id="2945a-176">Questa sezione ha presentato una visualizzazione di livello notevolmente elevato di uno scenario IoT, in cui potrebbe essere necessario tenere presenti alcune sottigliezze e problematiche.</span><span class="sxs-lookup"><span data-stu-id="2945a-176">This section has presented a very high-level view of IoT, and there are many subtleties and challenges to consider.</span></span> <span data-ttu-id="2945a-177">Per un'analisi più approfondita dell'architettura di riferimento, con tutte le considerazioni correlate, vedere [Microsoft Azure IoT Reference Architecture][iot-ref-arch] (Architettura di riferimento di Microsoft Azure IoT).</span><span class="sxs-lookup"><span data-stu-id="2945a-177">For a more detailed reference architecture and discussion, see the [Microsoft Azure IoT Reference Architecture][iot-ref-arch] (PDF download).</span></span>

 <!-- links -->

[competing-consumers]: ../../patterns/competing-consumers.md
[iot-ref-arch]: https://azure.microsoft.com/en-us/updates/microsoft-azure-iot-reference-architecture-available/
[minimize-coordination]: ../design-principles/minimize-coordination.md



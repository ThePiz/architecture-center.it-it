---
title: Disponibilità elevata per le applicazioni Azure
description: Panoramiche tecniche e informazioni approfondite sulla progettazione e la creazione di applicazioni per la disponibilità elevata in Microsoft Azure.
author: adamglick
ms.date: 05/31/2017
ms.openlocfilehash: f116b9e64f1722b5141ae90239d5c8a8b4a89487
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30848564"
---
[!INCLUDE [header](../_includes/header.md)]

# <a name="high-availability-for-applications-built-on-microsoft-azure"></a><span data-ttu-id="0f8a6-103">Disponibilità elevata per le applicazioni basate su Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="0f8a6-103">High availability for applications built on Microsoft Azure</span></span>
<span data-ttu-id="0f8a6-104">Un'applicazione a disponibilità elevata assorbe le fluttuazioni di disponibilità, carico ed errori temporanei nell'hardware e nei servizi dipendenti.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-104">A highly available application absorbs fluctuations in availability, load, and temporary failures in dependent services and hardware.</span></span> <span data-ttu-id="0f8a6-105">L'applicazione continua a funzionare in modo accettabile in base a quanto definito dai requisiti aziendali o dai contratti di servizio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-105">The application continues to perform acceptably, as defined by business requirements or application service-level agreements (SLAs).</span></span>

## <a name="azure-high-availability-features"></a><span data-ttu-id="0f8a6-106">Funzionalità a disponibilità elevata di Azure</span><span class="sxs-lookup"><span data-stu-id="0f8a6-106">Azure high-availability features</span></span>
<span data-ttu-id="0f8a6-107">Azure offre numerose funzionalità predefinite della piattaforma che supportano applicazioni a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-107">Azure has many built-in platform features that support highly available applications.</span></span> <span data-ttu-id="0f8a6-108">Questa sezione descrive alcune di queste funzionalità chiave.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-108">This section describes some of those key features.</span></span>

### <a name="fabric-controller"></a><span data-ttu-id="0f8a6-109">Controller di infrastruttura</span><span class="sxs-lookup"><span data-stu-id="0f8a6-109">Fabric controller</span></span>
<span data-ttu-id="0f8a6-110">Il controller di infrastruttura di Azure gestisce il provisioning e il monitoraggio delle condizioni delle istanze di calcolo di Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-110">The Azure fabric controller provisions and monitors the condition of Azure compute instances.</span></span> <span data-ttu-id="0f8a6-111">Monitora lo stato dell'hardware e del software delle istanze delle macchine host e guest.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-111">The fabric controller monitors the status of the hardware and software of the host and guest machine instances.</span></span> <span data-ttu-id="0f8a6-112">Quando rileva un errore, mantiene i contratti di servizio rilocando automaticamente le istanze delle VM.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-112">When it detects a failure, it maintains SLAs by automatically relocating the VM instances.</span></span> <span data-ttu-id="0f8a6-113">Il contratto di servizio di calcolo è ulteriormente supportato dal concetto dei domini di aggiornamento e di errore.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-113">The concept of fault and upgrade domains further supports the compute SLA.</span></span>

<span data-ttu-id="0f8a6-114">Quando vengono distribuite più istanze del ruolo del servizio cloud, Azure distribuisce queste istanze in domini di errore diversi.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-114">When multiple Cloud Service role instances are deployed, Azure deploys these instances to different fault domains.</span></span> <span data-ttu-id="0f8a6-115">Il limite di un dominio di errore è essenzialmente un diverso rack hardware nella stessa area.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-115">A fault domain boundary is essentially a different hardware rack in the same region.</span></span> <span data-ttu-id="0f8a6-116">I domini di errore riducono le probabilità che un errore hardware localizzato interrompa il servizio di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-116">Fault domains reduce the probability that a localized hardware failure interrupts the service of an application.</span></span> <span data-ttu-id="0f8a6-117">Non è possibile gestire il numero di domini di errore dei ruoli Web o di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-117">You cannot manage the number of fault domains of your worker roles or web roles.</span></span> <span data-ttu-id="0f8a6-118">Il controller di infrastruttura usa risorse dedicate separate dalle applicazioni ospitate in Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-118">The fabric controller uses dedicated resources that are separate from Azure-hosted applications.</span></span> <span data-ttu-id="0f8a6-119">Richiede un tempo di attività del 100% perché funge da nucleo del sistema Azure</span><span class="sxs-lookup"><span data-stu-id="0f8a6-119">It requires 100 percent uptime because it serves as the nucleus of the Azure system.</span></span> <span data-ttu-id="0f8a6-120">e monitora e gestisce le istanze del ruolo nei domini di errore.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-120">It monitors and manages role instances across fault domains.</span></span>

<span data-ttu-id="0f8a6-121">La figura seguente illustra le risorse condivise di Azure distribuite e gestite dal controller di infrastruttura nei diversi domini di errore.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-121">The following diagram shows Azure shared resources that the fabric controller deploys and manages across different fault domains.</span></span>

![Vista semplificata dell'isolamento dei domini di errore](./images/high-availability-azure-applications/fault-domain-isolation.png)

<span data-ttu-id="0f8a6-123">Mentre i domini di errore sono separazioni fisiche per l'attenuazione degli errori, i domini di aggiornamento sono unità logiche di separazione delle istanze che determinano quali istanze in un particolare servizio verranno aggiornate in uno specifico momento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-123">While fault domains are physical separations to mitigate failure, upgrade domains are logical units of instance separation that determine which instances of a service will be upgraded at a specific time.</span></span> <span data-ttu-id="0f8a6-124">Per impostazione predefinita, per la distribuzione del servizio ospitato vengono definiti cinque domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-124">By default, five upgrade domains are defined for your hosted service deployment.</span></span> <span data-ttu-id="0f8a6-125">È tuttavia possibile modificare tale valore nel file di definizione del servizio.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-125">However, you can change that value in the service definition file.</span></span> <span data-ttu-id="0f8a6-126">Si supponga ad esempio di avere otto istanze del ruolo Web. Saranno presenti due istanze in tre domini di aggiornamento e due istanze in un dominio di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-126">For example, if you have eight instances of your web role, there are two instances in three upgrade domains and two instances in one upgrade domain.</span></span> <span data-ttu-id="0f8a6-127">Azure definisce la sequenza di aggiornamento in base al numero di domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-127">Azure defines the update sequence based on the number of upgrade domains.</span></span> <span data-ttu-id="0f8a6-128">Per altre informazioni, vedere [Aggiornare un servizio cloud](/azure/cloud-services/cloud-services-update-azure-service/).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-128">For more information, see [Update a cloud service](/azure/cloud-services/cloud-services-update-azure-service/).</span></span>

### <a name="features-in-other-services"></a><span data-ttu-id="0f8a6-129">Funzionalità in altri servizi</span><span class="sxs-lookup"><span data-stu-id="0f8a6-129">Features in other services</span></span>
<span data-ttu-id="0f8a6-130">Oltre alle funzionalità della piattaforma che supportano la disponibilità elevata delle risorse di calcolo, Azure incorpora funzionalità di disponibilità elevata negli altri servizi.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-130">In addition to the platform features that support high availability of compute resources, Azure embeds high-availability features in its other services.</span></span> <span data-ttu-id="0f8a6-131">Ad esempio, Archiviazione di Azure mantiene almeno tre repliche di tutti i dati nell'account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-131">For example, Azure Storage maintains at least three replicas of all data in your Azure storage account.</span></span> <span data-ttu-id="0f8a6-132">Consente inoltre la replica geografica per archiviare copie dei dati in un'area secondaria.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-132">It also enables geo-replication to store copies of your data in a secondary region.</span></span> <span data-ttu-id="0f8a6-133">La rete per la distribuzione di contenuti di Azure consente di memorizzare i BLOB nella cache in tutto il mondo a fini di ridondanza, scalabilità e latenza più bassa.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-133">The Azure Content Delivery Network allows blobs to be cached around the world for redundancy, scalability, and lower latency.</span></span> <span data-ttu-id="0f8a6-134">Anche il database SQL di Azure gestisce più repliche.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-134">Azure SQL Database maintains multiple replicas as well.</span></span>

<span data-ttu-id="0f8a6-135">Per una discussione più approfondita sulle funzionalità di disponibilità della piattaforma Azure, vedere [Indicazioni tecniche sulla resilienza](index.md).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-135">For a deeper discussion of Azure platform availability features, see [Resiliency technical guidance](index.md).</span></span> <span data-ttu-id="0f8a6-136">Vedere inoltre [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) (Procedure consigliate per la progettazione di servizi su larga scala in Windows Azure).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-136">Also see [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

<span data-ttu-id="0f8a6-137">Nonostante Azure offra più funzionalità che supportano la disponibilità elevata, è importante conoscerne le limitazioni:</span><span class="sxs-lookup"><span data-stu-id="0f8a6-137">Although Azure provides multiple features that support high availability, it's important to understand their limitations:</span></span>

* <span data-ttu-id="0f8a6-138">Per il calcolo, Azure garantisce che i ruoli siano disponibili e in esecuzione, ma non rileva se l'applicazione è in esecuzione o sovraccarica.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-138">For compute, Azure guarantees that your roles are available and running, but it cannot detect whether your application is running or overloaded.</span></span>
* <span data-ttu-id="0f8a6-139">Per il database SQL di Azure, i dati vengono replicati in modo sincrono all'interno dell'area.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-139">For Azure SQL Database, data is replicated synchronously within the region.</span></span> <span data-ttu-id="0f8a6-140">È possibile scegliere la replica geografica attiva, che consente un massimo di quattro copie aggiuntive del database nella stessa area (o in aree diverse).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-140">You can choose active geo-replication, which allows up to four additional database copies in the same region (or different regions).</span></span> <span data-ttu-id="0f8a6-141">Mentre le repliche dei database non sono backup temporizzati, il database SQL offre funzionalità di backup temporizzato.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-141">While these database replicas are not point-in-time backups, SQL Database does provide point-in-time backup capabilities.</span></span> <span data-ttu-id="0f8a6-142">Per altre informazioni, vedere [Ripristinare un database SQL di Azure mediante i backup automatici del database: Ripristino temporizzato](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-142">For more information, see [Recover an Azure SQL Database using automated data backups: Point-in-time restore](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span></span>
* <span data-ttu-id="0f8a6-143">Per Archiviazione di Azure, i dati di BLOB e tabelle vengono replicati per impostazione predefinita in un'area alternativa.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-143">For Azure Storage, table data and blob data are replicated by default to an alternate region.</span></span> <span data-ttu-id="0f8a6-144">Non è tuttavia possibile accedere alle repliche finché Microsoft non sceglie di eseguire il failover nel sito alternativo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-144">However, you cannot access the replicas until Microsoft chooses to fail over to the alternate site.</span></span> <span data-ttu-id="0f8a6-145">Il failover di un'area viene eseguito solo in caso di interruzione prolungata del servizio a livello di area e non esistono contratti di servizio per il tempo di failover geografico.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-145">A region failover occurs only during a prolonged region-wide service disruption, and there is no SLA for geo-failover time.</span></span> <span data-ttu-id="0f8a6-146">È anche importante notare che qualsiasi danneggiamento dei dati si diffonde rapidamente alle repliche.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-146">It's also important to note that any data corruption quickly spreads to the replicas.</span></span> <span data-ttu-id="0f8a6-147">Per questi motivi, è necessario integrare le funzionalità di disponibilità della piattaforma con funzionalità di disponibilità specifiche dell'applicazione, tra cui la funzionalità di snapshot del BLOB per creare backup temporizzati di dati BLOB.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-147">For these reasons, you must supplement platform availability features with application-specific availability features, including the blob snapshot feature to create point-in-time backups of blob data.</span></span>

### <a name="availability-sets-for-azure-virtual-machines"></a><span data-ttu-id="0f8a6-148">Set di disponibilità per le macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="0f8a6-148">Availability sets for Azure Virtual Machines</span></span>
<span data-ttu-id="0f8a6-149">Questo articolo è prevalentemente incentrato sui servizi cloud, che usano un modello di piattaforma distribuita come servizio (PaaS).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-149">This document primarily focuses on cloud services, which use a platform-as-a-service (PaaS) model.</span></span> <span data-ttu-id="0f8a6-150">Esistono anche funzionalità di disponibilità specifiche per le macchine virtuali di Azure, che usano un modello di infrastruttura distribuita come servizio (IaaS).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-150">There are also specific availability features for Azure Virtual Machines, which use an infrastructure-as-a-service (IaaS) model.</span></span> <span data-ttu-id="0f8a6-151">Per ottenere la disponibilità elevata con le macchine virtuali, è necessario usare set di disponibilità, che svolgono una funzione simile ai domini di errore e di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-151">To achieve high availability with Virtual Machines, you must use availability sets, which serve a similar function to fault and upgrade domains.</span></span> <span data-ttu-id="0f8a6-152">All'interno di un set di disponibilità, Azure posiziona le macchine virtuali in modo da impedire che attività di manutenzione ed errori hardware localizzati arrestino tutte le macchine del gruppo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-152">Within an availability set, Azure positions the virtual machines in a way that prevents localized hardware faults and maintenance activities from bringing down all the machines in that group.</span></span> <span data-ttu-id="0f8a6-153">I set di disponibilità sono necessari per soddisfare i requisiti del contratto di servizio di Azure per la disponibilità delle macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-153">Availability sets are required to achieve the Azure SLA for the availability of Virtual Machines.</span></span>

<span data-ttu-id="0f8a6-154">La figura seguente rappresenta due set di disponibilità, rispettivamente per macchine virtuali Web e di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-154">The following diagram shows two availability sets for web and SQL Server virtual machines, respectively.</span></span>

![Set di disponibilità per le macchine virtuali di Azure](./images/high-availability-azure-applications/availability-set-for-azure-virtual-machines.png)

> [!NOTE]
> <span data-ttu-id="0f8a6-156">Nella figura precedente, SQL Server è installato ed eseguito in macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-156">In the preceding diagram, SQL Server is installed and running on virtual machines.</span></span> <span data-ttu-id="0f8a6-157">Il database SQL di Azure, al contrario, viene fornito come servizio gestito.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-157">This is different from Azure SQL Database, which provides a database as a managed service.</span></span>
> 
> 

## <a name="application-strategies-for-high-availability"></a><span data-ttu-id="0f8a6-158">Strategie delle applicazioni per la disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="0f8a6-158">Application strategies for high availability</span></span>
<span data-ttu-id="0f8a6-159">La maggior parte delle strategie delle applicazioni per la disponibilità elevata prevedono la ridondanza o la rimozione di dipendenze rigide tra i componenti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-159">Most application strategies for high availability involve either redundancy or the removal of hard dependencies between application components.</span></span> <span data-ttu-id="0f8a6-160">La progettazione dell'applicazione deve supportare la tolleranza di errore durante sporadici tempi di inattività di Azure o di servizi di terze parti.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-160">Application design should support fault tolerance during sporadic downtime of Azure or third-party services.</span></span> <span data-ttu-id="0f8a6-161">Le sezioni seguenti descrivono diversi modelli delle applicazioni per migliorare la disponibilità dei servizi cloud.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-161">The following sections describe application patterns for improving the availability of your cloud services.</span></span>

### <a name="asynchronous-communication-and-durable-queues"></a><span data-ttu-id="0f8a6-162">Comunicazione asincrona e code durevoli</span><span class="sxs-lookup"><span data-stu-id="0f8a6-162">Asynchronous communication and durable queues</span></span>
<span data-ttu-id="0f8a6-163">Per aumentare la disponibilità delle applicazioni Azure, prendere in considerazione la comunicazione asincrona tra servizi a regime di controllo libero.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-163">To increase availability in Azure applications, consider asynchronous communication between loosely coupled services.</span></span> <span data-ttu-id="0f8a6-164">In questo modello, i messaggi vengono scritti nelle code di archiviazione o nelle code del bus di servizio di Azure per l'elaborazione successiva.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-164">In this pattern, messages are written to either storage queues or Azure Service Bus queues for later processing.</span></span> <span data-ttu-id="0f8a6-165">Quando un messaggio viene scritto nella coda, il controllo torna immediatamente al mittente.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-165">When a message is written to the queue, control immediately returns to the sender.</span></span> <span data-ttu-id="0f8a6-166">L'elaborazione del messaggio viene gestita da un altro servizio dell'applicazione, in genere implementato come ruolo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-166">Another service of the application (typically implemented as a worker role) processes the message.</span></span> <span data-ttu-id="0f8a6-167">Se il servizio di elaborazione diventa inattivo, i messaggi si accumulano nella coda finché non viene ripristinato il servizio di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-167">If the processing service stops working, the messages accumulate in the queue until the processing service is restored.</span></span> <span data-ttu-id="0f8a6-168">Non esiste alcuna dipendenza diretta tra mittente front-end ed elaboratore dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-168">There is no direct dependency between the front-end sender and the message processor.</span></span> <span data-ttu-id="0f8a6-169">Questo elimina le chiamate sincrone ai servizi, che nelle applicazioni distribuite possono causare colli di bottiglia.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-169">This eliminates synchronous service calls that can cause bottlenecks in distributed applications.</span></span>

<span data-ttu-id="0f8a6-170">Una variante di questo modello archivia le informazioni relative alle chiamate al database non riuscite nelle code di Archiviazione di Azure (BLOB, tabelle, code) o del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-170">A variation of this pattern stores information about failed database calls in Azure Storage (blobs, tables, or queues) or Service Bus queues.</span></span> <span data-ttu-id="0f8a6-171">Se una chiamata sincrona all'interno di un'applicazione verso un altro servizio (come il database SQL di Azure) ha ripetutamente esito negativo, ad esempio,</span><span class="sxs-lookup"><span data-stu-id="0f8a6-171">For example, a synchronous call within an application to another service (such as Azure SQL Database) fails repeatedly.</span></span> <span data-ttu-id="0f8a6-172">è possibile serializzare tale richiesta in una risorsa di archiviazione durevole.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-172">You might be able to serialize that request into durable storage.</span></span> <span data-ttu-id="0f8a6-173">Successivamente, quando il servizio o il database è di nuovo online, l'applicazione può inviare nuovamente la richiesta dalla risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-173">At some later point when the service or database is back online, the application can resubmit the request from storage.</span></span> <span data-ttu-id="0f8a6-174">Questo modello si differenzia perché la posizione intermedia viene usata solo in caso di errore e non è una parte costante del flusso di lavoro dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-174">The difference in this model is that the intermediate location is used only during failures, not as a regular part of the application workflow.</span></span>

<span data-ttu-id="0f8a6-175">In entrambi gli scenari, la comunicazione asincrona e l'archiviazione intermedia impediscono a un servizio back-end inattivo di arrestare l'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-175">In both scenarios, asynchronous communication and intermediate storage prevent a downed back-end service from bringing down the entire application.</span></span> <span data-ttu-id="0f8a6-176">Le code fungono da intermediario logico.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-176">Queues serve as a logical intermediary.</span></span> <span data-ttu-id="0f8a6-177">Per altre indicazioni sulla scelta del servizio di accodamento, vedere [Analogie e differenze &mdash; tra le code di Azure e le code del bus di servizio di Azure](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-177">For more information on choosing between queuing services, see [Azure queues and Azure Service Bus queues &mdash; compared and contrasted](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span></span>

### <a name="fault-detection-and-retry-logic"></a><span data-ttu-id="0f8a6-178">Rilevamento degli errori e logica di ripetizione dei tentativi</span><span class="sxs-lookup"><span data-stu-id="0f8a6-178">Fault detection and retry logic</span></span>
<span data-ttu-id="0f8a6-179">Un aspetto chiave nella progettazione di applicazioni a disponibilità elevata è l'uso nel codice di logica di ripetizione dei tentativi per gestire correttamente un servizio temporaneamente inattivo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-179">A key aspect of the design of highly available applications is the use of retry logic within code to gracefully handle a service that is temporarily unavailable.</span></span> <span data-ttu-id="0f8a6-180">Le versioni recenti degli SDK per Archiviazione di Azure e il bus di servizio di Azure supportano la ripetizione dei tentativi in modo nativo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-180">Recent versions of SDKs for both Azure Storage and Azure Service Bus natively support retries.</span></span> <span data-ttu-id="0f8a6-181">Per altre informazioni su come fornire logica personalizzata di ripetizione dei tentativi per l'applicazione, vedere [Modello di ripetizione dei tentativi](../patterns/retry.md).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-181">For more information on providing custom retry logic for your application, see the [Retry pattern](../patterns/retry.md).</span></span>

### <a name="reference-data-pattern-for-high-availability"></a><span data-ttu-id="0f8a6-182">Modello dei dati di riferimento per la disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="0f8a6-182">Reference data pattern for high availability</span></span>
<span data-ttu-id="0f8a6-183">I dati di riferimento sono i dati di sola lettura di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-183">Reference data is the read-only data of an application.</span></span> <span data-ttu-id="0f8a6-184">Questi dati forniscono il contesto aziendale all'interno del quale l'applicazione genera dati transazionali nel corso di un'operazione aziendale.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-184">This data provides the business context within which the application generates transactional data during a business operation.</span></span> <span data-ttu-id="0f8a6-185">L'integrità dei dati transazionali dipende da uno snapshot dei dati di riferimento nel momento in cui la transazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-185">The integrity of transactional data depends on a snapshot of the reference data at the time the transaction was completed.</span></span>

<span data-ttu-id="0f8a6-186">I dati di riferimento sono necessari per il funzionamento corretto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-186">Reference data is necessary for the proper operation of the application.</span></span> <span data-ttu-id="0f8a6-187">Varie applicazioni creano e gestiscono i dati di riferimento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-187">Various applications create and maintain reference data; master data management (MDM) systems often perform this function.</span></span> <span data-ttu-id="0f8a6-188">Questa funzione è spesso svolta da sistemi di gestione dei dati master (MDM), Questi sistemi gestiscono il ciclo di vita dei dati di riferimento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-188">These systems are responsible for the life cycle of the reference data.</span></span> <span data-ttu-id="0f8a6-189">I dati di riferimento includono, ad esempio, il catalogo prodotti e i master di dipendenti, parti e attrezzature.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-189">Examples of reference data include product catalog, employee master, parts master, and equipment master.</span></span> <span data-ttu-id="0f8a6-190">I dati di riferimento possono anche avere origine all'esterno dell'organizzazione, come nel caso di CAP e aliquote d'imposta.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-190">Reference data can also originate from outside the organization, for example, postal codes or tax rates.</span></span> <span data-ttu-id="0f8a6-191">Le strategie per aumentare la disponibilità dei dati di riferimento sono in genere meno difficoltose di quelle per i dati transazionali.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-191">Strategies for increasing the availability of reference data are typically less difficult than those for transactional data.</span></span> <span data-ttu-id="0f8a6-192">I dati di riferimento hanno il vantaggio di essere prevalentemente immutabili.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-192">Reference data has the advantage of being mostly immutable.</span></span>

<span data-ttu-id="0f8a6-193">I ruoli Web e di lavoro di Azure che usano i dati di riferimento possono essere resi autonomi in fase di esecuzione distribuendo i dati di riferimento con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-193">Azure web and worker roles that consume reference data can be made autonomous at runtime by deploying the reference data along with the application.</span></span> <span data-ttu-id="0f8a6-194">Questo approccio è ideale se le dimensioni della risorsa di archiviazione locale consentono una distribuzione di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-194">This approach is ideal if the size of the local storage allows such a deployment.</span></span> <span data-ttu-id="0f8a6-195">L'autonomia delle unità di scala di calcolo di Azure è consentita da database SQL incorporati, database NoSQL o file XML distribuiti in locale.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-195">Embedded SQL databases, NoSQL databases, or XML files deployed locally help with the autonomy of Azure compute scale units.</span></span> <span data-ttu-id="0f8a6-196">È tuttavia consigliabile usare un meccanismo per aggiornare i dati in ogni ruolo senza che sia necessaria la ridistribuzione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-196">However, you should have a mechanism to update the data in each role without requiring redeployment.</span></span> <span data-ttu-id="0f8a6-197">A tale scopo, inserire tutti gli aggiornamenti dei dati di riferimento in un endpoint di archiviazione cloud (ad esempio, il database SQL o l'archiviazione BLOB di Azure).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-197">To do this, place any updates to the reference data at a cloud storage endpoint (for example, Azure Blob storage or SQL Database).</span></span> <span data-ttu-id="0f8a6-198">Aggiungere a ogni ruolo codice che scarica gli aggiornamenti dei dati nei nodi di calcolo all'avvio del ruolo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-198">Add code to each role that downloads the data updates into the compute nodes at role startup.</span></span> <span data-ttu-id="0f8a6-199">In alternativa, aggiungere codice che consente a un amministratore di eseguire un download forzato nelle istanze del ruolo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-199">Alternatively, add code that allows an administrator to perform a forced download into the role instances.</span></span>

<span data-ttu-id="0f8a6-200">Per aumentare la disponibilità, i ruoli devono contenere anche un set di dati di riferimento nel caso in cui la risorsa di archiviazione sia inattiva.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-200">To increase availability, the roles should also contain a set of reference data in case storage is down.</span></span> <span data-ttu-id="0f8a6-201">I ruoli possono partire da un set di dati di riferimento di base iniziale finché la risorsa di archiviazione non è disponibile per gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-201">Roles can start with a basic set of reference data until the storage resource becomes available for the updates.</span></span>

![Disponibilità elevata delle applicazioni con nodi di calcolo autonomi](./images/high-availability-azure-applications/application-high-availability-through-autonomous-compute-nodes.png)

<span data-ttu-id="0f8a6-203">Con questo modello, la distribuzione o il download di grandi quantità di dati di riferimento può aumentare il tempo necessario per avviare nuove distribuzioni o istanze del ruolo.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-203">With this pattern, new deployments or role instances may take longer to start if you are deploying or downloading large amounts of reference data.</span></span> <span data-ttu-id="0f8a6-204">Questo compromesso può essere accettabile per assicurare l'autonomia di avere i dati di riferimento immediatamente disponibili in ogni ruolo anziché dipendere da servizi di archiviazione esterni.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-204">This tradeoff might be acceptable for the autonomy of having the reference data immediately available on each role, rather than depending on external storage services.</span></span>

### <a name="transactional-data-pattern-for-high-availability"></a><span data-ttu-id="0f8a6-205">Modello dei dati transazionali per la disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="0f8a6-205">Transactional data pattern for high availability</span></span>
<span data-ttu-id="0f8a6-206">I dati transazionali sono i dati generati dall'applicazione in un contesto aziendale.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-206">Transactional data is the data that the application generates in a business context.</span></span> <span data-ttu-id="0f8a6-207">I dati transazionali sono una combinazione dell'insieme dei processi aziendali implementati dall'applicazione e dei dati di riferimento che supportano tali processi.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-207">Transactional data is a combination of the set of business processes that the application implements and the reference data that supports these processes.</span></span> <span data-ttu-id="0f8a6-208">Esempi di dati transazionali possono essere ordini, preavvisi di spedizione, fatture e opportunità di gestione delle relazioni con i clienti (CRM).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-208">Examples of transactional data can include orders, advanced shipping notices, invoices, and customer relationship management (CRM) opportunities.</span></span> <span data-ttu-id="0f8a6-209">I dati transazionali vengono inviati a sistemi esterni per il mantenimento dei record o l'ulteriore elaborazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-209">Transactional data is supplied to external systems for record keeping or for further processing.</span></span>

<span data-ttu-id="0f8a6-210">I dati di riferimento possono essere modificati nei sistemi responsabili di questi dati.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-210">Reference data can change within the systems that are responsible for that data.</span></span> <span data-ttu-id="0f8a6-211">Per questo motivo, i dati transazionali devono salvare il contesto di dati di riferimento temporizzato in modo da ridurre al minimo le dipendenze esterne per la coerenza semantica.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-211">Therefore, transactional data must save the point-in-time reference data context to minimize external dependencies for its semantic consistency.</span></span> <span data-ttu-id="0f8a6-212">Si consideri ad esempio la rimozione di un prodotto dal catalogo alcuni mesi dopo l'evasione di un ordine.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-212">For example, a product may be removed from the catalog several months after an order is fulfilled.</span></span> <span data-ttu-id="0f8a6-213">In questo caso è consigliabile archiviare con la transazione il massimo contesto di dati di riferimento possibile.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-213">Storing as much reference data context as possible with the transaction is recommended.</span></span> <span data-ttu-id="0f8a6-214">In questo modo, la semantica associata alla transazione viene mantenuta anche in caso di modifica dei dati di riferimento dopo l'acquisizione della transazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-214">This approach preserves the semantics associated with the transaction, even if the reference data changes after the transaction is captured.</span></span>

<span data-ttu-id="0f8a6-215">Come indicato in precedenza, le architetture che usano un regime di controllo libero e la comunicazione asincrona possono offrire livelli superiori di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-215">As mentioned previously, architectures that use loose coupling and asynchronous communication can provide higher levels of availability.</span></span> <span data-ttu-id="0f8a6-216">Lo stesso vale per i dati transazionali, ma l'implementazione è più complessa.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-216">This is true for transactional data as well, but the implementation is more complex.</span></span> <span data-ttu-id="0f8a6-217">I modelli transazionali tradizionali si basano in genere sul database per garantire la transazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-217">Traditional transactional patterns usually rely on the database for guaranteeing the transaction.</span></span> <span data-ttu-id="0f8a6-218">Quando si introducono livelli intermedi, il codice dell'applicazione deve gestire correttamente i dati a vari livelli per assicurare coerenza e durabilità sufficienti.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-218">When you introduce intermediate layers, the application code must correctly handle the data at various layers to ensure sufficient consistency and durability.</span></span>

<span data-ttu-id="0f8a6-219">La sequenza seguente descrive un flusso di lavoro che separa l'acquisizione dei dati transazionali dalla relativa elaborazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-219">The following sequence describes a workflow that separates the capture of transactional data from its processing:</span></span>

1. <span data-ttu-id="0f8a6-220">Nodo di calcolo Web: presentazione dei dati di riferimento.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-220">Web compute node: Present reference data.</span></span>
2. <span data-ttu-id="0f8a6-221">Archiviazione esterna: salvataggio dei dati transazionali intermedi.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-221">External storage: Save intermediate transactional data.</span></span>
3. <span data-ttu-id="0f8a6-222">Nodo di calcolo Web: completamento della transazione dell'utente finale.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-222">Web compute node: Complete the end-user transaction.</span></span>
4. <span data-ttu-id="0f8a6-223">Nodo di calcolo Web: invio dei dati transazionali completati con il contesto di dati di riferimento a una risorsa di archiviazione durevole temporanea che garantisce una risposta prevedibile.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-223">Web compute node: Send the completed transactional data with its reference data context to temporary durable storage that is guaranteed to give a predictable response.</span></span>
5. <span data-ttu-id="0f8a6-224">Nodo di calcolo Web: segnalazione all'utente finale del completamento della transazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-224">Web compute node: Signal the end-user completion of the transaction.</span></span>
6. <span data-ttu-id="0f8a6-225">Nodo di calcolo in background: estrazione dei dati transazionali, ulteriore elaborazione se necessaria e invio alla posizione di archiviazione finale nel sistema corrente.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-225">Background compute node: Extract the transactional data, process it further if necessary, and send it to its final storage location in the current system.</span></span>

<span data-ttu-id="0f8a6-226">La figura seguente illustra una possibile implementazione di questa progettazione in un servizio cloud ospitato in Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-226">The following diagram shows one possible implementation of this design in an Azure-hosted cloud service.</span></span>

![Disponibilità elevata a regime di controllo libero](./images/disaster-recovery-high-availability-azure-applications/application-high-availability-through-loose-coupling.png)

<span data-ttu-id="0f8a6-228">Le frecce tratteggiate nella figura precedente indicano l'elaborazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-228">The dashed arrows in the preceding diagram indicate asynchronous processing.</span></span> <span data-ttu-id="0f8a6-229">Il ruolo Web front-end non rileva questa elaborazione asincrona,</span><span class="sxs-lookup"><span data-stu-id="0f8a6-229">The front-end web role is not aware of this asynchronous processing.</span></span> <span data-ttu-id="0f8a6-230">che conduce all'archiviazione della transazione nella destinazione finale con riferimento al sistema corrente.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-230">This leads to the storage of the transaction at its final destination with reference to the current system.</span></span> <span data-ttu-id="0f8a6-231">A causa della latenza introdotta da questo modello asincrono, i dati transazionali non sono immediatamente disponibili per le query.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-231">Due to the latency that this asynchronous model introduces, the transactional data is not immediately available for query.</span></span> <span data-ttu-id="0f8a6-232">Ogni unità dei dati transazionali deve quindi essere salvata in una cache o una sessione utente per soddisfare le esigenze immediate dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-232">Therefore, each unit of the transactional data needs to be saved in a cache or a user session to meet the immediate UI needs.</span></span>

<span data-ttu-id="0f8a6-233">Il ruolo Web è autonomo dal resto dell'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-233">The web role is autonomous from the rest of the infrastructure.</span></span> <span data-ttu-id="0f8a6-234">Il relativo profilo di disponibilità è dato da una combinazione di ruolo Web e coda di Azure e non dall'intera infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-234">Its availability profile is a combination of the web role and the Azure queue and not the entire infrastructure.</span></span> <span data-ttu-id="0f8a6-235">Oltre alla disponibilità elevata, questo approccio supporta la scalabilità orizzontale del ruolo Web, indipendentemente dall'archiviazione back-end.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-235">In addition to high availability, this approach allows the web role to scale horizontally, independent of the back-end storage.</span></span> <span data-ttu-id="0f8a6-236">Questo modello di disponibilità elevata può influire sull'aspetto economico delle operazioni.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-236">This high-availability model can have an impact on the economics of operations.</span></span> <span data-ttu-id="0f8a6-237">Componenti aggiuntivi come ruoli di lavoro e code di Azure possono incidere sui costi d'uso mensili.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-237">Additional components like Azure queues and worker roles can affect monthly usage costs.</span></span>

<span data-ttu-id="0f8a6-238">La figura precedente illustra un'implementazione di questo approccio disaccoppiato ai dati transazionali.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-238">The previous diagram shows one implementation of this decoupled approach to transactional data.</span></span> <span data-ttu-id="0f8a6-239">Esistono molte altre possibili implementazioni.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-239">There are many other possible implementations.</span></span> <span data-ttu-id="0f8a6-240">Di seguito sono elencate alcune alternative:</span><span class="sxs-lookup"><span data-stu-id="0f8a6-240">The following list provides some alternatives:</span></span>

* <span data-ttu-id="0f8a6-241">È possibile inserire un ruolo di lavoro tra il ruolo Web e la coda di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-241">A worker role might be placed between the web role and the storage queue.</span></span>
* <span data-ttu-id="0f8a6-242">È possibile usare una coda del bus di servizio anziché una coda di Archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-242">A Service Bus queue can be used instead of an Azure Storage queue.</span></span>
* <span data-ttu-id="0f8a6-243">La destinazione finale potrebbe essere Archiviazione di Azure o un diverso provider di database.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-243">The final destination might be Azure Storage or a different database provider.</span></span>
* <span data-ttu-id="0f8a6-244">È possibile usare Cache di Azure al livello Web per garantire i requisiti di memorizzazione immediata nella cache dopo la transazione.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-244">Azure Cache can be used at the web layer to provide the immediate caching requirements after the transaction.</span></span>

### <a name="scalability-patterns"></a><span data-ttu-id="0f8a6-245">Modelli per la scalabilità</span><span class="sxs-lookup"><span data-stu-id="0f8a6-245">Scalability patterns</span></span>
<span data-ttu-id="0f8a6-246">È importante notare che la scalabilità di un servizio cloud influisce direttamente sulla disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-246">It's important to note that the scalability of a cloud service directly affects availability.</span></span> <span data-ttu-id="0f8a6-247">Se il servizio non risponde a causa di un incremento del carico, l'utente ha l'impressione che l'applicazione sia inattiva.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-247">If increased load causes your service to be unresponsive, the user perception is that the application is down.</span></span> <span data-ttu-id="0f8a6-248">Seguire le procedure comprovate per la scalabilità in base al carico previsto per l'applicazione e alle aspettative future.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-248">Follow proven practices for scalability based on your expected application load and future expectations.</span></span> <span data-ttu-id="0f8a6-249">Massimizzare la scalabilità implica molte considerazioni, ad esempio riguardo all'uso di uno o più account di archiviazione, alla condivisione in più database e alle strategie di caching.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-249">Maximizing scale involves many considerations, such as single versus multiple storage accounts, sharing across multiple databases, and caching strategies.</span></span> <span data-ttu-id="0f8a6-250">Per informazioni dettagliate su questi modelli, vedere [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) (Procedure consigliate per la progettazione di servizi su larga scala in Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-250">For in-depth information about these patterns, see [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="0f8a6-251">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="0f8a6-251">Next steps</span></span>
<span data-ttu-id="0f8a6-252">Questa serie di documenti illustra il ripristino di emergenza e disponibilità elevata per le applicazioni basate su Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="0f8a6-252">This series of documents covers disaster recovery and high availability for applications built on Microsoft Azure.</span></span> <span data-ttu-id="0f8a6-253">L'articolo successivo della serie riguarda è [Ripristino di emergenza per le applicazioni basate su Microsoft Azure](disaster-recovery-azure-applications.md).</span><span class="sxs-lookup"><span data-stu-id="0f8a6-253">The next article in the series is [Disaster recovery for applications built on Microsoft Azure](disaster-recovery-azure-applications.md).</span></span>


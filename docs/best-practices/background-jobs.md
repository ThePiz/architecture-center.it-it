---
title: Linee guida per i processi in background
description: Indicazioni sulle attività in background eseguite in modo indipendente dall'interfaccia utente.
author: dragon119
ms.date: 05/24/2017
pnp.series.title: Best Practices
ms.openlocfilehash: 57fd7a6cc400b53e51e08fb5a1377dce4ae61327
ms.sourcegitcommit: e9eb2b895037da0633ef3ccebdea2fcce047620f
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/30/2018
ms.locfileid: "50251924"
---
# <a name="background-jobs"></a><span data-ttu-id="97ba1-103">Processi in background</span><span class="sxs-lookup"><span data-stu-id="97ba1-103">Background jobs</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="97ba1-104">Molti tipi di applicazioni richiedono attività in background che vengono eseguite in modo indipendente dell'interfaccia utente (UI).</span><span class="sxs-lookup"><span data-stu-id="97ba1-104">Many types of applications require background tasks that run independently of the user interface (UI).</span></span> <span data-ttu-id="97ba1-105">Alcuni esempi sono i processi batch, le attività con uso intensivo della capacità di elaborazione e i processi a esecuzione prolungata come i flussi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="97ba1-105">Examples include batch jobs, intensive processing tasks, and long-running processes such as workflows.</span></span> <span data-ttu-id="97ba1-106">I processi in background possono essere eseguiti senza l'interazione dell'utente: l'applicazione può avviare il processo e quindi continuare a elaborare le richieste interattive degli utenti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-106">Background jobs can be executed without requiring user interaction--the application can start the job and then continue to process interactive requests from users.</span></span> <span data-ttu-id="97ba1-107">Questo consente di ridurre al minimo il carico sull'interfaccia utente dell'applicazione, consentendo di migliorare la disponibilità e di abbreviare i tempi di risposta interattiva.</span><span class="sxs-lookup"><span data-stu-id="97ba1-107">This can help to minimize the load on the application UI, which can improve availability and reduce interactive response times.</span></span>

<span data-ttu-id="97ba1-108">Ad esempio, se un'applicazione deve generare le anteprime delle immagini caricate dagli utenti, può eseguire questa operazione come processo in background e salvare l'anteprima nella risorsa di archiviazione al termine dell'operazione senza che l’utente debba attendere il completamento del processo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-108">For example, if an application is required to generate thumbnails of images that are uploaded by users, it can do this as a background job and save the thumbnail to storage when it is complete--without the user needing to wait for the process to be completed.</span></span> <span data-ttu-id="97ba1-109">Nello stesso modo, un utente che effettua un ordine può avviare un flusso di lavoro di background che elabora l'ordine, mentre continua a visualizzare l'app Web tramite l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-109">In the same way, a user placing an order can initiate a background workflow that processes the order, while the UI allows the user to continue browsing the web app.</span></span> <span data-ttu-id="97ba1-110">Al termine del processo in background l'applicazione può aggiornare i dati degli ordini archiviati e inviare un messaggio di posta elettronica all'utente per confermare l'ordine.</span><span class="sxs-lookup"><span data-stu-id="97ba1-110">When the background job is complete, it can update the stored orders data and send an email to the user that confirms the order.</span></span>

<span data-ttu-id="97ba1-111">Per decidere se implementare un'attività come processo in background, il criterio principale da valutare è stabilire se l'attività può essere eseguita senza l’interazione dell'utente e senza che l'interfaccia utente debba attendere il completamento del processo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-111">When you consider whether to implement a task as a background job, the main criteria is whether the task can run without user interaction and without the UI needing to wait for the job to be completed.</span></span> <span data-ttu-id="97ba1-112">Le attività che richiedono che l'utente o l'interfaccia utente attenda il completamento potrebbero non essere appropriate come processi in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-112">Tasks that require the user or the UI to wait while they are completed might not be appropriate as background jobs.</span></span>

## <a name="types-of-background-jobs"></a><span data-ttu-id="97ba1-113">Tipi di processi in background</span><span class="sxs-lookup"><span data-stu-id="97ba1-113">Types of background jobs</span></span>
<span data-ttu-id="97ba1-114">I processi in background includono in genere uno o più dei processi seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-114">Background jobs typically include one or more of the following types of jobs:</span></span>

* <span data-ttu-id="97ba1-115">Processi con uso intensivo della CPU, come calcoli matematici o analisi di modelli strutturali.</span><span class="sxs-lookup"><span data-stu-id="97ba1-115">CPU-intensive jobs, such as mathematical calculations or structural model analysis.</span></span>
* <span data-ttu-id="97ba1-116">Processi con uso intensivo dell'I/O, come l'esecuzione di una serie di transazioni di archiviazione o l'indicizzazione di file.</span><span class="sxs-lookup"><span data-stu-id="97ba1-116">I/O-intensive jobs, such as executing a series of storage transactions or indexing files.</span></span>
* <span data-ttu-id="97ba1-117">Processi batch, come gli aggiornamenti dei dati nelle ore notturne o l'elaborazione pianificata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-117">Batch jobs, such as nightly data updates or scheduled processing.</span></span>
* <span data-ttu-id="97ba1-118">Flussi di lavoro a esecuzione prolungata, come l'evasione di ordini o il provisioning di servizi e sistemi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-118">Long-running workflows, such as order fulfillment, or provisioning services and systems.</span></span>
* <span data-ttu-id="97ba1-119">Elaborazione di dati sensibili dove l'attività viene trasferita in una posizione più sicura per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-119">Sensitive-data processing where the task is handed off to a more secure location for processing.</span></span> <span data-ttu-id="97ba1-120">Ad esempio, elaborare dati sensibili in un’app Web potrebbe non essere opportuno</span><span class="sxs-lookup"><span data-stu-id="97ba1-120">For example, you might not want to process sensitive data within a web app.</span></span> <span data-ttu-id="97ba1-121">e si potrebbe preferire l'uso di un modello come [Gatekeeper](https://msdn.microsoft.com/library/dn589793.aspx) per trasferire i dati a un processo in background isolato con accesso a una risorsa di archiviazione protetta.</span><span class="sxs-lookup"><span data-stu-id="97ba1-121">Instead, you might use a pattern such as [Gatekeeper](https://msdn.microsoft.com/library/dn589793.aspx) to transfer the data to an isolated background process that has access to protected storage.</span></span>

## <a name="triggers"></a><span data-ttu-id="97ba1-122">Trigger</span><span class="sxs-lookup"><span data-stu-id="97ba1-122">Triggers</span></span>
<span data-ttu-id="97ba1-123">I processi in background possono essere avviati in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-123">Background jobs can be initiated in several different ways.</span></span> <span data-ttu-id="97ba1-124">I trigger sono classificabili nelle seguenti categorie:</span><span class="sxs-lookup"><span data-stu-id="97ba1-124">They fall into one of the following categories:</span></span>

* <span data-ttu-id="97ba1-125">[**Trigger guidati dagli eventi**](#event-driven-triggers).</span><span class="sxs-lookup"><span data-stu-id="97ba1-125">[**Event-driven triggers**](#event-driven-triggers).</span></span> <span data-ttu-id="97ba1-126">L'attività viene avviata in risposta a un evento, in genere un'azione eseguita da un utente o un passaggio di un flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="97ba1-126">The task is started in response to an event, typically an action taken by a user or a step in a workflow.</span></span>
* <span data-ttu-id="97ba1-127">[**Trigger guidati dalla pianificazione**](#schedule-driven-triggers).</span><span class="sxs-lookup"><span data-stu-id="97ba1-127">[**Schedule-driven triggers**](#schedule-driven-triggers).</span></span> <span data-ttu-id="97ba1-128">L'attività viene richiamata in una pianificazione basata su un timer.</span><span class="sxs-lookup"><span data-stu-id="97ba1-128">The task is invoked on a schedule based on a timer.</span></span> <span data-ttu-id="97ba1-129">Può trattarsi di una pianificazione ricorrente o di una chiamata occasionale specificata per un momento successivo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-129">This might be a recurring schedule or a one-off invocation that is specified for a later time.</span></span>

### <a name="event-driven-triggers"></a><span data-ttu-id="97ba1-130">Trigger guidati dagli eventi</span><span class="sxs-lookup"><span data-stu-id="97ba1-130">Event-driven triggers</span></span>
<span data-ttu-id="97ba1-131">Una chiamata guidata dagli eventi usa un trigger per avviare l'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-131">Event-driven invocation uses a trigger to start the background task.</span></span> <span data-ttu-id="97ba1-132">Di seguito sono riportati alcuni esempi di uso di trigger guidati dagli eventi:</span><span class="sxs-lookup"><span data-stu-id="97ba1-132">Examples of using event-driven triggers include:</span></span>

* <span data-ttu-id="97ba1-133">L'interfaccia utente o un altro processo inserisce un messaggio in una coda.</span><span class="sxs-lookup"><span data-stu-id="97ba1-133">The UI or another job places a message in a queue.</span></span> <span data-ttu-id="97ba1-134">Il messaggio contiene dati su un'azione che ha avuto luogo, ad esempio un ordine effettuato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-134">The message contains data about an action that has taken place, such as the user placing an order.</span></span> <span data-ttu-id="97ba1-135">L'attività in background è in attesa nella coda e rileva l'arrivo di un nuovo messaggio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-135">The background task listens on this queue and detects the arrival of a new message.</span></span> <span data-ttu-id="97ba1-136">Legge il messaggio e usa i dati come input per il processo in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-136">It reads the message and uses the data in it as the input to the background job.</span></span>
* <span data-ttu-id="97ba1-137">L'interfaccia utente o un altro processo salva o aggiorna un valore nella risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-137">The UI or another job saves or updates a value in storage.</span></span> <span data-ttu-id="97ba1-138">L'attività in background monitora la risorsa di archiviazione e rileva i cambiamenti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-138">The background task monitors the storage and detects changes.</span></span> <span data-ttu-id="97ba1-139">Legge i dati e li usa come input per il processo in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-139">It reads the data and uses it as the input to the background job.</span></span>
* <span data-ttu-id="97ba1-140">L'interfaccia utente o un altro processo invia una richiesta a un endpoint, ad esempio un URI HTTPS o un'API esposta come servizio Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-140">The UI or another job makes a request to an endpoint, such as an HTTPS URI, or an API that is exposed as a web service.</span></span> <span data-ttu-id="97ba1-141">Come parte della richiesta, passa i dati necessari per completare l'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-141">It passes the data that is required to complete the background task as part of the request.</span></span> <span data-ttu-id="97ba1-142">Il servizio Web o l'endpoint richiama l'attività in background che usa i dati come input.</span><span class="sxs-lookup"><span data-stu-id="97ba1-142">The endpoint or web service invokes the background task, which uses the data as its input.</span></span>

<span data-ttu-id="97ba1-143">Esempi tipici di attività appropriate per una chiamata guidata dagli eventi includono l'elaborazione delle immagini, i flussi di lavoro, l'invio di informazioni ai servizi remoti, l'invio di messaggi di posta elettronica e il provisioning di nuovi utenti in applicazioni multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="97ba1-143">Typical examples of tasks that are suited to event-driven invocation include image processing, workflows, sending information to remote services, sending email messages, and provisioning new users in multitenant applications.</span></span>

### <a name="schedule-driven-triggers"></a><span data-ttu-id="97ba1-144">Trigger guidati dalla pianificazione</span><span class="sxs-lookup"><span data-stu-id="97ba1-144">Schedule-driven triggers</span></span>
<span data-ttu-id="97ba1-145">Una chiamata guidata dalla pianificazione usa un timer per avviare l'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-145">Schedule-driven invocation uses a timer to start the background task.</span></span> <span data-ttu-id="97ba1-146">Di seguito sono riportati alcuni esempi di uso di trigger guidati dalla pianificazione:</span><span class="sxs-lookup"><span data-stu-id="97ba1-146">Examples of using schedule-driven triggers include:</span></span>

* <span data-ttu-id="97ba1-147">Un timer eseguito in locale all'interno dell'applicazione o come parte del sistema operativo dell'applicazione richiama un'attività in background a intervalli regolari.</span><span class="sxs-lookup"><span data-stu-id="97ba1-147">A timer that is running locally within the application or as part of the application’s operating system invokes a background task on a regular basis.</span></span>
* <span data-ttu-id="97ba1-148">Un timer in esecuzione in un'altra applicazione o un servizio timer come Utilità di pianificazione di Azure invia una richiesta a un’API o a un servizio Web a intervalli regolari.</span><span class="sxs-lookup"><span data-stu-id="97ba1-148">A timer that is running in a different application, or a timer service such as Azure Scheduler, sends a request to an API or web service on a regular basis.</span></span> <span data-ttu-id="97ba1-149">Il servizio Web o l'API richiama l'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-149">The API or web service invokes the background task.</span></span>
* <span data-ttu-id="97ba1-150">Un processo separato o un'applicazione avvia un timer che causa il richiamo dell'attività in background una volta dopo un ritardo di tempo specificato o in un momento specifico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-150">A separate process or application starts a timer that causes the background task to be invoked once after a specified time delay, or at a specific time.</span></span>

<span data-ttu-id="97ba1-151">Esempi tipici di attività appropriate per una chiamata guidata dalla pianificazione sono le routine di elaborazione batch (come l'aggiornamento di elenchi di prodotti correlati per gli utenti in base al loro comportamento recente), le attività di elaborazione dati routinarie (come l'aggiornamento di indici o la generazione di risultati cumulativi), l'analisi dei dati per report giornalieri, la pulizia per la conservazione dei dati e i controlli di coerenza dei dati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-151">Typical examples of tasks that are suited to schedule-driven invocation include batch-processing routines (such as updating related-products lists for users based on their recent behavior), routine data processing tasks (such as updating indexes or generating accumulated results), data analysis for daily reports, data retention cleanup, and data consistency checks.</span></span>

<span data-ttu-id="97ba1-152">Se si usa un'attività guidata dalla pianificazione che deve essere eseguita come singola istanza, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="97ba1-152">If you use a schedule-driven task that must run as a single instance, be aware of the following:</span></span>

* <span data-ttu-id="97ba1-153">Se l'istanza di calcolo che esegue l'utilità di pianificazione (ad esempio una macchina virtuale che usa operazioni pianificate di Windows) viene dimensionata, saranno presenti più istanze dell'utilità di pianificazione in esecuzione</span><span class="sxs-lookup"><span data-stu-id="97ba1-153">If the compute instance that is running the scheduler (such as a virtual machine using Windows scheduled tasks) is scaled, you will have multiple instances of the scheduler running.</span></span> <span data-ttu-id="97ba1-154">e queste potrebbero avviare più istanze dell'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-154">These could start multiple instances of the task.</span></span>
* <span data-ttu-id="97ba1-155">Se l'esecuzione delle attività dura più a lungo del tempo che intercorre tra gli eventi dell'utilità di pianificazione, tale utilità può avviare un'altra istanza dell'attività mentre quella precedente è ancora in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-155">If tasks run for longer than the period between scheduler events, the scheduler may start another instance of the task while the previous one is still running.</span></span>

## <a name="returning-results"></a><span data-ttu-id="97ba1-156">Restituzione di risultati</span><span class="sxs-lookup"><span data-stu-id="97ba1-156">Returning results</span></span>
<span data-ttu-id="97ba1-157">I processi in background vengono eseguiti in modo asincrono in un processo separato o anche in una posizione diversa rispetto all'interfaccia utente o al processo che ha richiamato l'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-157">Background jobs execute asynchronously in a separate process, or even in a separate location, from the UI or the process that invoked the background task.</span></span> <span data-ttu-id="97ba1-158">In teoria, le attività in background sono operazioni "fire and forget" e lo stato di avanzamento dell'esecuzione non ha alcun impatto sull'interfaccia utente o sul processo chiamante.</span><span class="sxs-lookup"><span data-stu-id="97ba1-158">Ideally, background tasks are “fire and forget” operations, and their execution progress has no impact on the UI or the calling process.</span></span> <span data-ttu-id="97ba1-159">Questo significa che il processo chiamante non attende il completamento delle attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-159">This means that the calling process does not wait for completion of the tasks.</span></span> <span data-ttu-id="97ba1-160">Pertanto non può rilevare automaticamente quando l’attività termina.</span><span class="sxs-lookup"><span data-stu-id="97ba1-160">Therefore, it cannot automatically detect when the task ends.</span></span>

<span data-ttu-id="97ba1-161">Se occorre che un'attività in background comunichi con l'attività chiamante per indicare lo stato di avanzamento o il completamento, è necessario implementare un meccanismo apposito.</span><span class="sxs-lookup"><span data-stu-id="97ba1-161">If you require a background task to communicate with the calling task to indicate progress or completion, you must implement a mechanism for this.</span></span> <span data-ttu-id="97ba1-162">Di seguito sono riportati alcuni esempi:</span><span class="sxs-lookup"><span data-stu-id="97ba1-162">Some examples are:</span></span>

* <span data-ttu-id="97ba1-163">Scrivere un valore di stato nella risorsa di archiviazione che sia accessibile all'attività dell'interfaccia utente o del chiamante in modo che questa possa monitorare o controllare tale valore quando richiesto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-163">Write a status indicator value to storage that is accessible to the UI or caller task, which can monitor or check this value when required.</span></span> <span data-ttu-id="97ba1-164">Altri dati che l'attività in background deve restituire al chiamante possono essere collocati nella stessa risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-164">Other data that the background task must return to the caller can be placed into the same storage.</span></span>
* <span data-ttu-id="97ba1-165">Stabilire una coda di risposta in cui l'interfaccia utente o il chiamante restano in ascolto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-165">Establish a reply queue that the UI or caller listens on.</span></span> <span data-ttu-id="97ba1-166">L'attività in background può inviare messaggi alla coda indicanti lo stato e il completamento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-166">The background task can send messages to the queue that indicate status and completion.</span></span> <span data-ttu-id="97ba1-167">I dati che l'attività in background deve restituire al chiamante possono essere inseriti nei messaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-167">Data that the background task must return to the caller can be placed into the messages.</span></span> <span data-ttu-id="97ba1-168">Se si usa il bus di servizio di Azure, è possibile usare le proprietà **ReplyTo** e **CorrelationId** per implementare questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="97ba1-168">If you are using Azure Service Bus, you can use the **ReplyTo** and **CorrelationId** properties to implement this capability.</span></span>
* <span data-ttu-id="97ba1-169">Esporre un'API o un endpoint dell'attività in background a cui l'interfaccia utente o il chiamante possa accedere per ottenere informazioni sullo stato.</span><span class="sxs-lookup"><span data-stu-id="97ba1-169">Expose an API or endpoint from the background task that the UI or caller can access to obtain status information.</span></span> <span data-ttu-id="97ba1-170">I dati che l'attività in background deve restituire al chiamante possono essere inclusi nella risposta.</span><span class="sxs-lookup"><span data-stu-id="97ba1-170">Data that the background task must return to the caller can be included in the response.</span></span>
* <span data-ttu-id="97ba1-171">Fare in modo che l'attività in background richiami l'interfaccia utente o il chiamante tramite un'API per indicare lo stato in determinati punti o al completamento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-171">Have the background task call back to the UI or caller through an API to indicate status at predefined points or on completion.</span></span> <span data-ttu-id="97ba1-172">A tal fine si possono usare eventi generati in locale oppure un meccanismo di pubblicazione e sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-172">This might be through events raised locally or through a publish-and-subscribe mechanism.</span></span> <span data-ttu-id="97ba1-173">I dati che l'attività in background deve restituire al chiamante possono essere inclusi nella richiesta o nel payload dell'evento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-173">Data that the background task must return to the caller can be included in the request or event payload.</span></span>

## <a name="hosting-environment"></a><span data-ttu-id="97ba1-174">Ambiente di hosting</span><span class="sxs-lookup"><span data-stu-id="97ba1-174">Hosting environment</span></span>
<span data-ttu-id="97ba1-175">È possibile ospitare le attività in background usando vari servizi diversi della piattaforma Azure:</span><span class="sxs-lookup"><span data-stu-id="97ba1-175">You can host background tasks by using a range of different Azure platform services:</span></span>

* <span data-ttu-id="97ba1-176">[**App Web e Processi Web di Azure**](#azure-web-apps-and-webjobs).</span><span class="sxs-lookup"><span data-stu-id="97ba1-176">[**Azure Web Apps and WebJobs**](#azure-web-apps-and-webjobs).</span></span> <span data-ttu-id="97ba1-177">È possibile usare Processi Web per eseguire processi personalizzati basati su tipi diversi di script o programmi eseguibili nell'ambito di un'app Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-177">You can use WebJobs to execute custom jobs based on a range of different types of scripts or executable programs within the context of a web app.</span></span>
* <span data-ttu-id="97ba1-178">[**Macchine virtuali di Azure**](#azure-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="97ba1-178">[**Azure Virtual Machines**](#azure-virtual-machines).</span></span> <span data-ttu-id="97ba1-179">Se si dispone di un servizio Windows o si desidera usare Utilità di pianificazione di Windows, è pratica comune ospitare le attività in background in una macchina virtuale dedicata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-179">If you have a Windows service or want to use the Windows Task Scheduler, it is common to host your background tasks within a dedicated virtual machine.</span></span>
* <span data-ttu-id="97ba1-180">[**Azure Batch**](#azure-batch).</span><span class="sxs-lookup"><span data-stu-id="97ba1-180">[**Azure Batch**](#azure-batch).</span></span> <span data-ttu-id="97ba1-181">Batch è un servizio di piattaforma che consente di pianificare il lavoro a elevato uso di calcoli da eseguire su una raccolta gestita di macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="97ba1-181">Batch is a platform service that schedules compute-intensive work to run on a managed collection of virtual machines.</span></span> <span data-ttu-id="97ba1-182">Può scalare automaticamente le risorse di calcolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-182">It can automatically scale compute resources.</span></span>
* <span data-ttu-id="97ba1-183">[**Servizio contenitore di Azure**](#azure-container-service).</span><span class="sxs-lookup"><span data-stu-id="97ba1-183">[**Azure Container Service**](#azure-container-service).</span></span> <span data-ttu-id="97ba1-184">Il servizio contenitore di Azure offre un ambiente di hosting di contenitori in Azure.</span><span class="sxs-lookup"><span data-stu-id="97ba1-184">Azure Container Service provides a container hosting environment on Azure.</span></span> 
* <span data-ttu-id="97ba1-185">[**Servizi cloud di Azure**](#azure-cloud-services).</span><span class="sxs-lookup"><span data-stu-id="97ba1-185">[**Azure Cloud Services**](#azure-cloud-services).</span></span> <span data-ttu-id="97ba1-186">È possibile scrivere codice all'interno di un ruolo eseguito come attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-186">You can write code within a role that executes as a background task.</span></span>

<span data-ttu-id="97ba1-187">Le sezioni seguenti descrivono dettagliatamente le opzioni e contengono considerazioni che consentono di scegliere quella appropriata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-187">The following sections describe each of these options in more detail, and include considerations to help you choose the appropriate option.</span></span>

### <a name="azure-web-apps-and-webjobs"></a><span data-ttu-id="97ba1-188">App Web e Processi Web di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-188">Azure Web Apps and WebJobs</span></span>

<span data-ttu-id="97ba1-189">È possibile usare Processi Web di Azure per eseguire processi personalizzati come attività in background all'interno di un'app Web di Azure.</span><span class="sxs-lookup"><span data-stu-id="97ba1-189">You can use Azure WebJobs to execute custom jobs as background tasks within an Azure Web App.</span></span> <span data-ttu-id="97ba1-190">I processi Web vengono eseguiti nell'ambito dell'app Web come processi continui.</span><span class="sxs-lookup"><span data-stu-id="97ba1-190">WebJobs run within the context of your web app as a continuous process.</span></span> <span data-ttu-id="97ba1-191">I processi Web vengono eseguiti anche in risposta a un evento di attivazione di Utilità di pianificazione di Azure o a fattori esterni come ad esempio le modifiche dei BLOB di archiviazione e le code di messaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-191">WebJobs also run in response to a trigger event from Azure Scheduler or external factors, such as changes to storage blobs and message queues.</span></span> <span data-ttu-id="97ba1-192">I processi possono essere avviati e interrotti su richiesta e arrestati in modo normale.</span><span class="sxs-lookup"><span data-stu-id="97ba1-192">Jobs can be started and stopped on demand, and shut down gracefully.</span></span> <span data-ttu-id="97ba1-193">Se un processo Web in esecuzione continua si interrompe viene riavviato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-193">If a continuously running WebJob fails, it is automatically restarted.</span></span> <span data-ttu-id="97ba1-194">Le azioni relative a nuovi tentativi ed errori sono configurabili.</span><span class="sxs-lookup"><span data-stu-id="97ba1-194">Retry and error actions are configurable.</span></span>

<span data-ttu-id="97ba1-195">Quando si configura un processo Web:</span><span class="sxs-lookup"><span data-stu-id="97ba1-195">When you configure a WebJob:</span></span>

* <span data-ttu-id="97ba1-196">Se il processo dovrà rispondere a un trigger guidato dagli eventi, è necessario configurarlo come **Esegui in modo continuo**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-196">If you want the job to respond to an event-driven trigger, you should configure it as **Run continuously**.</span></span> <span data-ttu-id="97ba1-197">Lo script o il programma viene archiviato nella cartella denominata site/wwwroot/app_data/jobs/continuous.</span><span class="sxs-lookup"><span data-stu-id="97ba1-197">The script or program is stored in the folder named site/wwwroot/app_data/jobs/continuous.</span></span>
* <span data-ttu-id="97ba1-198">Se il processo dovrà rispondere a un trigger guidato dalla pianificazione, è necessario configurarlo come **Esegui in base a una pianificazione**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-198">If you want the job to respond to a schedule-driven trigger, you should configure it as **Run on a schedule**.</span></span> <span data-ttu-id="97ba1-199">Lo script o il programma viene archiviato nella cartella denominata site/wwwroot/app_data/jobs/triggered.</span><span class="sxs-lookup"><span data-stu-id="97ba1-199">The script or program is stored in the folder named site/wwwroot/app_data/jobs/triggered.</span></span>
* <span data-ttu-id="97ba1-200">Se nella configurazione di un processo si sceglie l'opzione **Esegui su richiesta**, verrà eseguito lo stesso codice eseguito con l'opzione **Esegui in base a una pianificazione** al momento dell'avvio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-200">If you choose the **Run on demand** option when you configure a job, it will execute the same code as the **Run on a schedule** option when you start it.</span></span>

<span data-ttu-id="97ba1-201">I processi Web di Azure vengono eseguiti all'interno della sandbox dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-201">Azure WebJobs run within the sandbox of the web app.</span></span> <span data-ttu-id="97ba1-202">Perciò possono accedere alle variabili di ambiente e condividere informazioni come le stringhe di connessione con l'app Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-202">This means that they can access environment variables and share information, such as connection strings, with the web app.</span></span> <span data-ttu-id="97ba1-203">Il processo ha accesso all'identificatore univoco del computer che esegue il processo stesso.</span><span class="sxs-lookup"><span data-stu-id="97ba1-203">The job has access to the unique identifier of the machine that is running the job.</span></span> <span data-ttu-id="97ba1-204">La stringa di connessione denominata **AzureWebJobsStorage** fornisce l'accesso alle code, ai BLOB e alle tabelle di archiviazione di Azure per i dati applicazione, nonché l'accesso al bus di servizio per la messaggistica e la comunicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-204">The connection string named **AzureWebJobsStorage** provides access to Azure storage queues, blobs, and tables for application data, and access to Service Bus for messaging and communication.</span></span> <span data-ttu-id="97ba1-205">La stringa di connessione denominata **AzureWebJobsDashboard** fornisce accesso ai file di log delle azioni del processo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-205">The connection string named **AzureWebJobsDashboard** provides access to the job action log files.</span></span>

<span data-ttu-id="97ba1-206">I processi Web di Azure presentano le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-206">Azure WebJobs have the following characteristics:</span></span>

* <span data-ttu-id="97ba1-207">**Sicurezza**: i processi Web sono protetti dalle credenziali di distribuzione dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-207">**Security**: WebJobs are protected by the deployment credentials of the web app.</span></span>
* <span data-ttu-id="97ba1-208">**Tipi di file supportati**: è possibile definire i processi Web usando script di comandi (cmd), file batch (bat), script di PowerShell (ps1), script della shell bash (sh), script PHP (php), script Python (py), codice JavaScript (js) e programmi eseguibili (exe, jar e così via).</span><span class="sxs-lookup"><span data-stu-id="97ba1-208">**Supported file types**: You can define WebJobs by using command scripts (.cmd), batch files (.bat), PowerShell scripts (.ps1), bash shell scripts (.sh), PHP scripts (.php), Python scripts (.py), JavaScript code (.js), and executable programs (.exe, .jar, and more).</span></span>
* <span data-ttu-id="97ba1-209">**Distribuzione**: è possibile distribuire gli script e i file eseguibili tramite il [portale di Azure](/azure/app-service-web/web-sites-create-web-jobs), con [Visual Studio](/azure/app-service-web/websites-dotnet-deploy-webjobs), [SDK di Processi Web di Azure](/azure/app-service/webjobs-sdk-get-started) o copiandoli direttamente nei percorsi seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-209">**Deployment**: You can deploy scripts and executables by using the [Azure portal](/azure/app-service-web/web-sites-create-web-jobs), by using [Visual Studio](/azure/app-service-web/websites-dotnet-deploy-webjobs), by using the [Azure WebJobs SDK](/azure/app-service/webjobs-sdk-get-started), or by copying them directly to the following locations:</span></span>
  * <span data-ttu-id="97ba1-210">Per l'esecuzione con trigger: site/wwwroot/app_data/jobs/triggered/{nome processo}</span><span class="sxs-lookup"><span data-stu-id="97ba1-210">For triggered execution: site/wwwroot/app_data/jobs/triggered/{job name}</span></span>
  * <span data-ttu-id="97ba1-211">Per l'esecuzione continua: site/wwwroot/app_data/jobs/continuous/{nome processo}</span><span class="sxs-lookup"><span data-stu-id="97ba1-211">For continuous execution: site/wwwroot/app_data/jobs/continuous/{job name}</span></span>
* <span data-ttu-id="97ba1-212">**Registrazione**: Console.Out viene trattato (contrassegnato) come INFO.</span><span class="sxs-lookup"><span data-stu-id="97ba1-212">**Logging**: Console.Out is treated (marked) as INFO.</span></span> <span data-ttu-id="97ba1-213">Console.Error viene trattato come errore.</span><span class="sxs-lookup"><span data-stu-id="97ba1-213">Console.Error is treated as ERROR.</span></span> <span data-ttu-id="97ba1-214">È possibile accedere alle informazioni di monitoraggio e diagnostica dal Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97ba1-214">You can access monitoring and diagnostics information by using the Azure portal.</span></span> <span data-ttu-id="97ba1-215">I file di log possono essere scaricati direttamente dal sito.</span><span class="sxs-lookup"><span data-stu-id="97ba1-215">You can download log files directly from the site.</span></span> <span data-ttu-id="97ba1-216">Tali file vengono salvati nei percorsi seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-216">They are saved in the following locations:</span></span>
  * <span data-ttu-id="97ba1-217">Per l'esecuzione con trigger: Vfs/data/jobs/triggered/nomeProcesso</span><span class="sxs-lookup"><span data-stu-id="97ba1-217">For triggered execution: Vfs/data/jobs/triggered/jobName</span></span>
  * <span data-ttu-id="97ba1-218">Per l'esecuzione continua: Vfs/data/jobs/continuous/nomeProcesso</span><span class="sxs-lookup"><span data-stu-id="97ba1-218">For continuous execution: Vfs/data/jobs/continuous/jobName</span></span>
* <span data-ttu-id="97ba1-219">**Configurazione**: è possibile configurare i processi Web tramite il portale, l'API REST e PowerShell.</span><span class="sxs-lookup"><span data-stu-id="97ba1-219">**Configuration**: You can configure WebJobs by using the portal, the REST API, and PowerShell.</span></span> <span data-ttu-id="97ba1-220">Si può usare un file di configurazione denominato settings.job nella stessa directory radice dello script del processo per fornire le informazioni di configurazione per un processo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-220">You can use a configuration file named settings.job in the same root directory as the job script to provide configuration information for a job.</span></span> <span data-ttu-id="97ba1-221">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="97ba1-221">For example:</span></span>
  * <span data-ttu-id="97ba1-222">{ "stopping_wait_time": 60 }</span><span class="sxs-lookup"><span data-stu-id="97ba1-222">{ "stopping_wait_time": 60 }</span></span>
  * <span data-ttu-id="97ba1-223">{ "is_singleton": true }</span><span class="sxs-lookup"><span data-stu-id="97ba1-223">{ "is_singleton": true }</span></span>

#### <a name="considerations"></a><span data-ttu-id="97ba1-224">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-224">Considerations</span></span>

* <span data-ttu-id="97ba1-225">Per impostazione predefinita, i processi Web sono ridimensionati con l'app Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-225">By default, WebJobs scale with the web app.</span></span> <span data-ttu-id="97ba1-226">I processi possono tuttavia essere configurati per l'esecuzione in una singola istanza impostando la proprietà di configurazione **is_singleton** su **true**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-226">However, you can configure jobs to run on single instance by setting the **is_singleton** configuration property to **true**.</span></span> <span data-ttu-id="97ba1-227">I processi Web a istanza singola sono utili per le attività che non si vuole scalare o eseguire come istanze multiple simultanee, come ad esempio la reindicizzazione, l'analisi dei dati e attività simili.</span><span class="sxs-lookup"><span data-stu-id="97ba1-227">Single instance WebJobs are useful for tasks that you do not want to scale or run as simultaneous multiple instances, such as reindexing, data analysis, and similar tasks.</span></span>
* <span data-ttu-id="97ba1-228">Per ridurre al minimo l'impatto dei processi sulle prestazioni dell'app Web, è consigliabile creare un'istanza vuota di App Web di Azure in un nuovo piano di servizio app per ospitare i processi Web che potrebbero avere un'esecuzione prolungata o usare in modo intensivo le risorse.</span><span class="sxs-lookup"><span data-stu-id="97ba1-228">To minimize the impact of jobs on the performance of the web app, consider creating an empty Azure Web App instance in a new App Service plan to host WebJobs that may be long running or resource intensive.</span></span>

### <a name="more-information"></a><span data-ttu-id="97ba1-229">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-229">More information</span></span>
* <span data-ttu-id="97ba1-230">[Risorse di documentazione di Processi Web di Azure](/azure/app-service-web/websites-webjobs-resources) sono elencate molte risorse utili, download ed esempi relativi a Processi Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-230">[Azure WebJobs recommended resources](/azure/app-service-web/websites-webjobs-resources) lists the many useful resources, downloads, and samples for WebJobs.</span></span>

### <a name="azure-virtual-machines"></a><span data-ttu-id="97ba1-231">Macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-231">Azure Virtual Machines</span></span>
<span data-ttu-id="97ba1-232">Le attività in background possono essere implementate in modo da impedirne la distribuzione in App Web o Servizi cloud di Azure.</span><span class="sxs-lookup"><span data-stu-id="97ba1-232">Background tasks might be implemented in a way that prevents them from being deployed to Azure Web Apps or Cloud Services, or these options might not be convenient.</span></span> <span data-ttu-id="97ba1-233">Esempi tipici sono i servizi Windows nonché le utilità e i programmi eseguibili di terze parti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-233">Typical examples are Windows services, and third-party utilities and executable programs.</span></span> <span data-ttu-id="97ba1-234">O ancora i programmi scritti per un ambiente di esecuzione diverso da quello che ospita l'applicazione:</span><span class="sxs-lookup"><span data-stu-id="97ba1-234">Another example might be programs written for an execution environment that is different than that hosting the application.</span></span> <span data-ttu-id="97ba1-235">potrebbe trattarsi ad esempio di un programma Unix o Linux che deve essere eseguito da un'applicazione Windows o .NET.</span><span class="sxs-lookup"><span data-stu-id="97ba1-235">For example, it might be a Unix or Linux program that you want to execute from a Windows or .NET application.</span></span> <span data-ttu-id="97ba1-236">È possibile scegliere tra una gamma di sistemi operativi per una macchina virtuale di Azure ed eseguire il servizio o l'eseguibile su tale macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="97ba1-236">You can choose from a range of operating systems for an Azure virtual machine, and run your service or executable on that virtual machine.</span></span>

<span data-ttu-id="97ba1-237">Per scegliere se usare le macchine virtuali, vedere [Confronto tra Servizio app, Servizi cloud e Macchine virtuali di Azure](/azure/app-service-web/choose-web-site-cloud-service-vm/).</span><span class="sxs-lookup"><span data-stu-id="97ba1-237">To help you choose when to use Virtual Machines, see [Azure App Services, Cloud Services and Virtual Machines comparison](/azure/app-service-web/choose-web-site-cloud-service-vm/).</span></span> <span data-ttu-id="97ba1-238">Per informazioni sulle opzioni per le macchine virtuali, vedere [Dimensioni per le macchine virtuali Windows in Azure](/azure/virtual-machines/windows/sizes).</span><span class="sxs-lookup"><span data-stu-id="97ba1-238">For information about the options for Virtual Machines, see [Sizes for Windows virtual machines in Azure](/azure/virtual-machines/windows/sizes).</span></span> <span data-ttu-id="97ba1-239">Per altre informazioni sui sistemi operativi e le immagini predefinite disponibili per le macchine virtuali, vedere [Marketplace per Macchine virtuali](https://azure.microsoft.com/gallery/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="97ba1-239">For more information about the operating systems and prebuilt images that are available for Virtual Machines, see [Azure Virtual Machines Marketplace](https://azure.microsoft.com/gallery/virtual-machines/).</span></span>

<span data-ttu-id="97ba1-240">Per avviare l'attività in background in una macchina virtuale separata, sono disponibili diverse opzioni:</span><span class="sxs-lookup"><span data-stu-id="97ba1-240">To initiate the background task in a separate virtual machine, you have a range of options:</span></span>

* <span data-ttu-id="97ba1-241">È possibile eseguire l'attività su richiesta direttamente dall'applicazione inviando una richiesta a un endpoint esposto dall'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-241">You can execute the task on demand directly from your application by sending a request to an endpoint that the task exposes.</span></span> <span data-ttu-id="97ba1-242">In questo modo vengono passati tutti i dati richiesti dall'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-242">This passes in any data that the task requires.</span></span> <span data-ttu-id="97ba1-243">Questo endpoint richiama l'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-243">This endpoint invokes the task.</span></span>
* <span data-ttu-id="97ba1-244">È possibile configurare l'attività perché venga eseguita in base a una pianificazione usando un'utilità di pianificazione o un timer disponibile nel sistema operativo scelto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-244">You can configure the task to run on a schedule by using a scheduler or timer that is available in your chosen operating system.</span></span> <span data-ttu-id="97ba1-245">In Windows, ad esempio, è possibile usare Utilità di pianificazione per eseguire script e attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-245">For example, on Windows you can use Windows Task Scheduler to execute scripts and tasks.</span></span> <span data-ttu-id="97ba1-246">In alternativa, se SQL Server è installato nella macchina virtuale, è possibile usare SQL Server Agent per eseguire script e attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-246">Or, if you have SQL Server installed on the virtual machine, you can use the SQL Server Agent to execute scripts and tasks.</span></span>
* <span data-ttu-id="97ba1-247">È possibile usare l'utilità di pianificazione di Azure per avviare l'attività mediante l'aggiunta di un messaggio a una coda in cui l'attività è in ascolto o inviando una richiesta a un'API che espone l'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-247">You can use Azure Scheduler to initiate the task by adding a message to a queue that the task listens on, or by sending a request to an API that the task exposes.</span></span>

<span data-ttu-id="97ba1-248">Per altre informazioni su come avviare le attività in background, vedere la sezione precedente [Trigger](#triggers) .</span><span class="sxs-lookup"><span data-stu-id="97ba1-248">See the earlier section [Triggers](#triggers) for more information about how you can initiate background tasks.</span></span>  

#### <a name="considerations"></a><span data-ttu-id="97ba1-249">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-249">Considerations</span></span>
<span data-ttu-id="97ba1-250">Per decidere se distribuire le attività in background in una macchina virtuale di Azure, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="97ba1-250">Consider the following points when you are deciding whether to deploy background tasks in an Azure virtual machine:</span></span>

* <span data-ttu-id="97ba1-251">L'hosting di attività in background in una macchina virtuale di Azure separata offre flessibilità e consente un controllo preciso su avvio, esecuzione, pianificazione e allocazione delle risorse, </span><span class="sxs-lookup"><span data-stu-id="97ba1-251">Hosting background tasks in a separate Azure virtual machine provides flexibility and allows precise control over initiation, execution, scheduling, and resource allocation.</span></span> <span data-ttu-id="97ba1-252">ma determina un aumento dei costi di runtime se è necessario distribuire una macchina virtuale solo per eseguire attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-252">However, it will increase runtime cost if a virtual machine must be deployed just to run background tasks.</span></span>
* <span data-ttu-id="97ba1-253">Non sono disponibili funzionalità di monitoraggio delle attività nel portale di Azure o di riavvio automatico di operazioni non riuscite, anche se è possibile monitorare lo stato di base della macchina virtuale e gestirla usando i [cmdlet di Azure Resource Manager](https://msdn.microsoft.com/library/mt125356.aspx).</span><span class="sxs-lookup"><span data-stu-id="97ba1-253">There is no facility to monitor the tasks in the Azure portal and no automated restart capability for failed tasks--although you can monitor the basic status of the virtual machine and manage it by using the  [Azure Resource Manager Cmdlets](https://msdn.microsoft.com/library/mt125356.aspx).</span></span> <span data-ttu-id="97ba1-254">Non sono tuttavia disponibili funzioni di controllo dei processi e dei thread nei nodi di calcolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-254">However, there are no facilities to control processes and threads in compute nodes.</span></span> <span data-ttu-id="97ba1-255">In genere, l'uso di una macchina virtuale richiederà un impegno aggiuntivo per implementare un meccanismo che raccoglie i dati dalla strumentazione nell'attività e dal sistema operativo nella macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="97ba1-255">Typically, using a virtual machine will require additional effort to implement a mechanism that collects data from instrumentation in the task, and from the operating system in the virtual machine.</span></span> <span data-ttu-id="97ba1-256">Una soluzione appropriata potrebbe essere l'uso di [System Center Management Pack per Azure](https://www.microsoft.com/download/details.aspx?id=50013).</span><span class="sxs-lookup"><span data-stu-id="97ba1-256">One solution that might be appropriate is to use the [System Center Management Pack for Azure](https://www.microsoft.com/download/details.aspx?id=50013).</span></span>
* <span data-ttu-id="97ba1-257">È possibile considerare la creazione di probe di monitoraggio esposti tramite endpoint HTTP.</span><span class="sxs-lookup"><span data-stu-id="97ba1-257">You might consider creating monitoring probes that are exposed through HTTP endpoints.</span></span> <span data-ttu-id="97ba1-258">Il codice per questi probe potrebbe eseguire controlli di integrità, raccogliere informazioni operative e statistiche o raggruppare informazioni sugli errori e restituirle a un'applicazione di gestione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-258">The code for these probes could perform health checks, collect operational information and statistics--or collate error information and return it to a management application.</span></span> <span data-ttu-id="97ba1-259">Per altre informazioni, vedere [Modello di monitoraggio integrità Endpoint](../patterns/health-endpoint-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-259">For more information, see [Health Endpoint Monitoring Pattern](../patterns/health-endpoint-monitoring.md).</span></span>

#### <a name="more-information"></a><span data-ttu-id="97ba1-260">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-260">More information</span></span>
* <span data-ttu-id="97ba1-261">[Macchine virtuali](https://azure.microsoft.com/services/virtual-machines/) in Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-261">[Virtual Machines](https://azure.microsoft.com/services/virtual-machines/) on Azure</span></span>
* [<span data-ttu-id="97ba1-262">Domande frequenti su Macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-262">Azure Virtual Machines FAQ</span></span>](/azure/virtual-machines/virtual-machines-linux-classic-faq?toc=%2fazure%2fvirtual-machines%2flinux%2fclassic%2ftoc.json)

### <a name="azure-batch"></a><span data-ttu-id="97ba1-263">Azure Batch</span><span class="sxs-lookup"><span data-stu-id="97ba1-263">Azure Batch</span></span> 

<span data-ttu-id="97ba1-264">Prendere in considerazione [Azure Batch](/azure/batch/) se si devono eseguire carichi di lavoro di grandi dimensioni di high-performance computing in parallelo in decine, centinaia o migliaia di macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="97ba1-264">Consider [Azure Batch](/azure/batch/) if you need to run large, parallel high-performance computing (HPC) workloads across tens, hundreds, or thousands of VMs.</span></span>  

<span data-ttu-id="97ba1-265">Il servizio Batch esegue il provisioning delle macchine virtuali, assegna le attività alle macchine virtuali, esegue le attività e consente di monitorare lo stato di avanzamento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-265">The Batch service provisions the VMs, assign tasks to the VMs, runs the tasks, and monitors the progress.</span></span> <span data-ttu-id="97ba1-266">Batch può automaticamente ridurre le macchine virtuali in risposta al carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="97ba1-266">Batch can automatically scale out the VMs in response to the workload.</span></span> <span data-ttu-id="97ba1-267">Batch offre anche la pianificazione dei processi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-267">Batch also provides job scheduling.</span></span> <span data-ttu-id="97ba1-268">Azure Batch supporta le macchine virtuali di Linux e di Windows.</span><span class="sxs-lookup"><span data-stu-id="97ba1-268">Azure Batch supports both Linux and Windows VMs.</span></span>

#### <a name="considerations"></a><span data-ttu-id="97ba1-269">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-269">Considerations</span></span> 

<span data-ttu-id="97ba1-270">Batch funziona bene con carichi di lavoro intrinsecamente paralleli.</span><span class="sxs-lookup"><span data-stu-id="97ba1-270">Batch works well with intrinsically parallel workloads.</span></span> <span data-ttu-id="97ba1-271">Può anche eseguire calcoli paralleli saltando un passaggio alla fine, o eseguire le [applicazioni Message Passing Interface](/azure/batch/batch-mpi) per attività parallele che richiedono il passaggio di messaggi tra i nodi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-271">It can also perform parallel calculations with a reduce step at the end, or run [Message Passing Interface (MPI) applications](/azure/batch/batch-mpi) for parallel tasks that require message passing between nodes.</span></span> 

<span data-ttu-id="97ba1-272">Un processo di Azure Batch viene eseguito in un pool di nodi, ovvero macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="97ba1-272">An Azure Batch job runs on a pool of nodes (VMs).</span></span> <span data-ttu-id="97ba1-273">Un approccio consiste nell'assegnare un pool solo quando necessario e quindi eliminarlo al completamento del processo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-273">One approach is to allocate a pool only when needed and then delete it after the job completes.</span></span> <span data-ttu-id="97ba1-274">Questo ottimizza l'uso, poiché i nodi non sono inattivi, ma il processo deve attendere l'allocazione dei nodi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-274">This maximizes utilization, because nodes are not idle, but the job must wait for nodes to be allocated.</span></span> <span data-ttu-id="97ba1-275">In alternativa, è possibile creare un pool in anticipo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-275">Alternatively, you can create a pool ahead of time.</span></span> <span data-ttu-id="97ba1-276">Tale approccio riduce al minimo il tempo necessario per l'avvio di un processo, ma può comportarne l'inattività di alcuni nodi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-276">That approach minimizes the time that it takes for a job to start, but can result in having nodes that sit idle.</span></span> <span data-ttu-id="97ba1-277">Per altre informazioni, vedere [Durata del pool e dei nodi di calcolo](/azure/batch/batch-api-basics#pool-and-compute-node-lifetime).</span><span class="sxs-lookup"><span data-stu-id="97ba1-277">For more information, see [Pool and compute node lifetime](/azure/batch/batch-api-basics#pool-and-compute-node-lifetime).</span></span>

#### <a name="more-information"></a><span data-ttu-id="97ba1-278">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-278">More information</span></span> 

* [<span data-ttu-id="97ba1-279">Eseguire carichi di lavoro intrinsecamente paralleli con Batch</span><span class="sxs-lookup"><span data-stu-id="97ba1-279">Run intrinsically parallel workloads with Batch</span></span>](/azure/batch/batch-technical-overview) 
* [<span data-ttu-id="97ba1-280">Sviluppare soluzioni di calcolo parallele su larga scala con Batch</span><span class="sxs-lookup"><span data-stu-id="97ba1-280">Develop large-scale parallel compute solutions with Batch</span></span>](/azure/batch/batch-api-basics) 
* [<span data-ttu-id="97ba1-281">Soluzioni batch e HPC per carichi di lavoro di calcolo su larga scala</span><span class="sxs-lookup"><span data-stu-id="97ba1-281">Batch and HPC solutions for large-scale computing workloads</span></span>](/azure/batch/batch-hpc-solutions)

### <a name="azure-container-service"></a><span data-ttu-id="97ba1-282">Servizio contenitore di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-282">Azure Container Service</span></span> 

<span data-ttu-id="97ba1-283">Il servizio contenitore di Azure consente di configurare e gestire un cluster di macchine virtuali in Azure per l'esecuzione delle applicazioni all'interno di contenitori.</span><span class="sxs-lookup"><span data-stu-id="97ba1-283">Azure Container Service lets you configure and manage a cluster of VMs in Azure to run containerized applications.</span></span> <span data-ttu-id="97ba1-284">Consente di scegliere tra Docker Swarm, DC/OS o Kubernetes per l'orchestrazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-284">It provides a choice of Docker Swarm, DC/OS, or Kubernetes for orchestration.</span></span> 

<span data-ttu-id="97ba1-285">I contenitori possono essere utili per l'esecuzione di processi in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-285">Containers can be useful for running background jobs.</span></span> <span data-ttu-id="97ba1-286">Alcuni vantaggi includono:</span><span class="sxs-lookup"><span data-stu-id="97ba1-286">Some of the benefits include:</span></span> 

- <span data-ttu-id="97ba1-287">I contenitori supportano l'hosting ad alta densità.</span><span class="sxs-lookup"><span data-stu-id="97ba1-287">Containers support high-density hosting.</span></span> <span data-ttu-id="97ba1-288">È possibile isolare un'attività in background in un contenitore, durante l'inserimento di più contenitori in una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="97ba1-288">You can isolate a background task in a container, while placing multiple containers in each VM.</span></span>
- <span data-ttu-id="97ba1-289">L'agente di orchestrazione del contenitore gestisce un servizio di bilanciamento del carico interno, la configurazione della rete interna e altre attività di configurazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-289">The container orchestrator handles internal load balancing, configuring the internal network, and other configuration tasks.</span></span>
- <span data-ttu-id="97ba1-290">È possibile avviare e arrestare i contenitori in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="97ba1-290">Containers can be started and stopped as needed.</span></span> 
- <span data-ttu-id="97ba1-291">Registro contenitori di Azure consente di registrare i contenitori all'interno dei limiti di Azure.</span><span class="sxs-lookup"><span data-stu-id="97ba1-291">Azure Container Registry allows you to register your containers inside Azure boundaries.</span></span> <span data-ttu-id="97ba1-292">Questo implica vantaggi di sicurezza, privacy e prossimità.</span><span class="sxs-lookup"><span data-stu-id="97ba1-292">This comes with security, privacy, and proximity benefits.</span></span> 

#### <a name="considerations"></a><span data-ttu-id="97ba1-293">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-293">Considerations</span></span>

- <span data-ttu-id="97ba1-294">Richiede la conoscenza su come usare un agente di orchestrazione del contenitore.</span><span class="sxs-lookup"><span data-stu-id="97ba1-294">Requires an understanding of how to use a container orchestrator.</span></span> <span data-ttu-id="97ba1-295">A seconda dell'insieme di competenze del team DevOps, questo può rappresentare o meno o un problema.</span><span class="sxs-lookup"><span data-stu-id="97ba1-295">Depending on the skillset of your DevOps team, this may or may not be an issue.</span></span>  
- <span data-ttu-id="97ba1-296">Il servizio contenitore viene eseguito in un ambiente IaaS.</span><span class="sxs-lookup"><span data-stu-id="97ba1-296">Container Service runs in an IaaS environment.</span></span> <span data-ttu-id="97ba1-297">Esegue il provisioning di un cluster di macchine virtuali all'interno di una rete virtuale dedicata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-297">It provisions a cluster of VMs inside a dedicated VNet.</span></span> 

#### <a name="more-information"></a><span data-ttu-id="97ba1-298">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-298">More information</span></span> 

* [<span data-ttu-id="97ba1-299">Introduzione alle soluzioni di hosting di contenitori Docker con il servizio contenitore di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-299">Introduction to Docker container hosting solutions with Azure Container Service</span></span>](/azure/container-service/container-service-intro) 
* [<span data-ttu-id="97ba1-300">Introduzione ai registri per contenitori Docker privati</span><span class="sxs-lookup"><span data-stu-id="97ba1-300">Introduction to private Docker container registries</span></span>](/azure/container-registry/container-registry-intro) 

### <a name="azure-cloud-services"></a><span data-ttu-id="97ba1-301">Servizi cloud di Azure</span><span class="sxs-lookup"><span data-stu-id="97ba1-301">Azure Cloud Services</span></span> 
<span data-ttu-id="97ba1-302">È possibile eseguire attività in background all'interno di un ruolo Web o in un ruolo di lavoro distinto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-302">You can execute background tasks within a web role or in a separate worker role.</span></span> <span data-ttu-id="97ba1-303">Per decidere se usare un ruolo di lavoro è necessario considerare i requisiti di scalabilità ed elasticità, la durata dell'attività, la cadenza di rilascio, la sicurezza, la tolleranza di errore, la contesa, la complessità e l'architettura logica.</span><span class="sxs-lookup"><span data-stu-id="97ba1-303">When you are deciding whether to use a worker role, consider scalability and elasticity requirements, task lifetime, release cadence, security, fault tolerance, contention, complexity, and the logical architecture.</span></span> <span data-ttu-id="97ba1-304">Per altre informazioni, vedere [Modello di consolidamento delle risorse di calcolo](../patterns/compute-resource-consolidation.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-304">For more information, see [Compute Resource Consolidation Pattern](../patterns/compute-resource-consolidation.md).</span></span>

<span data-ttu-id="97ba1-305">Esistono diversi modi per implementare le attività di background in un ruolo Servizi cloud:</span><span class="sxs-lookup"><span data-stu-id="97ba1-305">There are several ways to implement background tasks within a Cloud Services role:</span></span>

* <span data-ttu-id="97ba1-306">Creare un'implementazione della classe **RoleEntryPoint** nel ruolo e usarne i metodi per eseguire attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-306">Create an implementation of the **RoleEntryPoint** class in the role and use its methods to execute background tasks.</span></span> <span data-ttu-id="97ba1-307">Le attività vengono eseguite nel contesto di WaIISHost.exe.</span><span class="sxs-lookup"><span data-stu-id="97ba1-307">The tasks run in the context of WaIISHost.exe.</span></span> <span data-ttu-id="97ba1-308">Possono usare il metodo **GetSetting** della classe **CloudConfigurationManager** per caricare le impostazioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-308">They can use the **GetSetting** method of the **CloudConfigurationManager** class to load configuration settings.</span></span> <span data-ttu-id="97ba1-309">Per altre informazioni, vedere [Ciclo di vita](#lifecycle).</span><span class="sxs-lookup"><span data-stu-id="97ba1-309">For more information, see [Lifecycle](#lifecycle).</span></span>
* <span data-ttu-id="97ba1-310">Usare le attività di avvio per eseguire attività in background all'avvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-310">Use startup tasks to execute background tasks when the application starts.</span></span> <span data-ttu-id="97ba1-311">Per forzare il proseguimento dell'esecuzione delle attività in background, impostare la proprietà **taskType** su **background**. In caso contrario il processo di avvio dell'applicazione si arresterà e attenderà il completamento dell'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-311">To force the tasks to continue to run in the background, set the **taskType** property to **background** (if you do not do this, the application startup process will halt and wait for the task to finish).</span></span> <span data-ttu-id="97ba1-312">Per altre informazioni, vedere [Come configurare ed eseguire attività di avvio per un servizio cloud](/azure/cloud-services/cloud-services-startup-tasks).</span><span class="sxs-lookup"><span data-stu-id="97ba1-312">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks).</span></span>
* <span data-ttu-id="97ba1-313">Usare WebJobs SDK per implementare attività in background come ad esempio WebJobs, che vengono avviate come attività di avvio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-313">Use the WebJobs SDK to implement background tasks such as WebJobs that are initiated as a startup task.</span></span> <span data-ttu-id="97ba1-314">Per altre informazioni, vedere [Creare un processo Web .NET in Servizio app di Azure](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started).</span><span class="sxs-lookup"><span data-stu-id="97ba1-314">For more information, see [Create a .NET WebJob in Azure App Service](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started).</span></span>
* <span data-ttu-id="97ba1-315">Usare un'attività di avvio per installare un servizio Windows che esegue una o più attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-315">Use a startup task to install a Windows service that executes one or more background tasks.</span></span> <span data-ttu-id="97ba1-316">È necessario impostare la proprietà **taskType** su **background** in modo che il servizio venga eseguito in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-316">You must set the **taskType** property to **background** so that the service executes in the background.</span></span> <span data-ttu-id="97ba1-317">Per altre informazioni, vedere [Come configurare ed eseguire attività di avvio per un servizio cloud](/azure/cloud-services/cloud-services-startup-tasks).</span><span class="sxs-lookup"><span data-stu-id="97ba1-317">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks).</span></span>

<span data-ttu-id="97ba1-318">Il vantaggio principale dell'esecuzione di attività in background nel ruolo Web è il risparmio dei costi di hosting perché non è richiesta la distribuzione di ruoli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-318">The main advantage of running background tasks in the web role is the saving in hosting costs because there is no requirement to deploy additional roles.</span></span>

<span data-ttu-id="97ba1-319">L'esecuzione di attività in background in un ruolo di lavoro presenta diversi vantaggi:</span><span class="sxs-lookup"><span data-stu-id="97ba1-319">Running background tasks in a worker role has several advantages:</span></span>

* <span data-ttu-id="97ba1-320">Consente di gestire il ridimensionamento separatamente per ogni tipo di ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-320">It allows you to manage scaling separately for each type of role.</span></span> <span data-ttu-id="97ba1-321">Ad esempio, potrebbero essere necessarie più istanze di un ruolo Web per supportare il carico corrente, ma un minor numero di istanze del ruolo di lavoro che esegue le attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-321">For example, you might need more instances of a web role to support the current load, but fewer instances of the worker role that executes background tasks.</span></span> <span data-ttu-id="97ba1-322">Il dimensionamento delle istanze di calcolo dell'attività in background separatamente dai ruoli dell'interfaccia utente consente di ridurre i costi di hosting mantenendo prestazioni accettabili.</span><span class="sxs-lookup"><span data-stu-id="97ba1-322">By scaling background task compute instances separately from the UI roles, you can reduce hosting costs, while maintaining acceptable performance.</span></span>
* <span data-ttu-id="97ba1-323">Scarica il sovraccarico dell'elaborazione per le attività in background del ruolo Web.</span><span class="sxs-lookup"><span data-stu-id="97ba1-323">It offloads the processing overhead for background tasks from the web role.</span></span> <span data-ttu-id="97ba1-324">Il ruolo Web che fornisce l'interfaccia utente può rimanere attivo per cui è necessario un minor numero di istanze per supportare un determinato volume di richieste dagli utenti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-324">The web role that provides the UI can remain responsive, and it may mean fewer instances are required to support a given volume of requests from users.</span></span>
* <span data-ttu-id="97ba1-325">Consente di implementare la separazione delle problematiche.</span><span class="sxs-lookup"><span data-stu-id="97ba1-325">It allows you to implement separation of concerns.</span></span> <span data-ttu-id="97ba1-326">Ogni tipo di ruolo può implementare un set specifico di attività ben definite e correlate.</span><span class="sxs-lookup"><span data-stu-id="97ba1-326">Each role type can implement a specific set of clearly defined and related tasks.</span></span> <span data-ttu-id="97ba1-327">La progettazione e la gestione del codice si semplificano grazie alla minore interdipendenza di codice e funzionalità tra ogni ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-327">This makes designing and maintaining the code easier because there is less interdependence of code and functionality between each role.</span></span>
* <span data-ttu-id="97ba1-328">Può essere utile per isolare dati e processi sensibili.</span><span class="sxs-lookup"><span data-stu-id="97ba1-328">It can help to isolate sensitive processes and data.</span></span> <span data-ttu-id="97ba1-329">Ad esempio, i ruoli Web che implementano l'interfaccia utente non richiedono l'accesso ai dati gestiti e controllati da un ruolo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="97ba1-329">For example, web roles that implement the UI do not need to have access to data that is managed and controlled by a worker role.</span></span> <span data-ttu-id="97ba1-330">Ciò può essere utile per rafforzare la sicurezza, soprattutto quando si usa un modello come [Gatekeeper Pattern](../patterns/gatekeeper.md)(Modello Gatekeeper).</span><span class="sxs-lookup"><span data-stu-id="97ba1-330">This can be useful in strengthening security, especially when you use a pattern such as the [Gatekeeper Pattern](../patterns/gatekeeper.md).</span></span>  

#### <a name="considerations"></a><span data-ttu-id="97ba1-331">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-331">Considerations</span></span>
<span data-ttu-id="97ba1-332">Nella scelta del modo e della posizione per la distribuzione delle attività in background quando si usano i ruoli di lavoro e Web di Servizi Cloud, tenere presenti le considerazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-332">Consider the following points when choosing how and where to deploy background tasks when using Cloud Services web and worker roles:</span></span>

* <span data-ttu-id="97ba1-333">Ospitare attività in background in un ruolo Web esistente può far risparmiare il costo di eseguire un ruolo di lavoro separato solo per queste attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-333">Hosting background tasks in an existing web role can save the cost of running a separate worker role just for these tasks.</span></span> <span data-ttu-id="97ba1-334">Questo comporta tuttavia la probabilità di influire sulle prestazioni e sulla disponibilità dell’applicazione in caso di contesa per l’elaborazione e per altre risorse.</span><span class="sxs-lookup"><span data-stu-id="97ba1-334">However, it is likely to affect the performance and availability of the application if there is contention for processing and other resources.</span></span> <span data-ttu-id="97ba1-335">L'uso di un ruolo di lavoro distinto protegge il ruolo Web dall'impatto delle attività in background a esecuzione prolungata o a uso intensivo delle risorse.</span><span class="sxs-lookup"><span data-stu-id="97ba1-335">Using a separate worker role protects the web role from the impact of long-running or resource-intensive background tasks.</span></span>
* <span data-ttu-id="97ba1-336">Se si ospitano le attività in background usando la classe **RoleEntryPoint** , è possibile spostarla facilmente in un altro ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-336">If you host background tasks by using the **RoleEntryPoint** class, you can easily move this to another role.</span></span> <span data-ttu-id="97ba1-337">Ad esempio, se si crea la classe in un ruolo Web e successivamente si decide di eseguire le attività in un ruolo di lavoro, è possibile spostare l'implementazione della classe **RoleEntryPoint** nel ruolo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="97ba1-337">For example, if you create the class in a web role and later decide that you need to run the tasks in a worker role, you can move the **RoleEntryPoint** class implementation into the worker role.</span></span>
* <span data-ttu-id="97ba1-338">Le attività di avvio sono progettate per eseguire un programma o uno script.</span><span class="sxs-lookup"><span data-stu-id="97ba1-338">Startup tasks are designed to execute a program or a script.</span></span> <span data-ttu-id="97ba1-339">La distribuzione di un processo in background come programma eseguibile potrebbe essere più difficile, soprattutto se richiede anche la distribuzione degli assembly dipendenti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-339">Deploying a background job as an executable program might be more difficult, especially if it also requires deployment of dependent assemblies.</span></span> <span data-ttu-id="97ba1-340">Potrebbe essere più facile distribuire e usare uno script per definire un processo in background quando si usano attività di avvio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-340">It might be easier to deploy and use a script to define a background job when you use startup tasks.</span></span>
* <span data-ttu-id="97ba1-341">Le eccezioni che provocano un esito negativo dell'attività in background hanno un impatto diverso a seconda del modo in cui sono ospitate:</span><span class="sxs-lookup"><span data-stu-id="97ba1-341">Exceptions that cause a background task to fail have a different impact, depending on the way that they are hosted:</span></span>
  * <span data-ttu-id="97ba1-342">Se si usa l'approccio della classe **RoleEntryPoint** , un'attività non riuscita comporterà il riavvio del ruolo in modo che l'attività venga riavviata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-342">If you use the **RoleEntryPoint** class approach, a failed task will cause the role to restart so that the task automatically restarts.</span></span> <span data-ttu-id="97ba1-343">Ciò può influire sulla disponibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-343">This can affect availability of the application.</span></span> <span data-ttu-id="97ba1-344">Per evitare questo problema, assicurarsi di includere un sistema di gestione delle eccezioni efficace nella classe **RoleEntryPoint** e in tutte le attività di background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-344">To prevent this, ensure that you include robust exception handling within the **RoleEntryPoint** class and all the background tasks.</span></span> <span data-ttu-id="97ba1-345">Usare il codice per riavviare le attività che hanno esito negativo laddove appropriato e generare l'eccezione per riavviare il ruolo solo se non è possibile correggere l'errore normalmente all'interno del codice.</span><span class="sxs-lookup"><span data-stu-id="97ba1-345">Use code to restart tasks that fail where this is appropriate, and throw the exception to restart the role only if you cannot gracefully recover from the failure within your code.</span></span>
  * <span data-ttu-id="97ba1-346">Se si usano attività di avvio, l'utente è responsabile della gestione e del controllo dell'esecuzione dell'attività in caso di esito negativo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-346">If you use startup tasks, you are responsible for managing the task execution and checking if it fails.</span></span>
* <span data-ttu-id="97ba1-347">La gestione e il monitoraggio delle attività di avvio è più difficile dell'utilizzo dell'approccio della classe **RoleEntryPoint** .</span><span class="sxs-lookup"><span data-stu-id="97ba1-347">Managing and monitoring startup tasks is more difficult than using the **RoleEntryPoint** class approach.</span></span> <span data-ttu-id="97ba1-348">Azure WebJobs SDK include tuttavia un dashboard per semplificare la gestione di WebJobs avviato tramite attività di avvio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-348">However, the Azure WebJobs SDK includes a dashboard to make it easier to manage WebJobs that you initiate through startup tasks.</span></span>

#### <a name="lifecycle"></a><span data-ttu-id="97ba1-349">Ciclo di vita</span><span class="sxs-lookup"><span data-stu-id="97ba1-349">Lifecycle</span></span> 
 <span data-ttu-id="97ba1-350">Se si decide di implementare processi in background per le applicazioni di Servizi cloud che usano i ruoli Web e di lavoro tramite la classe **RoleEntryPoint** , è importante comprendere il ciclo di vita di questa classe per usarla in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-350">If you decide to implement background jobs for Cloud Services applications that use web and worker roles by using the **RoleEntryPoint** class, it is important to understand the lifecycle of this class in order to use it correctly.</span></span>

<span data-ttu-id="97ba1-351">I ruoli Web e di lavoro attraversano una serie di fasi distinte quando vengono avviati, eseguiti e arrestati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-351">Web and worker roles go through a set of distinct phases as they start, run, and stop.</span></span> <span data-ttu-id="97ba1-352">La classe **RoleEntryPoint** espone una serie di eventi che indicano quando si verificano queste fasi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-352">The **RoleEntryPoint** class exposes a series of events that indicate when these stages are occurring.</span></span> <span data-ttu-id="97ba1-353">Vengono usati per inizializzare, eseguire e arrestare le attività di background personalizzate.</span><span class="sxs-lookup"><span data-stu-id="97ba1-353">You use these to initialize, run, and stop your custom background tasks.</span></span> <span data-ttu-id="97ba1-354">Il ciclo completo è:</span><span class="sxs-lookup"><span data-stu-id="97ba1-354">The complete cycle is:</span></span>

* <span data-ttu-id="97ba1-355">Azure carica l'assembly del ruolo e vi cerca una classe che deriva da **RoleEntryPoint**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-355">Azure loads the role assembly and searches it for a class that derives from **RoleEntryPoint**.</span></span>
* <span data-ttu-id="97ba1-356">Se trova la classe, chiama **RoleEntryPoint.OnStart()**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-356">If it finds this class, it calls **RoleEntryPoint.OnStart()**.</span></span> <span data-ttu-id="97ba1-357">Si esegue l'override di questo metodo per inizializzare le attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-357">You override this method to initialize your background tasks.</span></span>
* <span data-ttu-id="97ba1-358">Al termine dell'esecuzione del metodo **OnStart** Azure chiama **Application_Start ()** nel file Global dell'applicazione, se presente. ad esempio, Global.asax in un ruolo Web che esegue ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="97ba1-358">After the **OnStart** method has completed, Azure calls **Application_Start()** in the application’s Global file if this is present (for example, Global.asax in a web role running ASP.NET).</span></span>
* <span data-ttu-id="97ba1-359">Azure chiama **RoleEntryPoint.Run()** in un nuovo thread di primo piano eseguito in parallelo con **OnStart()**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-359">Azure calls **RoleEntryPoint.Run()** on a new foreground thread that executes in parallel with **OnStart()**.</span></span> <span data-ttu-id="97ba1-360">Si esegue l'override di questo metodo per avviare le attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-360">You override this method to start your background tasks.</span></span>
* <span data-ttu-id="97ba1-361">Al termine dell'esecuzione del metodo Run, Azure chiama prima **Application_End()** nel file Global dell'applicazione, se presente, quindi **RoleEntryPoint.OnStop()**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-361">When the Run method ends, Azure first calls **Application_End()** in the application’s Global file if this is present, and then calls **RoleEntryPoint.OnStop()**.</span></span> <span data-ttu-id="97ba1-362">Si esegue l'override del metodo **OnStop** per interrompere le attività in background, pulire le risorse, eliminare gli oggetti e chiudere le connessioni che possono essere state usate dalle attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-362">You override the **OnStop** method to stop your background tasks, clean up resources, dispose of objects, and close connections that the tasks may have used.</span></span>
* <span data-ttu-id="97ba1-363">Il ruolo di lavoro di Azure viene arrestato.</span><span class="sxs-lookup"><span data-stu-id="97ba1-363">The Azure worker role host process is stopped.</span></span> <span data-ttu-id="97ba1-364">A questo punto, il ruolo sarà riciclato e verrà riavviato.</span><span class="sxs-lookup"><span data-stu-id="97ba1-364">At this point, the role will be recycled and will restart.</span></span>

<span data-ttu-id="97ba1-365">Per altre informazioni e un esempio di utilizzo dei metodi della classe **RoleEntryPoint** , vedere [Modello di consolidamento delle risorse di calcolo](../patterns/compute-resource-consolidation.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-365">For more details and an example of using the methods of the **RoleEntryPoint** class, see [Compute Resource Consolidation Pattern](../patterns/compute-resource-consolidation.md).</span></span>

#### <a name="implementation-considerations"></a><span data-ttu-id="97ba1-366">Considerazioni sull'implementazione</span><span class="sxs-lookup"><span data-stu-id="97ba1-366">Implementation considerations</span></span>

<span data-ttu-id="97ba1-367">Se si desidera implementare le attività in background in un ruolo Web o di lavoro, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="97ba1-367">Consider the following points if you are implementing background tasks in a web or worker role:</span></span>

* <span data-ttu-id="97ba1-368">L'implementazione predefinita del metodo **Run** nella classe **RoleEntryPoint** contiene una chiamata a **Thread.Sleep(Timeout.Infinite)**, che mantiene il ruolo attivo per un tempo illimitato.</span><span class="sxs-lookup"><span data-stu-id="97ba1-368">The default **Run** method implementation in the **RoleEntryPoint** class contains a call to **Thread.Sleep(Timeout.Infinite)** that keeps the role alive indefinitely.</span></span> <span data-ttu-id="97ba1-369">Se si esegue l'override del metodo **Run** , operazione generalmente necessaria per eseguire attività in background, non deve essere consentito al codice di uscire dal metodo a meno che non si desideri riutilizzare l'istanza del ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-369">If you override the **Run** method (which is typically necessary to execute background tasks), you must not allow your code to exit from the method unless you want to recycle the role instance.</span></span>
* <span data-ttu-id="97ba1-370">Un'implementazione tipica del metodo **Run** include il codice per l'avvio di ciascuna attività in background e un costrutto del ciclo che controlla periodicamente lo stato di tutte le attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-370">A typical implementation of the **Run** method includes code to start each of the background tasks and a loop construct that periodically checks the state of all the background tasks.</span></span> <span data-ttu-id="97ba1-371">Tale implementazione consente di riavviare le attività non riuscite o di monitorare i token di annullamento che indicano il completamento dei processi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-371">It can restart any that fail or monitor for cancellation tokens that indicate that jobs have completed.</span></span>
* <span data-ttu-id="97ba1-372">Se un'attività in background genera un'eccezione non gestita, l'attività deve essere riavviata, consentendo al contempo il proseguimento dell'esecuzione delle altre attività in background nel ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-372">If a background task throws an unhandled exception, that task should be recycled while allowing any other background tasks in the role to continue running.</span></span> <span data-ttu-id="97ba1-373">Se l'eccezione è invece causata dal danneggiamento di oggetti esterni all'attività, come una risorsa di archiviazione condivisa, l'eccezione deve essere gestita dalla classe **RoleEntryPoint**, tutte le attività devono essere annullate ed è necessario consentire al metodo **Run** di terminare.</span><span class="sxs-lookup"><span data-stu-id="97ba1-373">However, if the exception is caused by corruption of objects outside the task, such as shared storage, the exception should be handled by your **RoleEntryPoint** class, all tasks should be cancelled, and the **Run** method should be allowed to end.</span></span> <span data-ttu-id="97ba1-374">Azure riavvierà quindi il ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-374">Azure will then restart the role.</span></span>
* <span data-ttu-id="97ba1-375">Utilizzare il metodo **OnStop** per sospendere o arrestare le attività in background e pulire le risorse.</span><span class="sxs-lookup"><span data-stu-id="97ba1-375">Use the **OnStop** method to pause or kill background tasks and clean up resources.</span></span> <span data-ttu-id="97ba1-376">Questo potrebbe comportare l'arresto di attività a esecuzione prolungata o a più passaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-376">This might involve stopping long-running or multistep tasks.</span></span> <span data-ttu-id="97ba1-377">È fondamentale considerare come eseguire questa operazione in modo da evitare incoerenze nei dati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-377">It is vital to consider how this can be done to avoid data inconsistencies.</span></span> <span data-ttu-id="97ba1-378">Se un'istanza del ruolo viene arrestata per un motivo diverso da un arresto avviato dall'utente, il codice in esecuzione nel metodo **OnStop** deve essere completato entro cinque minuti prima della terminazione forzata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-378">If a role instance stops for any reason other than a user-initiated shutdown, the code running in the **OnStop** method must be completed within five minutes before it is forcibly terminated.</span></span> <span data-ttu-id="97ba1-379">Verificare che il codice possa essere completato in quel periodo di tempo o che possa tollerare di non essere eseguito fino al completamento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-379">Ensure that your code can be completed in that time or can tolerate not running to completion.</span></span>  
* <span data-ttu-id="97ba1-380">Azure Load Balancer inizia a indirizzare il traffico all'istanza del ruolo quando il metodo **RoleEntryPoint.OnStart** restituisce il valore **true**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-380">The Azure load balancer starts directing traffic to the role instance when the **RoleEntryPoint.OnStart** method returns the value **true**.</span></span> <span data-ttu-id="97ba1-381">È quindi consigliabile inserire tutto il codice di inizializzazione nel metodo **OnStart** in modo che le istanze del ruolo non inizializziate correttamente non ricevano il traffico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-381">Therefore, consider putting all your initialization code in the **OnStart** method so that role instances that do not successfully initialize will not receive any traffic.</span></span>
* <span data-ttu-id="97ba1-382">È possibile usare le attività di avvio in aggiunta ai metodi della classe **RoleEntryPoint** .</span><span class="sxs-lookup"><span data-stu-id="97ba1-382">You can use startup tasks in addition to the methods of the **RoleEntryPoint** class.</span></span> <span data-ttu-id="97ba1-383">È consigliabile usare le attività di avvio per inizializzare le impostazioni da modificare nel servizio di bilanciamento del carico di Azure, poiché queste operazioni verranno eseguite prima che il ruolo riceva tutta le richieste.</span><span class="sxs-lookup"><span data-stu-id="97ba1-383">You should use startup tasks to initialize any settings that you need to change in the Azure load balancer because these tasks will execute before the role receives any requests.</span></span> <span data-ttu-id="97ba1-384">Per altre informazioni, vedere [Come configurare ed eseguire attività di avvio per un servizio cloud](/azure/cloud-services/cloud-services-startup-tasks/).</span><span class="sxs-lookup"><span data-stu-id="97ba1-384">For more information, see [Run startup tasks in Azure](/azure/cloud-services/cloud-services-startup-tasks/).</span></span>
* <span data-ttu-id="97ba1-385">Un eventuale errore in un'attività di avvio potrebbe determinare il continuo riavvio forzato del ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-385">If there is an error in a startup task, it might force the role to continually restart.</span></span> <span data-ttu-id="97ba1-386">Ciò può impedire di effettuare lo scambio di un indirizzo VIP con una versione temporanea precedente in quanto lo scambio richiede l'accesso esclusivo al ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-386">This can prevent you from performing a virtual IP (VIP) address swap back to a previously staged version because the swap requires exclusive access to the role.</span></span> <span data-ttu-id="97ba1-387">Questo non può essere ottenuto durante il riavvio del ruolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-387">This cannot be obtained while the role is restarting.</span></span> <span data-ttu-id="97ba1-388">Per risolvere il problema:</span><span class="sxs-lookup"><span data-stu-id="97ba1-388">To resolve this:</span></span>
  
  * <span data-ttu-id="97ba1-389">Aggiungere il codice seguente all'inizio dei metodi **OnStart** e **Run** nel ruolo:</span><span class="sxs-lookup"><span data-stu-id="97ba1-389">Add the following code to the beginning of the **OnStart** and **Run** methods in your role:</span></span>
    
    ```C#
    var freeze = CloudConfigurationManager.GetSetting("Freeze");
    if (freeze != null)
    {
      if (Boolean.Parse(freeze))
      {
        Thread.Sleep(System.Threading.Timeout.Infinite);
      }
    }
    ```
    
  * <span data-ttu-id="97ba1-390">Aggiungere la definizione dell'impostazione **Freeze** come valore booleano nei file ServiceDefinition.csdef e ServiceConfiguration.\*.cscfg per il ruolo e impostarla su **false**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-390">Add the definition of the **Freeze** setting as a Boolean value to the ServiceDefinition.csdef and ServiceConfiguration.\*.cscfg files for the role and set it to **false**.</span></span> <span data-ttu-id="97ba1-391">Se il ruolo passa alla modalità di riavvio ripetuto, è possibile modificare l'impostazione in **true** per bloccare l'esecuzione del ruolo e consentire lo scambio con una versione precedente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-391">If the role goes into a repeated restart mode, you can change the setting to **true** to freeze role execution and allow it to be swapped with a previous version.</span></span>

#### <a name="more-information"></a><span data-ttu-id="97ba1-392">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-392">More information</span></span>
* [<span data-ttu-id="97ba1-393">Modello di consolidamento delle risorse di calcolo</span><span class="sxs-lookup"><span data-stu-id="97ba1-393">Compute Resource Consolidation Pattern</span></span>](../patterns/compute-resource-consolidation.md)
* [<span data-ttu-id="97ba1-394">Introduzione ad Azure WebJobs SDK</span><span class="sxs-lookup"><span data-stu-id="97ba1-394">Get started with the Azure WebJobs SDK</span></span>](/azure/app-service-web/websites-dotnet-webjobs-sdk-get-started/)


## <a name="partitioning"></a><span data-ttu-id="97ba1-395">Partizionamento</span><span class="sxs-lookup"><span data-stu-id="97ba1-395">Partitioning</span></span>
<span data-ttu-id="97ba1-396">Se si decide di includere le attività in background all'interno di un'istanza di calcolo esistente (ad esempio un'app Web, un ruolo Web, un ruolo di lavoro esistente o una macchina virtuale), è necessario valutare l'impatto di questa condizione sugli attributi di qualità dell'istanza di calcolo e sull'attività in background stessa.</span><span class="sxs-lookup"><span data-stu-id="97ba1-396">If you decide to include background tasks within an existing compute instance (such as a web app, web role, existing worker role, or virtual machine), you must consider how this will affect the quality attributes of the compute instance and the background task itself.</span></span> <span data-ttu-id="97ba1-397">Questi fattori saranno utili per decidere se posizionare le attività insieme all'istanza di calcolo esistente o separarle in un'istanza di calcolo distinta:</span><span class="sxs-lookup"><span data-stu-id="97ba1-397">These factors will help you to decide whether to colocate the tasks with the existing compute instance or separate them out into a separate compute instance:</span></span>

* <span data-ttu-id="97ba1-398">**Disponibilità**: potrebbe non essere necessario assegnare alle attività in background lo stesso livello di disponibilità di altre parti dell'applicazione, in particolare dell'interfaccia utente e di altre parti direttamente coinvolte nell'interazione dell'utente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-398">**Availability**: Background tasks might not need to have the same level of availability as other parts of the application, in particular the UI and other parts that are directly involved in user interaction.</span></span> <span data-ttu-id="97ba1-399">Le attività in background potrebbero avere una maggiore tolleranza alla latenza, ai tentativi di connessione non riusciti e ad altri fattori che interessano la disponibilità poiché le operazioni possono essere accodate.</span><span class="sxs-lookup"><span data-stu-id="97ba1-399">Background tasks might be more tolerant of latency, retried connection failures, and other factors that affect availability because the operations can be queued.</span></span> <span data-ttu-id="97ba1-400">Deve essere tuttavia una capacità sufficiente a impedire il backup di richieste che potrebbero bloccare le code e influire sull'intera applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-400">However, there must be sufficient capacity to prevent the backup of requests that could block queues and affect the application as a whole.</span></span>
* <span data-ttu-id="97ba1-401">**Scalabilità**: è probabile che le attività in background presentino requisiti di scalabilità diversi rispetto all'interfaccia utente e alle parti interattive dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-401">**Scalability**: Background tasks are likely to have a different scalability requirement than the UI and the interactive parts of the application.</span></span> <span data-ttu-id="97ba1-402">Il dimensionamento dell'interfaccia utente potrebbe essere necessario per soddisfare i picchi della richiesta, mentre le attività in background in sospeso potrebbero essere completate nelle ore di lavoro meno intenso da un numero inferiore di istanze di calcolo.</span><span class="sxs-lookup"><span data-stu-id="97ba1-402">Scaling the UI might be necessary to meet peaks in demand, while outstanding background tasks might be completed during less busy times by a fewer number of compute instances.</span></span>
* <span data-ttu-id="97ba1-403">**Resilienza**: un errore di un'istanza di calcolo contenente solo attività in background non può avere un impatto irreversibile sull'intera applicazione, se le richieste di esecuzione di tali attività possono essere accodate o posticipate finché l'attività non diventa nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="97ba1-403">**Resiliency**: Failure of a compute instance that just hosts background tasks might not fatally affect the application as a whole if the requests for these tasks can be queued or postponed until the task is available again.</span></span> <span data-ttu-id="97ba1-404">Se l'istanza di calcolo e/o le attività possono essere riavviate entro un intervallo di tempo appropriato, gli utenti dell'applicazione non ne saranno interessati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-404">If the compute instance and/or tasks can be restarted within an appropriate interval, users of the application might not be affected.</span></span>
* <span data-ttu-id="97ba1-405">**Protezione**: le attività in background potrebbero presentare requisiti di sicurezza o limitazioni diversi rispetto all'interfaccia utente o ad altre parti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-405">**Security**: Background tasks might have different security requirements or restrictions than the UI or other parts of the application.</span></span> <span data-ttu-id="97ba1-406">Usando un'istanza di calcolo separata, è possibile specificare un ambiente di protezione diverso per le attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-406">By using a separate compute instance, you can specify a different security environment for the tasks.</span></span> <span data-ttu-id="97ba1-407">Inoltre, è possibile usare modelli, ad esempio Gatekeeper, per isolare le istanze di calcolo in background dall'interfaccia utente al fine di ottimizzare sicurezza e separazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-407">You can also use patterns such as Gatekeeper to isolate the background compute instances from the UI in order to maximize security and separation.</span></span>
* <span data-ttu-id="97ba1-408">**Prestazioni**: è possibile scegliere il tipo di istanza di calcolo per le attività in background per soddisfare i requisiti di prestazioni specifici delle attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-408">**Performance**: You can choose the type of compute instance for background tasks to specifically match the performance requirements of the tasks.</span></span> <span data-ttu-id="97ba1-409">Ciò potrebbe consentire l'uso di un'opzione di calcolo meno costosa, se le attività non richiedono le stesse funzionalità di elaborazione dell'interfaccia utente, o di un'istanza di dimensione maggiore, se richiedono risorse e capacità aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="97ba1-409">This might mean using a less expensive compute option if the tasks do not require the same processing capabilities as the UI, or a larger instance if they require additional capacity and resources.</span></span>
* <span data-ttu-id="97ba1-410">**Gestibilità**: le attività in background possono avere un ritmo di sviluppo e distribuzione diverso dal codice dell'applicazione principale o dall'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-410">**Manageability**: Background tasks might have a different development and deployment rhythm from the main application code or the UI.</span></span> <span data-ttu-id="97ba1-411">La distribuzione in un'istanza di calcolo separata consente di semplificare gli aggiornamenti e il controllo delle versioni.</span><span class="sxs-lookup"><span data-stu-id="97ba1-411">Deploying them to a separate compute instance can simplify updates and versioning.</span></span>
* <span data-ttu-id="97ba1-412">**Costo**: l'aggiunta di istanze di calcolo per eseguire attività in background aumenta i costi di hosting.</span><span class="sxs-lookup"><span data-stu-id="97ba1-412">**Cost**: Adding compute instances to execute background tasks increases hosting costs.</span></span> <span data-ttu-id="97ba1-413">È necessario valutare attentamente un compromesso tra capacità aggiuntiva e questi costi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-413">You should carefully consider the trade-off between additional capacity and these extra costs.</span></span>

<span data-ttu-id="97ba1-414">Per altre informazioni, vedere gli articoli [Leader Election Pattern](../patterns/leader-election.md) (Modello di designazione leader) e [Competing Consumers Pattern](../patterns/competing-consumers.md) (Modello di consumer concorrenti).</span><span class="sxs-lookup"><span data-stu-id="97ba1-414">For more information, see [Leader Election Pattern](../patterns/leader-election.md) and [Competing Consumers Pattern](../patterns/competing-consumers.md).</span></span>

## <a name="conflicts"></a><span data-ttu-id="97ba1-415">Conflitti</span><span class="sxs-lookup"><span data-stu-id="97ba1-415">Conflicts</span></span>
<span data-ttu-id="97ba1-416">Se sono presenti più istanze di un processo in background, è possibile che esse competano per l'accesso alle risorse e ai servizi, come i database e le risorse di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-416">If you have multiple instances of a background job, it is possible that they will compete for access to resources and services, such as databases and storage.</span></span> <span data-ttu-id="97ba1-417">L'accesso simultaneo può causare la contesa di risorse con conseguenti conflitti di disponibilità dei servizi e integrità dei dati nella risorsa di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-417">This concurrent access can result in resource contention, which might cause conflicts in availability of the services and in the integrity of data in storage.</span></span> <span data-ttu-id="97ba1-418">È possibile risolvere la contesa usando un approccio basato sul blocco pessimistico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-418">You can resolve resource contention by using a pessimistic locking approach.</span></span> <span data-ttu-id="97ba1-419">In questo modo si impedisce che le istanze in competizione di un'attività accedano contemporaneamente a un servizio o danneggino i dati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-419">This prevents competing instances of a task from concurrently accessing a service or corrupting data.</span></span>

<span data-ttu-id="97ba1-420">Un altro approccio per risolvere i conflitti consiste nel definire le attività in background come un singleton, in modo che vi sia sempre un'unica istanza in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-420">Another approach to resolve conflicts is to define background tasks as a singleton, so that there is only ever one instance running.</span></span> <span data-ttu-id="97ba1-421">Ciò elimina tuttavia i vantaggi di affidabilità e prestazioni che si possono ottenere da una configurazione a più istanze.</span><span class="sxs-lookup"><span data-stu-id="97ba1-421">However, this eliminates the reliability and performance benefits that a multiple-instance configuration can provide.</span></span> <span data-ttu-id="97ba1-422">In particolare quando l'interfaccia utente può fornire lavoro sufficiente da tenere occupata più di un'attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-422">This is especially true if the UI can supply sufficient work to keep more than one background task busy.</span></span>

<span data-ttu-id="97ba1-423">È fondamentale garantire che l'attività in background possa essere riavviata automaticamente e che disponga di capacità sufficiente per far fronte a picchi della richiesta.</span><span class="sxs-lookup"><span data-stu-id="97ba1-423">It is vital to ensure that the background task can automatically restart and that it has sufficient capacity to cope with peaks in demand.</span></span> <span data-ttu-id="97ba1-424">Questo scopo può essere raggiunto allocando un'istanza di calcolo con risorse sufficienti, implementando un meccanismo di accodamento che possa archiviare le richieste per un'esecuzione successiva quando la richiesta diminuisce o con una combinazione di queste tecniche.</span><span class="sxs-lookup"><span data-stu-id="97ba1-424">You can achieve this by allocating a compute instance with sufficient resources, by implementing a queueing mechanism that can store requests for later execution when demand decreases, or by using a combination of these techniques.</span></span>

## <a name="coordination"></a><span data-ttu-id="97ba1-425">Coordinamento</span><span class="sxs-lookup"><span data-stu-id="97ba1-425">Coordination</span></span>
<span data-ttu-id="97ba1-426">Le attività in background possono essere complesse e potrebbe essere necessaria l'esecuzione di più attività singole al fine di produrre un determinato risultato o soddisfare tutti i requisiti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-426">The background tasks might be complex and might require multiple individual tasks to execute to produce a result or to fulfil all the requirements.</span></span> <span data-ttu-id="97ba1-427">In tali scenari è comune dividere l'attività in passaggi discreti più piccoli o sottoattività che possono essere eseguite da più consumer.</span><span class="sxs-lookup"><span data-stu-id="97ba1-427">It is common in these scenarios to divide the task into smaller discreet steps or subtasks that can be executed by multiple consumers.</span></span> <span data-ttu-id="97ba1-428">I processi a più passaggi possono essere maggiormente efficienti e flessibili in quanto i singoli passaggi sono riutilizzabili in più processi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-428">Multistep jobs can be more efficient and more flexible because individual steps might be reusable in multiple jobs.</span></span> <span data-ttu-id="97ba1-429">È facile, inoltre, aggiungere, rimuovere o modificare l'ordine dei passaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-429">It is also easy to add, remove, or modify the order of the steps.</span></span>

<span data-ttu-id="97ba1-430">Il coordinamento di più attività e passaggi può essere difficile, ma sono disponibili tre modelli comuni utilizzabili come guida per l'implementazione di una soluzione:</span><span class="sxs-lookup"><span data-stu-id="97ba1-430">Coordinating multiple tasks and steps can be challenging, but there are three common patterns that you can use to guide your implementation of a solution:</span></span>

* <span data-ttu-id="97ba1-431">**Scomposizione di un'attività in più passaggi riutilizzabili**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-431">**Decomposing a task into multiple reusable steps**.</span></span> <span data-ttu-id="97ba1-432">Un'applicazione potrebbe dover eseguire una serie di attività di varia complessità sulle informazioni che elabora.</span><span class="sxs-lookup"><span data-stu-id="97ba1-432">An application might be required to perform a variety of tasks of varying complexity on the information that it processes.</span></span> <span data-ttu-id="97ba1-433">Un approccio semplice ma rigido per implementare tale applicazione potrebbe essere quello di eseguire l'elaborazione come modulo monolitico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-433">A straightforward but inflexible approach to implementing this application might be to perform this processing as a monolithic module.</span></span> <span data-ttu-id="97ba1-434">Tuttavia, questo approccio probabilmente ridurrà le opportunità di refactoring, ottimizzazione o riutilizzo del codice se parti della stessa elaborazione sono necessarie in un altro punto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-434">However, this approach is likely to reduce the opportunities for refactoring the code, optimizing it, or reusing it if parts of the same processing are required elsewhere within the application.</span></span> <span data-ttu-id="97ba1-435">Per altre informazioni, vedere [Modelli di pipe e filtri](../patterns/pipes-and-filters.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-435">For more information, see [Pipes and Filters Pattern](../patterns/pipes-and-filters.md).</span></span>
* <span data-ttu-id="97ba1-436">**Gestione dell'esecuzione dei passaggi per un'attività**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-436">**Managing execution of the steps for a task**.</span></span> <span data-ttu-id="97ba1-437">Un'applicazione potrebbe eseguire attività che comprendono diversi passaggi, alcuni dei quali potrebbero richiamare servizi remoti o accedere a risorse remote.</span><span class="sxs-lookup"><span data-stu-id="97ba1-437">An application might perform tasks that comprise a number of steps (some of which might invoke remote services or access remote resources).</span></span> <span data-ttu-id="97ba1-438">I singoli passaggi potrebbero essere indipendenti tra loro, ma sono coordinati dalla logica dell'applicazione che implementa l'attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-438">The individual steps might be independent of each other, but they are orchestrated by the application logic that implements the task.</span></span> <span data-ttu-id="97ba1-439">Per altre informazioni, vedere [Modello di supervisione agente di pianificazione](../patterns/scheduler-agent-supervisor.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-439">For more information, see [Scheduler Agent Supervisor Pattern](../patterns/scheduler-agent-supervisor.md).</span></span>
* <span data-ttu-id="97ba1-440">**Gestione del ripristino per i passaggi non riusciti di un'attività**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-440">**Managing recovery for task steps that fail**.</span></span> <span data-ttu-id="97ba1-441">Un'applicazione potrebbe dover annullare il lavoro eseguito da una serie di passaggi (che insieme definiscono un'operazione finale coerente) in caso di esito negativo di uno o più di tali passaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-441">An application might need to undo the work that is performed by a series of steps (which together define an eventually consistent operation) if one or more of the steps fail.</span></span> <span data-ttu-id="97ba1-442">Per altre informazioni, vedere [Modello di transazioni di compensazione](../patterns/compensating-transaction.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-442">For more information, see [Compensating Transaction Pattern](../patterns/compensating-transaction.md).</span></span>


## <a name="resiliency-considerations"></a><span data-ttu-id="97ba1-443">Considerazioni sulla resilienza</span><span class="sxs-lookup"><span data-stu-id="97ba1-443">Resiliency considerations</span></span>
<span data-ttu-id="97ba1-444">Le attività in background devono essere resilienti per fornire servizi affidabili all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-444">Background tasks must be resilient in order to provide reliable services to the application.</span></span> <span data-ttu-id="97ba1-445">Durante la pianificazione e progettazione di attività in background, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="97ba1-445">When you are planning and designing background tasks, consider the following points:</span></span>

* <span data-ttu-id="97ba1-446">Le attività in background devono poter gestire correttamente i riavvii del ruolo o servizio senza danneggiare i dati o introdurre incoerenze nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-446">Background tasks must be able to gracefully handle role or service restarts without corrupting data or introducing inconsistency into the application.</span></span> <span data-ttu-id="97ba1-447">Per le attività a esecuzione prolungata o a più passaggi, è consigliabile usare un *checkpoint* salvando lo stato dei processi in un archivio permanente o come messaggi in una coda, se appropriato.</span><span class="sxs-lookup"><span data-stu-id="97ba1-447">For long-running or multistep tasks, consider using *check pointing* by saving the state of jobs in persistent storage, or as messages in a queue if this is appropriate.</span></span> <span data-ttu-id="97ba1-448">Ad esempio, è possibile rendere permanenti le informazioni di stato in un messaggio in una coda e aggiornare in modo incrementale le informazioni sullo stato con l'avanzamento dell'attività, affinché questa possa essere elaborata a partire dall'ultimo checkpoint valido conosciuto anziché ricominciare dall'inizio.</span><span class="sxs-lookup"><span data-stu-id="97ba1-448">For example, you can persist state information in a message in a queue and incrementally update this state information with the task progress so that the task can be processed from the last known good checkpoint--instead of restarting from the beginning.</span></span> <span data-ttu-id="97ba1-449">Quando si usano le code del bus di servizio di Azure, è possibile usare le sessioni dei messaggi per abilitare lo stesso scenario.</span><span class="sxs-lookup"><span data-stu-id="97ba1-449">When using Azure Service Bus queues, you can use message sessions to enable the same scenario.</span></span> <span data-ttu-id="97ba1-450">Le sessioni consentono di salvare e recuperare lo stato di elaborazione dell'applicazione usando i metodi [SetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.setstate?view=azureservicebus-4.0.0) e [GetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.getstate?view=azureservicebus-4.0.0).</span><span class="sxs-lookup"><span data-stu-id="97ba1-450">Sessions allow you to save and retrieve the application processing state by using the [SetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.setstate?view=azureservicebus-4.0.0) and [GetState](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.messagesession.getstate?view=azureservicebus-4.0.0) methods.</span></span> <span data-ttu-id="97ba1-451">Per altre informazioni sulla progettazione di processi e flussi di lavoro a più passaggi affidabili, vedere l'articolo relativo al [Scheduler Agent Supervisor Pattern](../patterns/scheduler-agent-supervisor.md)(Modello di supervisione agente di pianificazione).</span><span class="sxs-lookup"><span data-stu-id="97ba1-451">For more information about designing reliable multistep processes and workflows, see [Scheduler Agent Supervisor Pattern](../patterns/scheduler-agent-supervisor.md).</span></span>
* <span data-ttu-id="97ba1-452">Quando si usano i ruoli di lavoro o Web per ospitare più attività in background, progettare l'override del metodo **Run** in modo da monitorare le attività bloccate o non riuscite e riavviarle.</span><span class="sxs-lookup"><span data-stu-id="97ba1-452">When you use web or worker roles to host multiple background tasks, design your override of the **Run** method to monitor for failed or stalled tasks, and restart them.</span></span> <span data-ttu-id="97ba1-453">Se questo metodo non è pratico e si usa un ruolo di lavoro, forzare il riavvio del ruolo di lavoro uscendo dal metodo **Run** .</span><span class="sxs-lookup"><span data-stu-id="97ba1-453">Where this is not practical, and you are using a worker role, force the worker role to restart by exiting from the **Run** method.</span></span>
* <span data-ttu-id="97ba1-454">Se si usano code per comunicare con le attività in background, le code possono fungere da buffer in cui archiviare le richieste inviate alle attività quando l'applicazione ha un carico maggiore del solito.</span><span class="sxs-lookup"><span data-stu-id="97ba1-454">When you use queues to communicate with background tasks, the queues can act as a buffer to store requests that are sent to the tasks while the application is under higher than usual load.</span></span> <span data-ttu-id="97ba1-455">In questo modo le attività possono tornare al passo con l'interfaccia utente durante i periodi di minore attività.</span><span class="sxs-lookup"><span data-stu-id="97ba1-455">This allows the tasks to catch up with the UI during less busy periods.</span></span> <span data-ttu-id="97ba1-456">Il riavvio del ruolo, inoltre, non bloccherà l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-456">It also means that recycling the role will not block the UI.</span></span> <span data-ttu-id="97ba1-457">Per altre informazioni, vedere [Modello di livellamento del carico basato sulle code](../patterns/queue-based-load-leveling.md).</span><span class="sxs-lookup"><span data-stu-id="97ba1-457">For more information, see [Queue-Based Load Leveling Pattern](../patterns/queue-based-load-leveling.md).</span></span> <span data-ttu-id="97ba1-458">Se alcune attività sono più importanti di altre, valutare l'implementazione del [modello di coda di priorità](../patterns/priority-queue.md) per garantire che tali attività vengano eseguite prima di quelle meno importanti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-458">If some tasks are more important than others, consider implementing the [Priority Queue Pattern](../patterns/priority-queue.md) to ensure that these tasks run before less important ones.</span></span>
* <span data-ttu-id="97ba1-459">Le attività in background avviate da messaggi o da messaggi del processo devono essere progettate in modo da gestire le incoerenze, ad esempio i messaggi che arrivano in un ordine errato, i messaggi che causano ripetutamente un errore (detti anche messaggi *non elaborabili*) e i messaggi recapitati più volte.</span><span class="sxs-lookup"><span data-stu-id="97ba1-459">Background tasks that are initiated by messages or process messages must be designed to handle inconsistencies, such as messages arriving out of order, messages that repeatedly cause an error (often referred to as *poison messages*), and messages that are delivered more than once.</span></span> <span data-ttu-id="97ba1-460">Valutare gli aspetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="97ba1-460">Consider the following:</span></span>
  * <span data-ttu-id="97ba1-461">I messaggi che devono essere elaborati in un ordine specifico, ad esempio quelli che modificano i dati in base al valore esistente (come l'aggiunta di un valore a un valore esistente), potrebbero non arrivare nell'ordine in cui sono stati originariamente inviati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-461">Messages that must be processed in a specific order, such as those that change data based on the existing data value (for example, adding a value to an existing value), might not arrive in the original order in which they were sent.</span></span> <span data-ttu-id="97ba1-462">Oppure potrebbero essere gestiti da istanze diverse di un'attività in background in un ordine differente a causa di carichi variabili in ogni istanza.</span><span class="sxs-lookup"><span data-stu-id="97ba1-462">Alternatively, they might be handled by different instances of a background task in a different order due to varying loads on each instance.</span></span> <span data-ttu-id="97ba1-463">I messaggi che devono essere elaborati in un ordine specifico devono includere un numero di sequenza, una chiave o un altro indicatore utilizzabile dalle attività in background per garantire l'elaborazione nell'ordine corretto.</span><span class="sxs-lookup"><span data-stu-id="97ba1-463">Messages that must be processed in a specific order should include a sequence number, key, or some other indicator that background tasks can use to ensure that they are processed in the correct order.</span></span> <span data-ttu-id="97ba1-464">Se si usa il bus di servizio di Azure, è possibile usare le sessioni di messaggistica per garantire l'ordine di recapito.</span><span class="sxs-lookup"><span data-stu-id="97ba1-464">If you are using Azure Service Bus, you can use message sessions to guarantee the order of delivery.</span></span> <span data-ttu-id="97ba1-465">In genere, tuttavia, la soluzione più efficace è progettare il processo in modo che l'ordine dei messaggi non sia importante.</span><span class="sxs-lookup"><span data-stu-id="97ba1-465">However, it is usually more efficient, where possible, to design the process so that the message order is not important.</span></span>
  * <span data-ttu-id="97ba1-466">Un'attività in background normalmente visualizza i messaggi della coda, nascondendoli temporaneamente agli altri consumer di messaggi.</span><span class="sxs-lookup"><span data-stu-id="97ba1-466">Typically, a background task will peek at messages in the queue, which temporarily hides them from other message consumers.</span></span> <span data-ttu-id="97ba1-467">Quindi elimina i messaggi dopo che sono stati elaborati e l'elaborazione è riuscita.</span><span class="sxs-lookup"><span data-stu-id="97ba1-467">Then it deletes the messages after they have been successfully processed.</span></span> <span data-ttu-id="97ba1-468">Se un'attività in background non riesce a portare a termine l'elaborazione di un messaggio, il messaggio ricompare nella coda dopo la scadenza del periodo di tempo di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-468">If a background task fails when processing a message, that message will reappear on the queue after the peek time-out expires.</span></span> <span data-ttu-id="97ba1-469">Sarà elaborato da un'altra istanza dell'attività o durante il successivo ciclo di elaborazione di questa istanza.</span><span class="sxs-lookup"><span data-stu-id="97ba1-469">It will be processed by another instance of the task or during the next processing cycle of this instance.</span></span> <span data-ttu-id="97ba1-470">Se il messaggio provoca regolarmente un errore nel consumer, blocca l'attività, la coda e infine l'applicazione stessa quando la coda diventa piena.</span><span class="sxs-lookup"><span data-stu-id="97ba1-470">If the message consistently causes an error in the consumer, it will block the task, the queue, and eventually the application itself when the queue becomes full.</span></span> <span data-ttu-id="97ba1-471">È essenziale quindi rilevare e rimuovere i messaggi non elaborabili dalla coda.</span><span class="sxs-lookup"><span data-stu-id="97ba1-471">Therefore, it is vital to detect and remove poison messages from the queue.</span></span> <span data-ttu-id="97ba1-472">Se si usa il bus di servizio di Azure, i messaggi che causano un errore possono essere spostati automaticamente o manualmente in una coda dei messaggi non recapitabili associata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-472">If you are using Azure Service Bus, messages that cause an error can be moved automatically or manually to an associated dead letter queue.</span></span>
  * <span data-ttu-id="97ba1-473">Per le code è garantito un meccanismo che prevede il recapito *almeno una volta* , ma possono recapitare lo stesso messaggio più volte.</span><span class="sxs-lookup"><span data-stu-id="97ba1-473">Queues are guaranteed at *least once* delivery mechanisms, but they might deliver the same message more than once.</span></span> <span data-ttu-id="97ba1-474">Inoltre, se un'attività in background ha esito negativo dopo l'elaborazione di un messaggio ma prima che questo venga eliminato dalla coda, il messaggio diventerà di nuovo disponibile per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-474">In addition, if a background task fails after processing a message but before deleting it from the queue, the message will become available for processing again.</span></span> <span data-ttu-id="97ba1-475">Le attività in background dovranno essere idempotenti, ossia l'elaborazione multipla dello stesso messaggio non deve causare un errore o un'incoerenza nei dati dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97ba1-475">Background tasks should be idempotent, which means that processing the same message more than once does not cause an error or inconsistency in the application’s data.</span></span> <span data-ttu-id="97ba1-476">Alcune operazioni sono naturalmente idempotenti, ad esempio l'impostazione di un valore archiviato su un nuovo valore specifico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-476">Some operations are naturally idempotent, such as setting a stored value to a specific new value.</span></span> <span data-ttu-id="97ba1-477">Tuttavia operazioni quali l'aggiunta di un valore a un valore archiviato esistente, senza verificare che il valore archiviato non sia cambiato da quando è stato originariamente inviato il messaggio, causeranno incoerenze.</span><span class="sxs-lookup"><span data-stu-id="97ba1-477">However, operations such as adding a value to an existing stored value without checking that the stored value is still the same as when the message was originally sent will cause inconsistencies.</span></span> <span data-ttu-id="97ba1-478">Le code del bus di servizio di Azure possono essere configurate per rimuovere automaticamente i messaggi duplicati.</span><span class="sxs-lookup"><span data-stu-id="97ba1-478">Azure Service Bus queues can be configured to automatically remove duplicated messages.</span></span>
  * <span data-ttu-id="97ba1-479">Alcuni sistemi di messaggistica, quali le code di archiviazione di Azure e le code del bus di servizio di Azure, supportano una proprietà di conteggio di rimozioni dalla coda che indica il numero di volte in cui un messaggio è stato letto dalla coda.</span><span class="sxs-lookup"><span data-stu-id="97ba1-479">Some messaging systems, such as Azure storage queues and Azure Service Bus queues, support a de-queue count property that indicates the number of times a message has been read from the queue.</span></span> <span data-ttu-id="97ba1-480">Tale indicazione può essere utile per la gestione dei messaggi non elaborabili e ripetuti.</span><span class="sxs-lookup"><span data-stu-id="97ba1-480">This can be useful in handling repeated and poison messages.</span></span> <span data-ttu-id="97ba1-481">Per altre informazioni, vedere [Introduzione alla messaggistica asincrona](https://msdn.microsoft.com/library/dn589781.aspx) e [Modelli di idempotenza](https://blog.jonathanoliver.com/idempotency-patterns/).</span><span class="sxs-lookup"><span data-stu-id="97ba1-481">For more information, see [Asynchronous Messaging Primer](https://msdn.microsoft.com/library/dn589781.aspx) and [Idempotency Patterns](https://blog.jonathanoliver.com/idempotency-patterns/).</span></span>

## <a name="scaling-and-performance-considerations"></a><span data-ttu-id="97ba1-482">Considerazioni su ridimensionamento e prestazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-482">Scaling and performance considerations</span></span>
<span data-ttu-id="97ba1-483">Le attività in background devono offrire prestazioni sufficienti a garantire che l'applicazione non si blocchi o causi incoerenze dovute all'operazione ritardata quando il sistema è sotto carico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-483">Background tasks must offer sufficient performance to ensure they do not block the application, or cause inconsistencies due to delayed operation when the system is under load.</span></span> <span data-ttu-id="97ba1-484">In genere, le prestazioni risultano migliorate ridimensionando le istanze di calcolo che ospitano le attività in background.</span><span class="sxs-lookup"><span data-stu-id="97ba1-484">Typically, performance is improved by scaling the compute instances that host the background tasks.</span></span> <span data-ttu-id="97ba1-485">Durante la pianificazione e la progettazione di attività in background, tenere presenti i seguenti aspetti relativi al dimensionamento e alle prestazioni:</span><span class="sxs-lookup"><span data-stu-id="97ba1-485">When you are planning and designing background tasks, consider the following points around scalability and performance:</span></span>

* <span data-ttu-id="97ba1-486">Azure supporta il dimensionamento automatico (aumento e riduzione) in base alla domanda e al carico corrente o in base a una pianificazione predefinita per App Web, ruoli Web e di lavoro di Servizi cloud, nonché distribuzioni ospitate su Macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="97ba1-486">Azure supports autoscaling (both scaling out and scaling back in) based on current demand and load--or on a predefined schedule, for Web Apps, Cloud Services web and worker roles, and Virtual Machines hosted deployments.</span></span> <span data-ttu-id="97ba1-487">Usare questa funzionalità per garantire che l'applicazione nel suo complesso offra prestazioni sufficienti, riducendo al minimo i costi di runtime.</span><span class="sxs-lookup"><span data-stu-id="97ba1-487">Use this feature to ensure that the application as a whole has sufficient performance capabilities while minimizing runtime costs.</span></span>
* <span data-ttu-id="97ba1-488">Se le attività in background hanno una capacità di prestazioni diversa dalle altre parti di un'applicazione di Servizi Cloud (ad esempio l'interfaccia utente o componenti come il livello di accesso ai dati), l'hosting delle attività in background insieme in un ruolo di lavoro separato consente all'interfaccia utente e all'attività in background di ridimensionarsi in modo indipendente per gestire il carico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-488">Where background tasks have a different performance capability from the other parts of a Cloud Services application (for example, the UI or components such as the data access layer), hosting the background tasks together in a separate worker role allows the UI and background task roles to scale independently to manage the load.</span></span> <span data-ttu-id="97ba1-489">Se più attività in background hanno prestazioni notevolmente diverse, è consigliabile dividerle in ruoli di lavoro separati e dimensionare ogni tipo di ruolo in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="97ba1-489">If multiple background tasks have significantly different performance capabilities from each other, consider dividing them into separate worker roles and scaling each role type independently.</span></span> <span data-ttu-id="97ba1-490">Si noti tuttavia che ciò potrebbe accrescere i costi di runtime rispetto alla combinazione di tutte le attività in un minor numero di ruoli.</span><span class="sxs-lookup"><span data-stu-id="97ba1-490">However, note that this might increase runtime costs compared to combining all the tasks into fewer roles.</span></span>
* <span data-ttu-id="97ba1-491">Dimensionare semplicemente i ruoli potrebbe non essere sufficiente a evitare la perdita di prestazioni in condizioni di carico.</span><span class="sxs-lookup"><span data-stu-id="97ba1-491">Simply scaling the roles might not be sufficient to prevent loss of performance under load.</span></span> <span data-ttu-id="97ba1-492">Potrebbe essere anche necessario dimensionare le code di archiviazione e altre risorse per evitare che un singolo punto dell'intera catena di elaborazione diventi un collo di bottiglia.</span><span class="sxs-lookup"><span data-stu-id="97ba1-492">You might also need to scale storage queues and other resources to prevent a single point of the overall processing chain from becoming a bottleneck.</span></span> <span data-ttu-id="97ba1-493">È opportuno considerare anche altre limitazioni, ad esempio la velocità massima di archiviazione e altri servizi su cui l'applicazione e le attività in background fanno affidamento.</span><span class="sxs-lookup"><span data-stu-id="97ba1-493">Also, consider other limitations, such as the maximum throughput of storage and other services that the application and the background tasks rely on.</span></span>
* <span data-ttu-id="97ba1-494">Le attività in background devono essere progettate per la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="97ba1-494">Background tasks must be designed for scaling.</span></span> <span data-ttu-id="97ba1-495">Ad esempio, devono essere in grado di rilevare in modo dinamico il numero di code di archiviazione in uso per attendere o inviare messaggi alla coda appropriata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-495">For example, they must be able to dynamically detect the number of storage queues in use in order to listen on or send messages to the appropriate queue.</span></span>
* <span data-ttu-id="97ba1-496">Per impostazione predefinita, i processi Web vengono ridimensionati con la relativa istanza di App Web di Azure associata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-496">By default, WebJobs scale with their associated Azure Web Apps instance.</span></span> <span data-ttu-id="97ba1-497">Tuttavia, quando un processo Web deve essere eseguito solo come singola istanza, è possibile creare un file Settings.job contenente i dati JSON **{"is_singleton": true}**.</span><span class="sxs-lookup"><span data-stu-id="97ba1-497">However, if you want a WebJob to run as only a single instance, you can create a Settings.job file that contains the JSON data **{ "is_singleton": true }**.</span></span> <span data-ttu-id="97ba1-498">In questo modo si costringe Azure a eseguire solo un'istanza del processo Web, anche se ci sono più istanze dell'app Web associata.</span><span class="sxs-lookup"><span data-stu-id="97ba1-498">This forces Azure to only run one instance of the WebJob, even if there are multiple instances of the associated web app.</span></span> <span data-ttu-id="97ba1-499">Questa tecnica può essere utile per i processi pianificati che devono essere eseguiti solo come singola istanza.</span><span class="sxs-lookup"><span data-stu-id="97ba1-499">This can be a useful technique for scheduled jobs that must run as only a single instance.</span></span>

## <a name="related-patterns"></a><span data-ttu-id="97ba1-500">Modelli correlati</span><span class="sxs-lookup"><span data-stu-id="97ba1-500">Related patterns</span></span>
* [<span data-ttu-id="97ba1-501">Introduzione alla messaggistica asincrona</span><span class="sxs-lookup"><span data-stu-id="97ba1-501">Asynchronous Messaging Primer</span></span>](https://msdn.microsoft.com/library/dn589781.aspx)
* [<span data-ttu-id="97ba1-502">Indicazioni sulla scalabilità automatica</span><span class="sxs-lookup"><span data-stu-id="97ba1-502">Autoscaling Guidance</span></span>](https://msdn.microsoft.com/library/dn589774.aspx)
* [<span data-ttu-id="97ba1-503">Modello di transazioni di compensazione</span><span class="sxs-lookup"><span data-stu-id="97ba1-503">Compensating Transaction Pattern</span></span>](../patterns/compensating-transaction.md)
* [<span data-ttu-id="97ba1-504">Modello di consumer concorrenti</span><span class="sxs-lookup"><span data-stu-id="97ba1-504">Competing Consumers Pattern</span></span>](../patterns/competing-consumers.md)
* [<span data-ttu-id="97ba1-505">Indicazioni sul partizionamento del calcolo</span><span class="sxs-lookup"><span data-stu-id="97ba1-505">Compute Partitioning Guidance</span></span>](https://msdn.microsoft.com/library/dn589773.aspx)
* [<span data-ttu-id="97ba1-506">Modello di consolidamento delle risorse di calcolo</span><span class="sxs-lookup"><span data-stu-id="97ba1-506">Compute Resource Consolidation Pattern</span></span>](https://msdn.microsoft.com/library/dn589778.aspx)
* [<span data-ttu-id="97ba1-507">Modello gatekeeper</span><span class="sxs-lookup"><span data-stu-id="97ba1-507">Gatekeeper Pattern</span></span>](../patterns/gatekeeper.md)
* [<span data-ttu-id="97ba1-508">Modello di designazione leader</span><span class="sxs-lookup"><span data-stu-id="97ba1-508">Leader Election Pattern</span></span>](../patterns/leader-election.md)
* [<span data-ttu-id="97ba1-509">Modelli di pipe e filtri</span><span class="sxs-lookup"><span data-stu-id="97ba1-509">Pipes and Filters Pattern</span></span>](../patterns/pipes-and-filters.md)
* [<span data-ttu-id="97ba1-510">Modello di coda di priorità</span><span class="sxs-lookup"><span data-stu-id="97ba1-510">Priority Queue Pattern</span></span>](../patterns/priority-queue.md)
* [<span data-ttu-id="97ba1-511">Modello di livellamento del carico basato sulle code</span><span class="sxs-lookup"><span data-stu-id="97ba1-511">Queue-based Load Leveling Pattern</span></span>](../patterns/queue-based-load-leveling.md)
* [<span data-ttu-id="97ba1-512">Modello di supervisione agente di pianificazione</span><span class="sxs-lookup"><span data-stu-id="97ba1-512">Scheduler Agent Supervisor Pattern</span></span>](../patterns/scheduler-agent-supervisor.md)

## <a name="more-information"></a><span data-ttu-id="97ba1-513">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="97ba1-513">More information</span></span>
* [<span data-ttu-id="97ba1-514">Esecuzione di attività in background</span><span class="sxs-lookup"><span data-stu-id="97ba1-514">Executing Background Tasks</span></span>](https://msdn.microsoft.com/library/ff803365.aspx)
* <span data-ttu-id="97ba1-515">[Ciclo di vita del ruolo di Servizi cloud di Azure](https://channel9.msdn.com/Series/Windows-Azure-Cloud-Services-Tutorials/Windows-Azure-Cloud-Services-Role-Lifecycle) (video)</span><span class="sxs-lookup"><span data-stu-id="97ba1-515">[Azure Cloud Services Role Lifecycle](https://channel9.msdn.com/Series/Windows-Azure-Cloud-Services-Tutorials/Windows-Azure-Cloud-Services-Role-Lifecycle) (video)</span></span>
* [<span data-ttu-id="97ba1-516">Che cos'è Azure WebJobs SDK</span><span class="sxs-lookup"><span data-stu-id="97ba1-516">What is the Azure WebJobs SDK</span></span>](https://docs.microsoft.com/azure/app-service-web/websites-dotnet-webjobs-sdk)
* [<span data-ttu-id="97ba1-517">Eseguire attività in background con Processi Web</span><span class="sxs-lookup"><span data-stu-id="97ba1-517">Run Background tasks with WebJobs</span></span>](https://docs.microsoft.com/azure/app-service-web/web-sites-create-web-jobs)
* [<span data-ttu-id="97ba1-518">Analogie e differenze tra le code di Azure e le code del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="97ba1-518">Azure Queues and Service Bus Queues - Compared and Contrasted</span></span>](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted)
* [<span data-ttu-id="97ba1-519">Come abilitare il modulo Diagnostica in un servizio cloud</span><span class="sxs-lookup"><span data-stu-id="97ba1-519">How to Enable Diagnostics in a Cloud Service</span></span>](https://docs.microsoft.com/azure/cloud-services/cloud-services-dotnet-diagnostics)


---
title: Guida all'implementazione API
description: Indicazioni su come implementare un'API.
author: dragon119
ms.date: 07/13/2016
pnp.series.title: Best Practices
ms.openlocfilehash: cc28864de36afdeed2f8a7155a307e312c3a398e
ms.sourcegitcommit: c93f1b210b3deff17cc969fb66133bc6399cfd10
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 01/05/2018
ms.locfileid: "27596020"
---
# <a name="api-implementation"></a><span data-ttu-id="95a30-103">Implementazione di API</span><span class="sxs-lookup"><span data-stu-id="95a30-103">API implementation</span></span>

<span data-ttu-id="95a30-104">UN’API web RESTful progettata attentamente definisce le risorse, relazioni e gli schemi di navigazione che sono accessibili alle applicazioni del client.</span><span class="sxs-lookup"><span data-stu-id="95a30-104">A carefully-designed RESTful web API defines the resources, relationships, and navigation schemes that are accessible to client applications.</span></span> <span data-ttu-id="95a30-105">Quando implementi e distribuisci un’API web, è necessario considerare i requisiti fisici dell'ambiente di hosting web API e il modo in cui viene creata l'API web, anziché la struttura logica dei dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-105">When you implement and deploy a web API, you should consider the physical requirements of the environment hosting the web API and the way in which the web API is constructed rather than the logical structure of the data.</span></span> <span data-ttu-id="95a30-106">Questa guida illustra le procedure consigliate per l'implementazione e la pubblicazione di un'API web al fine di renderla disponibile alle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="95a30-106">This guidance focusses on best practices for implementing a web API and publishing it to make it available to client applications.</span></span> <span data-ttu-id="95a30-107">Per informazioni dettagliate sulla progettazione di un'API Web vedere [Linee guida alla progettazione di un'API](/azure/architecture/best-practices/api-design).</span><span class="sxs-lookup"><span data-stu-id="95a30-107">For detailed information about web API design, see [API Design Guidance](/azure/architecture/best-practices/api-design).</span></span>

## <a name="processing-requests"></a><span data-ttu-id="95a30-108">Elaborazione delle richieste</span><span class="sxs-lookup"><span data-stu-id="95a30-108">Processing requests</span></span>

<span data-ttu-id="95a30-109">Quando si implementa il codice per gestire le richieste, tenere presente quanto segue.</span><span class="sxs-lookup"><span data-stu-id="95a30-109">Consider the following points when you implement the code to handle requests.</span></span>

### <a name="get-put-delete-head-and-patch-actions-should-be-idempotent"></a><span data-ttu-id="95a30-110">Le azioni GET, PUT, DELETE, HEAD e PATCH devono essere idempotenti</span><span class="sxs-lookup"><span data-stu-id="95a30-110">GET, PUT, DELETE, HEAD, and PATCH actions should be idempotent</span></span>

<span data-ttu-id="95a30-111">Il codice che implementa queste richieste non deve causare effetti collaterali.</span><span class="sxs-lookup"><span data-stu-id="95a30-111">The code that implements these requests should not impose any side-effects.</span></span> <span data-ttu-id="95a30-112">La stessa richiesta ripetuta sulla stessa risorsa deve produrre lo stesso stato.</span><span class="sxs-lookup"><span data-stu-id="95a30-112">The same request repeated over the same resource should result in the same state.</span></span> <span data-ttu-id="95a30-113">Ad esempio, l'invio di richieste DELETE multiple allo stesso URI deve avere lo stesso effetto, anche se il codice di stato HTTP nei messaggi di risposta può essere diverso.</span><span class="sxs-lookup"><span data-stu-id="95a30-113">For example, sending multiple DELETE requests to the same URI should have the same effect, although the HTTP status code in the response messages may be different.</span></span> <span data-ttu-id="95a30-114">La prima richiesta DELETE potrebbe restituire il codice di stato 204 (Nessun contenuto), mentre una richiesta DELETE successiva potrebbe restituire il codice di stato 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="95a30-114">The first DELETE request might return status code 204 (No Content), while a subsequent DELETE request might return status code 404 (Not Found).</span></span>

> [!NOTE]
> <span data-ttu-id="95a30-115">L'articolo [Modelli di idempotenza](http://blog.jonathanoliver.com/idempotency-patterns/) sul blog di Oliver Jonathan fornisce una panoramica sull’idempotenza e sul modo in cui è correlata alle operazioni di gestione dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-115">The article [Idempotency Patterns](http://blog.jonathanoliver.com/idempotency-patterns/) on Jonathan Oliver’s blog provides an overview of idempotency and how it relates to data management operations.</span></span>
>

### <a name="post-actions-that-create-new-resources-should-not-have-unrelated-side-effects"></a><span data-ttu-id="95a30-116">Le azioni POST che creano nuove risorse non devono avere effetti collaterali non correlati</span><span class="sxs-lookup"><span data-stu-id="95a30-116">POST actions that create new resources should not have unrelated side-effects</span></span>

<span data-ttu-id="95a30-117">Se si tratta di una richiesta POST per creare una nuova risorsa, gli effetti di tale richiesta devono essere limitati alla nuova risorsa (e possibilmente a tutte le risorse direttamente correlate se presente un collegamento). Ad esempio, in un sistema di e-commerce, una richiesta POST che crea un nuovo ordine per un cliente potrebbe anche modificare i livelli di inventario e generare informazioni di fatturazione, ma non deve modificare le informazioni non direttamente correlate all'ordine o avere eventuali altri effetti collaterali sullo stato complessivo del sistema.</span><span class="sxs-lookup"><span data-stu-id="95a30-117">If a POST request is intended to create a new resource, the effects of the request should be limited to the new resource (and possibly any directly related resources if there is some sort of linkage involved) For example, in an ecommerce system, a POST request that creates a new order for a customer might also amend inventory levels and generate billing information, but it should not modify information not directly related to the order or have any other side-effects on the overall state of the system.</span></span>

### <a name="avoid-implementing-chatty-post-put-and-delete-operations"></a><span data-ttu-id="95a30-118">Evitare l'implementazione delle operazioni POST, PUT e DELETE frammentate</span><span class="sxs-lookup"><span data-stu-id="95a30-118">Avoid implementing chatty POST, PUT, and DELETE operations</span></span>

<span data-ttu-id="95a30-119">Supporto delle richieste POST, PUT e DELETE su raccolte di risorse.</span><span class="sxs-lookup"><span data-stu-id="95a30-119">Support POST, PUT and DELETE requests over resource collections.</span></span> <span data-ttu-id="95a30-120">Una richiesta POST può contenere i dettagli per più risorse nuove e aggiungerle tutte alla stessa raccolta; una richiesta PUT può sostituire l'intero set di risorse in una raccolta e una richiesta DELETE può rimuovere un'intera raccolta.</span><span class="sxs-lookup"><span data-stu-id="95a30-120">A POST request can contain the details for multiple new resources and add them all to the same collection, a PUT request can replace the entire set of resources in a collection, and a DELETE request can remove an entire collection.</span></span>

<span data-ttu-id="95a30-121">Il supporto di OData incluso in API Web ASP.NET 2 offre la possibilità di richieste batch.</span><span class="sxs-lookup"><span data-stu-id="95a30-121">The OData support included in ASP.NET Web API 2 provides the ability to batch requests.</span></span> <span data-ttu-id="95a30-122">Un'applicazione client può impacchettare diverse richieste di API Web, inviarle al server in una singola richiesta HTTP e ricevere una singola risposta HTTP che contiene le risposte a ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-122">A client application can package up several web API requests and send them to the server in a single HTTP request, and receive a single HTTP response that contains the replies to each request.</span></span> <span data-ttu-id="95a30-123">Per altre informazioni consultare [Introducing Batch Support in Web API and Web API OData](http://blogs.msdn.com/b/webdev/archive/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata.aspx) (Introduzione al supporto Batch in API Web e API Web OData).</span><span class="sxs-lookup"><span data-stu-id="95a30-123">For more information, [Introducing Batch Support in Web API and Web API OData](http://blogs.msdn.com/b/webdev/archive/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata.aspx).</span></span>

### <a name="follow-the-http-specification-when-sending-a-response"></a><span data-ttu-id="95a30-124">Seguire la specifica HTTP durante l'invio di una risposta</span><span class="sxs-lookup"><span data-stu-id="95a30-124">Follow the HTTP specification when sending a response</span></span> 

<span data-ttu-id="95a30-125">Un'API Web deve restituire i messaggi che contengono il codice di stato HTTP corretto per consentire al client di stabilire come gestire il risultato, le intestazioni HTTP appropriate in modo che il client sia in grado di comprendere la natura del risultato e un corpo formattato adeguatamente per consentire al client di analizzare il risultato.</span><span class="sxs-lookup"><span data-stu-id="95a30-125">A web API must return messages that contain the correct HTTP status code to enable the client to determine how to handle the result, the appropriate HTTP headers so that the client understands the nature of the result, and a suitably formatted body to enable the client to parse the result.</span></span> 

<span data-ttu-id="95a30-126">Ad esempio, un'operazione POST deve restituire il codice di stato 201 (Creato) e il messaggio di risposta deve includere l'URI della risorsa appena creata nell'intestazione Location del messaggio di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-126">For example, a POST operation should return status code 201 (Created) and the response message should include the URI of the newly created resource in the Location header of the response message.</span></span>

### <a name="support-content-negotiation"></a><span data-ttu-id="95a30-127">Negoziazione dei contenuti di supporto</span><span class="sxs-lookup"><span data-stu-id="95a30-127">Support content negotiation</span></span>

<span data-ttu-id="95a30-128">Il corpo di un messaggio di risposta può contenere dati in diversi formati.</span><span class="sxs-lookup"><span data-stu-id="95a30-128">The body of a response message may contain data in a variety of formats.</span></span> <span data-ttu-id="95a30-129">Ad esempio, una richiesta HTTP GET potrebbe restituire dati in formato JSON o XML.</span><span class="sxs-lookup"><span data-stu-id="95a30-129">For example, an HTTP GET request could return data in JSON, or XML format.</span></span> <span data-ttu-id="95a30-130">Quando il client invia una richiesta, questa può includere un'intestazione Accept che specifica i formati di dati che il client è in grado di gestire.</span><span class="sxs-lookup"><span data-stu-id="95a30-130">When the client submits a request, it can include an Accept header that specifies the data formats that it can handle.</span></span> <span data-ttu-id="95a30-131">Questi formati vengono specificati come tipi di supporto.</span><span class="sxs-lookup"><span data-stu-id="95a30-131">These formats are specified as media types.</span></span> <span data-ttu-id="95a30-132">Un client che invia una richiesta GET che recupera un'immagine può specificare un'intestazione Accept che elenca i tipi di supporto che il client è in grado di gestire, ad esempio "image/jpeg, image/gif, image/png".</span><span class="sxs-lookup"><span data-stu-id="95a30-132">For example, a client that issues a GET request that retrieves an image can specify an Accept header that lists the media types that the client can handle, such as "image/jpeg, image/gif, image/png".</span></span>  <span data-ttu-id="95a30-133">Quando l'API Web restituisce il risultato, è necessario formattare i dati utilizzando uno di questi tipi di supporto e specificare il formato nell'intestazione Content-Type della risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-133">When the web API returns the result, it should format the data by using one of these media types and specify the format in the Content-Type header of the response.</span></span>

<span data-ttu-id="95a30-134">Se il client non specifica un'intestazione Accept, è necessario utilizzare un formato predefinito adeguato per il corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-134">If the client does not specify an Accept header, then use a sensible default format for the response body.</span></span> <span data-ttu-id="95a30-135">Ad esempio, il framework API Web ASP.NET impostato su JSON per i dati basati su testo.</span><span class="sxs-lookup"><span data-stu-id="95a30-135">As an example, the ASP.NET Web API framework defaults to JSON for text-based data.</span></span>

### <a name="provide-links-to-support-hateoas-style-navigation-and-discovery-of-resources"></a><span data-ttu-id="95a30-136">Specificare i collegamenti per supportare la navigazione di tipo HATEOAS e l'individuazione di risorse</span><span class="sxs-lookup"><span data-stu-id="95a30-136">Provide links to support HATEOAS-style navigation and discovery of resources</span></span>

<span data-ttu-id="95a30-137">L'approccio HATEOAS consente a un client di esplorare e individuare le risorse da un punto di partenza iniziale.</span><span class="sxs-lookup"><span data-stu-id="95a30-137">The HATEOAS approach enables a client to navigate and discover resources from an initial starting point.</span></span> <span data-ttu-id="95a30-138">Questo avviene utilizzando i collegamenti che contengono URI. Quando un client invia una richiesta HTTP GET per ottenere una risorsa, la risposta deve contenere gli URI che consentono a un'applicazione client di individuare rapidamente tutte le risorse direttamente correlate.</span><span class="sxs-lookup"><span data-stu-id="95a30-138">This is achieved by using links containing URIs; when a client issues an HTTP GET request to obtain a resource, the response should contain URIs that enable a client application to quickly locate any directly related resources.</span></span> <span data-ttu-id="95a30-139">In un'API Web che supporta una soluzione e-commerce, ad esempio, un cliente può avere molti ordini posizionati.</span><span class="sxs-lookup"><span data-stu-id="95a30-139">For example, in a web API that supports an e-commerce solution, a customer may have placed many orders.</span></span> <span data-ttu-id="95a30-140">Quando un'applicazione client recupera i dettagli per un cliente, la risposta deve includere i collegamenti che consentono all'applicazione client di inviare richieste HTTP GET che possono recuperare questi ordini.</span><span class="sxs-lookup"><span data-stu-id="95a30-140">When a client application retrieves the details for a customer, the response should include links that enable the client application to send HTTP GET requests that can retrieve these orders.</span></span> <span data-ttu-id="95a30-141">Inoltre, i collegamenti di tipo HATEOAS devono descrivere le altre operazioni (POST, PUT, DELETE e così via) che ciascuna risorsa collegata supporta, insieme all'URI corrispondente, per eseguire ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-141">Additionally, HATEOAS-style links should describe the other operations (POST, PUT, DELETE, and so on) that each linked resource supports together with the corresponding URI to perform each request.</span></span> <span data-ttu-id="95a30-142">Questo approccio è descritto più dettagliatamente in [API Design][api-design] (Progettazione API).</span><span class="sxs-lookup"><span data-stu-id="95a30-142">This approach is described in more detail in [API Design][api-design].</span></span>

<span data-ttu-id="95a30-143">Attualmente non esistono standard che regolano l'implementazione di HATEOAS, ma nell'esempio seguente viene illustrato uno degli approcci possibili.</span><span class="sxs-lookup"><span data-stu-id="95a30-143">Currently there are no standards that govern the implementation of HATEOAS, but the following example illustrates one possible approach.</span></span> <span data-ttu-id="95a30-144">In questo esempio, una richiesta HTTP GET che consente di trovare i dettagli di un cliente, restituisce una risposta che include i collegamenti HATEOAS che fanno riferimento agli ordini di quel cliente:</span><span class="sxs-lookup"><span data-stu-id="95a30-144">In this example, an HTTP GET request that finds the details for a customer returns a response that include HATEOAS links that reference the orders for that customer:</span></span>

```HTTP
GET http://adventure-works.com/customers/2 HTTP/1.1
Accept: text/json
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"CustomerID":2,"CustomerName":"Bert","Links":[
    {"rel":"self",
    "href":"http://adventure-works.com/customers/2",
    "action":"GET",
    "types":["text/xml","application/json"]},
    {"rel":"self",
    "href":"http://adventure-works.com/customers/2",
    "action":"PUT",
    "types":["application/x-www-form-urlencoded"]},
    {"rel":"self",
    "href":"http://adventure-works.com/customers/2",
    "action":"DELETE",
    "types":[]},
    {"rel":"orders",
    "href":"http://adventure-works.com/customers/2/orders",
    "action":"GET",
    "types":["text/xml","application/json"]},
    {"rel":"orders",
    "href":"http://adventure-works.com/customers/2/orders",
    "action":"POST",
    "types":["application/x-www-form-urlencoded"]}
]}
```

<span data-ttu-id="95a30-145">In questo esempio, i dati del cliente sono rappresentati dalla `Customer` classe illustrata nel frammento di codice riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="95a30-145">In this example, the customer data is represented by the `Customer` class shown in the following code snippet.</span></span> <span data-ttu-id="95a30-146">I collegamenti HATEOAS vengono archiviati nella `Links` proprietà di raccolta:</span><span class="sxs-lookup"><span data-stu-id="95a30-146">The HATEOAS links are held in the `Links` collection property:</span></span>

```csharp
public class Customer
{
    public int CustomerID { get; set; }
    public string CustomerName { get; set; }
    public List<Link> Links { get; set; }
    ...
}

public class Link
{
    public string Rel { get; set; }
    public string Href { get; set; }
    public string Action { get; set; }
    public string [] Types { get; set; }
}
```

<span data-ttu-id="95a30-147">L'operazione HTTP GET recupera i dati del cliente dalla memoria, costruisce un `Customer` oggetto e quindi li inserisce nella `Links` raccolta.</span><span class="sxs-lookup"><span data-stu-id="95a30-147">The HTTP GET operation retrieves the customer data from storage and constructs a `Customer` object, and then populates the `Links` collection.</span></span> <span data-ttu-id="95a30-148">Il risultato viene formattato come un messaggio di risposta JSON.</span><span class="sxs-lookup"><span data-stu-id="95a30-148">The result is formatted as a JSON response message.</span></span> <span data-ttu-id="95a30-149">Ogni collegamento comprende i seguenti campi:</span><span class="sxs-lookup"><span data-stu-id="95a30-149">Each link comprises the following fields:</span></span>

* <span data-ttu-id="95a30-150">La relazione tra l'oggetto restituito e l'oggetto descritto dal collegamento.</span><span class="sxs-lookup"><span data-stu-id="95a30-150">The relationship between the object being returned and the object described by the link.</span></span> <span data-ttu-id="95a30-151">In questo caso "self" indica che il collegamento è un riferimento all'oggetto stesso (simile a un `this` puntatore in molti linguaggi orientati agli oggetti), e "orders" è il nome di una raccolta contenente le informazioni sugli ordini correlati.</span><span class="sxs-lookup"><span data-stu-id="95a30-151">In this case "self" indicates that the link is a reference back to the object itself (similar to a `this` pointer in many object-oriented languages), and "orders" is the name of a collection containing the related order information.</span></span>
* <span data-ttu-id="95a30-152">Il collegamento ipertestuale (`Href`) per l'oggetto viene descritto dal collegamento sotto forma di un URI.</span><span class="sxs-lookup"><span data-stu-id="95a30-152">The hyperlink (`Href`) for the object being described by the link in the form of a URI.</span></span>
* <span data-ttu-id="95a30-153">Il tipo di richiesta HTTP (`Action`) che può essere inviata a questo URI.</span><span class="sxs-lookup"><span data-stu-id="95a30-153">The type of HTTP request (`Action`) that can be sent to this URI.</span></span>
* <span data-ttu-id="95a30-154">Il formato dei dati (`Types`) che deve essere fornito nella richiesta HTTP o che può essere restituito nella risposta, a seconda del tipo di richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-154">The format of any data (`Types`) that should be provided in the HTTP request or that can be returned in the response, depending on the type of the request.</span></span>

<span data-ttu-id="95a30-155">I collegamenti HATEOAS illustrati nell'esempio di risposta HTTP indicano che un'applicazione client è in grado di eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="95a30-155">The HATEOAS links shown in the example HTTP response indicate that a client application can perform the following operations:</span></span>

* <span data-ttu-id="95a30-156">Richiesta HTTP GET all'URI `http://adventure-works.com/customers/2` per recuperare nuovamente i dettagli del cliente.</span><span class="sxs-lookup"><span data-stu-id="95a30-156">An HTTP GET request to the URI `http://adventure-works.com/customers/2` to fetch the details of the customer (again).</span></span> <span data-ttu-id="95a30-157">I dati possono essere restituiti come XML o JSON.</span><span class="sxs-lookup"><span data-stu-id="95a30-157">The data can be returned as XML or JSON.</span></span>
* <span data-ttu-id="95a30-158">Richiesta HTTP PUT all'URI `http://adventure-works.com/customers/2` per modificare i dettagli del cliente.</span><span class="sxs-lookup"><span data-stu-id="95a30-158">An HTTP PUT request to the URI `http://adventure-works.com/customers/2` to modify the details of the customer.</span></span> <span data-ttu-id="95a30-159">I nuovi dati devono essere forniti nel messaggio di richiesta nel formato x-www-form-urlencoded.</span><span class="sxs-lookup"><span data-stu-id="95a30-159">The new data must be provided in the request message in x-www-form-urlencoded format.</span></span>
* <span data-ttu-id="95a30-160">Richiesta HTTP DELETE all'URI `http://adventure-works.com/customers/2` per eliminare il cliente.</span><span class="sxs-lookup"><span data-stu-id="95a30-160">An HTTP DELETE request to the URI `http://adventure-works.com/customers/2` to delete the customer.</span></span> <span data-ttu-id="95a30-161">La richiesta non prevede informazioni aggiuntive o la restituzione dei dati nel corpo del messaggio di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-161">The request does not expect any additional information or return data in the response message body.</span></span>
* <span data-ttu-id="95a30-162">Richiesta HTTP GET all'URI `http://adventure-works.com/customers/2/orders` per individuare tutti gli ordini del cliente.</span><span class="sxs-lookup"><span data-stu-id="95a30-162">An HTTP GET request to the URI `http://adventure-works.com/customers/2/orders` to find all the orders for the customer.</span></span> <span data-ttu-id="95a30-163">I dati possono essere restituiti come XML o JSON.</span><span class="sxs-lookup"><span data-stu-id="95a30-163">The data can be returned as XML or JSON.</span></span>
* <span data-ttu-id="95a30-164">Richiesta HTTP PUT all'URI `http://adventure-works.com/customers/2/orders` per creare un nuovo ordine per il cliente.</span><span class="sxs-lookup"><span data-stu-id="95a30-164">An HTTP PUT request to the URI `http://adventure-works.com/customers/2/orders` to create a new order for this customer.</span></span> <span data-ttu-id="95a30-165">I dati devono essere forniti nel messaggio di richiesta nel formato x-www-form-urlencoded.</span><span class="sxs-lookup"><span data-stu-id="95a30-165">The data must be provided in the request message in x-www-form-urlencoded format.</span></span>

## <a name="handling-exceptions"></a><span data-ttu-id="95a30-166">Gestione delle eccezioni</span><span class="sxs-lookup"><span data-stu-id="95a30-166">Handling exceptions</span></span>

<span data-ttu-id="95a30-167">Se un'operazione genera un'eccezione non rilevata, tenere presente quanto segue.</span><span class="sxs-lookup"><span data-stu-id="95a30-167">Consider the following points if an operation throws an uncaught exception.</span></span>

### <a name="capture-exceptions-and-return-a-meaningful-response-to-clients"></a><span data-ttu-id="95a30-168">Acquisire le eccezioni e restituire una risposta significativa ai client</span><span class="sxs-lookup"><span data-stu-id="95a30-168">Capture exceptions and return a meaningful response to clients</span></span>

<span data-ttu-id="95a30-169">Il codice che implementa un'operazione HTTP deve indicare l'eccezione completa gestendo le eccezioni non rilevate anziché consentirne la propagazione al framework.</span><span class="sxs-lookup"><span data-stu-id="95a30-169">The code that implements an HTTP operation should provide comprehensive exception handling rather than letting uncaught exceptions propagate to the framework.</span></span> <span data-ttu-id="95a30-170">Se un'eccezione non consente di completare correttamente l'operazione, l'eccezione può essere passata nuovamente al messaggio di risposta, che deve includere una descrizione significativa dell'errore che ha causato l’eccezione.</span><span class="sxs-lookup"><span data-stu-id="95a30-170">If an exception makes it impossible to complete the operation successfully, the exception can be passed back in the response message, but it should include a meaningful description of the error that caused the exception.</span></span> <span data-ttu-id="95a30-171">L'eccezione deve includere anche il codice di stato HTTP appropriato anziché restituire semplicemente il codice di stato 500 per ogni situazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-171">The exception should also include the appropriate HTTP status code rather than simply returning status code 500 for every situation.</span></span> <span data-ttu-id="95a30-172">Ad esempio, se la richiesta di un utente provoca un aggiornamento del database che viola un vincolo (ad esempio, il tentativo di eliminare un cliente che ha degli ordini in sospeso), è necessario restituire lo stato del codice 409 (conflitto) e un corpo del messaggio che indica il motivo del conflitto.</span><span class="sxs-lookup"><span data-stu-id="95a30-172">For example, if a user request causes a database update that violates a constraint (such as attempting to delete a customer that has outstanding orders), you should return status code 409 (Conflict) and a message body indicating the reason for the conflict.</span></span> <span data-ttu-id="95a30-173">Se un'altra condizione rende la richiesta irrealizzabile, è possibile restituire il codice di stato 400 (richiesta non valida).</span><span class="sxs-lookup"><span data-stu-id="95a30-173">If some other condition renders the request unachievable, you can return status code 400 (Bad Request).</span></span> <span data-ttu-id="95a30-174">È possibile trovare un elenco completo dei codici di stato HTTP nella pagina [Definizioni dei codici di stato](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) sul sito Web W3C.</span><span class="sxs-lookup"><span data-stu-id="95a30-174">You can find a full list of HTTP status codes on the [Status Code Definitions](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) page on the W3C website.</span></span>

<span data-ttu-id="95a30-175">Il codice di esempio intercetta diverse condizioni e restituisce una risposta appropriata.</span><span class="sxs-lookup"><span data-stu-id="95a30-175">The code example traps different conditions and returns an appropriate response.</span></span>

```csharp
[HttpDelete]
[Route("customers/{id:int}")]
public IHttpActionResult DeleteCustomer(int id)
{
    try
    {
        // Find the customer to be deleted in the repository
        var customerToDelete = repository.GetCustomer(id);

        // If there is no such customer, return an error response
        // with status code 404 (Not Found)
        if (customerToDelete == null)
        {
                return NotFound();
        }

        // Remove the customer from the repository
        // The DeleteCustomer method returns true if the customer
        // was successfully deleted
        if (repository.DeleteCustomer(id))
        {
            // Return a response message with status code 204 (No Content)
            // To indicate that the operation was successful
            return StatusCode(HttpStatusCode.NoContent);
        }
        else
        {
            // Otherwise return a 400 (Bad Request) error response
            return BadRequest(Strings.CustomerNotDeleted);
        }
    }
    catch
    {
        // If an uncaught exception occurs, return an error response
        // with status code 500 (Internal Server Error)
        return InternalServerError();
    }
}
```

> [!TIP]
> <span data-ttu-id="95a30-176">Non includere informazioni che potrebbero essere utili a un utente malintenzionato che tenta di accedere all'API.</span><span class="sxs-lookup"><span data-stu-id="95a30-176">Do not include information that could be useful to an attacker attempting to penetrate your API.</span></span>
  
<span data-ttu-id="95a30-177">Molti server Web bloccano le condizioni di errore prima che raggiungano l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-177">Many web servers trap error conditions themselves before they reach the web API.</span></span> <span data-ttu-id="95a30-178">Ad esempio, se si configura l'autenticazione a un sito Web e l'utente non riesce a fornire le informazioni di autenticazione corrette, il server web deve rispondere con il codice di stato 401 (non autorizzato).</span><span class="sxs-lookup"><span data-stu-id="95a30-178">For example, if you configure authentication for a web site and the user fails to provide the correct authentication information, the web server should respond with status code 401 (Unauthorized).</span></span> <span data-ttu-id="95a30-179">Una volta che un client è stato autenticato, il codice può eseguire i propri controlli per verificare che il client sia in grado di accedere alla risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-179">Once a client has been authenticated, your code can perform its own checks to verify that the client should be able access the requested resource.</span></span> <span data-ttu-id="95a30-180">Se questa autorizzazione ha esito negativo, è necessario restituire il codice di stato 403 (accesso negato).</span><span class="sxs-lookup"><span data-stu-id="95a30-180">If this authorization fails, you should return status code 403 (Forbidden).</span></span>
 
### <a name="handle-exceptions-consistently-and-log-information-about-errors"></a><span data-ttu-id="95a30-181">Gestire le eccezioni in modo coerente e registrare le informazioni sugli errori</span><span class="sxs-lookup"><span data-stu-id="95a30-181">Handle exceptions consistently and log information about errors</span></span>

<span data-ttu-id="95a30-182">Per gestire le eccezioni in modo coerente, è necessario considerare l’implementazione di una strategia globale di gestione degli errori su tutta la API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-182">To handle exceptions in a consistent manner, consider implementing a global error handling strategy across the entire web API.</span></span> <span data-ttu-id="95a30-183">È inoltre necessario incorporare la registrazione di errori che permette di rilevare informazioni dettagliate su ogni eccezione. La registrazione degli errori può contenere informazioni dettagliate, purché non sia accessibile sul web ai client.</span><span class="sxs-lookup"><span data-stu-id="95a30-183">You should also incorporate error logging which captures the full details of each exception; this error log can contain detailed information as long as it is not made accessible over the web to clients.</span></span> 

### <a name="distinguish-between-client-side-errors-and-server-side-errors"></a><span data-ttu-id="95a30-184">Distinzione tra errori sul lato client ed errori sul lato server</span><span class="sxs-lookup"><span data-stu-id="95a30-184">Distinguish between client-side errors and server-side errors</span></span>

<span data-ttu-id="95a30-185">Il protocollo HTTP consente di distinguere tra errori che si verificano a causa dell'applicazione client (codici di stato HTTP 4xx) ed errori che sono causati da problemi sul server (codici di stato HTTP 5xx).</span><span class="sxs-lookup"><span data-stu-id="95a30-185">The HTTP protocol distinguishes between errors that occur due to the client application (the HTTP 4xx status codes), and errors that are caused by a mishap on the server (the HTTP 5xx status codes).</span></span> <span data-ttu-id="95a30-186">È necessario assicurarsi di rispettare questa convenzione in tutti i messaggi di risposta di errore.</span><span class="sxs-lookup"><span data-stu-id="95a30-186">Make sure that you respect this convention in any error response messages.</span></span>

## <a name="optimizing-client-side-data-access"></a><span data-ttu-id="95a30-187">Ottimizzazione dell'accesso ai dati sul lato client</span><span class="sxs-lookup"><span data-stu-id="95a30-187">Optimizing client-side data access</span></span>
<span data-ttu-id="95a30-188">In un ambiente distribuito, che coinvolge, ad esempio, un server Web e applicazioni client, l’origine principale di problemi è la rete.</span><span class="sxs-lookup"><span data-stu-id="95a30-188">In a distributed environment such as that involving a web server and client applications, one of the primary sources of concern is the network.</span></span> <span data-ttu-id="95a30-189">Questo può fungere da notevole collo di bottiglia, soprattutto se un'applicazione client invia richieste o riceve dati frequentemente.</span><span class="sxs-lookup"><span data-stu-id="95a30-189">This can act as a considerable bottleneck, especially if a client application is frequently sending requests or receiving data.</span></span> <span data-ttu-id="95a30-190">È pertanto consigliabile ridurre al minimo la quantità di traffico che passa attraverso la rete.</span><span class="sxs-lookup"><span data-stu-id="95a30-190">Therefore you should aim to minimize the amount of traffic that flows across the network.</span></span> <span data-ttu-id="95a30-191">Quando si implementa il codice per recuperare le richieste, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="95a30-191">Consider the following points when you implement the code to retrieve and maintain data:</span></span>

### <a name="support-client-side-caching"></a><span data-ttu-id="95a30-192">Supporto di memorizzazione nella cache sul lato client</span><span class="sxs-lookup"><span data-stu-id="95a30-192">Support client-side caching</span></span>

<span data-ttu-id="95a30-193">Il protocollo HTTP 1.1 supporta la memorizzazione nella cache nei client e nei server intermedi attraverso i quali una richiesta viene indirizzata dall'utilizzo dell'intestazione Cache-Control.</span><span class="sxs-lookup"><span data-stu-id="95a30-193">The HTTP 1.1 protocol supports caching in clients and intermediate servers through which a request is routed by the use of the Cache-Control header.</span></span> <span data-ttu-id="95a30-194">Quando un'applicazione client invia una richiesta GET HTTP richiesta all'API Web, la risposta può includere un'intestazione Cache-Control che indica se i dati nel corpo della risposta possono essere memorizzati in modo sicuro nella cache dal client o da un server intermedio attraverso i quali è stata inviata la richiesta e per quanto prima che la richiesta scada e sia considerata non più valida.</span><span class="sxs-lookup"><span data-stu-id="95a30-194">When a client application sends an HTTP GET request to the web API, the response can include a Cache-Control header that indicates whether the data in the body of the response can be safely cached by the client or an intermediate server through which the request has been routed, and for how long before it should expire and be considered out-of-date.</span></span> <span data-ttu-id="95a30-195">Nell'esempio seguente viene mostrata una richiesta HTTP GET e la relativa risposta che include un'intestazione Cache-Control:</span><span class="sxs-lookup"><span data-stu-id="95a30-195">The following example shows an HTTP GET request and the corresponding response that includes a Cache-Control header:</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
```

```HTTP
HTTP/1.1 200 OK
...
Cache-Control: max-age=600, private
Content-Type: text/json; charset=utf-8
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

<span data-ttu-id="95a30-196">In questo esempio, l'intestazione Cache-Control specifica che i dati restituiti scadono dopo 600 secondi, è adatta solo per un client singolo e non deve essere archiviata in una cache condivisa utilizzata da altri client (è *private*).</span><span class="sxs-lookup"><span data-stu-id="95a30-196">In this example, the Cache-Control header specifies that the data returned should be expired after 600 seconds, and is only suitable for a single client and must not be stored in a shared cache used by other clients (it is *private*).</span></span> <span data-ttu-id="95a30-197">Se l'intestazione Cache-Control specifica *public* anziché *private*, i dati possono essere archiviati in una cache condivisa. Se invece specifica *no-store*, i dati **non** devono essere memorizzati nella cache dal client.</span><span class="sxs-lookup"><span data-stu-id="95a30-197">The Cache-Control header could specify *public* rather than *private* in which case the data can be stored in a shared cache, or it could specify *no-store* in which case the data must **not** be cached by the client.</span></span> <span data-ttu-id="95a30-198">Il seguente esempio di codice mostra come costruire un'intestazione Cache-Control in un messaggio di risposta:</span><span class="sxs-lookup"><span data-stu-id="95a30-198">The following code example shows how to construct a Cache-Control header in a response message:</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    [Route("api/orders/{id:int:min(0)}")]
    [HttpGet]
    public IHttpActionResult FindOrderByID(int id)
    {
        // Find the matching order
        Order order = ...;
        ...
        // Create a Cache-Control header for the response
        var cacheControlHeader = new CacheControlHeaderValue();
        cacheControlHeader.Private = true;
        cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);
        ...

        // Return a response message containing the order and the cache control header
        OkResultWithCaching<Order> response = new OkResultWithCaching<Order>(order, this)
        {
            CacheControlHeader = cacheControlHeader
        };
        return response;
    }
    ...
}
```

<span data-ttu-id="95a30-199">Questo codice utilizza una `IHttpActionResult` classe denominata `OkResultWithCaching` personalizzata.</span><span class="sxs-lookup"><span data-stu-id="95a30-199">This code makes use of a custom `IHttpActionResult` class named `OkResultWithCaching`.</span></span> <span data-ttu-id="95a30-200">Questa classe consente al controller di impostare i contenuti dell’intestazione cache:</span><span class="sxs-lookup"><span data-stu-id="95a30-200">This class enables the controller to set the cache header contents:</span></span>

```csharp
public class OkResultWithCaching<T> : OkNegotiatedContentResult<T>
{
    public OkResultWithCaching(T content, ApiController controller)
        : base(content, controller) { }

    public OkResultWithCaching(T content, IContentNegotiator contentNegotiator, HttpRequestMessage request, IEnumerable<MediaTypeFormatter> formatters)
        : base(content, contentNegotiator, request, formatters) { }

    public CacheControlHeaderValue CacheControlHeader { get; set; }
    public EntityTagHeaderValue ETag { get; set; }

    public override async Task<HttpResponseMessage> ExecuteAsync(CancellationToken cancellationToken)
    {
        HttpResponseMessage response;
        try
        {
            response = await base.ExecuteAsync(cancellationToken);
            response.Headers.CacheControl = this.CacheControlHeader;
            response.Headers.ETag = ETag;
        }
        catch (OperationCanceledException)
        {
            response = new HttpResponseMessage(HttpStatusCode.Conflict) {ReasonPhrase = "Operation was cancelled"};
        }
        return response;
    }
}
```

> [!NOTE]
> <span data-ttu-id="95a30-201">Il protocollo HTTP definisce inoltre la direttiva *no-cache* per l'intestazione Cache-Control.</span><span class="sxs-lookup"><span data-stu-id="95a30-201">The HTTP protocol also defines the *no-cache* directive for the Cache-Control header.</span></span> <span data-ttu-id="95a30-202">Questa direttiva non significa "non memorizzare nella cache" ma "riconvalidare le informazioni nella cache con il server prima di restituirle". I dati possono comunque essere memorizzati nella cache, che viene verificata ad ogni utilizzo per verificare che sia sempre valida.</span><span class="sxs-lookup"><span data-stu-id="95a30-202">Rather confusingly, this directive does not mean "do not cache" but rather "revalidate the cached information with the server before returning it"; the data can still be cached, but it is checked each time it is used to ensure that it is still current.</span></span>
>
>

<span data-ttu-id="95a30-203">La gestione della cache è responsabilità dell’applicazione client o del server intermedio. Se implementata correttamente, può risparmiare larghezza di banda e migliorare le prestazioni, eliminando la necessità di recuperare i dati che sono già stati salvati.</span><span class="sxs-lookup"><span data-stu-id="95a30-203">Cache management is the responsibility of the client application or intermediate server, but if properly implemented it can save bandwidth and improve performance by removing the need to fetch data that has already been recently retrieved.</span></span>

<span data-ttu-id="95a30-204">Il valore *max-age* nell'intestazione Cache-Control è solo un riferimento e non garantisce che i dati corrispondenti non verranno modificati nel tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="95a30-204">The *max-age* value in the Cache-Control header is only a guide and not a guarantee that the corresponding data won't change during the specified time.</span></span> <span data-ttu-id="95a30-205">L'API Web deve impostare il valore max-age su un valore adatto a seconda della volatilità prevista dei dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-205">The web API should set the max-age to a suitable value depending on the expected volatility of the data.</span></span> <span data-ttu-id="95a30-206">Quando questo periodo scade, il client deve eliminare l'oggetto dalla cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-206">When this period expires, the client should discard the object from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="95a30-207">La maggior parte dei moderni Web browser supportano la memorizzazione nella cache sul lato client mediante l’aggiunta di appropriate intestazioni cache-control alle richieste ed esaminando le intestazioni dei risultati, come descritto.</span><span class="sxs-lookup"><span data-stu-id="95a30-207">Most modern web browsers support client-side caching by adding the appropriate cache-control headers to requests and examining the headers of the results, as described.</span></span> <span data-ttu-id="95a30-208">Tuttavia, alcuni browser meno recenti non memorizzano nella cache i valori restituiti da un URL che include una stringa di query.</span><span class="sxs-lookup"><span data-stu-id="95a30-208">However, some older browsers will not cache the values returned from a URL that includes a query string.</span></span> <span data-ttu-id="95a30-209">Non si tratta in genere di un problema per le applicazioni client personalizzate che implementano la propria strategia di gestione cache basata sul protocollo descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="95a30-209">This is not usually an issue for custom client applications which implement their own cache management strategy based on the protocol discussed here.</span></span>
>
> <span data-ttu-id="95a30-210">Alcuni proxy meno recenti hanno lo stesso comportamento e non sono in grado di memorizzare nella cache le richieste basate su URL con stringhe di query.</span><span class="sxs-lookup"><span data-stu-id="95a30-210">Some older proxies exhibit the same behavior and might not cache requests based on URLs with query strings.</span></span> <span data-ttu-id="95a30-211">Potrebbe trattarsi di un problema per le applicazioni client personalizzate che si connettono a un server Web tramite un proxy di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="95a30-211">This could be an issue for custom client applications that connect to a web server through such a proxy.</span></span>
>

### <a name="provide-etags-to-optimize-query-processing"></a><span data-ttu-id="95a30-212">Indicare gli ETag per ottimizzare l'elaborazione delle query</span><span class="sxs-lookup"><span data-stu-id="95a30-212">Provide ETags to optimize query processing</span></span>

<span data-ttu-id="95a30-213">Quando un'applicazione client recupera un oggetto, il messaggio di risposta può includere anche un *ETag*, ovvero un tag di entità.</span><span class="sxs-lookup"><span data-stu-id="95a30-213">When a client application retrieves an object, the response message can also include an *ETag* (Entity Tag).</span></span> <span data-ttu-id="95a30-214">Un valore ETag è una stringa opaca che indica la versione di una risorsa. Ogni volta che una risorsa cambia, viene modificato anche il valore Etag.</span><span class="sxs-lookup"><span data-stu-id="95a30-214">An ETag is an opaque string that indicates the version of a resource; each time a resource changes the Etag is also modified.</span></span> <span data-ttu-id="95a30-215">Questo ETag deve essere memorizzato nella cache come parte dei dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-215">This ETag should be cached as part of the data by the client application.</span></span> <span data-ttu-id="95a30-216">Il seguente esempio di codice mostra come aggiungere un ETag come parte della risposta a una richiesta HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="95a30-216">The following code example shows how to add an ETag as part of the response to an HTTP GET request.</span></span> <span data-ttu-id="95a30-217">Questo codice utilizza il `GetHashCode` metodo di un oggetto per generare un valore numerico che identifica l'oggetto (è possibile sostituire questo metodo se necessario e generare il proprio hash utilizzando un algoritmo, ad esempio MD5):</span><span class="sxs-lookup"><span data-stu-id="95a30-217">This code uses the `GetHashCode` method of an object to generate a numeric value that identifies the object (you can override this method if necessary and generate your own hash using an algorithm such as MD5) :</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    public IHttpActionResult FindOrderByID(int id)
    {
        // Find the matching order
        Order order = ...;
        ...

        var hashedOrder = order.GetHashCode();
        string hashedOrderEtag = $"\"{hashedOrder}\"";
        var eTag = new EntityTagHeaderValue(hashedOrderEtag);

        // Return a response message containing the order and the cache control header
        OkResultWithCaching<Order> response = new OkResultWithCaching<Order>(order, this)
        {
            ...,
            ETag = eTag
        };
        return response;
    }
    ...
}
```

<span data-ttu-id="95a30-218">Il messaggio di risposta inviato utilizzando l'API Web è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="95a30-218">The response message posted by the web API looks like this:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Cache-Control: max-age=600, private
Content-Type: text/json; charset=utf-8
ETag: "2147483648"
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

> [!TIP]
> <span data-ttu-id="95a30-219">Per motivi di sicurezza, non autorizzare dati riservati o dati restituiti tramite una connessione (HTTPS) autenticata da memorizzare nella cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-219">For security reasons, do not allow sensitive data or data returned over an authenticated (HTTPS) connection to be cached.</span></span>
>
>

<span data-ttu-id="95a30-220">Un'applicazione client può inviare una richiesta GET successiva per recuperare la risorsa stessa in qualsiasi momento. Se la risorsa è stata modificata (con un ETag diverso), la versione memorizzata nella cache deve essere eliminata e la nuova versione deve essere aggiunta alla cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-220">A client application can issue a subsequent GET request to retrieve the same resource at any time, and if the resource has changed (it has a different ETag) the cached version should be discarded and the new version added to the cache.</span></span> <span data-ttu-id="95a30-221">Se una risorsa è di grandi dimensioni e richiede una notevole quantità di larghezza di banda per trasmettere al client, le richieste ripetute per recuperare i dati stessi possono diventare inefficienti.</span><span class="sxs-lookup"><span data-stu-id="95a30-221">If a resource is large and requires a significant amount of bandwidth to transmit back to the client, repeated requests to fetch the same data can become inefficient.</span></span> <span data-ttu-id="95a30-222">Per evitare questo inconveniente, il protocollo HTTP definisce il seguente processo per l'ottimizzazione delle richieste GET che devono essere supportate in un'API Web:</span><span class="sxs-lookup"><span data-stu-id="95a30-222">To combat this, the HTTP protocol defines the following process for optimizing GET requests that you should support in a web API:</span></span>

* <span data-ttu-id="95a30-223">Il client crea una richiesta GET che contiene il valore ETag per la versione attualmente memorizzata nella cache della risorsa a cui fa riferimento in un'intestazione HTTP If-None-Match:</span><span class="sxs-lookup"><span data-stu-id="95a30-223">The client constructs a GET request containing the ETag for the currently cached version of the resource referenced in an If-None-Match HTTP header:</span></span>

    ```HTTP
    GET http://adventure-works.com/orders/2 HTTP/1.1
    If-None-Match: "2147483648"
    ```
* <span data-ttu-id="95a30-224">L'operazione GET nell'API Web ottiene l’attuale valore ETag per i dati richiesti (ordine 2 nell'esempio precedente) e lo confronta con il valore dell'intestazione If-None-Match.</span><span class="sxs-lookup"><span data-stu-id="95a30-224">The GET operation in the web API obtains the current ETag for the requested data (order 2 in the above example), and compares it to the value in the If-None-Match header.</span></span>
* <span data-ttu-id="95a30-225">Se l’attuale valore ETag per i dati richiesti corrisponde al valore ETag fornito dalla richiesta, la risorsa non è stata modificata e l'API Web deve restituire una risposta HTTP con un corpo del messaggio vuoto e un codice di stato di 304 (non modificato).</span><span class="sxs-lookup"><span data-stu-id="95a30-225">If the current ETag for the requested data matches the ETag provided by the request, the resource has not changed and the web API should return an HTTP response with an empty message body and a status code of 304 (Not Modified).</span></span>
* <span data-ttu-id="95a30-226">Se l’attuale valore ETag per i dati richiesti non corrisponde al valore ETag fornito dalla richiesta, i dati sono stati modificati e l'API Web deve restituire una risposta HTTP che contiene i nuovi dati nel corpo del messaggio e un codice di stato 200 (OK).</span><span class="sxs-lookup"><span data-stu-id="95a30-226">If the current ETag for the requested data does not match the ETag provided by the request, then the data has changed and the web API should return an HTTP response with the new data in the message body and a status code of 200 (OK).</span></span>
* <span data-ttu-id="95a30-227">Se i dati richiesti non esistono più, l'API Web deve restituire una risposta HTTP con il codice di stato 404 (non trovato).</span><span class="sxs-lookup"><span data-stu-id="95a30-227">If the requested data no longer exists then the web API should return an HTTP response with the status code of 404 (Not Found).</span></span>
* <span data-ttu-id="95a30-228">Il client utilizza il codice di stato per gestire la cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-228">The client uses the status code to maintain the cache.</span></span> <span data-ttu-id="95a30-229">Se i dati non sono stati modificati (codice di stato 304), l'oggetto può rimanere memorizzato nella cache e l'applicazione client deve continuare a utilizzare questa versione dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="95a30-229">If the data has not changed (status code 304) then the object can remain cached and the client application should continue to use this version of the object.</span></span> <span data-ttu-id="95a30-230">Se i dati sono stati modificati (codice di stato 200), l'oggetto memorizzato nella cache deve essere eliminato e deve essere inserito quello nuovo.</span><span class="sxs-lookup"><span data-stu-id="95a30-230">If the data has changed (status code 200) then the cached object should be discarded and the new one inserted.</span></span> <span data-ttu-id="95a30-231">Se i dati non sono più disponibili (codice di stato 404), l'oggetto deve essere rimosso dalla cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-231">If the data is no longer available (status code 404) then the object should be removed from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="95a30-232">Se l'intestazione della risposta contiene l'intestazione Cache-Control no-store, l'oggetto deve sempre essere rimosso dalla cache indipendentemente dal codice di stato HTTP.</span><span class="sxs-lookup"><span data-stu-id="95a30-232">If the response header contains the Cache-Control header no-store then the object should always be removed from the cache regardless of the HTTP status code.</span></span>
>

<span data-ttu-id="95a30-233">Il codice seguente mostra il `FindOrderByID` metodo esteso per supportare l'intestazione If-None-Match.</span><span class="sxs-lookup"><span data-stu-id="95a30-233">The code below shows the `FindOrderByID` method extended to support the If-None-Match header.</span></span> <span data-ttu-id="95a30-234">Si noti che, se si omette l'intestazione If-None-Match, viene recuperato sempre l'ordine specificato:</span><span class="sxs-lookup"><span data-stu-id="95a30-234">Notice that if the If-None-Match header is omitted, the specified order is always retrieved:</span></span>

```csharp
public class OrdersController : ApiController
{
    [Route("api/orders/{id:int:min(0)}")]
    [HttpGet]
    public IHttpActionResult FindOrderByID(int id)
    {
        try
        {
            // Find the matching order
            Order order = ...;

            // If there is no such order then return NotFound
            if (order == null)
            {
                return NotFound();
            }

            // Generate the ETag for the order
            var hashedOrder = order.GetHashCode();
            string hashedOrderEtag = $"\"{hashedOrder}\"";

            // Create the Cache-Control and ETag headers for the response
            IHttpActionResult response;
            var cacheControlHeader = new CacheControlHeaderValue();
            cacheControlHeader.Public = true;
            cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);
            var eTag = new EntityTagHeaderValue(hashedOrderEtag);

            // Retrieve the If-None-Match header from the request (if it exists)
            var nonMatchEtags = Request.Headers.IfNoneMatch;

            // If there is an ETag in the If-None-Match header and
            // this ETag matches that of the order just retrieved,
            // then create a Not Modified response message
            if (nonMatchEtags.Count > 0 &&
                String.CompareOrdinal(nonMatchEtags.First().Tag, hashedOrderEtag) == 0)
            {
                response = new EmptyResultWithCaching()
                {
                    StatusCode = HttpStatusCode.NotModified,
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag
                };
            }
            // Otherwise create a response message that contains the order details
            else
            {
                response = new OkResultWithCaching<Order>(order, this)
                {
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag
                };
            }

            return response;
        }
        catch
        {
            return InternalServerError();
        }
    }
...
}
```

<span data-ttu-id="95a30-235">Questo esempio incorpora una `IHttpActionResult` classe denominata `EmptyResultWithCaching` aggiuntiva personalizzata.</span><span class="sxs-lookup"><span data-stu-id="95a30-235">This example incorporates an additional custom `IHttpActionResult` class named `EmptyResultWithCaching`.</span></span> <span data-ttu-id="95a30-236">Questa classe funge semplicemente da wrapper per un `HttpResponseMessage` oggetto che non contiene il corpo della risposta:</span><span class="sxs-lookup"><span data-stu-id="95a30-236">This class simply acts as a wrapper around an `HttpResponseMessage` object that does not contain a response body:</span></span>

```csharp
public class EmptyResultWithCaching : IHttpActionResult
{
    public CacheControlHeaderValue CacheControlHeader { get; set; }
    public EntityTagHeaderValue ETag { get; set; }
    public HttpStatusCode StatusCode { get; set; }
    public Uri Location { get; set; }

    public async Task<HttpResponseMessage> ExecuteAsync(CancellationToken cancellationToken)
    {
        HttpResponseMessage response = new HttpResponseMessage(StatusCode);
        response.Headers.CacheControl = this.CacheControlHeader;
        response.Headers.ETag = this.ETag;
        response.Headers.Location = this.Location;
        return response;
    }
}
```

> [!TIP]
> <span data-ttu-id="95a30-237">In questo esempio, il valore ETag per i dati viene generato eseguendo l'hashing dei dati recuperati dall'origine dati sottostante.</span><span class="sxs-lookup"><span data-stu-id="95a30-237">In this example, the ETag for the data is generated by hashing the data retrieved from the underlying data source.</span></span> <span data-ttu-id="95a30-238">Se il valore ETag può essere calcolato in modo diverso, è possibile ottimizzare ulteriormente il processo e solo i dati devono essere recuperati dall'origine dati se questa è stata modificata.</span><span class="sxs-lookup"><span data-stu-id="95a30-238">If the ETag can be computed in some other way, then the process can be optimized further and the data only needs to be fetched from the data source if it has changed.</span></span>  <span data-ttu-id="95a30-239">Questo approccio è particolarmente utile se i dati sono di grandi dimensioni o l'accesso all'origine dati può comportare una latenza significativa (ad esempio, se l'origine dati è un database remoto).</span><span class="sxs-lookup"><span data-stu-id="95a30-239">This approach is especially useful if the data is large or accessing the data source can result in significant latency (for example, if the data source is a remote database).</span></span>
>

### <a name="use-etags-to-support-optimistic-concurrency"></a><span data-ttu-id="95a30-240">Usare ETag per il supporto della concorrenza ottimistica</span><span class="sxs-lookup"><span data-stu-id="95a30-240">Use ETags to Support Optimistic Concurrency</span></span>

<span data-ttu-id="95a30-241">Per abilitare gli aggiornamenti su dati memorizzati nella cache in precedenza, il protocollo HTTP supporta una strategia di concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="95a30-241">To enable updates over previously cached data, the HTTP protocol supports an optimistic concurrency strategy.</span></span> <span data-ttu-id="95a30-242">Se, dopo il recupero e la memorizzazione nella cache di una risorsa, l'applicazione client invia successivamente una richiesta PUT o DELETE per modificare o rimuovere la risorsa, tale richiesta deve includere nell'intestazione If-Match il riferimento al valore ETag.</span><span class="sxs-lookup"><span data-stu-id="95a30-242">If, after fetching and caching a resource, the client application subsequently sends a PUT or DELETE request to change or remove the resource, it should include in If-Match header that references the ETag.</span></span> <span data-ttu-id="95a30-243">L'API Web può quindi utilizzare queste informazioni per determinare se la risorsa è già stata modificata da un altro utente quando è stata recuperata e per inviare una risposta appropriata all'applicazione client, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="95a30-243">The web API can then use this information to determine whether the resource has already been changed by another user since it was retrieved and send an appropriate response back to the client application as follows:</span></span>

* <span data-ttu-id="95a30-244">Il client crea una richiesta GET che contiene i nuovi dettagli della risorsa e il valore ETag per la versione attualmente memorizzata nella cache della risorsa a cui fa riferimento in un'intestazione HTTP If-None-Match.</span><span class="sxs-lookup"><span data-stu-id="95a30-244">The client constructs a PUT request containing the new details for the resource and the ETag for the currently cached version of the resource referenced in an If-Match HTTP header.</span></span> <span data-ttu-id="95a30-245">Il seguente esempio mostra una richiesta PUT che aggiorna un ordine:</span><span class="sxs-lookup"><span data-stu-id="95a30-245">The following example shows a PUT request that updates an order:</span></span>

    ```HTTP
    PUT http://adventure-works.com/orders/1 HTTP/1.1
    If-Match: "2282343857"
    Content-Type: application/x-www-form-urlencoded
    Content-Length: ...
    productID=3&quantity=5&orderValue=250
    ```
* <span data-ttu-id="95a30-246">L'operazione PUT nell'API Web ottiene l’attuale valore ETag per i dati richiesti (ordine 1 nell'esempio precedente) e lo confronta con il valore dell'intestazione If-None-Match.</span><span class="sxs-lookup"><span data-stu-id="95a30-246">The PUT operation in the web API obtains the current ETag for the requested data (order 1 in the above example), and compares it to the value in the If-Match header.</span></span>
* <span data-ttu-id="95a30-247">Se l’attuale valore ETag per i dati richiesti corrisponde al valore ETag fornito dalla richiesta, la risorsa non è stata modificata e l'API Web deve eseguire l’aggiornamento, restituendo un messaggio con codice di stato HTTP 204 (nessun contenuto) se l’operazione ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="95a30-247">If the current ETag for the requested data matches the ETag provided by the request, the resource has not changed and the web API should perform the update, returning a message with HTTP status code 204 (No Content) if it is successful.</span></span> <span data-ttu-id="95a30-248">La risposta può includere intestazioni ETag e Cache-Control per la versione aggiornata della risorsa.</span><span class="sxs-lookup"><span data-stu-id="95a30-248">The response can include Cache-Control and ETag headers for the updated version of the resource.</span></span> <span data-ttu-id="95a30-249">La risposta deve sempre includere l'intestazione Location che fa riferimento all'URI della risorsa appena aggiornata.</span><span class="sxs-lookup"><span data-stu-id="95a30-249">The response should always include the Location header that references the URI of the newly updated resource.</span></span>
* <span data-ttu-id="95a30-250">Se l’attuale valore ETag per i dati richiesti non corrisponde al valore ETag fornito dalla richiesta, i dati sono stati modificati da un altro utente dal momento del loro recupero e l'API Web deve restituire una risposta HTTP con un corpo del messaggio vuoto e un codice di stato 412 (Condizione preliminare non riuscita).</span><span class="sxs-lookup"><span data-stu-id="95a30-250">If the current ETag for the requested data does not match the ETag provided by the request, then the data has been changed by another user since it was fetched and the web API should return an HTTP response with an empty message body and a status code of 412 (Precondition Failed).</span></span>
* <span data-ttu-id="95a30-251">Se la risorsa che deve essere aggiornata non esiste più, l'API Web deve restituire una risposta HTTP con il codice di stato 404 (non trovato).</span><span class="sxs-lookup"><span data-stu-id="95a30-251">If the resource to be updated no longer exists then the web API should return an HTTP response with the status code of 404 (Not Found).</span></span>
* <span data-ttu-id="95a30-252">Il client utilizza il codice di stato e le intestazioni della risposta per gestire la cache.</span><span class="sxs-lookup"><span data-stu-id="95a30-252">The client uses the status code and response headers to maintain the cache.</span></span> <span data-ttu-id="95a30-253">Se i dati sono stati aggiornati (codice di stato 204), l'oggetto può rimanere memorizzato nella cache (fino a quando l'intestazione Cache-Control non specifica alcun archivio), ma il valore ETag che deve essere aggiornato.</span><span class="sxs-lookup"><span data-stu-id="95a30-253">If the data has been updated (status code 204) then the object can remain cached (as long as the Cache-Control header does not specify no-store) but the ETag should be updated.</span></span> <span data-ttu-id="95a30-254">Se i dati sono stati modificati da un altro utente modificato (codice di stato 412) o non trovato (codice di stato 404), l'oggetto memorizzato nella cache deve essere eliminato.</span><span class="sxs-lookup"><span data-stu-id="95a30-254">If the data was changed by another user changed (status code 412) or not found (status code 404) then the cached object should be discarded.</span></span>

<span data-ttu-id="95a30-255">Il successivo esempio di codice mostra un'implementazione dell'operazione PUT per il controller degli Ordini:</span><span class="sxs-lookup"><span data-stu-id="95a30-255">The next code example shows an implementation of the PUT operation for the Orders controller:</span></span>

```csharp
public class OrdersController : ApiController
{
    [HttpPut]
    [Route("api/orders/{id:int}")]
    public IHttpActionResult UpdateExistingOrder(int id, DTOOrder order)
    {
        try
        {
            var baseUri = Constants.GetUriFromConfig();
            var orderToUpdate = this.ordersRepository.GetOrder(id);
            if (orderToUpdate == null)
            {
                return NotFound();
            }

            var hashedOrder = orderToUpdate.GetHashCode();
            string hashedOrderEtag = $"\"{hashedOrder}\"";

            // Retrieve the If-Match header from the request (if it exists)
            var matchEtags = Request.Headers.IfMatch;

            // If there is an Etag in the If-Match header and
            // this etag matches that of the order just retrieved,
            // or if there is no etag, then update the Order
            if (((matchEtags.Count > 0 &&
                String.CompareOrdinal(matchEtags.First().Tag, hashedOrderEtag) == 0)) ||
                matchEtags.Count == 0)
            {
                // Modify the order
                orderToUpdate.OrderValue = order.OrderValue;
                orderToUpdate.ProductID = order.ProductID;
                orderToUpdate.Quantity = order.Quantity;

                // Save the order back to the data store
                // ...

                // Create the No Content response with Cache-Control, ETag, and Location headers
                var cacheControlHeader = new CacheControlHeaderValue();
                cacheControlHeader.Private = true;
                cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);

                hashedOrder = order.GetHashCode();
                hashedOrderEtag = $"\"{hashedOrder}\"";
                var eTag = new EntityTagHeaderValue(hashedOrderEtag);

                var location = new Uri($"{baseUri}/{Constants.ORDERS}/{id}");
                var response = new EmptyResultWithCaching()
                {
                    StatusCode = HttpStatusCode.NoContent,
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag,
                    Location = location
                };

                return response;
            }

            // Otherwise return a Precondition Failed response
            return StatusCode(HttpStatusCode.PreconditionFailed);
        }
        catch
        {
            return InternalServerError();
        }
    }
    ...
}
```

> [!TIP]
> <span data-ttu-id="95a30-256">L’utilizzo dell'intestazione If-Match è completamente facoltativo; se viene omesso l’API Web tenterà sempre di aggiornare l'ordine specificato, sovrascrivendo alla cieca un aggiornamento effettuato da un altro utente.</span><span class="sxs-lookup"><span data-stu-id="95a30-256">Use of the If-Match header is entirely optional, and if it is omitted the web API will always attempt to update the specified order, possibly blindly overwriting an update made by another user.</span></span> <span data-ttu-id="95a30-257">Per evitare problemi dovuti alla perdita di aggiornamenti, è necessario fornire sempre un'intestazione If-Match.</span><span class="sxs-lookup"><span data-stu-id="95a30-257">To avoid problems due to lost updates, always provide an If-Match header.</span></span>
>
>

## <a name="handling-large-requests-and-responses"></a><span data-ttu-id="95a30-258">Gestione di risposte e richieste di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="95a30-258">Handling large requests and responses</span></span>
<span data-ttu-id="95a30-259">Si possono verificare casi in cui un’applicazione client deve emettere richieste di invio o ricezione dati delle dimensioni di diversi megabyte (o maggiori).</span><span class="sxs-lookup"><span data-stu-id="95a30-259">There may be occasions when a client application needs to issue requests that send or receive data that may be several megabytes (or bigger) in size.</span></span> <span data-ttu-id="95a30-260">L’applicazione potrebbe bloccarsi mentre questa quantità di dati viene trasmessa.</span><span class="sxs-lookup"><span data-stu-id="95a30-260">Waiting while this amount of data is transmitted could cause the client application to become unresponsive.</span></span> <span data-ttu-id="95a30-261">Quando è necessario gestire le richieste che includono quantità elevate di dati, considerare quanto riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="95a30-261">Consider the following points when you need to handle requests that include significant amounts of data:</span></span>

### <a name="optimize-requests-and-responses-that-involve-large-objects"></a><span data-ttu-id="95a30-262">Ottimizzare richieste e risposte contenenti oggetti di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="95a30-262">Optimize requests and responses that involve large objects</span></span>

<span data-ttu-id="95a30-263">Alcune risorse potrebbero essere oggetti di grandi dimensioni o includere campi di grandi dimensioni, ad esempio immagini grafiche o altri tipi di dati binari.</span><span class="sxs-lookup"><span data-stu-id="95a30-263">Some resources may be large objects or include large fields, such as graphics images or other types of binary data.</span></span> <span data-ttu-id="95a30-264">Un'API Web deve supportare lo streaming per abilitare il caricamento e il download ottimizzati di queste risorse.</span><span class="sxs-lookup"><span data-stu-id="95a30-264">A web API should support streaming to enable optimized uploading and downloading of these resources.</span></span>

<span data-ttu-id="95a30-265">Il protocollo HTTP fornisce il meccanismo di codifica di trasferimento in blocchi per eseguire lo streaming di oggetti di dati di grandi dimensioni a un client.</span><span class="sxs-lookup"><span data-stu-id="95a30-265">The HTTP protocol provides the chunked transfer encoding mechanism to stream large data objects back to a client.</span></span> <span data-ttu-id="95a30-266">Quando il client invia una richiesta HTTP GET per un oggetto di grandi dimensioni, l'API Web può inviare la risposta in *blocchi* frammentari tramite una connessione HTTP.</span><span class="sxs-lookup"><span data-stu-id="95a30-266">When the client sends an HTTP GET request for a large object, the web API can send the reply back in piecemeal *chunks* over an HTTP connection.</span></span> <span data-ttu-id="95a30-267">La lunghezza dei dati nella risposta potrebbe non essere nota inizialmente (potrebbe essere generata), in modo che il server che ospita l'API Web debba inviare un messaggio di risposta con ogni blocco che specifica la codifica di trasferimento: blocchi di intestazione anziché un'intestazione Content-Length.</span><span class="sxs-lookup"><span data-stu-id="95a30-267">The length of the data in the reply may not be known initially (it might be generated), so the server hosting the web API should send a response message with each chunk that specifies the Transfer-Encoding: Chunked header rather than a Content-Length header.</span></span> <span data-ttu-id="95a30-268">L'applicazione client può ricevere, a sua volta, ogni blocco per costruire la risposta completa.</span><span class="sxs-lookup"><span data-stu-id="95a30-268">The client application can receive each chunk in turn to build up the complete response.</span></span> <span data-ttu-id="95a30-269">Il trasferimento dei dati viene completato quando il server restituisce un blocco finale di dimensioni pari a zero.</span><span class="sxs-lookup"><span data-stu-id="95a30-269">The data transfer completes when the server sends back a final chunk with zero size.</span></span> 

<span data-ttu-id="95a30-270">Una singola richiesta potrebbe creare un oggetto di grandi dimensioni che usa una quantità notevole di risorse.</span><span class="sxs-lookup"><span data-stu-id="95a30-270">A single request could conceivably result in a massive object that consumes considerable resources.</span></span> <span data-ttu-id="95a30-271">Se, durante il processo di streaming, l'API Web determina che la quantità di dati in una richiesta ha superato alcuni limiti accettabili, può interrompere l'operazione e restituire un messaggio di risposta con codice di stato 413 (Entità richiesta troppo grande).</span><span class="sxs-lookup"><span data-stu-id="95a30-271">If, during the streaming process, the web API determines that the amount of data in a request has exceeded some acceptable bounds, it can abort the operation and return a response message with status code 413 (Request Entity Too Large).</span></span>

<span data-ttu-id="95a30-272">È possibile ridurre le dimensioni di oggetti di grandi dimensioni trasmessi in rete utilizzando la compressione HTTP.</span><span class="sxs-lookup"><span data-stu-id="95a30-272">You can minimize the size of large objects transmitted over the network by using HTTP compression.</span></span> <span data-ttu-id="95a30-273">Questo approccio aiuta a ridurre la quantità di traffico di rete e la latenza di rete associati, ma a costo di richiedere ulteriori elaborazioni al client e al server che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-273">This approach helps to reduce the amount of network traffic and the associated network latency, but at the cost of requiring additional processing at the client and the server hosting the web API.</span></span> <span data-ttu-id="95a30-274">Ad esempio, un'applicazione client che si aspetta di ricevere dati compressi può includere un’intestazione Accept-Encoding: gzip della richiesta (è inoltre possibile specificare altri per la compressione dei dati).</span><span class="sxs-lookup"><span data-stu-id="95a30-274">For example, a client application that expects to receive compressed data can include an Accept-Encoding: gzip request header (other data compression algorithms can also be specified).</span></span> <span data-ttu-id="95a30-275">Se il server supporta la compressione deve rispondere con il contenuto in formato gzip nel corpo del messaggio e l’intestazione Content-Encoding: gzip della risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-275">If the server supports compression it should respond with the content held in gzip format in the message body and the Content-Encoding: gzip response header.</span></span>

<span data-ttu-id="95a30-276">È possibile combinare la compressione codificata con la trasmissione; comprimere i dati prima della loro trasmissione e specificare la codifica del contenuto gzip e la codifica del trasferimento in blocchi nelle intestazioni del messaggio.</span><span class="sxs-lookup"><span data-stu-id="95a30-276">You can combine encoded compression with streaming; compress the data first before streaming it, and specify the gzip content encoding and chunked transfer encoding in the message headers.</span></span> <span data-ttu-id="95a30-277">Si noti inoltre che alcuni server Web (ad esempio Internet Information Server) possono essere configurati per comprimere automaticamente le risposte HTTP indipendentemente dal fatto che l'API Web comprima i dati o meno.</span><span class="sxs-lookup"><span data-stu-id="95a30-277">Also note that some web servers (such as Internet Information Server) can be configured to automatically compress HTTP responses regardless of whether the web API compresses the data or not.</span></span>

### <a name="implement-partial-responses-for-clients-that-do-not-support-asynchronous-operations"></a><span data-ttu-id="95a30-278">Implementare risposte parziali per i client che non supportano le operazioni asincrone</span><span class="sxs-lookup"><span data-stu-id="95a30-278">Implement partial responses for clients that do not support asynchronous operations</span></span>

<span data-ttu-id="95a30-279">In alternativa al flusso asincrono, un'applicazione client può richiedere in modo esplicito dati per oggetti di grandi dimensioni in blocchi, noti come risposte parziali.</span><span class="sxs-lookup"><span data-stu-id="95a30-279">As an alternative to asynchronous streaming, a client application can explicitly request data for large objects in chunks, known as partial responses.</span></span> <span data-ttu-id="95a30-280">L'applicazione client invia una richiesta HEAD HTTP per ottenere informazioni sull'oggetto.</span><span class="sxs-lookup"><span data-stu-id="95a30-280">The client application sends an HTTP HEAD request to obtain information about the object.</span></span> <span data-ttu-id="95a30-281">Se l’API Web supporta risposte parziali se deve rispondere alla richiesta HEAD con un messaggio di risposta che contiene un'intestazione Accept-Ranges e un'intestazione Content-Length che indica la dimensione totale dell'oggetto, ma il corpo del messaggio deve essere vuoto.</span><span class="sxs-lookup"><span data-stu-id="95a30-281">If the web API supports partial responses if should respond to the HEAD request with a response message that contains an Accept-Ranges header and a Content-Length header that indicates the total size of the object, but the body of the message should be empty.</span></span> <span data-ttu-id="95a30-282">L'applicazione client può utilizzare queste informazioni per costruire una serie di richieste GET che specificano un intervallo di byte da ricevere.</span><span class="sxs-lookup"><span data-stu-id="95a30-282">The client application can use this information to construct a series of GET requests that specify a range of bytes to receive.</span></span> <span data-ttu-id="95a30-283">L'API Web deve restituire un messaggio di risposta con stato HTTP 206 (contenuto parziale), un'intestazione Content-Length che specifica l’attuale quantità di dati inclusi nel corpo del messaggio di risposta e un'intestazione Content-Range che indica quale parte (ad esempio, 4000 e 8000 byte) dell'oggetto rappresenta questi dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-283">The web API should return a response message with HTTP status 206 (Partial Content), a Content-Length header that specifies the actual amount of data included in the body of the response message, and a Content-Range header that indicates which part (such as bytes 4000 to 8000) of the object this data represents.</span></span>

<span data-ttu-id="95a30-284">Le richieste HTTP HEAD e le risposte parziali sono descritte in dettaglio in [API Design][api-design] (Progettazione API).</span><span class="sxs-lookup"><span data-stu-id="95a30-284">HTTP HEAD requests and partial responses are described in more detail in [API Design][api-design].</span></span>

### <a name="avoid-sending-unnecessary-100-continue-status-messages-in-client-applications"></a><span data-ttu-id="95a30-285">Evitare l'invio di inutili messaggi di stato 100 - Continua nelle applicazioni client</span><span class="sxs-lookup"><span data-stu-id="95a30-285">Avoid sending unnecessary 100-Continue status messages in client applications</span></span>

<span data-ttu-id="95a30-286">Un'applicazione client che è sul punto di inviare una grande quantità di dati a un server può determinare innanzitutto se il server è effettivamente disposto ad accettare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-286">A client application that is about to send a large amount of data to a server may determine first whether the server is actually willing to accept the request.</span></span> <span data-ttu-id="95a30-287">Prima di inviare i dati, l'applicazione client può inviare una richiesta HTTP con un’intestazione Expect: 100-Continue, un'intestazione Content-Length che indica le dimensioni dei dati, ma un corpo del messaggio vuoto.</span><span class="sxs-lookup"><span data-stu-id="95a30-287">Prior to sending the data, the client application can submit an HTTP request with an Expect: 100-Continue header, a Content-Length header that indicates the size of the data, but an empty message body.</span></span> <span data-ttu-id="95a30-288">Se il server è disposto a gestire la richiesta, deve rispondere con un messaggio che specifica lo stato HTTP 100 (Continua).</span><span class="sxs-lookup"><span data-stu-id="95a30-288">If the server is willing to handle the request, it should respond with a message that specifies the HTTP status 100 (Continue).</span></span> <span data-ttu-id="95a30-289">L'applicazione client può quindi procedere e inviare la richiesta completa, inclusi i dati nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="95a30-289">The client application can then proceed and send the complete request including the data in the message body.</span></span>

<span data-ttu-id="95a30-290">Se si ospita un servizio tramite IIS, il driver HTTP. sys rileva automaticamente e gestisce le intestazioni Expect: 100-continuare prima di passare le richieste all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-290">If you are hosting a service by using IIS, the HTTP.sys driver automatically detects and handles Expect: 100-Continue headers before passing requests to your web application.</span></span> <span data-ttu-id="95a30-291">Ciò significa che è improbabile visualizzare queste intestazioni nel codice dell'applicazione e si può presupporre che IIS abbia già filtrato tutti i messaggi che ritiene non idonei o di dimensioni troppo grandi.</span><span class="sxs-lookup"><span data-stu-id="95a30-291">This means that you are unlikely to see these headers in your application code, and you can assume that IIS has already filtered any messages that it deems to be unfit or too large.</span></span>

<span data-ttu-id="95a30-292">Se si creano applicazioni client utilizzando .NET Framework, tutti i messaggi POST e PUT invieranno innanzitutto messaggi con intestazioni Expect: 100-Continue per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="95a30-292">If you are building client applications by using the .NET Framework, then all POST and PUT messages will first send messages with Expect: 100-Continue headers by default.</span></span> <span data-ttu-id="95a30-293">Come con il lato server, il processo viene gestito in modo trasparente da .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="95a30-293">As with the server-side, the process is handled transparently by the .NET Framework.</span></span> <span data-ttu-id="95a30-294">Tuttavia, questo processo causa, in ogni richiesta POST e PUT, 2 round trip al server, anche per le richieste di piccole dimensioni.</span><span class="sxs-lookup"><span data-stu-id="95a30-294">However, this process results in each POST and PUT request causing two round-trips to the server, even for small requests.</span></span> <span data-ttu-id="95a30-295">Se l'applicazione non invia richieste con grandi quantità di dati, è possibile disattivare questa funzionalità utilizzando la `ServicePointManager` classe per creare `ServicePoint` oggetti nell'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="95a30-295">If your application is not sending requests with large amounts of data, you can disable this feature by using the `ServicePointManager` class to create `ServicePoint` objects in the client application.</span></span> <span data-ttu-id="95a30-296">Un `ServicePoint` oggetto gestisce le connessioni che il client effettua a un server basato sui frammenti di URI di schema e l'host che identificano le risorse del server.</span><span class="sxs-lookup"><span data-stu-id="95a30-296">A `ServicePoint` object handles the connections that the client makes to a server based on the scheme and host fragments of URIs that identify resources on the server.</span></span> <span data-ttu-id="95a30-297">È quindi possibile impostare la `Expect100Continue` proprietà dell’ `ServicePoint` oggetto su false.</span><span class="sxs-lookup"><span data-stu-id="95a30-297">You can then set the `Expect100Continue` property of the `ServicePoint` object to false.</span></span> <span data-ttu-id="95a30-298">Tutte le successive richieste POST e PUT effettuate dal client tramite un URI che corrisponde a frammenti di schema e host dell’ `ServicePoint` oggetto saranno inviate senza le intestazioni Expect: 100-Continue.</span><span class="sxs-lookup"><span data-stu-id="95a30-298">All subsequent POST and PUT requests made by the client through a URI that matches the scheme and host fragments of the `ServicePoint` object will be sent without Expect: 100-Continue headers.</span></span> <span data-ttu-id="95a30-299">Il codice seguente mostra come configurare un `ServicePoint` oggetto che consente di configurare tutte le richieste inviate a URI con uno schema di `http` e un host di `www.contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="95a30-299">The following code shows how to configure a `ServicePoint` object that configures all requests sent to URIs with a scheme of `http` and a host of `www.contoso.com`.</span></span>

```csharp
Uri uri = new Uri("http://www.contoso.com/");
ServicePoint sp = ServicePointManager.FindServicePoint(uri);
sp.Expect100Continue = false;
```

<span data-ttu-id="95a30-300">È inoltre possibile impostare il metodo statico `Expect100Continue` proprietà della `ServicePointManager` classe per specificare il valore predefinito di questa proprietà per tutti gli`ServicePoint` oggetti creati successivamente.</span><span class="sxs-lookup"><span data-stu-id="95a30-300">You can also set the static `Expect100Continue` property of the `ServicePointManager` class to specify the default value of this property for all subsequently created `ServicePoint` objects.</span></span> <span data-ttu-id="95a30-301">Per altre informazioni, vedere [Classe ServicePoint](https://msdn.microsoft.com/library/system.net.servicepoint.aspx).</span><span class="sxs-lookup"><span data-stu-id="95a30-301">For more information, see [ServicePoint Class](https://msdn.microsoft.com/library/system.net.servicepoint.aspx).</span></span>

### <a name="support-pagination-for-requests-that-may-return-large-numbers-of-objects"></a><span data-ttu-id="95a30-302">Supporto per l'impaginazione di richieste che possono restituire un numero elevato di oggetti</span><span class="sxs-lookup"><span data-stu-id="95a30-302">Support pagination for requests that may return large numbers of objects</span></span>

<span data-ttu-id="95a30-303">Se una raccolta contiene un numero elevato di risorse, l’esecuzione di una richiesta GET all'URI corrispondente potrebbe determinare un’elaborazione significativa sul server delle prestazioni che interessano l’API Web e generare una quantità significativa di traffico di rete determinando un aumento della latenza.</span><span class="sxs-lookup"><span data-stu-id="95a30-303">If a collection contains a large number of resources, issuing a GET request to the corresponding URI could result in significant processing on the server hosting the web API affecting performance, and generate a significant amount of network traffic resulting in increased latency.</span></span>

<span data-ttu-id="95a30-304">Per gestire questi casi, l'API Web deve supportare le stringhe di query che consentono all'applicazione client di ridefinire le richieste o recuperare i dati in blocchi (o pagine) più gestibili o discreti.</span><span class="sxs-lookup"><span data-stu-id="95a30-304">To handle these cases, the web API should support query strings that enable the client application to refine requests or fetch data in more manageable, discrete blocks (or pages).</span></span> <span data-ttu-id="95a30-305">Il codice seguente mostra il `GetAllOrders` metodo del `Orders` controller.</span><span class="sxs-lookup"><span data-stu-id="95a30-305">The code below shows the `GetAllOrders` method in the `Orders` controller.</span></span> <span data-ttu-id="95a30-306">Questo metodo recupera i dettagli di ordini.</span><span class="sxs-lookup"><span data-stu-id="95a30-306">This method retrieves the details of orders.</span></span> <span data-ttu-id="95a30-307">Se questo metodo è stato vincolato, potrebbe restituire presumibilmente una grande quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-307">If this method was unconstrained, it could conceivably return a large amount of data.</span></span> <span data-ttu-id="95a30-308">I parametri`limit` e `offset` consentono di ridurre il volume dei dati a un sottoinsieme più piccolo, in questo caso, solo i primi 10 ordini per impostazione predefinita:</span><span class="sxs-lookup"><span data-stu-id="95a30-308">The `limit` and `offset` parameters are intended to reduce the volume of data to a smaller subset, in this case only the first 10 orders by default:</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    [Route("api/orders")]
    [HttpGet]
    public IEnumerable<Order> GetAllOrders(int limit=10, int offset=0)
    {
        // Find the number of orders specified by the limit parameter
        // starting with the order specified by the offset parameter
        var orders = ...
        return orders;
    }
    ...
}
```

<span data-ttu-id="95a30-309">Un'applicazione client può inviare una richiesta per recuperare 30 ordini a partire dall'offset 50 usando l'URI `http://www.adventure-works.com/api/orders?limit=30&offset=50`.</span><span class="sxs-lookup"><span data-stu-id="95a30-309">A client application can issue a request to retrieve 30 orders starting at offset 50 by using the URI `http://www.adventure-works.com/api/orders?limit=30&offset=50`.</span></span>

> [!TIP]
> <span data-ttu-id="95a30-310">Evitare di abilitare le applicazioni client per specificare le stringhe di query che generano un URI con più di 2000 caratteri.</span><span class="sxs-lookup"><span data-stu-id="95a30-310">Avoid enabling client applications to specify query strings that result in a URI that is more than 2000 characters long.</span></span> <span data-ttu-id="95a30-311">Molti client Web e server non possono gestire URI di questa lunghezza.</span><span class="sxs-lookup"><span data-stu-id="95a30-311">Many web clients and servers cannot handle URIs that are this long.</span></span>
>
>

## <a name="maintaining-responsiveness-scalability-and-availability"></a><span data-ttu-id="95a30-312">Gestione di velocità di risposta, scalabilità e disponibilità</span><span class="sxs-lookup"><span data-stu-id="95a30-312">Maintaining responsiveness, scalability, and availability</span></span>
<span data-ttu-id="95a30-313">La stessa API Web può essere utilizzata da numerose applicazioni client in esecuzione ovunque nel mondo.</span><span class="sxs-lookup"><span data-stu-id="95a30-313">The same web API might be utilized by many client applications running anywhere in the world.</span></span> <span data-ttu-id="95a30-314">È importante assicurarsi che l'API Web sia implementata per mantenere la velocità di risposta con un carico pesante, per essere scalabile per supportare un carico di lavoro estremamente variabile e per garantire la disponibilità per i client che eseguono operazioni critiche.</span><span class="sxs-lookup"><span data-stu-id="95a30-314">It is important to ensure that the web API is implemented to maintain responsiveness under a heavy load, to be scalable to support a highly varying workload, and to guarantee availability for clients that perform business-critical operations.</span></span> <span data-ttu-id="95a30-315">Per determinare le modalità per soddisfare tali requisiti, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="95a30-315">Consider the following points when determining how to meet these requirements:</span></span>

### <a name="provide-asynchronous-support-for-long-running-requests"></a><span data-ttu-id="95a30-316">Offrire supporto asincrono per le richieste a esecuzione prolungata</span><span class="sxs-lookup"><span data-stu-id="95a30-316">Provide asynchronous support for long-running requests</span></span>

<span data-ttu-id="95a30-317">Una richiesta che potrebbe richiedere molto tempo per l'elaborazione deve essere eseguita senza bloccare il client che ha inviato tale richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-317">A request that might take a long time to process should be performed without blocking the client that submitted the request.</span></span> <span data-ttu-id="95a30-318">L'API Web può eseguire un controllo iniziale per convalidare la richiesta, avviare un'attività separata per eseguire il lavoro e quindi restituire un messaggio di risposta con codice HTTP 202 (Accettato).</span><span class="sxs-lookup"><span data-stu-id="95a30-318">The web API can perform some initial checking to validate the request, initiate a separate task to perform the work, and then return a response message with HTTP code 202 (Accepted).</span></span> <span data-ttu-id="95a30-319">È possibile eseguire l'attività in modo asincrono come parte dell'elaborazione dell'API Web oppure è possibile scaricarla in un'attività in background.</span><span class="sxs-lookup"><span data-stu-id="95a30-319">The task could run asynchronously as part of the web API processing, or it could be offloaded to a background task.</span></span>

<span data-ttu-id="95a30-320">L'API Web deve inoltre fornire un meccanismo per restituire i risultati dell'elaborazione all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="95a30-320">The web API should also provide a mechanism to return the results of the processing to the client application.</span></span> <span data-ttu-id="95a30-321">È possibile ottenere questo risultato, fornendo un meccanismo di polling per le applicazioni client per chiedere periodicamente se l'elaborazione è terminata e ottenere il risultato o l'abilitazione di un’Api Web per inviare una notifica quando l'operazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="95a30-321">You can achieve this by providing a polling mechanism for client applications to periodically query whether the processing has finished and obtain the result, or enabling the web API to send a notification when the operation has completed.</span></span>

<span data-ttu-id="95a30-322">È possibile implementare un semplice meccanismo di polling, fornendo un URI di *polling* che funge da risorsa virtuale con l'approccio seguente:</span><span class="sxs-lookup"><span data-stu-id="95a30-322">You can implement a simple polling mechanism by providing a *polling* URI that acts as a virtual resource using the following approach:</span></span>

1. <span data-ttu-id="95a30-323">L'applicazione client invia la richiesta iniziale all'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-323">The client application sends the initial request to the web API.</span></span>
2. <span data-ttu-id="95a30-324">L'API Web archivia informazioni sulla richiesta in una tabella conservata nell'archiviazione tabella o nella Cache di Microsoft Azure e genera una chiave univoca per questa voce, possibilmente in forma di GUID.</span><span class="sxs-lookup"><span data-stu-id="95a30-324">The web API stores information about the request in a table held in table storage or Microsoft Azure Cache, and generates a unique key for this entry, possibly in the form of a GUID.</span></span>
3. <span data-ttu-id="95a30-325">L'API Web avvia l'elaborazione come un'attività separata.</span><span class="sxs-lookup"><span data-stu-id="95a30-325">The web API initiates the processing as a separate task.</span></span> <span data-ttu-id="95a30-326">L'API web registra lo stato dell'attività nella tabella come *In esecuzione*.</span><span class="sxs-lookup"><span data-stu-id="95a30-326">The web API records the state of the task in the table as *Running*.</span></span>
4. <span data-ttu-id="95a30-327">L'API Web restituisce un messaggio di risposta con codice di stato HTTP 202 (Accettato) e il GUID della voce della tabella nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="95a30-327">The web API returns a response message with HTTP status code 202 (Accepted), and the GUID of the table entry in the body of the message.</span></span>
5. <span data-ttu-id="95a30-328">Al termine dell'attività, l'API Web archivia i risultati nella tabella e imposta lo stato dell'attività su *Operazione completata*.</span><span class="sxs-lookup"><span data-stu-id="95a30-328">When the task has completed, the web API stores the results in the table, and sets the state of the task to *Complete*.</span></span> <span data-ttu-id="95a30-329">Si noti che se l'attività ha esito negativo, l'API Web può archiviare le informazioni sull'errore e impostare lo stato su *Operazione non riuscita*.</span><span class="sxs-lookup"><span data-stu-id="95a30-329">Note that if the task fails, the web API could also store information about the failure and set the status to *Failed*.</span></span>
6. <span data-ttu-id="95a30-330">Mentre l'attività è in esecuzione, il client può continuare a eseguire la propria elaborazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-330">While the task is running, the client can continue performing its own processing.</span></span> <span data-ttu-id="95a30-331">Periodicamente può inviare una richiesta all'URI */polling/{guid}* dove *{guid}* è il GUID restituito dall'API Web nel messaggio di risposta 202.</span><span class="sxs-lookup"><span data-stu-id="95a30-331">It can periodically send a request to the URI */polling/{guid}* where *{guid}* is the GUID returned in the 202 response message by the web API.</span></span>
7. <span data-ttu-id="95a30-332">L'API Web nell'URI */polling/{guid}* esegue query sullo stato dell'attività corrispondente nella tabella e restituisce un messaggio di risposta con codice di stato HTTP 200 (OK) che contiene lo stato *In esecuzione*, *Operazione completata* oppure *Operazione non riuscita*.</span><span class="sxs-lookup"><span data-stu-id="95a30-332">The web API at the */polling/{guid}* URI queries the state of the corresponding task in the table and returns a response message with HTTP status code 200 (OK) containing this state (*Running*, *Complete*, or *Failed*).</span></span> <span data-ttu-id="95a30-333">Se l'attività è stata completato o ha avuto esito negativo, il messaggio di risposta può includere anche i risultati dell'elaborazione oppure le informazioni disponibili relative al motivo dell'esito negativo.</span><span class="sxs-lookup"><span data-stu-id="95a30-333">If the task has completed or failed, the response message can also include the results of the processing or any information available about the reason for the failure.</span></span>

<span data-ttu-id="95a30-334">Le opzioni per l'implementazione delle notifiche includono:</span><span class="sxs-lookup"><span data-stu-id="95a30-334">Options for implementing notifications include:</span></span>

- <span data-ttu-id="95a30-335">Utilizzo di un Hub di notifica di Azure per spingere le risposte asincrone alle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="95a30-335">Using an Azure Notification Hub to push asynchronous responses to client applications.</span></span> <span data-ttu-id="95a30-336">Per altre informazioni, vedere [Hub di notifica di Azure per inviare notifiche agli utenti](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/).</span><span class="sxs-lookup"><span data-stu-id="95a30-336">For more information, see [Azure Notification Hubs Notify Users](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/).</span></span>
- <span data-ttu-id="95a30-337">L’utilizzo del modello Comet per mantenere una connessione di rete permanente tra il client e server che ospita l'API Web e l’utilizzo di questa connessione per spingere i messaggi dal server fino al client.</span><span class="sxs-lookup"><span data-stu-id="95a30-337">Using the Comet model to retain a persistent network connection between the client and the server hosting the web API, and using this connection to push messages from the server back to the client.</span></span> <span data-ttu-id="95a30-338">L'articolo di MSDN Magazine [Creazione di una semplice applicazione Comet in Microsoft .NET Framework](https://msdn.microsoft.com/magazine/jj891053.aspx) descrive una soluzione di esempio.</span><span class="sxs-lookup"><span data-stu-id="95a30-338">The MSDN magazine article [Building a Simple Comet Application in the Microsoft .NET Framework](https://msdn.microsoft.com/magazine/jj891053.aspx) describes an example solution.</span></span>
- <span data-ttu-id="95a30-339">L’utilizzo di SignalR per spingere i dati in tempo reale dal server Web al client su una connessione di rete permanente.</span><span class="sxs-lookup"><span data-stu-id="95a30-339">Using SignalR to push data in real-time from the web server to the client over a persistent network connection.</span></span> <span data-ttu-id="95a30-340">SignalR è disponibile per le applicazioni Web ASP.NET come pacchetto NuGet.</span><span class="sxs-lookup"><span data-stu-id="95a30-340">SignalR is available for ASP.NET web applications as a NuGet package.</span></span> <span data-ttu-id="95a30-341">È possibile trovare ulteriori informazioni sul sito Web [ASP.NET SignalR](http://signalr.net/) .</span><span class="sxs-lookup"><span data-stu-id="95a30-341">You can find more information on the [ASP.NET SignalR](http://signalr.net/) website.</span></span>

### <a name="ensure-that-each-request-is-stateless"></a><span data-ttu-id="95a30-342">Assicurarsi che ogni richiesta sia senza stato</span><span class="sxs-lookup"><span data-stu-id="95a30-342">Ensure that each request is stateless</span></span>

<span data-ttu-id="95a30-343">Ogni richiesta deve essere considerata atomica.</span><span class="sxs-lookup"><span data-stu-id="95a30-343">Each request should be considered atomic.</span></span> <span data-ttu-id="95a30-344">Non deve esistere alcuna dipendenza tra una richiesta effettuata da un'applicazione client e le successive richieste inviate dal client stesso.</span><span class="sxs-lookup"><span data-stu-id="95a30-344">There should be no dependencies between one request made by a client application and any subsequent requests submitted by the same client.</span></span> <span data-ttu-id="95a30-345">Questo approccio semplifica la scalabilità; le istanze del servizio Web possono essere distribuite su un certo numero di server.</span><span class="sxs-lookup"><span data-stu-id="95a30-345">This approach assists in scalability; instances of the web service can be deployed on a number of servers.</span></span> <span data-ttu-id="95a30-346">Le richieste client possono essere indirizzate a una qualsiasi istanza e i risultati devono rimanere invariati.</span><span class="sxs-lookup"><span data-stu-id="95a30-346">Client requests can be directed at any of these instances and the results should always be the same.</span></span> <span data-ttu-id="95a30-347">Inoltre, migliora la disponibilità: se un server Web smette di funzionare, le richieste possono essere indirizzate a un'altra istanza, tramite la Gestione traffico di Azure, mentre il server viene riavviato senza effetti negativi sulle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="95a30-347">It also improves availability for a similar reason; if a web server fails requests can be routed to another instance (by using Azure Traffic Manager) while the server is restarted with no ill effects on client applications.</span></span>

### <a name="track-clients-and-implement-throttling-to-reduce-the-chances-of-dos-attacks"></a><span data-ttu-id="95a30-348">Tenere traccia dei client e implementare la limitazione per ridurre il rischio di attacchi DOS</span><span class="sxs-lookup"><span data-stu-id="95a30-348">Track clients and implement throttling to reduce the chances of DOS attacks</span></span>

<span data-ttu-id="95a30-349">Se un client specifico esegue un numero elevato di richieste entro un determinato periodo di tempo potrebbe monopolizzare il servizio e influire sulle prestazioni degli altri client.</span><span class="sxs-lookup"><span data-stu-id="95a30-349">If a specific client makes a large number of requests within a given period of time it might monopolize the service and affect the performance of other clients.</span></span> <span data-ttu-id="95a30-350">Per evitare questo problema, un'API Web può monitorare le chiamate dalle applicazioni client o registrando l'indirizzo IP di tutte le richieste in ingresso, o registrando ogni accesso autenticato.</span><span class="sxs-lookup"><span data-stu-id="95a30-350">To mitigate this issue, a web API can monitor calls from client applications either by tracking the IP address of all incoming requests or by logging each authenticated access.</span></span> <span data-ttu-id="95a30-351">È possibile utilizzare queste informazioni per limitare l'accesso alle risorse.</span><span class="sxs-lookup"><span data-stu-id="95a30-351">You can use this information to limit resource access.</span></span> <span data-ttu-id="95a30-352">Se un client supera un limite definito, l'API Web può restituire un messaggio di risposta con stato 503 (Servizio non disponibile) e può includere un'intestazione Retry-After che specifica quando il client può inviare la richiesta successiva senza che questa venga rifiutata.</span><span class="sxs-lookup"><span data-stu-id="95a30-352">If a client exceeds a defined limit, the web API can return a response message with status 503 (Service Unavailable) and include a Retry-After header that specifies when the client can send the next request without it being declined.</span></span> <span data-ttu-id="95a30-353">Questa strategia può contribuire a ridurre le probabilità di un attacco Denial Of Service (DOS) da un set di client che provocano l’arresto del sistema.</span><span class="sxs-lookup"><span data-stu-id="95a30-353">This strategy can help to reduce the chances of a Denial Of Service (DOS) attack from a set of clients stalling the system.</span></span>

### <a name="manage-persistent-http-connections-carefully"></a><span data-ttu-id="95a30-354">Gestire attentamente le connessioni HTTP permanenti</span><span class="sxs-lookup"><span data-stu-id="95a30-354">Manage persistent HTTP connections carefully</span></span>

<span data-ttu-id="95a30-355">Il protocollo HTTP supporta le connessioni HTTP permanenti dove sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="95a30-355">The HTTP protocol supports persistent HTTP connections where they are available.</span></span> <span data-ttu-id="95a30-356">Le specifiche HTTP 1.0 hanno aggiunto l’intestazione: Connection: Keep-Alive che consente a un'applicazione client di indicare al server che è possibile utilizzare la stessa connessione per inviare le richieste successive, anziché aprire nuove connessioni.</span><span class="sxs-lookup"><span data-stu-id="95a30-356">The HTTP 1.0 specificiation added the Connection:Keep-Alive header that enables a client application to indicate to the server that it can use the same connection to send subsequent requests rather than opening new ones.</span></span> <span data-ttu-id="95a30-357">La connessione verrà chiusa automaticamente se il client non riutilizzare la connessione all'interno di un periodo definito dall'host.</span><span class="sxs-lookup"><span data-stu-id="95a30-357">The connection closes automatically if the client does not reuse the connection within a period defined by the host.</span></span> <span data-ttu-id="95a30-358">Questo comportamento è l'impostazione predefinita in HTTP 1.1 come utilizzato dai servizi di Azure, pertanto non è necessario includere le intestazioni Keep-Alive nei messaggi.</span><span class="sxs-lookup"><span data-stu-id="95a30-358">This behavior is the default in HTTP 1.1 as used by Azure services, so there is no need to include Keep-Alive headers in messages.</span></span>

<span data-ttu-id="95a30-359">Mantenere aperta una connessione può contribuire a migliorare la velocità di risposta riducendo la latenza e la congestione della rete, ma può avere effetti negativi sulla scalabilità, mantenendo aperte connessioni inutili più a lungo del necessario e limitando la possibilità di connessione ad altri client simultanei.</span><span class="sxs-lookup"><span data-stu-id="95a30-359">Keeping a connection open can help to improve responsiveness by reducing latency and network congestion, but it can be detrimental to scalability by keeping unnecessary connections open for longer than required, limiting the ability of other concurrent clients to connect.</span></span> <span data-ttu-id="95a30-360">Può anche influire sulla durata della batteria se l'applicazione client è in esecuzione su un dispositivo mobile. Se l'applicazione effettua solo occasionali richieste al server, la gestione di una connessione aperta può scaricare più velocemente la batteria.</span><span class="sxs-lookup"><span data-stu-id="95a30-360">It can also affect battery life if the client application is running on a mobile device; if the application only makes occasional requests to the server, maintaining an open connection can cause the battery to drain more quickly.</span></span> <span data-ttu-id="95a30-361">Per garantire che una connessione non venga resa persistente con HTTP 1.1, il client può includere un'intestazione Connection:Close con i messaggi per eseguire l'override del comportamento predefinito.</span><span class="sxs-lookup"><span data-stu-id="95a30-361">To ensure that a connection is not made persistent with HTTP 1.1, the client can include a Connection:Close header with messages to override the default behavior.</span></span> <span data-ttu-id="95a30-362">Analogamente, se un server gestisce un numero molto elevato di client può includere un'intestazione di  Connection:Close nei messaggi di risposta che devono chiudere la connessione e salvare le risorse del server.</span><span class="sxs-lookup"><span data-stu-id="95a30-362">Similarly, if a server is handling a very large number of clients it can include a Connection:Close header in response messages which should close the connection and save server resources.</span></span>

> [!NOTE]
> <span data-ttu-id="95a30-363">Le connessioni HTTP permanenti sono una funzionalità facoltativa esclusivamente per ridurre il sovraccarico di rete associato al tentativo di stabilire ripetutamente un canale di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-363">Persistent HTTP connections are a purely optional feature to reduce the network overhead associated with repeatedly establishing a communications channel.</span></span> <span data-ttu-id="95a30-364">Né L'API Web né l'applicazione client devono dipendere da una connessione HTTP permanente disponibile.</span><span class="sxs-lookup"><span data-stu-id="95a30-364">Neither the web API nor the client application should depend on a persistent HTTP connection being available.</span></span> <span data-ttu-id="95a30-365">Non utilizzare connessioni HTTP permanenti per implementare sistemi di notifica Comet stile; è invece consigliabile utilizzare Socket (o WebSocket, se disponibile) a livello di TCP.</span><span class="sxs-lookup"><span data-stu-id="95a30-365">Do not use persistent HTTP connections to implement Comet-style notification systems; instead you should utilize sockets (or websockets if available) at the TCP layer.</span></span> <span data-ttu-id="95a30-366">Si noti infine che le intestazioni Keep-Alive hanno un utilizzo limitato se un'applicazione client comunica con un server tramite un proxy. Solo la connessione con il client e il proxy è permanente.</span><span class="sxs-lookup"><span data-stu-id="95a30-366">Finally, note Keep-Alive headers are of limited use if a client application communicates with a server via a proxy; only the connection with the client and the proxy will be persistent.</span></span>
>
>

## <a name="publishing-and-managing-a-web-api"></a><span data-ttu-id="95a30-367">Pubblicazione e gestione di un'API Web</span><span class="sxs-lookup"><span data-stu-id="95a30-367">Publishing and managing a web API</span></span>
<span data-ttu-id="95a30-368">Per rendere disponibile un’API Web per le applicazioni client, l'API Web deve essere distribuito in un ambiente host.</span><span class="sxs-lookup"><span data-stu-id="95a30-368">To make a web API available for client applications, the web API must be deployed to a host environment.</span></span> <span data-ttu-id="95a30-369">Questo ambiente è in genere un server Web, sebbene possa essere un altro tipo di processo host.</span><span class="sxs-lookup"><span data-stu-id="95a30-369">This environment is typically a web server, although it may be some other type of host process.</span></span> <span data-ttu-id="95a30-370">Quando si pubblica un'API Web, è necessario considerare quanto riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="95a30-370">You should consider the following points when publishing a web API:</span></span>

* <span data-ttu-id="95a30-371">Tutte le richieste devono essere autenticate e autorizzate e deve essere applicato il livello di controllo di accesso appropriato.</span><span class="sxs-lookup"><span data-stu-id="95a30-371">All requests must be authenticated and authorized, and the appropriate level of access control must be enforced.</span></span>
* <span data-ttu-id="95a30-372">Un'API web commerciale potrebbe essere soggetta a vari garanzie di qualità relativamente ai tempi di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-372">A commercial web API might be subject to various quality guarantees concerning response times.</span></span> <span data-ttu-id="95a30-373">È importante assicurarsi che l'ambiente host sia scalabile se il carico può variare in modo significativo nel corso del tempo.</span><span class="sxs-lookup"><span data-stu-id="95a30-373">It is important to ensure that host environment is scalable if the load can vary significantly over time.</span></span>
* <span data-ttu-id="95a30-374">Potrebbe essere necessario controllare le richieste per scopi di monetizzazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-374">It may be necessary to meter requests for monetization purposes.</span></span>
* <span data-ttu-id="95a30-375">Potrebbe essere necessario regolare il flusso del traffico all'API Web e implementare la limitazione delle richieste per i client specifici che hanno esaurito le loro quote.</span><span class="sxs-lookup"><span data-stu-id="95a30-375">It might be necessary to regulate the flow of traffic to the web API, and implement throttling for specific clients that have exhausted their quotas.</span></span>
* <span data-ttu-id="95a30-376">Requisiti normativi potrebbero imporre la registrazione e il controllo di tutte le richieste e risposte.</span><span class="sxs-lookup"><span data-stu-id="95a30-376">Regulatory requirements might mandate logging and auditing of all requests and responses.</span></span>
* <span data-ttu-id="95a30-377">Per garantire la disponibilità, è necessario monitorare l'integrità del server che ospita l'API Web e riavviare se necessario.</span><span class="sxs-lookup"><span data-stu-id="95a30-377">To ensure availability, it may be necessary to monitor the health of the server hosting the web API and restart it if necessary.</span></span>

<span data-ttu-id="95a30-378">È utile essere in grado di separare questi problemi dai problemi tecnici riguardanti l'implementazione dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-378">It is useful to be able to decouple these issues from the technical issues concerning the implementation of the web API.</span></span> <span data-ttu-id="95a30-379">Per questo motivo, è consigliabile creare un’ [interfaccia](http://en.wikipedia.org/wiki/Facade_pattern), in esecuzione come un processo separato e che indirizzi le richieste all’API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-379">For this reason, consider creating a [façade](http://en.wikipedia.org/wiki/Facade_pattern), running as a separate process and that routes requests to the web API.</span></span> <span data-ttu-id="95a30-380">L’interfaccia può fornire le operazioni di gestione e inoltrare le richieste convalidate all'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-380">The façade can provide the management operations and forward validated requests to the web API.</span></span> <span data-ttu-id="95a30-381">Utilizzare un’interfaccia può portare inoltre molti vantaggi funzionali, tra cui:</span><span class="sxs-lookup"><span data-stu-id="95a30-381">Using a façade can also bring many functional advantages, including:</span></span>

* <span data-ttu-id="95a30-382">Agire come un punto di integrazione per più API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-382">Acting as an integration point for multiple web APIs.</span></span>
* <span data-ttu-id="95a30-383">Trasformare i messaggi e convertire i protocolli di comunicazione per i client creati utilizzando diverse tecnologie.</span><span class="sxs-lookup"><span data-stu-id="95a30-383">Transforming messages and translating communications protocols for clients built by using varying technologies.</span></span>
* <span data-ttu-id="95a30-384">Memorizzare nella cache richieste e risposte per ridurre il carico sul server che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-384">Caching requests and responses to reduce load on the server hosting the web API.</span></span>

## <a name="testing-a-web-api"></a><span data-ttu-id="95a30-385">Test di un'API Web</span><span class="sxs-lookup"><span data-stu-id="95a30-385">Testing a web API</span></span>
<span data-ttu-id="95a30-386">Un'API Web deve essere testata accuratamente come qualsiasi altro elemento del software.</span><span class="sxs-lookup"><span data-stu-id="95a30-386">A web API should be tested as thoroughly as any other piece of software.</span></span> <span data-ttu-id="95a30-387">È necessario considerare la creazione di unit test per convalidarne la funzionalità. La natura di un'API Web comporta requisiti aggiuntivi che ne verificano il corretto funzionamento.</span><span class="sxs-lookup"><span data-stu-id="95a30-387">You should consider creating unit tests to validate the functionality of The nature of a web API brings its own additional requirements to verify that it operates correctly.</span></span> <span data-ttu-id="95a30-388">È necessario prestare particolare attenzione ai seguenti aspetti:</span><span class="sxs-lookup"><span data-stu-id="95a30-388">You should pay particular attention to the following aspects:</span></span>

* <span data-ttu-id="95a30-389">Testare tutte le route per verificare che richiamino le operazioni corrette.</span><span class="sxs-lookup"><span data-stu-id="95a30-389">Test all routes to verify that they invoke the correct operations.</span></span> <span data-ttu-id="95a30-390">Fare particolare attenzione se il codice di stato HTTP 405 (Metodo non consentito) viene restituito in modo imprevisto, poiché questo può indicare una mancata corrispondenza tra una route e i metodi HTTP (GET, POST, PUT, DELETE) che possono essere indirizzati a tale route.</span><span class="sxs-lookup"><span data-stu-id="95a30-390">Be especially aware of HTTP status code 405 (Method Not Allowed) being returned unexpectedly as this can indicate a mismatch between a route and the HTTP methods (GET, POST, PUT, DELETE) that can be dispatched to that route.</span></span>

    <span data-ttu-id="95a30-391">Inviare richieste HTTP alla route che non le supporta, ad esempio inviare una richiesta POST a una risorsa specifica (le richieste POST devono essere inviate solo alle raccolte di risorse).</span><span class="sxs-lookup"><span data-stu-id="95a30-391">Send HTTP requests to routes that do not support them, such as submitting a POST request to a specific resource (POST requests should only be sent to resource collections).</span></span> <span data-ttu-id="95a30-392">In questi casi, l'unica risposta valida *deve* essere il codice di stato 405 (non consentito).</span><span class="sxs-lookup"><span data-stu-id="95a30-392">In these cases, the only valid response *should* be status code 405 (Not Allowed).</span></span>
* <span data-ttu-id="95a30-393">Verificare che tutte le route siano protette correttamente e siano soggette ai controlli di autenticazione e autorizzazione appropriati.</span><span class="sxs-lookup"><span data-stu-id="95a30-393">Verify that all routes are protected properly and are subject to the appropriate authentication and authorization checks.</span></span>

  > [!NOTE]
  > <span data-ttu-id="95a30-394">Alcuni aspetti della sicurezza, ad esempio l'autenticazione degli utenti, sono molto probabilmente responsabilità dell'ambiente host anziché dell'API Web, ma è comunque necessario includere test di sicurezza come parte del processo di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="95a30-394">Some aspects of security such as user authentication are most likely to be the responsibility of the host environment rather than the web API, but it is still necessary to include security tests as part of the deployment process.</span></span>
  >
  >
* <span data-ttu-id="95a30-395">Testare la gestione delle eccezioni eseguite da ogni operazione e verificare che una risposta HTTP appropriata e significativa sia passata all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="95a30-395">Test the exception handling performed by each operation and verify that an appropriate and meaningful HTTP response is passed back to the client application.</span></span>
* <span data-ttu-id="95a30-396">Verificare che i messaggi di richiesta e risposta siano ben formati.</span><span class="sxs-lookup"><span data-stu-id="95a30-396">Verify that request and response messages are well-formed.</span></span> <span data-ttu-id="95a30-397">Ad esempio, se una richiesta POST HTTP contiene i dati per una nuova risorsa nel formato x-www-form-urlencoded, verificare che l'operazione corrispondente analizzi correttamente i dati, crei le risorse e restituisca una risposta contenente i dettagli della nuova risorsa, compresa l'intestazione del percorso corretto.</span><span class="sxs-lookup"><span data-stu-id="95a30-397">For example, if an HTTP POST request contains the data for a new resource in x-www-form-urlencoded format, confirm that the corresponding operation correctly parses the data, creates the resources, and returns a response containing the details of the new resource, including the correct Location header.</span></span>
* <span data-ttu-id="95a30-398">Verificare tutti i collegamenti e gli URI nei messaggi di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-398">Verify all links and URIs in response messages.</span></span> <span data-ttu-id="95a30-399">Ad esempio, un messaggio POST HTTP deve restituire l'URI della risorsa appena creata.</span><span class="sxs-lookup"><span data-stu-id="95a30-399">For example, an HTTP POST message should return the URI of the newly-created resource.</span></span> <span data-ttu-id="95a30-400">Tutti i collegamenti HATEOAS devono essere validi.</span><span class="sxs-lookup"><span data-stu-id="95a30-400">All HATEOAS links should be valid.</span></span>

* <span data-ttu-id="95a30-401">Assicurarsi che ogni operazione restituisca i codici di stato corretti per diverse combinazioni di input.</span><span class="sxs-lookup"><span data-stu-id="95a30-401">Ensure that each operation returns the correct status codes for different combinations of input.</span></span> <span data-ttu-id="95a30-402">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="95a30-402">For example:</span></span>

  * <span data-ttu-id="95a30-403">Se una query ha esito positivo, deve restituire il codice di stato 200 (OK)</span><span class="sxs-lookup"><span data-stu-id="95a30-403">If a query is successful, it should return status code 200 (OK)</span></span>
  * <span data-ttu-id="95a30-404">Se una risorsa non viene trovata, l'operazione deve restituire il codice di stato HTTP 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="95a30-404">If a resource is not found, the operation should return HTTP status code 404 (Not Found).</span></span>
  * <span data-ttu-id="95a30-405">Se il client invia una richiesta che consente di eliminare una risorsa, il codice di stato deve essere 204 (Nessun contenuto).</span><span class="sxs-lookup"><span data-stu-id="95a30-405">If the client sends a request that successfully deletes a resource, the status code should be 204 (No Content).</span></span>
  * <span data-ttu-id="95a30-406">Se il client invia una richiesta che crea una nuova risorsa, il codice di stato deve essere 201 (Creato).</span><span class="sxs-lookup"><span data-stu-id="95a30-406">If the client sends a request that creates a new resource, the status code should be 201 (Created)</span></span>

<span data-ttu-id="95a30-407">Fare attenzione alle risposte non previste per i codici di stato compresi nell'intervallo 5xx.</span><span class="sxs-lookup"><span data-stu-id="95a30-407">Watch out for unexpected response status codes in the 5xx range.</span></span> <span data-ttu-id="95a30-408">Questi messaggi vengono in genere segnalati dal server host per indicare che non è riuscito a soddisfare una richiesta valida.</span><span class="sxs-lookup"><span data-stu-id="95a30-408">These messages are usually reported by the host server to indicate that it was unable to fulfill a valid request.</span></span>

* <span data-ttu-id="95a30-409">Testare le diverse combinazioni di richiesta di intestazione che un'applicazione client può specificare e assicurarsi che l'API Web restituisca le informazioni previste nei messaggi di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-409">Test the different request header combinations that a client application can specify and ensure that the web API returns the expected information in response messages.</span></span>
* <span data-ttu-id="95a30-410">Testare le stringhe di query.</span><span class="sxs-lookup"><span data-stu-id="95a30-410">Test query strings.</span></span> <span data-ttu-id="95a30-411">Se un'operazione può richiedere parametri facoltativi (ad esempio richieste di impaginazione), testare le diverse combinazioni e l'ordine dei parametri.</span><span class="sxs-lookup"><span data-stu-id="95a30-411">If an operation can take optional parameters (such as pagination requests), test the different combinations and order of parameters.</span></span>
* <span data-ttu-id="95a30-412">Verificare che le operazioni asincrone siano state completate correttamente.</span><span class="sxs-lookup"><span data-stu-id="95a30-412">Verify that asynchronous operations complete successfully.</span></span> <span data-ttu-id="95a30-413">Se l'API Web supporta il flusso per le richieste che restituiscono oggetti binari di grandi dimensioni (come video o audio), assicurarsi che le richieste client non siano bloccate durante il trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-413">If the web API supports streaming for requests that return large binary objects (such as video or audio), ensure that client requests are not blocked while the data is streamed.</span></span> <span data-ttu-id="95a30-414">Se l'API Web implementa il polling per operazioni di modifica dei dati a esecuzione prolungata, verificare che le operazioni riportino il proprio stato correttamente durante l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="95a30-414">If the web API implements polling for long-running data modification operations, verify that that the operations report their status correctly as they proceed.</span></span>

<span data-ttu-id="95a30-415">È necessario creare ed eseguire test delle prestazioni per verificare che l'API Web funzioni in modo soddisfacente sotto costrizione.</span><span class="sxs-lookup"><span data-stu-id="95a30-415">You should also create and run performance tests to check that the web API operates satisfactorily under duress.</span></span> <span data-ttu-id="95a30-416">È possibile creare un progetto di test di carico e delle prestazioni web utilizzando Visual Studio Ultimate.</span><span class="sxs-lookup"><span data-stu-id="95a30-416">You can build a web performance and load test project by using Visual Studio Ultimate.</span></span> <span data-ttu-id="95a30-417">Per altre informazioni, vedere [Eseguire test delle prestazioni su un'applicazione prima del suo rilascio](https://msdn.microsoft.com/library/dn250793.aspx).</span><span class="sxs-lookup"><span data-stu-id="95a30-417">For more information, see [Run performance tests on an application before a release](https://msdn.microsoft.com/library/dn250793.aspx).</span></span>

## <a name="using-azure-api-management"></a><span data-ttu-id="95a30-418">Uso di Gestione API di Azure</span><span class="sxs-lookup"><span data-stu-id="95a30-418">Using Azure API Management</span></span> 

<span data-ttu-id="95a30-419">In Azure valutare la possibilità di usare [Gestione API di Azure](https://azure.microsoft.com/documentation/services/api-management/) per pubblicare e gestire un'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-419">On Azure, consider using [Azue API Management](https://azure.microsoft.com/documentation/services/api-management/) to publish and manage a web API.</span></span> <span data-ttu-id="95a30-420">Questa funzionalità consente di generare un servizio che funge da interfaccia per una o più API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-420">Using this facility, you can generate a service that acts as a façade for one or more web APIs.</span></span> <span data-ttu-id="95a30-421">Il servizio è a sua volta un servizio Web scalabile che è possibile creare e configurare tramite il portale di gestione di Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-421">The service is itself a scalable web service that you can create and configure by using the Azure Management portal.</span></span> <span data-ttu-id="95a30-422">È possibile utilizzare questo servizio per pubblicare e gestire un'API Web come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="95a30-422">You can use this service to publish and manage a web API as follows:</span></span>

1. <span data-ttu-id="95a30-423">Distribuire l'API Web su un sito Web, un servizio cloud di Azure o una macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-423">Deploy the web API to a website, Azure cloud service, or Azure virtual machine.</span></span>
2. <span data-ttu-id="95a30-424">Connettere il Servizio di gestione API all'API web.</span><span class="sxs-lookup"><span data-stu-id="95a30-424">Connect the API management service to the web API.</span></span> <span data-ttu-id="95a30-425">Le richieste inviate all'URL della gestione API vengono associate agli URI nell'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-425">Requests sent to the URL of the management API are mapped to URIs in the web API.</span></span> <span data-ttu-id="95a30-426">Lo stesso Servizio di gestione API può indirizzare le richieste a più API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-426">The same API management service can route requests to more than one web API.</span></span> <span data-ttu-id="95a30-427">Questo consente di aggregare più API Web in un servizio di gestione singolo.</span><span class="sxs-lookup"><span data-stu-id="95a30-427">This enables you to aggregate multiple web APIs into a single management service.</span></span> <span data-ttu-id="95a30-428">Allo stesso modo, alla stessa API Web può fare riferimento più di un Servizio di gestione API se è necessario limitare o partizionare le funzionalità disponibili per applicazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="95a30-428">Similarly, the same web API can be referenced from more than one API management service if you need to restrict or partition the functionality available to different applications.</span></span>

   > [!NOTE]
   > <span data-ttu-id="95a30-429">Gli URI nei collegamenti HATEOAS generati come parte della risposta per le richieste HTTP GET devono fare riferimento all'URL del Servizio di gestione API e non al server Web che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-429">The URIs in HATEOAS links generated as part of the response for HTTP GET requests should reference the URL of the API management service and not the web server hosting the web API.</span></span>
   >
   >
3. <span data-ttu-id="95a30-430">Per ogni API Web, specificare le operazioni HTTP che espone l'API Web insieme a eventuali parametri facoltativi che un'operazione può accettare come input.</span><span class="sxs-lookup"><span data-stu-id="95a30-430">For each web API, specify the HTTP operations that the web API exposes together with any optional parameters that an operation can take as input.</span></span> <span data-ttu-id="95a30-431">È inoltre possibile configurare se il Servizio di gestione API deve memorizzare nella cache la risposta ricevuta dall'API Web per ottimizzare le richieste ripetute per gli stessi dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-431">You can also configure whether the API management service should cache the response received from the web API to optimize repeated requests for the same data.</span></span> <span data-ttu-id="95a30-432">Registrare i dettagli di ogni risposta HTTP che ogni operazione può generare.</span><span class="sxs-lookup"><span data-stu-id="95a30-432">Record the details of the HTTP responses that each operation can generate.</span></span> <span data-ttu-id="95a30-433">Queste informazioni vengono utilizzate per generare la documentazione per gli sviluppatori, pertanto è importante che siano accurate e complete.</span><span class="sxs-lookup"><span data-stu-id="95a30-433">This information is used to generate documentation for developers, so it is important that it is accurate and complete.</span></span>

   <span data-ttu-id="95a30-434">È possibile definire le operazioni manualmente mediante le procedure guidate disponibili nel portale di gestione di Azure o è possibile importarle da un file contenente le definizioni in formato WADL o Swagger.</span><span class="sxs-lookup"><span data-stu-id="95a30-434">You can either define operations manually using the wizards provided by the Azure Management portal, or you can import them from a file containing the definitions in WADL or Swagger format.</span></span>
4. <span data-ttu-id="95a30-435">Configurare le impostazioni di sicurezza per le comunicazioni tra il Servizio di gestione API e il server Web che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-435">Configure the security settings for communications between the API management service and the web server hosting the web API.</span></span> <span data-ttu-id="95a30-436">Il Servizio di gestione API supporta attualmente l'autenticazione di base e l'autenticazione reciproca utilizzando i certificati e l'autorizzazione utente OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="95a30-436">The API management service currently supports Basic authentication and mutual authentication using certificates, and OAuth 2.0 user authorization.</span></span>
5. <span data-ttu-id="95a30-437">Creare un prodotto.</span><span class="sxs-lookup"><span data-stu-id="95a30-437">Create a product.</span></span> <span data-ttu-id="95a30-438">Un prodotto è l'unità di pubblicazione. È necessario aggiungere le API Web precedentemente connesse al servizio di gestione al prodotto.</span><span class="sxs-lookup"><span data-stu-id="95a30-438">A product is the unit of publication; you add the web APIs that you previously connected to the management service to the product.</span></span> <span data-ttu-id="95a30-439">Quando il prodotto è pubblicato, le API Web diventano disponibili per gli sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="95a30-439">When the product is published, the web APIs become available to developers.</span></span>

   > [!NOTE]
   > <span data-ttu-id="95a30-440">Prima della pubblicazione di un prodotto, è inoltre possibile definire gruppi utenti che possono accedere al prodotto e aggiungere utenti a questi gruppi.</span><span class="sxs-lookup"><span data-stu-id="95a30-440">Prior to publishing a product, you can also define user-groups that can access the product and add users to these groups.</span></span> <span data-ttu-id="95a30-441">Questo consente di controllare gli sviluppatori e le applicazioni che possono utilizzare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-441">This gives you control over the developers and applications that can use the web API.</span></span> <span data-ttu-id="95a30-442">Se un’API Web è soggetta ad approvazione, prima di essere in grado di accedervi, uno sviluppatore deve inviare una richiesta all'amministratore del prodotto.</span><span class="sxs-lookup"><span data-stu-id="95a30-442">If a web API is subject to approval, prior to being able to access it a developer must send a request to the product administrator.</span></span> <span data-ttu-id="95a30-443">L'amministratore può concedere o negare l'accesso allo sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="95a30-443">The administrator can grant or deny access to the developer.</span></span> <span data-ttu-id="95a30-444">Gli sviluppatori esistenti possono anche essere bloccati se cambiano le circostanze.</span><span class="sxs-lookup"><span data-stu-id="95a30-444">Existing developers can also be blocked if circumstances change.</span></span>
   >
   >
6. <span data-ttu-id="95a30-445">Configurare i criteri per ogni API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-445">Configure policies for each web API.</span></span> <span data-ttu-id="95a30-446">I criteri determinano gli aspetti, ad esempio se devono essere consentite chiamate tra domini, le modalità di autenticazione dei client, se convertire i formati di dati tra JSON e XML in modo trasparente, se si desidera limitare le chiamate da un intervallo IP specificato, le quote di utilizzo e se si desidera limitare la frequenza di chiamata.</span><span class="sxs-lookup"><span data-stu-id="95a30-446">Policies govern aspects such as whether cross-domain calls should be allowed, how to authenticate clients, whether to convert between XML and JSON data formats transparently, whether to restrict calls from a given IP range, usage quotas, and whether to limit the call rate.</span></span> <span data-ttu-id="95a30-447">I criteri possono essere applicati a livello globale sull’intero prodotto, per una singola API Web in un prodotto o per singole operazioni in un API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-447">Policies can be applied globally across the entire product, for a single web API in a product, or for individual operations in a web API.</span></span>

<span data-ttu-id="95a30-448">Per altre informazioni, vedere [Documentazione di Gestione API](/azure/api-management/).</span><span class="sxs-lookup"><span data-stu-id="95a30-448">For more information, see the [API Management Documentation](/azure/api-management/).</span></span> 

> [!TIP]
> <span data-ttu-id="95a30-449">Azure offre la Gestione traffico di Azure che consente di implementare il failover e il bilanciamento del carico e ridurre la latenza tra più istanze di un sito Web ospitato in aree geografiche diverse.</span><span class="sxs-lookup"><span data-stu-id="95a30-449">Azure provides the Azure Traffic Manager which enables you to implement failover and load-balancing, and reduce latency across multiple instances of a web site hosted in different geographic locations.</span></span> <span data-ttu-id="95a30-450">È possibile utilizzare la Gestione traffico di Azure in combinazione con il Servizio di gestione API. il Servizio di gestione API può indirizzare le richieste a istanze di un sito Web tramite la Gestione traffico di Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-450">You can use Azure Traffic Manager in conjunction with the API Management Service; the API Management Service can route requests to instances of a web site through Azure Traffic Manager.</span></span>  <span data-ttu-id="95a30-451">Per altre informazioni, vedere [Metodi di routing di Gestione traffico](/azure/traffic-manager/traffic-manager-routing-methods/).</span><span class="sxs-lookup"><span data-stu-id="95a30-451">For more information, see [Traffic Manager routing Methods](/azure/traffic-manager/traffic-manager-routing-methods/).</span></span>
>
> <span data-ttu-id="95a30-452">In questa struttura, se si utilizzano nomi DNS personalizzati per i siti Web, è necessario configurare il record CNAME appropriato per ogni sito Web per indicare il nome DNS del sito web di Gestione traffico di Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-452">In this structure, if you are using custom DNS names for your web sites, you should configure the appropriate CNAME record for each web site to point to the DNS name of the Azure Traffic Manager web site.</span></span>
>

## <a name="supporting-client-side-developers"></a><span data-ttu-id="95a30-453">Supporto degli sviluppatori lato client</span><span class="sxs-lookup"><span data-stu-id="95a30-453">Supporting client-side developers</span></span>
<span data-ttu-id="95a30-454">Gli sviluppatori che creano applicazioni client in genere richiedono informazioni su come accedere alle API Web e la documentazione relativa a parametri, tipi di dati, tipi restituiti e codici restituiti che descrivono le diverse richieste e risposte tra il servizio Web e l'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="95a30-454">Developers constructing client applications typically require information on how to access the web API, and documentation concerning the parameters, data types, return types, and return codes that describe the different requests and responses between the web service and the client application.</span></span>

### <a name="document-the-rest-operations-for-a-web-api"></a><span data-ttu-id="95a30-455">Documentare le operazioni REST per un'API Web</span><span class="sxs-lookup"><span data-stu-id="95a30-455">Document the REST operations for a web API</span></span>
<span data-ttu-id="95a30-456">Il Servizio di gestione API di Azure include un portale per sviluppatori che descrive le operazioni REST esposte da un'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-456">The Azure API Management Service includes a developer portal that describes the REST operations exposed by a web API.</span></span> <span data-ttu-id="95a30-457">Quando un prodotto è stato pubblicato viene visualizzato nel portale.</span><span class="sxs-lookup"><span data-stu-id="95a30-457">When a product has been published it appears on this portal.</span></span> <span data-ttu-id="95a30-458">Gli sviluppatori possono utilizzare il portale di registrazione per l'accesso; l'amministratore può quindi approvare o rifiutare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-458">Developers can use this portal to sign up for access; the administrator can then approve or deny the request.</span></span> <span data-ttu-id="95a30-459">Se lo sviluppatore viene approvato, gli viene assegnata una chiave di sottoscrizione che viene usata per autenticare le chiamate dalle applicazioni client che sviluppa.</span><span class="sxs-lookup"><span data-stu-id="95a30-459">If the developer is approved, they are assigned a subscription key that is used to authenticate calls from the client applications that they develop.</span></span> <span data-ttu-id="95a30-460">Questa chiave deve essere fornita con ogni chiamata di API Web; in caso contrario, verrà rifiutata.</span><span class="sxs-lookup"><span data-stu-id="95a30-460">This key must be provided with each web API call otherwise it will be rejected.</span></span>

<span data-ttu-id="95a30-461">Questo portale fornisce inoltre:</span><span class="sxs-lookup"><span data-stu-id="95a30-461">This portal also provides:</span></span>

* <span data-ttu-id="95a30-462">Documentazione del prodotto, elenco delle operazioni che espone, i parametri richiesti e le diverse risposte che possono essere restituite.</span><span class="sxs-lookup"><span data-stu-id="95a30-462">Documentation for the product, listing the operations that it exposes, the parameters required, and the different responses that can be returned.</span></span> <span data-ttu-id="95a30-463">Si noti che queste informazioni vengono generate dai dettagli forniti nel passaggio 3 dell'elenco nella sezione relativa alla pubblicazione di un'API Web tramite il servizio di gestione API di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-463">Note that this information is generated from the details provided in step 3 in the list in the Publishing a web API by using the Microsoft Azure API Management Service section.</span></span>
* <span data-ttu-id="95a30-464">Frammenti di codice mostrano come richiamare le operazioni da diversi linguaggi, tra cui JavaScript, C#, Java, Ruby, Python e PHP.</span><span class="sxs-lookup"><span data-stu-id="95a30-464">Code snippets that show how to invoke operations from several languages, including JavaScript, C#, Java, Ruby, Python, and PHP.</span></span>
* <span data-ttu-id="95a30-465">Console degli sviluppatori che consente agli sviluppatori di inviare una richiesta HTTP per testare ogni operazione nel prodotto e visualizzare i risultati.</span><span class="sxs-lookup"><span data-stu-id="95a30-465">A developers' console that enables a developer to send an HTTP request to test each operation in the product and view the results.</span></span>
* <span data-ttu-id="95a30-466">Una pagina in cui lo sviluppatore può segnalare ogni problema rilevato.</span><span class="sxs-lookup"><span data-stu-id="95a30-466">A page where the developer can report any issues or problems found.</span></span>

<span data-ttu-id="95a30-467">Il portale di gestione di Azure consente di personalizzare il portale per sviluppatori per modificare lo stile e il layout in modo che corrisponda alla personalizzazione dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-467">The Azure Management portal enables you to customize the developer portal to change the styling and layout to match the branding of your organization.</span></span>

### <a name="implement-a-client-sdk"></a><span data-ttu-id="95a30-468">Implementare un client SDK</span><span class="sxs-lookup"><span data-stu-id="95a30-468">Implement a client SDK</span></span>
<span data-ttu-id="95a30-469">Creare un'applicazione client che richiama le richieste REST per accedere a un’API Web richiede la scrittura di una quantità significativa di codice per creare ogni richiesta e formattarla in modo appropriato, inviare la richiesta al server che ospita il servizio Web e analizzare la risposta da elaborare se la richiesta ha avuto esito positivo o negativo ed estrarre i dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="95a30-469">Building a client application that invokes REST requests to access a web API requires writing a significant amount of code to construct each request and format it appropriately, send the request to the server hosting the web service, and parse the response to work out whether the request succeeded or failed and extract any data returned.</span></span> <span data-ttu-id="95a30-470">Per isolare l'applicazione client da questi problemi, è possibile fornire un SDK che racchiude l'interfaccia REST e consente di astrarre i dettagli di basso livello all'interno di un set di metodi più funzionale.</span><span class="sxs-lookup"><span data-stu-id="95a30-470">To insulate the client application from these concerns, you can provide an SDK that wraps the REST interface and abstracts these low-level details inside a more functional set of methods.</span></span> <span data-ttu-id="95a30-471">Un'applicazione client utilizza questi metodi, che consentono di convertire in modo trasparente le chiamate in richieste REST e quindi di convertire le risposte in valori restituiti dal metodo.</span><span class="sxs-lookup"><span data-stu-id="95a30-471">A client application uses these methods, which transparently convert calls into REST requests and then convert the responses back into method return values.</span></span> <span data-ttu-id="95a30-472">Si tratta di una tecnica comune che viene implementata da molti servizi, tra cui Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="95a30-472">This is a common technique that is implemented by many services, including the Azure SDK.</span></span>

<span data-ttu-id="95a30-473">La creazione di un SDK lato client è un'impresa considerevole poiché deve essere implementata in modo coerente e testata con attenzione.</span><span class="sxs-lookup"><span data-stu-id="95a30-473">Creating a client-side SDK is a considerable undertaking as it has to be implemented consistently and tested carefully.</span></span> <span data-ttu-id="95a30-474">Tuttavia, gran parte di questo processo può essere resa meccanica e molti fornitori forniscono strumenti in grado di automatizzare molte di queste attività.</span><span class="sxs-lookup"><span data-stu-id="95a30-474">However, much of this process can be made mechanical, and many vendors supply tools that can automate many of these tasks.</span></span>

## <a name="monitoring-a-web-api"></a><span data-ttu-id="95a30-475">Monitoraggio di un'API Web</span><span class="sxs-lookup"><span data-stu-id="95a30-475">Monitoring a web API</span></span>
<span data-ttu-id="95a30-476">A seconda della modalità di pubblicazione e distribuzione dell’API Web, è possibile monitorare l'API Web direttamente oppure è possibile raccogliere informazioni di utilizzo e integrità analizzando il traffico che passa attraverso il Servizio di gestione API.</span><span class="sxs-lookup"><span data-stu-id="95a30-476">Depending on how you have published and deployed your web API you can monitor the web API directly, or you can gather usage and health information by analyzing the traffic that passes through the API Management service.</span></span>

### <a name="monitoring-a-web-api-directly"></a><span data-ttu-id="95a30-477">Monitoraggio diretto di un'API Web</span><span class="sxs-lookup"><span data-stu-id="95a30-477">Monitoring a web API directly</span></span>
<span data-ttu-id="95a30-478">Se l’API Web è stata implementata utilizzando il modello API Web ASP.NET (in un progetto di API Web o come ruolo Web in un servizio cloud di Azure) e Visual Studio 2013, è possibile raccogliere dati di disponibilità, prestazioni e utilizzo mediante ASP.NET Application Insights.</span><span class="sxs-lookup"><span data-stu-id="95a30-478">If you have implemented your web API by using the ASP.NET Web API template (either as a Web API project or as a Web role in an Azure cloud service) and Visual Studio 2013, you can gather availability, performance, and usage data by using ASP.NET Application Insights.</span></span> <span data-ttu-id="95a30-479">Application Insights è un pacchetto che traccia in modo trasparente e registra le informazioni sulle richieste e risposte quando l'API Web viene distribuita nel cloud; una volta che il pacchetto viene installato e configurato, non è necessario modificare il codice presente in API Web per utilizzarlo.</span><span class="sxs-lookup"><span data-stu-id="95a30-479">Application Insights is a package that transparently tracks and records information about requests and responses when the web API is deployed to the cloud; once the package is installed and configured, you don't need to amend any code in your web API to use it.</span></span> <span data-ttu-id="95a30-480">Quando si distribuisce l'API Web in un sito Web di Azure, tutto il traffico viene esaminato e vengono raccolte le statistiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="95a30-480">When you deploy the web API to an Azure web site, all traffic is examined and the following statistics are gathered:</span></span>

* <span data-ttu-id="95a30-481">Tempo di risposta del server.</span><span class="sxs-lookup"><span data-stu-id="95a30-481">Server response time.</span></span>
* <span data-ttu-id="95a30-482">Numero di richieste del server e i dettagli di ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="95a30-482">Number of server requests and the details of each request.</span></span>
* <span data-ttu-id="95a30-483">Le richieste più lente in termini di tempo medio di risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-483">The top slowest requests in terms of average response time.</span></span>
* <span data-ttu-id="95a30-484">I dettagli delle richieste non riuscite.</span><span class="sxs-lookup"><span data-stu-id="95a30-484">The details of any failed requests.</span></span>
* <span data-ttu-id="95a30-485">Il numero di sessioni avviate da browser diversi e gli agenti utente.</span><span class="sxs-lookup"><span data-stu-id="95a30-485">The number of sessions initiated by different browsers and user agents.</span></span>
* <span data-ttu-id="95a30-486">Le pagine visualizzate più frequentemente (utile soprattutto per le applicazioni Web anziché le API Web).</span><span class="sxs-lookup"><span data-stu-id="95a30-486">The most frequently viewed pages (primarily useful for web applications rather than web APIs).</span></span>
* <span data-ttu-id="95a30-487">I diversi ruoli utente di accesso all'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-487">The different user roles accessing the web API.</span></span>

<span data-ttu-id="95a30-488">È possibile visualizzare questi dati in tempo reale dal portale di gestione di Azure.</span><span class="sxs-lookup"><span data-stu-id="95a30-488">You can view this data in real time from the Azure Management portal.</span></span> <span data-ttu-id="95a30-489">È inoltre possibile creare un test Web per monitorare l'integrità dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-489">You can also create webtests that monitor the health of the web API.</span></span> <span data-ttu-id="95a30-490">Un test Web invia una richiesta periodica a un URI specificato nell'API Web e acquisisce la risposta.</span><span class="sxs-lookup"><span data-stu-id="95a30-490">A webtest sends a periodic request to a specified URI in the web API and captures the response.</span></span> <span data-ttu-id="95a30-491">È possibile specificare la definizione di una risposta corretta (ad esempio, il codice di stato HTTP 200) e se la richiesta non restituisce questa risposta è possibile disporre di un avviso da inviare a un amministratore.</span><span class="sxs-lookup"><span data-stu-id="95a30-491">You can specify the definition of a successful response (such as HTTP status code 200), and if the request does not return this response you can arrange for an alert to be sent to an administrator.</span></span> <span data-ttu-id="95a30-492">Se necessario, l'amministratore può riavviare il server che ospita l'API Web se l’esito è negativo.</span><span class="sxs-lookup"><span data-stu-id="95a30-492">If necessary, the administrator can restart the server hosting the web API if it has failed.</span></span>

<span data-ttu-id="95a30-493">Per altre informazioni, vedere [Application Insights - Introduzione ad ASP.NET](/azure/application-insights/app-insights-asp-net/).</span><span class="sxs-lookup"><span data-stu-id="95a30-493">For more information, see [Application Insights - Get started with ASP.NET](/azure/application-insights/app-insights-asp-net/).</span></span>

### <a name="monitoring-a-web-api-through-the-api-management-service"></a><span data-ttu-id="95a30-494">Monitoraggio di un'API Web tramite il Servizio di gestione API</span><span class="sxs-lookup"><span data-stu-id="95a30-494">Monitoring a web API through the API Management Service</span></span>
<span data-ttu-id="95a30-495">Se l'API Web è stata pubblicata mediante il Servizio di gestione API, la pagina di gestione API nel portale di gestione di Azure contiene un dashboard che consente di visualizzare le prestazioni complessive del servizio.</span><span class="sxs-lookup"><span data-stu-id="95a30-495">If you have published your web API by using the API Management service, the API Management page on the Azure Management portal contains a dashboard that enables you to view the overall performance of the service.</span></span> <span data-ttu-id="95a30-496">La pagina di analisi consente di eseguire il drill-down nei dettagli dell'utilizzo del prodotto.</span><span class="sxs-lookup"><span data-stu-id="95a30-496">The Analytics page enables you to drill down into the details of how the product is being used.</span></span> <span data-ttu-id="95a30-497">Questa pagina contiene le schede seguenti:</span><span class="sxs-lookup"><span data-stu-id="95a30-497">This page contains the following tabs:</span></span>

* <span data-ttu-id="95a30-498">**Utilizzo**.</span><span class="sxs-lookup"><span data-stu-id="95a30-498">**Usage**.</span></span> <span data-ttu-id="95a30-499">Questa scheda fornisce informazioni sul numero di chiamate API effettuate e la larghezza di banda utilizzata per gestire queste chiamate nel tempo.</span><span class="sxs-lookup"><span data-stu-id="95a30-499">This tab provides information about the number of API calls made and the bandwidth used to handle these calls over time.</span></span> <span data-ttu-id="95a30-500">È possibile filtrare i dettagli di utilizzo per prodotto, API e operazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-500">You can filter usage details by product, API, and operation.</span></span>
* <span data-ttu-id="95a30-501">**Integrità**.</span><span class="sxs-lookup"><span data-stu-id="95a30-501">**Health**.</span></span> <span data-ttu-id="95a30-502">Questa scheda consente di visualizzare il risultato delle richieste API, ovvero icodici di stato HTTP restituiti, l'efficacia dei criteri di memorizzazione nella cache, il tempo di risposta dell'API e il tempo di risposta del servizio.</span><span class="sxs-lookup"><span data-stu-id="95a30-502">This tab enables you to view the outcome of API requests (the HTTP status codes returned), the effectiveness of the caching policy, the API response time, and the service response time.</span></span> <span data-ttu-id="95a30-503">È possibile filtrare di nuovo i dettagli di integrità per prodotto, API e operazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-503">Again, you can filter health data by product, API, and operation.</span></span>
* <span data-ttu-id="95a30-504">**Attività**.</span><span class="sxs-lookup"><span data-stu-id="95a30-504">**Activity**.</span></span> <span data-ttu-id="95a30-505">Questa scheda contiene un riepilogo del testo dei numeri di chiamate completate, non riuscite, bloccate, del tempo medio di risposta e dei tempi di risposta per ogni prodotto, API Web e operazione.</span><span class="sxs-lookup"><span data-stu-id="95a30-505">This tab provides a text summary of the numbers of successful calls, failed calls, blocked calls, average response time, and response times for each product, web API, and operation.</span></span> <span data-ttu-id="95a30-506">Questa pagina elenca anche il numero di chiamate effettuate da ogni sviluppatore.</span><span class="sxs-lookup"><span data-stu-id="95a30-506">This page also lists the number of calls made by each developer.</span></span>
* <span data-ttu-id="95a30-507">**Riepilogo**.</span><span class="sxs-lookup"><span data-stu-id="95a30-507">**At a glance**.</span></span> <span data-ttu-id="95a30-508">Questa scheda visualizza un riepilogo dei dati sulle prestazioni, tra cui gli sviluppatori responsabili del maggior numero di chiamate API, e i prodotti, API Web e le operazioni che hanno ricevuto queste chiamate.</span><span class="sxs-lookup"><span data-stu-id="95a30-508">This tab displays a summary of the performance data, including the developers responsible for making the most API calls, and the products, web APIs, and operations that received these calls.</span></span>

<span data-ttu-id="95a30-509">È possibile utilizzare queste informazioni per determinare se una determinata API Web o un'operazione causa un collo di bottiglia e, se necessario, ridurre l’ambiente host e aggiungere più server.</span><span class="sxs-lookup"><span data-stu-id="95a30-509">You can use this information to determine whether a particular web API or operation is causing a bottleneck, and if necessary scale the host environment and add more servers.</span></span> <span data-ttu-id="95a30-510">È  inoltre possibile verificare se una o più applicazioni utilizzano una quantità sproporzionata di risorse e applicano i criteri appropriati per impostare le quote e limitare la frequenza delle chiamate.</span><span class="sxs-lookup"><span data-stu-id="95a30-510">You can also ascertain whether one or more applications are using a disproportionate volume of resources and apply the appropriate policies to set quotas and limit call rates.</span></span>

> [!NOTE]
> <span data-ttu-id="95a30-511">È possibile modificare i dettagli di un prodotto pubblicato e le modifiche vengono applicate immediatamente.</span><span class="sxs-lookup"><span data-stu-id="95a30-511">You can change the details for a published product, and the changes are applied immediately.</span></span> <span data-ttu-id="95a30-512">Ad esempio, è possibile aggiungere o rimuovere un’operazione da un’API Web senza l’obbligo di pubblicare di nuovo il prodotto che contiene l’API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-512">For example, you can add or remove an operation from a web API without requiring that you republish the product that contains the web API.</span></span>
>
>

## <a name="more-information"></a><span data-ttu-id="95a30-513">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="95a30-513">More information</span></span>
* <span data-ttu-id="95a30-514">La pagina [API Web ASP.NET OData](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api) contiene esempi e altre informazioni sull'implementazione di un'API Web di OData tramite ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="95a30-514">[ASP.NET Web API OData](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api) contains examples and further information on implementing an OData web API by using ASP.NET.</span></span>
* <span data-ttu-id="95a30-515">[Introducing Batch Support in Web API and Web API OData](http://blogs.msdn.com/b/webdev/archive/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata.aspx) (Introduzione del supporto Batch in API Web e API Web OData) descrive come implementare le operazioni batch in un'API Web tramite OData.</span><span class="sxs-lookup"><span data-stu-id="95a30-515">[Introducing Batch Support in Web API and Web API OData](http://blogs.msdn.com/b/webdev/archive/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata.aspx) describes how to implement batch operations in a web API by using OData.</span></span>
* <span data-ttu-id="95a30-516">[Idempotency Patterns](http://blog.jonathanoliver.com/idempotency-patterns/) (Modelli di idempotenza) sul blog di Oliver Jonathan offre una panoramica sull'idempotenza e sul modo in cui è correlata alle operazioni di gestione dati.</span><span class="sxs-lookup"><span data-stu-id="95a30-516">[Idempotency Patterns](http://blog.jonathanoliver.com/idempotency-patterns/) on Jonathan Oliver’s blog provides an overview of idempotency and how it relates to data management operations.</span></span>
* <span data-ttu-id="95a30-517">[Status Code Definitions](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) (Definizioni dei codici di stato) sul sito Web W3C contiene un elenco completo dei codici di stato HTTP e le relative descrizioni.</span><span class="sxs-lookup"><span data-stu-id="95a30-517">[Status Code Definitions](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) on the W3C website contains a full list of HTTP status codes and their descriptions.</span></span>
* <span data-ttu-id="95a30-518">[Eseguire attività in background con i processi Web](/azure/app-service-web/web-sites-create-web-jobs/) contiene informazioni ed esempi sull'uso dei processi Web per eseguire operazioni in background.</span><span class="sxs-lookup"><span data-stu-id="95a30-518">[Run background tasks with WebJobs](/azure/app-service-web/web-sites-create-web-jobs/) provides information and examples on using WebJobs to perform background operations.</span></span>
* <span data-ttu-id="95a30-519">[Hub di notifica di Azure per inviare notifiche agli utenti](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/) mostra come usare un Hub di notifica di Azure per inviare le risposte asincrone alle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="95a30-519">[Azure Notification Hubs Notify Users](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/) shows how to use an Azure Notification Hub to push asynchronous responses to client applications.</span></span>
* <span data-ttu-id="95a30-520">[Gestione API](https://azure.microsoft.com/services/api-management/) descrive come pubblicare un prodotto che offre un accesso sicuro e controllato a un'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-520">[API Management](https://azure.microsoft.com/services/api-management/) describes how to publish a product that provides controlled and secure access to a web API.</span></span>
* <span data-ttu-id="95a30-521">[Riferimento API REST di Gestione API di Azure](https://msdn.microsoft.com/library/azure/dn776326.aspx) descrive come usare l'API REST di Gestione API per creare applicazioni di gestione personalizzate.</span><span class="sxs-lookup"><span data-stu-id="95a30-521">[Azure API Management REST API Reference](https://msdn.microsoft.com/library/azure/dn776326.aspx) describes how to use the API Management REST API to build custom management applications.</span></span>
* <span data-ttu-id="95a30-522">[Metodi di routing di Gestione traffico](/azure/traffic-manager/traffic-manager-routing-methods/) riepiloga come Gestione traffico di Azure può essere usato per le richieste di bilanciamento del carico tra più istanze di un sito Web che ospita un'API Web.</span><span class="sxs-lookup"><span data-stu-id="95a30-522">[Traffic Manager Routing Methods](/azure/traffic-manager/traffic-manager-routing-methods/) summarizes how Azure Traffic Manager can be used to load-balance requests across multiple instances of a website hosting a web API.</span></span>
* <span data-ttu-id="95a30-523">[Application Insights - Introduzione ad ASP.NET](/azure/application-insights/app-insights-asp-net/) contiene informazioni dettagliate sull'installazione e la configurazione di Application Insights in un progetto di API Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="95a30-523">[Application Insights - Get started with ASP.NET](/azure/application-insights/app-insights-asp-net/) provides detailed information on installing and configuring Application Insights in an ASP.NET Web API project.</span></span>


<!-- links -->

[api-design]: ./api-design.md

---
title: Linee guida di partizionamento di dati
titleSuffix: Best practices for cloud applications
description: Indicazioni su come suddividere le partizioni per la gestione e l'accesso separati.
author: dragon119
ms.date: 11/04/2018
ms.topic: best-practice
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: 561fe6e47a4cd64aa545349dde4c76260d76e78e
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 01/23/2019
ms.locfileid: "54482308"
---
# <a name="horizontal-vertical-and-functional-data-partitioning"></a><span data-ttu-id="66392-103">Partizionamento orizzontale, verticale e funzionale dei dati</span><span class="sxs-lookup"><span data-stu-id="66392-103">Horizontal, vertical, and functional data partitioning</span></span>

<span data-ttu-id="66392-104">In molte soluzioni su larga scala, i dati vengono divisi in *partizioni* gestibili e accessibili separatamente.</span><span class="sxs-lookup"><span data-stu-id="66392-104">In many large-scale solutions, data is divided into *partitions* that can be managed and accessed separately.</span></span> <span data-ttu-id="66392-105">Il partizionamento può migliorare la scalabilità, ridurre la contesa e ottimizzare le prestazioni,</span><span class="sxs-lookup"><span data-stu-id="66392-105">Partitioning can improve scalability, reduce contention, and optimize performance.</span></span> <span data-ttu-id="66392-106">nonché offrire un meccanismo per dividere i dati in base al modello di utilizzo.</span><span class="sxs-lookup"><span data-stu-id="66392-106">It can also provide a mechanism for dividing data by usage pattern.</span></span> <span data-ttu-id="66392-107">È ad esempio possibile archiviare i dati meno recenti in un archivio dati più economico.</span><span class="sxs-lookup"><span data-stu-id="66392-107">For example, you can archive older data in cheaper data storage.</span></span>

<span data-ttu-id="66392-108">È tuttavia necessario scegliere attentamente la strategia di partizionamento in modo da massimizzare i vantaggi riducendo al minimo gli effetti negativi.</span><span class="sxs-lookup"><span data-stu-id="66392-108">However, the partitioning strategy must be chosen carefully to maximize the benefits while minimizing adverse effects.</span></span>

> [!NOTE]
> <span data-ttu-id="66392-109">In questo articolo il termine *partizionamento* si riferisce al processo di suddivisione fisica dei dati in archivi dati separati.</span><span class="sxs-lookup"><span data-stu-id="66392-109">In this article, the term *partitioning* means the process of physically dividing data into separate data stores.</span></span> <span data-ttu-id="66392-110">Non si tratta del partizionamento delle tabelle SQL Server.</span><span class="sxs-lookup"><span data-stu-id="66392-110">It is not the same as SQL Server table partitioning.</span></span>

<!-- markdownlint-disable MD026 -->

## <a name="why-partition-data"></a><span data-ttu-id="66392-111">Perché la partizione di dati?</span><span class="sxs-lookup"><span data-stu-id="66392-111">Why partition data?</span></span>

<!-- markdownlint-enable MD026 -->

- <span data-ttu-id="66392-112">**Migliorare la scalabilità**.</span><span class="sxs-lookup"><span data-stu-id="66392-112">**Improve scalability**.</span></span> <span data-ttu-id="66392-113">L'aumento delle dimensioni del sistema del singolo database potrebbe causare il raggiungimento di un limite hardware fisico.</span><span class="sxs-lookup"><span data-stu-id="66392-113">When you scale up a single database system, it will eventually reach a physical hardware limit.</span></span> <span data-ttu-id="66392-114">Dividendo i dati in più partizioni, ognuna ospitata in un server separato, è possibile aumentare il numero di istanze del sistema quasi all'infinito.</span><span class="sxs-lookup"><span data-stu-id="66392-114">If you divide data across multiple partitions, each hosted on a separate server, you can scale out the system almost indefinitely.</span></span>

- <span data-ttu-id="66392-115">**Migliorare le prestazioni**</span><span class="sxs-lookup"><span data-stu-id="66392-115">**Improve performance**.</span></span> <span data-ttu-id="66392-116">Le operazioni di accesso ai dati in ogni partizione vengono eseguite su un volume di dati più piccolo.</span><span class="sxs-lookup"><span data-stu-id="66392-116">Data access operations on each partition take place over a smaller volume of data.</span></span> <span data-ttu-id="66392-117">Se eseguito correttamente, il partizionamento può rendere il sistema più efficiente.</span><span class="sxs-lookup"><span data-stu-id="66392-117">Correctly done, partitioning can make your system more efficient.</span></span> <span data-ttu-id="66392-118">Le operazioni che interessano più di una partizione possono essere eseguite in parallelo.</span><span class="sxs-lookup"><span data-stu-id="66392-118">Operations that affect more than one partition can run in parallel.</span></span>

- <span data-ttu-id="66392-119">**Migliorare la sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="66392-119">**Improve security**.</span></span> <span data-ttu-id="66392-120">In alcuni casi, è possibile separare i dati sensibili e quelli non sensibili in partizioni diverse e applicare controlli di sicurezza diversi ai dati sensibili.</span><span class="sxs-lookup"><span data-stu-id="66392-120">In some cases, you can separate sensitive and non-sensitive data into different partitions and apply different security controls to the sensitive data.</span></span>

- <span data-ttu-id="66392-121">**Fornire flessibilità operativa**.</span><span class="sxs-lookup"><span data-stu-id="66392-121">**Provide operational flexibility**.</span></span> <span data-ttu-id="66392-122">Il partizionamento offre molte opportunità per operazioni di ottimizzazione, ottimizzazione dell'efficienza amministrativa e riduzione dei costi.</span><span class="sxs-lookup"><span data-stu-id="66392-122">Partitioning offers many opportunities for fine tuning operations, maximizing administrative efficiency, and minimizing cost.</span></span> <span data-ttu-id="66392-123">È possibile ad esempio definire diverse strategie per la gestione, il monitoraggio, il backup e il ripristino e altre attività amministrative in base all'importanza dei dati in ogni partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-123">For example, you can define different strategies for management, monitoring, backup and restore, and other administrative tasks based on the importance of the data in each partition.</span></span>

- <span data-ttu-id="66392-124">**Combinare l'archivio dati al modello di utilizzo**.</span><span class="sxs-lookup"><span data-stu-id="66392-124">**Match the data store to the pattern of use**.</span></span> <span data-ttu-id="66392-125">Il partizionamento consente a ogni partizione di essere distribuita in un diverso tipo di archivio dati, basato sul costo e le funzionalità incorporate offerte dall’archivio dati.</span><span class="sxs-lookup"><span data-stu-id="66392-125">Partitioning allows each partition to be deployed on a different type of data store, based on cost and the built-in features that data store offers.</span></span> <span data-ttu-id="66392-126">È ad esempio possibile archiviare i dati binari di grandi dimensioni in un archivio BLOB e i dati più strutturati in un database di documenti.</span><span class="sxs-lookup"><span data-stu-id="66392-126">For example, large binary data can be stored in blob storage, while more structured data can be held in a document database.</span></span> <span data-ttu-id="66392-127">Vedere [Scegliere l'archivio dati corretto](../guide/technology-choices/data-store-overview.md).</span><span class="sxs-lookup"><span data-stu-id="66392-127">See [Choose the right data store](../guide/technology-choices/data-store-overview.md).</span></span>

- <span data-ttu-id="66392-128">**Migliorare la disponibilità**.</span><span class="sxs-lookup"><span data-stu-id="66392-128">**Improve availability**.</span></span> <span data-ttu-id="66392-129">La separazione dei dati tra più server consente di evitare singoli punti di errore.</span><span class="sxs-lookup"><span data-stu-id="66392-129">Separating data across multiple servers avoids a single point of failure.</span></span> <span data-ttu-id="66392-130">In caso di problemi in un'istanza, risultano non disponibili solo i dati in tale partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-130">If one instance fails, only the data in that partition is unavailable.</span></span> <span data-ttu-id="66392-131">Le operazioni su altre partizioni possono continuare.</span><span class="sxs-lookup"><span data-stu-id="66392-131">Operations on other partitions can continue.</span></span> <span data-ttu-id="66392-132">Per gli archivi dati PaaS gestiti, questa considerazione è meno significativa perché tali servizi sono progettati con ridondanza predefinita.</span><span class="sxs-lookup"><span data-stu-id="66392-132">For managed PaaS data stores, this consideration is less relevant, because these services are designed with built-in redundancy.</span></span>

## <a name="designing-partitions"></a><span data-ttu-id="66392-133">Progettazione di partizioni</span><span class="sxs-lookup"><span data-stu-id="66392-133">Designing partitions</span></span>

<span data-ttu-id="66392-134">Per il partizionamento dei dati esistono tre strategie tipiche:</span><span class="sxs-lookup"><span data-stu-id="66392-134">There are three typical strategies for partitioning data:</span></span>

- <span data-ttu-id="66392-135">**Il partizionamento orizzontale** (spesso chiamato *sharding*).</span><span class="sxs-lookup"><span data-stu-id="66392-135">**Horizontal partitioning** (often called *sharding*).</span></span> <span data-ttu-id="66392-136">In questa strategia, ogni partizione è un archivio dati separato, ma tutte le partizioni hanno lo stesso schema.</span><span class="sxs-lookup"><span data-stu-id="66392-136">In this strategy, each partition is a separate data store, but all partitions have the same schema.</span></span> <span data-ttu-id="66392-137">Ogni *partizione* contiene uno specifico subset di dati, ad esempio tutti gli ordini per un set specifico di clienti.</span><span class="sxs-lookup"><span data-stu-id="66392-137">Each partition is known as a *shard* and holds a specific subset of the data, such as all the orders for a specific set of customers.</span></span>

- <span data-ttu-id="66392-138">**Il partizionamento verticale**.</span><span class="sxs-lookup"><span data-stu-id="66392-138">**Vertical partitioning**.</span></span> <span data-ttu-id="66392-139">In questa strategia ogni partizione contiene un sottoinsieme dei campi per gli elementi nell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="66392-139">In this strategy, each partition holds a subset of the fields for items in the data store.</span></span> <span data-ttu-id="66392-140">I campi sono suddivisi in base ai loro modello di utilizzo.</span><span class="sxs-lookup"><span data-stu-id="66392-140">The fields are divided according to their pattern of use.</span></span> <span data-ttu-id="66392-141">I campi usati di frequente ad esempio possono essere collocati in una partizione verticale, mentre i campi usati raramente possono essere collocati in un'altra partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-141">For example, frequently accessed fields might be placed in one vertical partition and less frequently accessed fields in another.</span></span>

- <span data-ttu-id="66392-142">**Partizionamento funzionale**.</span><span class="sxs-lookup"><span data-stu-id="66392-142">**Functional partitioning**.</span></span> <span data-ttu-id="66392-143">In questa strategia i dati vengono aggregati in base alla loro modalità di utilizzo da parte di ogni contesto limitato nel sistema.</span><span class="sxs-lookup"><span data-stu-id="66392-143">In this strategy, data is aggregated according to how it is used by each bounded context in the system.</span></span> <span data-ttu-id="66392-144">Un sistema di e-commerce, ad esempio, potrebbe archiviare i dati delle fatture in una partizione e quelli relativi all'inventario dei prodotti in un'altra.</span><span class="sxs-lookup"><span data-stu-id="66392-144">For example, an e-commerce system might store invoice data in one partition and product inventory data in another.</span></span>

<span data-ttu-id="66392-145">Queste strategie possono essere combinate ed è consigliabile prenderle tutte in considerazione quando si progetta uno schema di partizionamento.</span><span class="sxs-lookup"><span data-stu-id="66392-145">These strategies can be combined, and we recommend that you consider them all when you design a partitioning scheme.</span></span> <span data-ttu-id="66392-146">Ad esempio, si potrebbe dividere i dati in partizioni e quindi utilizzare il partizionamento verticale per suddividere ulteriormente i dati in ogni partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-146">For example, you might divide data into shards and then use vertical partitioning to further subdivide the data in each shard.</span></span>

### <a name="horizontal-partitioning-sharding"></a><span data-ttu-id="66392-147">Partizionamento orizzontale (sharding)</span><span class="sxs-lookup"><span data-stu-id="66392-147">Horizontal partitioning (sharding)</span></span>

<span data-ttu-id="66392-148">La figura 1 illustra il partizionamento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="66392-148">Figure 1 shows horizontal partitioning or sharding.</span></span> <span data-ttu-id="66392-149">In questo esempio, i dati di inventario del prodotto sono divisi in partizioni in base alla chiave di prodotto.</span><span class="sxs-lookup"><span data-stu-id="66392-149">In this example, product inventory data is divided into shards based on the product key.</span></span> <span data-ttu-id="66392-150">Ogni partizione contiene i dati per un intervallo contiguo di chiavi di partizione (A-G e H-Z), organizzati in ordine alfabetico.</span><span class="sxs-lookup"><span data-stu-id="66392-150">Each shard holds the data for a contiguous range of shard keys (A-G and H-Z), organized alphabetically.</span></span> <span data-ttu-id="66392-151">Il partizionamento orizzontale distribuisce il carico in più computer, riducendo la contesa e migliorando le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="66392-151">Sharding spreads the load over more computers, which reduces contention and improves performance.</span></span>

![Partizionamento orizzontale (sharding) dei dati in base a una chiave di partizione](./images/data-partitioning/DataPartitioning01.png)

<span data-ttu-id="66392-153">*Figura 1. Partizionamento orizzontale (sharding) dei dati in base a una chiave di partizione.*</span><span class="sxs-lookup"><span data-stu-id="66392-153">*Figure 1. Horizontally partitioning (sharding) data based on a partition key.*</span></span>

<span data-ttu-id="66392-154">Il fattore più importante è la scelta di una chiave di partizionamento.</span><span class="sxs-lookup"><span data-stu-id="66392-154">The most important factor is the choice of a sharding key.</span></span> <span data-ttu-id="66392-155">Può essere difficile modificare la chiave quando il sistema è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="66392-155">It can be difficult to change the key after the system is in operation.</span></span> <span data-ttu-id="66392-156">La chiave deve garantire che i dati siano partizionati in modo che la distribuzione del carico di lavoro tra le partizioni sia il più uniforme possibile.</span><span class="sxs-lookup"><span data-stu-id="66392-156">The key must ensure that data is partitioned to spread the workload as evenly as possible across the shards.</span></span>

<span data-ttu-id="66392-157">Non è necessario che le partizioni siano di uguali dimensioni.</span><span class="sxs-lookup"><span data-stu-id="66392-157">The shards don't have to be the same size.</span></span> <span data-ttu-id="66392-158">È più importante bilanciare il numero di richieste.</span><span class="sxs-lookup"><span data-stu-id="66392-158">It's more important to balance the number of requests.</span></span> <span data-ttu-id="66392-159">È possibile che in alcune partizioni molto grandi i singoli elementi abbiano un numero ridotto di operazioni di accesso.</span><span class="sxs-lookup"><span data-stu-id="66392-159">Some shards might be very large, but each item has a low number of access operations.</span></span> <span data-ttu-id="66392-160">Altre partizioni invece possono essere più piccole, ma è possibile che ogni elemento venga usato più frequentemente.</span><span class="sxs-lookup"><span data-stu-id="66392-160">Other shards might be smaller, but each item is accessed much more frequently.</span></span> <span data-ttu-id="66392-161">È anche importante garantire che una singola partizione non superi i limiti di scalabilità (in termini di capacità e risorse di elaborazione) dell'archivio dati.</span><span class="sxs-lookup"><span data-stu-id="66392-161">It's also important to ensure that a single shard does not exceed the scale limits (in terms of capacity and processing resources) of the data store.</span></span>

<span data-ttu-id="66392-162">Evitare di creare partizioni ad accesso frequente che possono influire sulle prestazioni e sulla disponibilità.</span><span class="sxs-lookup"><span data-stu-id="66392-162">Avoid creating "hot" partitions that can affect performance and availability.</span></span> <span data-ttu-id="66392-163">L'uso della prima lettera del nome di un cliente, ad esempio, può determinare una distribuzione non bilanciata perché alcune lettere sono più comuni. Usare invece un hash dell'identificatore cliente per distribuire più uniformemente i dati tra le partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-163">For example, using the first letter of a customer’s name causes an unbalanced distribution, because some letters are more common Instead, use a hash of a customer identifier to distribute data more evenly across partitions.</span></span>

<span data-ttu-id="66392-164">Scegliere una chiave di partizionamento che riduca al minimo eventuali esigenze future di dividere le partizioni di grandi dimensioni, unire le partizioni piccole in partizioni di dimensioni maggiori o modificare lo schema.</span><span class="sxs-lookup"><span data-stu-id="66392-164">Choose a sharding key that minimizes any future requirements to split large shards, coalesce small shards into larger partitions, or change the schema.</span></span> <span data-ttu-id="66392-165">Queste operazioni possono richiedere molto tempo e potrebbe essere necessario disconnettere una o più partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-165">These operations can be very time consuming, and might require taking one or more shards offline while they are performed.</span></span>

<span data-ttu-id="66392-166">Se viene eseguita la replica delle partizioni, potrebbe essere possibile mantenere alcune delle repliche online mentre altre vengono suddivise, unite o riconfigurate.</span><span class="sxs-lookup"><span data-stu-id="66392-166">If shards are replicated, it might be possible to keep some of the replicas online while others are split, merged, or reconfigured.</span></span> <span data-ttu-id="66392-167">Il sistema potrebbe tuttavia richiedere una limitazione delle operazioni eseguibili durante la riconfigurazione.</span><span class="sxs-lookup"><span data-stu-id="66392-167">However, the system might need to limit the operations that can be performed during the reconfiguration.</span></span> <span data-ttu-id="66392-168">Ad esempio, i dati nelle repliche potrebbero essere contrassegnati come di sola lettura per evitare incoerenze dei dati.</span><span class="sxs-lookup"><span data-stu-id="66392-168">For example, the data in the replicas might be marked as read-only to prevent data inconsistences.</span></span>

<span data-ttu-id="66392-169">Per altre informazioni sul partizionamento orizzontale, vedere [Modello di partizionamento orizzontale].</span><span class="sxs-lookup"><span data-stu-id="66392-169">For more information about horizontal partitioning, see [Sharding pattern].</span></span>

### <a name="vertical-partitioning"></a><span data-ttu-id="66392-170">Il partizionamento verticale</span><span class="sxs-lookup"><span data-stu-id="66392-170">Vertical partitioning</span></span>

<span data-ttu-id="66392-171">Il partizionamento verticale viene prevalentemente usato per ridurre i costi di I/O e prestazioni associati al recupero degli elementi a cui si accede frequentemente.</span><span class="sxs-lookup"><span data-stu-id="66392-171">The most common use for vertical partitioning is to reduce the I/O and performance costs associated with fetching items that are frequently accessed.</span></span> <span data-ttu-id="66392-172">La Figura 2 mostra un esempio di partizionamento verticale.</span><span class="sxs-lookup"><span data-stu-id="66392-172">Figure 2 shows an example of vertical partitioning.</span></span> <span data-ttu-id="66392-173">Nell'esempio, le diverse proprietà di un elemento vengono archiviate in partizioni diverse.</span><span class="sxs-lookup"><span data-stu-id="66392-173">In this example, different properties of an item are stored in different partitions.</span></span> <span data-ttu-id="66392-174">Una partizione contiene i dati a cui si accede più frequentemente, come nome, descrizione e prezzo dei prodotti.</span><span class="sxs-lookup"><span data-stu-id="66392-174">One partition holds data that is accessed more frequently, including product name, description, and price.</span></span> <span data-ttu-id="66392-175">Un'altra partizione contiene i dati di inventario, ossia il conteggio delle scorte e la data dell'ultimo ordine.</span><span class="sxs-lookup"><span data-stu-id="66392-175">Another partition holds inventory data: the stock count and last-ordered date.</span></span>

![Partizionamento verticale dei dati in base al modello di utilizzo](./images/data-partitioning/DataPartitioning02.png)

<span data-ttu-id="66392-177">*Figura 2. Partizionamento verticale dei dati in base al modello di utilizzo.*</span><span class="sxs-lookup"><span data-stu-id="66392-177">*Figure 2. Vertically partitioning data by its pattern of use.*</span></span>

<span data-ttu-id="66392-178">Nell'esempio, l'applicazione ricerca regolarmente il nome del prodotto, la descrizione e il prezzo quando visualizza i dettagli dei prodotti ai clienti.</span><span class="sxs-lookup"><span data-stu-id="66392-178">In this example, the application regularly queries the product name, description, and price when displaying the product details to customers.</span></span> <span data-ttu-id="66392-179">Il conteggio delle scorte e la data dell'ultimo ordine vengono mantenuti in una partizione separata perché questi due elementi vengono in genere usati insieme.</span><span class="sxs-lookup"><span data-stu-id="66392-179">Stock count and last- ordered date are held in a separate partition because these two items are commonly used together.</span></span>

<span data-ttu-id="66392-180">Altri vantaggi del partizionamento verticale:</span><span class="sxs-lookup"><span data-stu-id="66392-180">Other advantages of vertical partitioning:</span></span>

- <span data-ttu-id="66392-181">I dati relativamente lenti (come nome, descrizione e prezzo dei prodotti) possono essere separati dai dati più dinamici (come livello delle scorte e data dell'ultimo ordine).</span><span class="sxs-lookup"><span data-stu-id="66392-181">Relatively slow-moving data (product name, description, and price) can be separated from the more dynamic data (stock level and last ordered date).</span></span> <span data-ttu-id="66392-182">I dati lenti si prestano bene a essere inseriti da un'applicazione nella cache in memoria.</span><span class="sxs-lookup"><span data-stu-id="66392-182">Slow moving data is a good candidate for an application to cache in memory.</span></span>

- <span data-ttu-id="66392-183">È possibile archiviare i dati sensibili in una partizione separata con controlli di sicurezza aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="66392-183">Sensitive data can be stored in a separate partition with additional security controls.</span></span>

- <span data-ttu-id="66392-184">Il partizionamento verticale può ridurre il numero di accessi simultanei necessario.</span><span class="sxs-lookup"><span data-stu-id="66392-184">Vertical partitioning can reduce the amount of concurrent access that's needed.</span></span>

<span data-ttu-id="66392-185">Il partizionamento verticale opera a livello di entità all'interno di un archivio dati, normalizzando parzialmente un'entità per suddividerla da un elemento *di grandi dimensioni* a una raccolta di elementi *di dimensioni ridotte*.</span><span class="sxs-lookup"><span data-stu-id="66392-185">Vertical partitioning operates at the entity level within a data store, partially normalizing an entity to break it down from a *wide* item to a set of *narrow* items.</span></span> <span data-ttu-id="66392-186">È particolarmente adatto per gli archivi di dati orientati alla colonna, ad esempio HBase e Cassandra.</span><span class="sxs-lookup"><span data-stu-id="66392-186">It is ideally suited for column-oriented data stores such as HBase and Cassandra.</span></span> <span data-ttu-id="66392-187">Se è improbabile modificare i dati in una raccolta di colonne, è possibile utilizzare archivi di colonne in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="66392-187">If the data in a collection of columns is unlikely to change, you can also consider using column stores in SQL Server.</span></span>

### <a name="functional-partitioning"></a><span data-ttu-id="66392-188">Partizionamento funzionale</span><span class="sxs-lookup"><span data-stu-id="66392-188">Functional partitioning</span></span>

<span data-ttu-id="66392-189">Quando è possibile identificare un contesto delimitato per ogni distinta area di attività in un'applicazione, il partizionamento funzionale consente di migliorare l'isolamento e le prestazioni di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="66392-189">When it's possible to identify a bounded context for each distinct business area in an application, functional partitioning is a way to improve isolation and data access performance.</span></span> <span data-ttu-id="66392-190">Un altro uso comune del partizionamento funzionale è la separazione dei dati di lettura/scrittura dai dati di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="66392-190">Another common use for functional partitioning is to separate read-write data from read-only data.</span></span> <span data-ttu-id="66392-191">La figura 3 mostra una panoramica del partizionamento funzionale in cui i dati di inventario sono separati dai dati del cliente.</span><span class="sxs-lookup"><span data-stu-id="66392-191">Figure 3 shows an overview of functional partitioning where inventory data is separated from customer data.</span></span>

![Partizionamento funzionale dei dati in base al contesto limitato o al sottodominio](./images/data-partitioning/DataPartitioning03.png)

<span data-ttu-id="66392-193">*Figura 3. Partizionamento funzionale dei dati in base al contesto limitato o al sottodominio.*</span><span class="sxs-lookup"><span data-stu-id="66392-193">*Figure 3. Functionally partitioning data by bounded context or subdomain.*</span></span>

<span data-ttu-id="66392-194">Questa strategia di partizionamento può contribuire a ridurre i conflitti di accesso ai dati in diverse parti del sistema.</span><span class="sxs-lookup"><span data-stu-id="66392-194">This partitioning strategy can help reduce data access contention across different parts of a system.</span></span>

## <a name="designing-partitions-for-scalability"></a><span data-ttu-id="66392-195">Progettazione di partizioni per la scalabilità</span><span class="sxs-lookup"><span data-stu-id="66392-195">Designing partitions for scalability</span></span>

<span data-ttu-id="66392-196">È importante considerare le dimensioni e il carico di lavoro di ogni partizione e bilanciarle in modo che i dati siano distribuiti per ottenere la massima scalabilità.</span><span class="sxs-lookup"><span data-stu-id="66392-196">It's vital to consider size and workload for each partition and balance them so that data is distributed to achieve maximum scalability.</span></span> <span data-ttu-id="66392-197">È tuttavia necessario partizionare i dati in modo che non superino i limiti di ridimensionamento della singola partizione di un archivio.</span><span class="sxs-lookup"><span data-stu-id="66392-197">However, you must also partition the data so that it does not exceed the scaling limits of a single partition store.</span></span>

<span data-ttu-id="66392-198">Quando si progettano le partizioni per la scalabilità, attenersi alla seguente procedura:</span><span class="sxs-lookup"><span data-stu-id="66392-198">Follow these steps when designing partitions for scalability:</span></span>

1. <span data-ttu-id="66392-199">Analizzare l'applicazione per comprendere i modelli di accesso ai dati, ad esempio la dimensione del set di risultati restituito da ogni query, la frequenza di accesso, la latenza intrinseca e i requisiti di elaborazione di calcolo sul lato server.</span><span class="sxs-lookup"><span data-stu-id="66392-199">Analyze the application to understand the data access patterns, such as the size of the result set returned by each query, the frequency of access, the inherent latency, and the server-side compute processing requirements.</span></span> <span data-ttu-id="66392-200">In molti casi, è possibile che alcune entità principali richiederanno la maggior parte delle risorse di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="66392-200">In many cases, a few major entities will demand most of the processing resources.</span></span>
2. <span data-ttu-id="66392-201">Usare questa analisi per determinare gli obiettivi di scalabilità attuali e futuri, ad esempio la dimensione dei dati e il carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="66392-201">Use this analysis to determine the current and future scalability targets, such as data size and workload.</span></span> <span data-ttu-id="66392-202">Distribuire i dati nelle partizioni in modo da soddisfare l'obiettivo di scalabilità.</span><span class="sxs-lookup"><span data-stu-id="66392-202">Then distribute the data across the partitions to meet the scalability target.</span></span> <span data-ttu-id="66392-203">Per il partizionamento orizzontale, la scelta della chiave di partizione corretta è importante per garantire una distribuzione uniforme.</span><span class="sxs-lookup"><span data-stu-id="66392-203">For horizontal partitioning, choosing the right shard key is important to make sure distribution is even.</span></span> <span data-ttu-id="66392-204">Per altre informazioni, vedere il [Modello di partizionamento orizzontale].</span><span class="sxs-lookup"><span data-stu-id="66392-204">For more information, see the [Sharding pattern].</span></span>
3. <span data-ttu-id="66392-205">Assicurarsi che ogni partizione abbia risorse sufficienti per gestire i requisiti di scalabilità in termini di dimensioni dei dati e di velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="66392-205">Make sure each partition has enough resources to handle the scalability requirements, in terms of data size and throughput.</span></span> <span data-ttu-id="66392-206">A seconda dell'archivio dati, può esistere un limite alla quantità di spazio di archiviazione, alla potenza di elaborazione o alla larghezza di banda di rete per partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-206">Depending on the data store, there might be a limit on the amount of storage space, processing power, or network bandwidth per partition.</span></span> <span data-ttu-id="66392-207">Se è probabile che i requisiti superino tali limiti, potrebbe essere necessario perfezionare la strategia di partizionamento o suddividere ulteriormente i dati, combinando eventualmente due o più strategie.</span><span class="sxs-lookup"><span data-stu-id="66392-207">If the requirements are likely to exceed these limits, you may need to refine your partitioning strategy or split data out further, possibly combining two or more strategies.</span></span>
4. <span data-ttu-id="66392-208">Monitorare il sistema per verificare che i dati vengano distribuiti come previsto e che le partizioni possano gestire il carico.</span><span class="sxs-lookup"><span data-stu-id="66392-208">Monitor the system to verify that data is distributed as expected and that the partitions can handle the load.</span></span> <span data-ttu-id="66392-209">L'utilizzo effettivo non sempre corrisponde a quanto previsto da un'analisi.</span><span class="sxs-lookup"><span data-stu-id="66392-209">Actual usage does not always match what an analysis predicts.</span></span> <span data-ttu-id="66392-210">In tal caso, è possibile ribilanciare le partizioni o in alternativa riprogettare alcune parti del sistema per ottenere il bilanciamento necessario.</span><span class="sxs-lookup"><span data-stu-id="66392-210">If so, it might be possible to rebalance the partitions, or else redesign some parts of the system to gain the required balance.</span></span>

<span data-ttu-id="66392-211">Alcuni ambienti cloud allocano le risorse in termini di limiti di infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="66392-211">Some cloud environments allocate resources in terms of infrastructure boundaries.</span></span> <span data-ttu-id="66392-212">Assicurarsi che tali limiti forniscano spazio sufficiente per una crescita anticipata del volume di dati, in termini di archiviazione dei dati, potenza di elaborazione e larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="66392-212">Ensure that the limits of your selected boundary provide enough room for any anticipated growth in the volume of data, in terms of data storage, processing power, and bandwidth.</span></span>

<span data-ttu-id="66392-213">Se si usa l'archivio tabelle di Azure, ad esempio, esiste un limite al volume di richieste che può essere gestito da una singola partizione in un determinato periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="66392-213">For example, if you use Azure table storage, there is a limit to the volume of requests that can be handled by a single partition in a particular period of time.</span></span> <span data-ttu-id="66392-214">Vedere [Obiettivi di scalabilità e prestazioni per Archiviazione di Azure]. Una partizione occupata potrebbe richiedere una quantità di risorse superiore a quella che può essere gestita da una singola partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-214">(See [Azure storage scalability and performance targets].) A busy shard might require more resources than a single partition can handle.</span></span> <span data-ttu-id="66392-215">In tal caso, potrebbe essere necessario un ripartizionamento per distribuire il carico.</span><span class="sxs-lookup"><span data-stu-id="66392-215">If so, the shard might need to be repartitioned to spread the load.</span></span> <span data-ttu-id="66392-216">Se le dimensioni totali o la velocità effettiva delle tabelle supera la capacità di un account di archiviazione, potrebbe essere necessario creare altri account di archiviazione e suddividere le tabelle tra questi.</span><span class="sxs-lookup"><span data-stu-id="66392-216">If the total size or throughput of these tables exceeds the capacity of a storage account, you might need to create additional storage accounts and spread the tables across these accounts.</span></span>

## <a name="designing-partitions-for-query-performance"></a><span data-ttu-id="66392-217">Progettazione di partizioni per le prestazioni delle query</span><span class="sxs-lookup"><span data-stu-id="66392-217">Designing partitions for query performance</span></span>

<span data-ttu-id="66392-218">Le prestazioni delle query possono spesso essere aumentate usando set di dati più piccoli ed eseguendo query parallele.</span><span class="sxs-lookup"><span data-stu-id="66392-218">Query performance can often be boosted by using smaller data sets and by running parallel queries.</span></span> <span data-ttu-id="66392-219">Ogni partizione deve contenere una piccola parte dell'intero set di dati.</span><span class="sxs-lookup"><span data-stu-id="66392-219">Each partition should contain a small proportion of the entire data set.</span></span> <span data-ttu-id="66392-220">La riduzione del volume può migliorare le prestazioni delle query.</span><span class="sxs-lookup"><span data-stu-id="66392-220">This reduction in volume can improve the performance of queries.</span></span> <span data-ttu-id="66392-221">Tuttavia, il partizionamento non è un'alternativa per la progettazione e la configurazione di un database in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="66392-221">However, partitioning is not an alternative for designing and configuring a database appropriately.</span></span> <span data-ttu-id="66392-222">Assicurarsi ad esempio che siano presenti gli indici necessari.</span><span class="sxs-lookup"><span data-stu-id="66392-222">For example, make sure that you have the necessary indexes in place.</span></span>

<span data-ttu-id="66392-223">Quando si progettano le partizioni per le prestazioni delle query, attenersi alla seguente procedura:</span><span class="sxs-lookup"><span data-stu-id="66392-223">Follow these steps when designing partitions for query performance:</span></span>

1. <span data-ttu-id="66392-224">Esaminare i requisiti dell'applicazione e delle prestazioni:</span><span class="sxs-lookup"><span data-stu-id="66392-224">Examine the application requirements and performance:</span></span>

   - <span data-ttu-id="66392-225">Usare i requisiti aziendali per determinare le query critiche che devono sempre essere eseguite rapidamente.</span><span class="sxs-lookup"><span data-stu-id="66392-225">Use business requirements to determine the critical queries that must always perform quickly.</span></span>
   - <span data-ttu-id="66392-226">Monitoraggio del sistema per identificare qualsiasi query eseguita lentamente.</span><span class="sxs-lookup"><span data-stu-id="66392-226">Monitor the system to identify any queries that perform slowly.</span></span>
   - <span data-ttu-id="66392-227">Individuare le query eseguite con maggiore frequenza.</span><span class="sxs-lookup"><span data-stu-id="66392-227">Find which queries are performed most frequently.</span></span> <span data-ttu-id="66392-228">Anche se una singola query ha un costo minimo, l'utilizzo complessivo delle risorse potrebbe essere significativo.</span><span class="sxs-lookup"><span data-stu-id="66392-228">Even if a single query has a minimal cost, the cumulative resource consumption could be significant.</span></span>

2. <span data-ttu-id="66392-229">Partizionare i dati che causano un rallentamento delle prestazioni:</span><span class="sxs-lookup"><span data-stu-id="66392-229">Partition the data that is causing slow performance:</span></span>
   - <span data-ttu-id="66392-230">Limitare le dimensioni di ogni partizione in modo che il tempo di risposta della query sia compreso nel target.</span><span class="sxs-lookup"><span data-stu-id="66392-230">Limit the size of each partition so that the query response time is within target.</span></span>
   - <span data-ttu-id="66392-231">Se si usa il partizionamento orizzontale, progettare la chiave di partizione in modo che l'applicazione possa selezionare facilmente la partizione corretta.</span><span class="sxs-lookup"><span data-stu-id="66392-231">If you use horizontal partitioning, design the shard key so that the application can easily select the right partition.</span></span> <span data-ttu-id="66392-232">In questo modo la query non deve analizzare ogni partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-232">This prevents the query from having to scan through every partition.</span></span>
   - <span data-ttu-id="66392-233">Considerare la posizione di una partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-233">Consider the location of a partition.</span></span> <span data-ttu-id="66392-234">Se possibile, provare a mantenere i dati nelle partizioni geograficamente vicine alle applicazioni e gli utenti che vi accedono.</span><span class="sxs-lookup"><span data-stu-id="66392-234">If possible, try to keep data in partitions that are geographically close to the applications and users that access it.</span></span>

3. <span data-ttu-id="66392-235">Se un'entità dispone di requisiti relativi alle prestazioni di velocità effettiva e della query, utilizzare il partizionamento funzionale in base a tale entità.</span><span class="sxs-lookup"><span data-stu-id="66392-235">If an entity has throughput and query performance requirements, use functional partitioning based on that entity.</span></span> <span data-ttu-id="66392-236">Se tale entità non soddisfa i requisiti, è necessario applicare anche il partizionamento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="66392-236">If this still doesn't satisfy the requirements, apply horizontal partitioning as well.</span></span> <span data-ttu-id="66392-237">Nella maggior parte dei casi è sufficiente una singola strategia di partizionamento, ma in alcuni casi è preferibile combinare entrambe le strategie.</span><span class="sxs-lookup"><span data-stu-id="66392-237">In most cases a single partitioning strategy will suffice, but in some cases it is more efficient to combine both strategies.</span></span>

4. <span data-ttu-id="66392-238">Valutare la possibilità di eseguire le query in parallelo nelle partizioni per migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="66392-238">Consider running queries in parallel across partitions to improve performance.</span></span>

## <a name="designing-partitions-for-availability"></a><span data-ttu-id="66392-239">Progettazione di partizioni per la disponibilità</span><span class="sxs-lookup"><span data-stu-id="66392-239">Designing partitions for availability</span></span>

<span data-ttu-id="66392-240">Il partizionamento dei dati può migliorare la disponibilità delle applicazioni garantendo che l'intero set di dati non costituisca un singolo punto di errore e che i singoli sottoinsiemi del set di dati possano essere gestiti in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="66392-240">Partitioning data can improve the availability of applications by ensuring that the entire dataset does not constitute a single point of failure and that individual subsets of the dataset can be managed independently.</span></span>

<span data-ttu-id="66392-241">Considerare i fattori seguenti, che influiscono sulla disponibilità:</span><span class="sxs-lookup"><span data-stu-id="66392-241">Consider the following factors that affect availability:</span></span>

<span data-ttu-id="66392-242">**Criticità dei dati nelle operazioni aziendali**.</span><span class="sxs-lookup"><span data-stu-id="66392-242">**How critical the data is to business operations**.</span></span> <span data-ttu-id="66392-243">Identificare i dati che sono informazioni aziendali critiche, come le transazioni, e i dati operativi meno critici, come i file di log.</span><span class="sxs-lookup"><span data-stu-id="66392-243">Identify which data is critical business information, such as transactions, and which data is less critical operational data, such as log files.</span></span>

- <span data-ttu-id="66392-244">Valutare la possibilità di archiviare i dati critici in partizioni a disponibilità elevata con un piano di backup appropriato.</span><span class="sxs-lookup"><span data-stu-id="66392-244">Consider storing critical data in highly-available partitions with an appropriate backup plan.</span></span>

- <span data-ttu-id="66392-245">Stabilire procedure di gestione e monitoraggio separate per i diversi set di dati.</span><span class="sxs-lookup"><span data-stu-id="66392-245">Establish separate management and monitoring procedures for the different datasets.</span></span>

- <span data-ttu-id="66392-246">Il posizionamento di dati che hanno lo stesso livello di criticità nella stessa partizione in modo da poter eseguire il backup con una frequenza appropriata.</span><span class="sxs-lookup"><span data-stu-id="66392-246">Place data that has the same level of criticality in the same partition so that it can be backed up together at an appropriate frequency.</span></span> <span data-ttu-id="66392-247">Le partizioni contenenti i dati delle transazioni, ad esempio, potrebbero richiedere backup più frequenti rispetto alle partizioni che contengono informazioni di traccia o di log.</span><span class="sxs-lookup"><span data-stu-id="66392-247">For example, partitions that hold transaction data might need to be backed up more frequently than partitions that hold logging or trace information.</span></span>

<span data-ttu-id="66392-248">**Gestione delle singole partizioni**.</span><span class="sxs-lookup"><span data-stu-id="66392-248">**How individual partitions can be managed**.</span></span> <span data-ttu-id="66392-249">La progettazione di partizioni per supportare la manutenzione e la gestione indipendenti offre diversi vantaggi.</span><span class="sxs-lookup"><span data-stu-id="66392-249">Designing partitions to support independent management and maintenance provides several advantages.</span></span> <span data-ttu-id="66392-250">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="66392-250">For example:</span></span>

- <span data-ttu-id="66392-251">In caso di problemi in una partizione, questa può essere ripristinata in modo indipendente senza le applicazioni che accedono ai dati in altre partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-251">If a partition fails, it can be recovered independently without applications that access data in other partitions.</span></span>

- <span data-ttu-id="66392-252">Il partizionamento dei dati per aree geografiche può consentire attività di manutenzione pianificate che vengono eseguite in determinate fasce orarie per ogni posizione.</span><span class="sxs-lookup"><span data-stu-id="66392-252">Partitioning data by geographical area allows scheduled maintenance tasks to occur at off-peak hours for each location.</span></span> <span data-ttu-id="66392-253">Assicurarsi che le partizioni non siano troppo grandi per evitare che le operazioni di manutenzione pianificata non siano completate durante questo periodo.</span><span class="sxs-lookup"><span data-stu-id="66392-253">Ensure that partitions are not too big to prevent any planned maintenance from being completed during this period.</span></span>

<span data-ttu-id="66392-254">**Replica dei dati critici tra le partizioni**.</span><span class="sxs-lookup"><span data-stu-id="66392-254">**Whether to replicate critical data across partitions**.</span></span> <span data-ttu-id="66392-255">Questa strategia può migliorare la disponibilità e le prestazioni, ma anche introdurre problemi di coerenza.</span><span class="sxs-lookup"><span data-stu-id="66392-255">This strategy can improve availability and performance, but can also introduce consistency issues.</span></span> <span data-ttu-id="66392-256">La sincronizzazione delle modifiche con ogni replica richiede tempo.</span><span class="sxs-lookup"><span data-stu-id="66392-256">It takes time to synchronize changes with every replica.</span></span> <span data-ttu-id="66392-257">Durante questo periodo, le diverse partizioni conterranno valori di dati diversi.</span><span class="sxs-lookup"><span data-stu-id="66392-257">During this period, different partitions will contain different data values.</span></span>

## <a name="application-design-considerations"></a><span data-ttu-id="66392-258">Considerazioni sulla progettazione di applicazioni</span><span class="sxs-lookup"><span data-stu-id="66392-258">Application design considerations</span></span>

<span data-ttu-id="66392-259">Il partizionamento aumenta la complessità di progettazione e sviluppo del sistema.</span><span class="sxs-lookup"><span data-stu-id="66392-259">Partitioning adds complexity to the design and development of your system.</span></span> <span data-ttu-id="66392-260">Considerare il partizionamento come parte fondamentale della progettazione del sistema anche se inizialmente il sistema contiene una singola partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-260">Consider partitioning as a fundamental part of system design even if the system initially only contains a single partition.</span></span> <span data-ttu-id="66392-261">Se eseguito a posteriori, il partizionamento è più complicato perché è già presente un sistema attivo da gestire:</span><span class="sxs-lookup"><span data-stu-id="66392-261">If you address partitioning as an afterthought, it will be more challenging because you already have a live system to maintain:</span></span>

- <span data-ttu-id="66392-262">La logica di accesso ai dati dovrà essere modificata.</span><span class="sxs-lookup"><span data-stu-id="66392-262">Data access logic will need to be modified.</span></span>
- <span data-ttu-id="66392-263">Potrebbe essere necessario eseguire la migrazione di grandi quantità di dati esistenti per distribuire i dati tra le partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-263">Large quantities of existing data may need to be migrated, to distribute it across partitions</span></span>
- <span data-ttu-id="66392-264">Gli utenti si aspettano di poter continuare a usare il sistema durante la migrazione.</span><span class="sxs-lookup"><span data-stu-id="66392-264">Users expect to be able to continue using the system during the migration.</span></span>

<span data-ttu-id="66392-265">In alcuni casi, il partizionamento non è considerato importante perché il set di dati iniziale è ridotto e può essere facilmente gestito da un singolo server.</span><span class="sxs-lookup"><span data-stu-id="66392-265">In some cases, partitioning is not considered important because the initial dataset is small and can be easily handled by a single server.</span></span> <span data-ttu-id="66392-266">Questo può essere vero per alcuni carichi di lavoro, ma molti sistemi commerciali devono espandersi con l'aumento del numero di utenti.</span><span class="sxs-lookup"><span data-stu-id="66392-266">This might be true for some workloads, but many commercial systems need to expand as the number of users increases.</span></span>

<span data-ttu-id="66392-267">Il partizionamento, inoltre, è vantaggioso non solo per archivi dati di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="66392-267">Moreover, it's not only large data stores that benefit from partitioning.</span></span> <span data-ttu-id="66392-268">Ad esempio, un archivio dati di piccole dimensioni potrebbe essere utilizzato molto frequentemente da centinaia di client simultanei.</span><span class="sxs-lookup"><span data-stu-id="66392-268">For example, a small data store might be heavily accessed by hundreds of concurrent clients.</span></span> <span data-ttu-id="66392-269">Il partizionamento dei dati in questa situazione può aiutare a ridurre i conflitti e a migliorare la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="66392-269">Partitioning the data in this situation can help to reduce contention and improve throughput.</span></span>

<span data-ttu-id="66392-270">Quando si progetta un schema di partizionamento dei dati, tenere presente quanto riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="66392-270">Consider the following points when you design a data partitioning scheme:</span></span>

<span data-ttu-id="66392-271">**Ridurre al minimo le operazioni di accesso ai dati tra partizioni**.</span><span class="sxs-lookup"><span data-stu-id="66392-271">**Minimize cross-partition data access operations**.</span></span> <span data-ttu-id="66392-272">Quando possibile, mantenere insieme i dati per le operazioni di database più comuni in ogni partizione per ridurre al minimo le operazioni di accesso ai dati tra partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-272">Where possible, keep data for the most common database operations together in each partition to minimize cross-partition data access operations.</span></span> <span data-ttu-id="66392-273">Le query tra partizioni possono richiedere più tempo rispetto alle query all'interno di una singola partizione, ma ottimizzare le partizioni per un set di query potrebbe influire negativamente sugli altri set di query.</span><span class="sxs-lookup"><span data-stu-id="66392-273">Querying across partitions can be more time-consuming than querying within a single partition, but optimizing partitions for one set of queries might adversely affect other sets of queries.</span></span> <span data-ttu-id="66392-274">Se è necessario eseguire query tra partizioni, ridurne al minimo la durata eseguendo query parallele e aggregando i risultati all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="66392-274">If you must query across partitions, minimize query time by running parallel queries and aggregating the results within the application.</span></span> <span data-ttu-id="66392-275">Questo approccio potrebbe non essere possibile in alcuni casi, ad esempio quando il risultato di una query viene usato nella successiva.</span><span class="sxs-lookup"><span data-stu-id="66392-275">(This approach might not be possible in some cases, such as when the result from one query is used in the next query.)</span></span>

<span data-ttu-id="66392-276">**Valutare la possibilità di replicare i dati di riferimento statici.**</span><span class="sxs-lookup"><span data-stu-id="66392-276">**Consider replicating static reference data.**</span></span> <span data-ttu-id="66392-277">Se le query usano dati di riferimento relativamente statici, come tabelle di codici postali o elenchi di prodotti, valutare la possibilità di replicare tali dati in tutte le partizioni per ridurre le operazioni separate di ricerca in altre partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-277">If queries use relatively static reference data, such as postal code tables or product lists, consider replicating this data in all of the partitions to reduce separate lookup operations in different partitions.</span></span> <span data-ttu-id="66392-278">Questo approccio può ridurre anche la probabilità che i dati di riferimento diventino un set di dati ad accesso frequente e traffico elevato nell'intero sistema.</span><span class="sxs-lookup"><span data-stu-id="66392-278">This approach can also reduce the likelihood of the reference data becoming a "hot" dataset, with heavy traffic from across the entire system.</span></span> <span data-ttu-id="66392-279">Alla sincronizzazione di tutte le modifiche ai dati di riferimento è tuttavia associato un costo aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="66392-279">However, there is an additional cost associated with synchronizing any changes to the reference data.</span></span>

<span data-ttu-id="66392-280">**Ridurre al minimo i join tra partizioni.**</span><span class="sxs-lookup"><span data-stu-id="66392-280">**Minimize cross-partition joins.**</span></span> <span data-ttu-id="66392-281">Quando possibile, ridurre al minimo i requisiti di integrità referenziale tra le partizioni verticali e funzionali.</span><span class="sxs-lookup"><span data-stu-id="66392-281">Where possible, minimize requirements for referential integrity across vertical and functional partitions.</span></span> <span data-ttu-id="66392-282">In questi schemi, l'applicazione è responsabile del mantenimento dell'integrità referenziale tra le partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-282">In these schemes, the application is responsible for maintaining referential integrity across partitions.</span></span> <span data-ttu-id="66392-283">Le query che uniscono in join i dati in più partizioni sono inefficienti perché l'applicazione in genere deve eseguire query consecutive in base a una chiave e quindi a una chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="66392-283">Queries that join data across multiple partitions are inefficient because the application typically needs to perform consecutive queries based on a key and then a foreign key.</span></span> <span data-ttu-id="66392-284">Si consiglia di replicare o de-normalizzare i dati rilevanti.</span><span class="sxs-lookup"><span data-stu-id="66392-284">Instead, consider replicating or de-normalizing the relevant data.</span></span> <span data-ttu-id="66392-285">Se sono necessari join tra partizioni, eseguire query parallele sulle partizioni e unire i dati all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="66392-285">If cross-partition joins are necessary, run parallel queries over the partitions and join the data within the application.</span></span>

<span data-ttu-id="66392-286">**Implementare la coerenza finale**.</span><span class="sxs-lookup"><span data-stu-id="66392-286">**Embrace eventual consistency**.</span></span> <span data-ttu-id="66392-287"> Valutare se la coerenza assoluta è effettivamente un requisito.</span><span class="sxs-lookup"><span data-stu-id="66392-287">Evaluate whether strong consistency is actually a requirement.</span></span> <span data-ttu-id="66392-288">Nei sistemi distribuiti, un approccio comune consiste nell'implementare la coerenza finale.</span><span class="sxs-lookup"><span data-stu-id="66392-288">A common approach in distributed systems is to implement eventual consistency.</span></span> <span data-ttu-id="66392-289">I dati in ogni partizione vengono aggiornati separatamente e la logica dell'applicazione garantisce che tutti gli aggiornamenti vengano completati correttamente.</span><span class="sxs-lookup"><span data-stu-id="66392-289">The data in each partition is updated separately, and the application logic ensures that the updates are all completed successfully.</span></span> <span data-ttu-id="66392-290">La logica gestisce inoltre le incoerenze che possono essere generate da query sui dati durante l'esecuzione di un'operazione coerente.</span><span class="sxs-lookup"><span data-stu-id="66392-290">It also handles the inconsistencies that can arise from querying data while an eventually consistent operation is running.</span></span>

<span data-ttu-id="66392-291">**È necessario considerare come le query individuano la partizione corretta**.</span><span class="sxs-lookup"><span data-stu-id="66392-291">**Consider how queries locate the correct partition**.</span></span> <span data-ttu-id="66392-292">Se una query deve analizzare tutte le partizioni per individuare i dati richiesti, ci sarà un impatto significativo sulle prestazioni, anche se sono in esecuzione più query parallele.</span><span class="sxs-lookup"><span data-stu-id="66392-292">If a query must scan all partitions to locate the required data, there is a significant impact on performance, even when multiple parallel queries are running.</span></span> <span data-ttu-id="66392-293">Con il partizionamento verticale e funzionale, le query possono naturalmente specificare le partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-293">With vertical and functional partitioning, queries can naturally specify the partition.</span></span> <span data-ttu-id="66392-294">Con il partizionamento orizzontale, invece, può essere difficile individuare un elemento perché ogni partizione ha lo stesso schema.</span><span class="sxs-lookup"><span data-stu-id="66392-294">Horizontal partitioning, on the other hand, can make locating an item difficult, because every shard has the same schema.</span></span> <span data-ttu-id="66392-295">Una soluzione tipica consiste nel mantenere una mappa che verrà usata per cercare elementi specifici nel percorso delle partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-295">A typical solution to maintain a map that is used to look up the shard location for specific items.</span></span> <span data-ttu-id="66392-296">Questa mappa può essere implementata nella logica di partizionamento orizzontale dell'applicazione o gestita dall'archivio dati se supporta il partizionamento orizzontale trasparente.</span><span class="sxs-lookup"><span data-stu-id="66392-296">This map can be implemented in the sharding logic of the application, or maintained by the data store if it supports transparent sharding.</span></span>

<span data-ttu-id="66392-297">**Valutare la possibilità di ribilanciare periodicamente le partizioni**.</span><span class="sxs-lookup"><span data-stu-id="66392-297">**Consider periodically rebalancing shards**.</span></span> <span data-ttu-id="66392-298">Con il partizionamento orizzontale, il ribilanciamento delle partizioni consente di distribuire uniformemente i dati in base alle dimensioni e al carico di lavoro per ridurre al minimo le aree ad accesso frequente, ottimizzare le prestazioni delle query e aggirare le limitazioni fisiche dello spazio di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="66392-298">With horizontal partitioning, rebalancing shards can help distribute the data evenly by size and by workload to minimize hotspots, maximize query performance, and work around physical storage limitations.</span></span> <span data-ttu-id="66392-299">Tuttavia, si tratta di un'attività complessa che spesso richiede l'utilizzo di uno strumento personalizzato o di un processo.</span><span class="sxs-lookup"><span data-stu-id="66392-299">However, this is a complex task that often requires the use of a custom tool or process.</span></span>

<span data-ttu-id="66392-300">**Replicare le partizioni.**</span><span class="sxs-lookup"><span data-stu-id="66392-300">**Replicate partitions.**</span></span> <span data-ttu-id="66392-301">La replica di ogni partizione offre protezione aggiuntiva dagli errori.</span><span class="sxs-lookup"><span data-stu-id="66392-301">If you replicate each partition, it provides additional protection against failure.</span></span> <span data-ttu-id="66392-302">Se una singola replica ha esito negativo, le query possono essere indirizzate verso una copia di lavoro.</span><span class="sxs-lookup"><span data-stu-id="66392-302">If a single replica fails, queries can be directed towards a working copy.</span></span>

<span data-ttu-id="66392-303">**Se si raggiungono i limiti fisici di una strategia di partizionamento, potrebbe essere necessario estendere la scalabilità a un livello diverso**.</span><span class="sxs-lookup"><span data-stu-id="66392-303">**If you reach the physical limits of a partitioning strategy, you might need to extend the scalability to a different level**.</span></span> <span data-ttu-id="66392-304">Ad esempio, se il partizionamento è a livello di database, potrebbe essere necessario individuare o eseguire la replica delle partizioni in più database.</span><span class="sxs-lookup"><span data-stu-id="66392-304">For example, if partitioning is at the database level, you might need to locate or replicate partitions in multiple databases.</span></span> <span data-ttu-id="66392-305">Se il partizionamento è già a livello di database e i limiti fisici sono un problema, può essere necessario individuare o eseguire la replica delle partizioni in più account di hosting.</span><span class="sxs-lookup"><span data-stu-id="66392-305">If partitioning is already at the database level, and physical limitations are an issue, it might mean that you need to locate or replicate partitions in multiple hosting accounts.</span></span>

<span data-ttu-id="66392-306">**Evitare transazioni che accedono ai dati in più partizioni**.</span><span class="sxs-lookup"><span data-stu-id="66392-306">**Avoid transactions that access data in multiple partitions**.</span></span> <span data-ttu-id="66392-307">Alcuni archivi di dati implementano la coerenza transazionale e l'integrità per le operazioni che modificano i dati, ma solo quando i dati si trovano in una singola partizione.</span><span class="sxs-lookup"><span data-stu-id="66392-307">Some data stores implement transactional consistency and integrity for operations that modify data, but only when the data is located in a single partition.</span></span> <span data-ttu-id="66392-308">Se è necessario supporto transazionale tra più partizioni, probabilmente sarà necessario implementare questo come parte della logica dell'applicazione poiché la maggior parte dei sistemi di partizionamento non forniscono il supporto nativo.</span><span class="sxs-lookup"><span data-stu-id="66392-308">If you need transactional support across multiple partitions, you will probably need to implement this as part of your application logic because most partitioning systems do not provide native support.</span></span>

<span data-ttu-id="66392-309">Tutti gli archivi dati richiedono una gestione operativa e il monitoraggio dell'attività.</span><span class="sxs-lookup"><span data-stu-id="66392-309">All data stores require some operational management and monitoring activity.</span></span> <span data-ttu-id="66392-310">Le attività variano dal caricamento dei dati, backup e ripristino dei dati, riorganizzazione dei dati e la garanzia che il sistema funziona in modo corretto ed efficiente.</span><span class="sxs-lookup"><span data-stu-id="66392-310">The tasks can range from loading data, backing up and restoring data, reorganizing data, and ensuring that the system is performing correctly and efficiently.</span></span>

<span data-ttu-id="66392-311">Considerare i seguenti fattori che influiscono sulla gestione operativa:</span><span class="sxs-lookup"><span data-stu-id="66392-311">Consider the following factors that affect operational management:</span></span>

- <span data-ttu-id="66392-312">**Come implementare attività di gestione e operative appropriate quando i dati sono partizionati**.</span><span class="sxs-lookup"><span data-stu-id="66392-312">**How to implement appropriate management and operational tasks when the data is partitioned**.</span></span> <span data-ttu-id="66392-313">Queste attività possono includere il backup e il ripristino, l'archiviazione dei dati, il monitoraggio del sistema e altre attività amministrative.</span><span class="sxs-lookup"><span data-stu-id="66392-313">These tasks might include backup and restore, archiving data, monitoring the system, and other administrative tasks.</span></span> <span data-ttu-id="66392-314">Mantenere la coerenza logica durante le operazioni di backup e ripristino, ad esempio, può essere una sfida.</span><span class="sxs-lookup"><span data-stu-id="66392-314">For example, maintaining logical consistency during backup and restore operations can be a challenge.</span></span>

- <span data-ttu-id="66392-315">**Come caricare i dati in più partizioni e aggiungere nuovi dati provenienti da altre origini**.</span><span class="sxs-lookup"><span data-stu-id="66392-315">**How to load the data into multiple partitions and add new data that's arriving from other sources**.</span></span> <span data-ttu-id="66392-316">Alcuni strumenti e utilità potrebbero non supportare le operazioni di dati partizionati, quale il caricamento dei dati nella partizione corretta.</span><span class="sxs-lookup"><span data-stu-id="66392-316">Some tools and utilities might not support sharded data operations such as loading data into the correct partition.</span></span>

- <span data-ttu-id="66392-317">**Come archiviare ed eliminare i dati a intervalli regolari**.</span><span class="sxs-lookup"><span data-stu-id="66392-317">**How to archive and delete the data on a regular basis**.</span></span> <span data-ttu-id="66392-318">Per impedire una crescita eccessiva delle partizioni, è necessario archiviare ed eliminare i dati a intervalli regolari, ad esempio ogni mese.</span><span class="sxs-lookup"><span data-stu-id="66392-318">To prevent the excessive growth of partitions, you need to archive and delete data on a regular basis (perhaps monthly).</span></span> <span data-ttu-id="66392-319">Può essere necessario trasformare i dati in base a uno schema di archiviazione differente.</span><span class="sxs-lookup"><span data-stu-id="66392-319">It might be necessary to transform the data to match a different archive schema.</span></span>

- <span data-ttu-id="66392-320">**Come individuare i problemi di integrità dei dati**.</span><span class="sxs-lookup"><span data-stu-id="66392-320">**How to locate data integrity issues**.</span></span> <span data-ttu-id="66392-321">Valutare la possibilità di eseguire periodicamente un processo per individuare eventuali problemi di integrità dei dati, ad esempio dati in una partizione che fanno riferimento a informazioni mancanti in un'altra.</span><span class="sxs-lookup"><span data-stu-id="66392-321">Consider running a periodic process to locate any data integrity issues, such as data in one partition that references missing information in another.</span></span> <span data-ttu-id="66392-322">Il processo potrà tentare di correggere automaticamente i problemi oppure generare semplicemente un report per la verifica manuale.</span><span class="sxs-lookup"><span data-stu-id="66392-322">The process can either attempt to fix these issues automatically or simply generate a report for manual review.</span></span>

## <a name="rebalancing-partitions"></a><span data-ttu-id="66392-323">Ribilanciamento delle partizioni</span><span class="sxs-lookup"><span data-stu-id="66392-323">Rebalancing partitions</span></span>

<span data-ttu-id="66392-324">Con l'evoluzione del sistema potrebbe essere necessario modificare lo schema di partizionamento.</span><span class="sxs-lookup"><span data-stu-id="66392-324">As a system matures, you might have to adjust the partitioning scheme.</span></span> <span data-ttu-id="66392-325">È ad esempio possibile che singole partizioni inizino a ricevere un volume di traffico sproporzionato e diventino ad accesso frequente, causando una contesa eccessiva,</span><span class="sxs-lookup"><span data-stu-id="66392-325">For example, individual partitions might start get a disproportionate volume of traffic and become hot, leading to excessive contention.</span></span> <span data-ttu-id="66392-326">oppure che il volume dei dati in alcune partizioni sia stato sottostimato e che di conseguenza alcune partizioni stiano per raggiungere i limiti di capacità.</span><span class="sxs-lookup"><span data-stu-id="66392-326">Or you might have underestimated the volume of data in some partitions, causing some partitions to approach capacity limits.</span></span>

<span data-ttu-id="66392-327">Alcuni archivi dati, come Cosmos DB, possono ribilanciare automaticamente le partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-327">Some data stores, such as Cosmos DB, can automatically rebalance partitions.</span></span> <span data-ttu-id="66392-328">In altri casi, il ribilanciamento è un'attività amministrativa in due fasi:</span><span class="sxs-lookup"><span data-stu-id="66392-328">In other cases, rebalancing is an administrative task that consists of two stages:</span></span>

1. <span data-ttu-id="66392-329">Determinare una nuova strategia di partizionamento.</span><span class="sxs-lookup"><span data-stu-id="66392-329">Determine a new partitioning strategy.</span></span>

    - <span data-ttu-id="66392-330">Quali partizioni è necessario dividere o eventualmente combinare?</span><span class="sxs-lookup"><span data-stu-id="66392-330">Which partitions need to be split (or possibly combined)?</span></span>
    - <span data-ttu-id="66392-331">Qual è la nuova chiave di partizione?</span><span class="sxs-lookup"><span data-stu-id="66392-331">What is the new partition key?</span></span>

2. <span data-ttu-id="66392-332">Eseguire la migrazione dei dati dallo schema di partizionamento precedente al nuovo set di partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-332">Migrate data from the old partitioning scheme to the new set of partitions.</span></span>

<span data-ttu-id="66392-333">A seconda dell'archivio dati, potrebbe essere possibile eseguire la migrazione dei dati tra le partizioni mentre vengono usate.</span><span class="sxs-lookup"><span data-stu-id="66392-333">Depending on the data store, you might be able to migrate data between partitions while they are in use.</span></span> <span data-ttu-id="66392-334">Questo approccio è denominato *migrazione online*.</span><span class="sxs-lookup"><span data-stu-id="66392-334">This is called *online migration*.</span></span> <span data-ttu-id="66392-335">Se non è possibile, potrebbe essere necessario rendere le partizioni non disponibili durante la rilocazione dei dati (*migrazione offline*).</span><span class="sxs-lookup"><span data-stu-id="66392-335">If that's not possible, you might need to make partitions unavailable while the data is relocated (*offline migration*).</span></span>

### <a name="offline-migration"></a><span data-ttu-id="66392-336">Migrazione offline</span><span class="sxs-lookup"><span data-stu-id="66392-336">Offline migration</span></span>

<span data-ttu-id="66392-337">La migrazione offline è in genere più semplice perché riduce le probabilità di contesa.</span><span class="sxs-lookup"><span data-stu-id="66392-337">Offline migration is generally simpler, because it reduces the chances of contention occurring.</span></span> <span data-ttu-id="66392-338">A livello concettuale, la migrazione offline funziona nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="66392-338">Conceptually, offline migration works as follows:</span></span>

1. <span data-ttu-id="66392-339">Contrassegnare la partizione come offline.</span><span class="sxs-lookup"><span data-stu-id="66392-339">Mark the partition offline.</span></span>
2. <span data-ttu-id="66392-340">Dividere/unire e spostare i dati nelle nuove partizioni.</span><span class="sxs-lookup"><span data-stu-id="66392-340">Split-merge and move the data to the new partitions.</span></span>
3. <span data-ttu-id="66392-341">Verificare i dati.</span><span class="sxs-lookup"><span data-stu-id="66392-341">Verify the data.</span></span>
4. <span data-ttu-id="66392-342">Portare le nuove partizioni online.</span><span class="sxs-lookup"><span data-stu-id="66392-342">Bring the new partitions online.</span></span>
5. <span data-ttu-id="66392-343">Rimuovere la partizione precedente.</span><span class="sxs-lookup"><span data-stu-id="66392-343">Remove the old partition.</span></span>

<span data-ttu-id="66392-344">Facoltativamente, è possibile contrassegnare una partizione come di sola lettura nel passaggio 1, in modo che le applicazioni possano comunque leggere i dati mentre vengono spostati.</span><span class="sxs-lookup"><span data-stu-id="66392-344">Optionally, you can mark a partition as read-only in step 1, so that applications can still read the data while it is being moved.</span></span>

## <a name="online-migration"></a><span data-ttu-id="66392-345">Migrazione online</span><span class="sxs-lookup"><span data-stu-id="66392-345">Online migration</span></span>

<span data-ttu-id="66392-346">La migrazione online è più complessa ma comporta minori interruzioni.</span><span class="sxs-lookup"><span data-stu-id="66392-346">Online migration is more complex to perform but less disruptive.</span></span> <span data-ttu-id="66392-347">Il processo è simile alla migrazione offline, ad eccezione del fatto che la partizione originale non viene contrassegnata come offline.</span><span class="sxs-lookup"><span data-stu-id="66392-347">The process is similar to offline migration, except the original partition is not marked offline.</span></span> <span data-ttu-id="66392-348">A seconda della granularità del processo di migrazione (ad esempio, elemento per elemento o partizione per partizione), il codice di accesso ai dati nelle applicazioni client potrebbe dover gestire la lettura e la scrittura di dati contenuti in due posizioni, ossia la partizione originale e quella nuova.</span><span class="sxs-lookup"><span data-stu-id="66392-348">Depending on the granularity of the migration process (for example, item by item versus shard by shard), the data access code in the client applications might have to handle reading and writing data that's held in two locations, the original partition and the new partition.</span></span>

## <a name="related-patterns"></a><span data-ttu-id="66392-349">Modelli correlati</span><span class="sxs-lookup"><span data-stu-id="66392-349">Related patterns</span></span>

<span data-ttu-id="66392-350">Per uno specifico scenario potrebbero essere rilevanti i modelli di progettazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="66392-350">The following design patterns might be relevant to your scenario:</span></span>

- <span data-ttu-id="66392-351">Il [modello di partizionamento orizzontale](../patterns/sharding.md) descrive alcune strategie comuni per il partizionamento orizzontale dei dati.</span><span class="sxs-lookup"><span data-stu-id="66392-351">The [sharding pattern](../patterns/sharding.md) describes some common strategies for sharding data.</span></span>

- <span data-ttu-id="66392-352">Il [modello di tabella degli indici](../patterns/index-table.md) illustra come creare indici secondari sui dati.</span><span class="sxs-lookup"><span data-stu-id="66392-352">The [index table pattern](../patterns/index-table.md) shows how to create secondary indexes over data.</span></span> <span data-ttu-id="66392-353">Un'applicazione consente di recuperare rapidamente i dati con questo approccio, usando le query che non fanno riferimento alla chiave primaria di una raccolta.</span><span class="sxs-lookup"><span data-stu-id="66392-353">An application can quickly retrieve data with this approach, by using queries that do not reference the primary key of a collection.</span></span>

- <span data-ttu-id="66392-354">Il [modello di vista materializzata](../patterns/materialized-view.md) descrive come generare viste prepopolate con un riepilogo dei dati per supportare operazioni di query rapide.</span><span class="sxs-lookup"><span data-stu-id="66392-354">The [materialized view pattern](../patterns/materialized-view.md) describes how to generate pre-populated views that summarize data to support fast query operations.</span></span> <span data-ttu-id="66392-355">Questo approccio può essere utile in un archivio dati partizionati se le partizioni che contengono dati riepilogati vengono distribuite tra più siti.</span><span class="sxs-lookup"><span data-stu-id="66392-355">This approach can be useful in a partitioned data store if the partitions that contain the data being summarized are distributed across multiple sites.</span></span>

## <a name="next-steps"></a><span data-ttu-id="66392-356">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="66392-356">Next steps</span></span>

- <span data-ttu-id="66392-357">Informazioni sulle strategie di partizionamento per servizi di Azure specifici.</span><span class="sxs-lookup"><span data-stu-id="66392-357">Learn about partitioning strategies for specific Azure services.</span></span> <span data-ttu-id="66392-358">Vedere [Strategie di partizionamento dei dati](./data-partitioning-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="66392-358">See [Data partitioning strategies](./data-partitioning-strategies.md)</span></span>

[Obiettivi di scalabilità e prestazioni per Archiviazione di Azure]: /azure/storage/storage-scalability-targets
[Azure Storage Scalability and Performance Targets]: /azure/storage/storage-scalability-targets

---
title: "Linee guida per la progettazione di un’API"
description: "Linee guida su come creare un’API ben progettata."
author: dragon119
ms.date: 07/13/2016
pnp.series.title: Best Practices
ms.openlocfilehash: 3ffadce1b0c4a4da808e52d61cff0b7f0b27de11
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/14/2017
---
# <a name="api-design"></a><span data-ttu-id="2f03a-103">Progettazione API</span><span class="sxs-lookup"><span data-stu-id="2f03a-103">API design</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="2f03a-104">Molte soluzioni moderne basate sul Web ricorrono ai servizi Web, ospitati su server Web, per fornire funzionalità per le applicazioni client remote.</span><span class="sxs-lookup"><span data-stu-id="2f03a-104">Many modern web-based solutions make the use of web services, hosted by web servers, to provide functionality for remote client applications.</span></span> <span data-ttu-id="2f03a-105">Le operazioni esposte da un servizio Web costituiscono un'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-105">The operations that a web service exposes constitute a web API.</span></span> <span data-ttu-id="2f03a-106">Un'API Web progettata in modo adeguato deve supportare:</span><span class="sxs-lookup"><span data-stu-id="2f03a-106">A well-designed web API should aim to support:</span></span>

* <span data-ttu-id="2f03a-107">**Indipendenza dalla piattaforma**.</span><span class="sxs-lookup"><span data-stu-id="2f03a-107">**Platform independence**.</span></span> <span data-ttu-id="2f03a-108">Le applicazioni client devono riuscire a usare l'API fornita dal servizio Web senza richiedere in che modo i dati o le operazioni esposte dall’API vengano implementati fisicamente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-108">Client applications should be able to utilize the API that the web service provides without requiring how the data or operations that API exposes are physically implemented.</span></span> <span data-ttu-id="2f03a-109">A questo scopo, l’API deve rispettare gli standard comuni che consentono a un’applicazione client e a un servizio Web di concordare i formati di dati da usare e la struttura dei dati scambiati tra le applicazioni client e il servizio Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-109">This requires that the API abides by common standards that enable a client application and web service to agree on which data formats to use, and the structure of the data that is exchanged between client applications and the web service.</span></span>
* <span data-ttu-id="2f03a-110">**Evoluzione del servizio**.</span><span class="sxs-lookup"><span data-stu-id="2f03a-110">**Service evolution**.</span></span> <span data-ttu-id="2f03a-111">Il servizio Web deve essere in grado di evolversi e aggiungere o rimuovere funzionalità in modo indipendente dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="2f03a-111">The web service should be able to evolve and add (or remove) functionality independently from client applications.</span></span> <span data-ttu-id="2f03a-112">Le applicazioni client esistenti devono continuare a funzionare senza modifiche mentre le funzionalità fornite dal servizio Web cambiano.</span><span class="sxs-lookup"><span data-stu-id="2f03a-112">Existing client applications should be able to continue to operate unmodified as the features provided by the web service change.</span></span> <span data-ttu-id="2f03a-113">Tutte le funzionalità devono essere individuabili, per poter essere usate appieno dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="2f03a-113">All functionality should also be discoverable, so that client applications can fully utilize it.</span></span>

<span data-ttu-id="2f03a-114">Lo scopo di queste linee guida è descrivere i problemi da prendere in considerazione quando si progetta un'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-114">The purpose of this guidance is to describe the issues that you should consider when designing a web API.</span></span>

## <a name="introduction-to-representational-state-transfer-rest"></a><span data-ttu-id="2f03a-115">Introduzione a REST (Representational State Transfer)</span><span class="sxs-lookup"><span data-stu-id="2f03a-115">Introduction to Representational State Transfer (REST)</span></span>
<span data-ttu-id="2f03a-116">Nella sua dissertazione del 2000, Roy Fielding ha proposto un approccio architetturale alternativo per strutturare le operazioni esposte da servizi Web, denominato REST.</span><span class="sxs-lookup"><span data-stu-id="2f03a-116">In his dissertation in 2000, Roy Fielding proposed an alternative architectural approach to structuring the operations exposed by web services; REST.</span></span> <span data-ttu-id="2f03a-117">REST è uno stile architetturale per la creazione di sistemi distribuiti basati su ipermedia.</span><span class="sxs-lookup"><span data-stu-id="2f03a-117">REST is an architectural style for building distributed systems based on hypermedia.</span></span> <span data-ttu-id="2f03a-118">Uno dei principali vantaggi del modello REST sta nel fatto che è basato su standard aperti e che non vincola l'implementazione del modello o le applicazioni client che vi accedono a nessuna implementazione specifica.</span><span class="sxs-lookup"><span data-stu-id="2f03a-118">A primary advantage of the REST model is that it is based on open standards and does not bind the implementation of the model or the client applications that access it to any specific implementation.</span></span> <span data-ttu-id="2f03a-119">Ad esempio, un servizio Web REST può essere implementato usando l’API Web Microsoft ASP.NET e le applicazioni client possono essere sviluppate usando qualsiasi linguaggio e set di strumenti in grado di generare richieste HTTP e analizzare le risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f03a-119">For example, a REST web service could be implemented by using the Microsoft ASP.NET Web API, and client applications could be developed by using any language and toolset that can generate HTTP requests and parse HTTP responses.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-120">REST è di fatto indipendente da qualsiasi protocollo sottostante e non è necessariamente legato a HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f03a-120">REST is actually independent of any underlying protocol and is not necessarily tied to HTTP.</span></span> <span data-ttu-id="2f03a-121">Tuttavia, le implementazioni più comuni dei sistemi basati su REST usano HTTP come protocollo di applicazione per l'invio e la ricezione di richieste.</span><span class="sxs-lookup"><span data-stu-id="2f03a-121">However, most common implementations of systems that are based on REST utilize HTTP as the application protocol for sending and receiving requests.</span></span> <span data-ttu-id="2f03a-122">Questo documento è incentrato sul mapping dei principi REST ai sistemi progettati per funzionare con HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f03a-122">This document focuses on mapping REST principles to systems designed to operate using HTTP.</span></span>
>
>

<span data-ttu-id="2f03a-123">Per rappresentare gli oggetti e i servizi in una rete, denominati *risorse*, il modello REST usa uno schema di spostamento.</span><span class="sxs-lookup"><span data-stu-id="2f03a-123">The REST model uses a navigational scheme to represent objects and services over a network (referred to as *resources*).</span></span> <span data-ttu-id="2f03a-124">Molti sistemi che implementano REST in genere usano il protocollo HTTP per trasmettere le richieste di accesso a queste risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-124">Many systems that implement REST typically use the HTTP protocol to transmit requests to access these resources.</span></span> <span data-ttu-id="2f03a-125">In questi sistemi, un'applicazione client invia una richiesta sotto forma di un URI che identifica una risorsa e un metodo HTTP (i più comuni sono GET, POST, PUT o DELETE) che indica l'operazione da eseguire su tale risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-125">In these systems, a client application submits a request in the form of a URI that identifies a resource, and an HTTP method (the most common being GET, POST, PUT, or DELETE) that indicates the operation to be performed on that resource.</span></span>  <span data-ttu-id="2f03a-126">Il corpo della richiesta HTTP contiene i dati necessari per eseguire l'operazione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-126">The body of the HTTP request contains the data required to perform the operation.</span></span> <span data-ttu-id="2f03a-127">Il punto importante da comprendere è che REST definisce un modello di richiesta senza stato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-127">The important point to understand is that REST defines a stateless request model.</span></span> <span data-ttu-id="2f03a-128">Le richieste HTTP devono essere indipendenti e possono verificarsi in qualsiasi ordine, per cui il tentativo di mantenere le informazioni di stato temporaneo tra due richieste non è realizzabile.</span><span class="sxs-lookup"><span data-stu-id="2f03a-128">HTTP requests should be independent and may occur in any order, so attempting to retain transient state information between requests is not feasible.</span></span>  <span data-ttu-id="2f03a-129">L'unico punto in cui sono memorizzate le informazioni sono le risorse stesse e ogni richiesta deve essere un'operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="2f03a-129">The only place where information is stored is in the resources themselves, and each request should be an atomic operation.</span></span> <span data-ttu-id="2f03a-130">In effetti, un modello REST implementa una macchina a stati finiti in cui una richiesta passa una risorsa da uno stato non temporaneo ben definito a un altro.</span><span class="sxs-lookup"><span data-stu-id="2f03a-130">Effectively, a REST model implements a finite state machine where a request transitions a resource from one well-defined non-transient state to another.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-131">La natura senza stato delle singole richieste nel modello REST consente a un sistema costituito dai seguenti principi di essere altamente scalabile.</span><span class="sxs-lookup"><span data-stu-id="2f03a-131">The stateless nature of individual requests in the REST model enables a system constructed by following these principles to be highly scalable.</span></span> <span data-ttu-id="2f03a-132">Non è necessario conservare l’affinità tra un'applicazione client che effettua una serie di richieste e i server Web specifici che gestiscono queste richieste.</span><span class="sxs-lookup"><span data-stu-id="2f03a-132">There is no need to retain any affinity between a client application making a series of requests and the specific web servers handling those requests.</span></span>
>
>

<span data-ttu-id="2f03a-133">Un altro punto fondamentale nell'implementazione di un modello REST efficace consiste nel comprendere le relazioni tra le varie risorse a cui il modello fornisce l'accesso.</span><span class="sxs-lookup"><span data-stu-id="2f03a-133">Another crucial point in implementing an effective REST model is to understand the relationships between the various resources to which the model provides access.</span></span> <span data-ttu-id="2f03a-134">Queste risorse sono in genere organizzate in raccolte e relazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-134">These resources are typically organized as collections and relationships.</span></span> <span data-ttu-id="2f03a-135">Ad esempio, si supponga che una rapida analisi di un sistema di e-commerce mostri che le raccolte a cui le applicazioni client possono essere interessate sono due: ordini e clienti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-135">For example, suppose that a quick analysis of an ecommerce system shows that there are two collections in which client applications are likely to be interested: orders and customers.</span></span> <span data-ttu-id="2f03a-136">Ogni ordine e ogni cliente deve avere la propria chiave univoca per l'identificazione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-136">Each order and customer should have its own unique key for identification purposes.</span></span> <span data-ttu-id="2f03a-137">L'URI per accedere alla raccolta di ordini può essere semplice come */orders*. Analogamente, l'URI per recuperare tutti i clienti può essere */customers*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-137">The URI to access the collection of orders could be something as simple as */orders*, and similarly the URI for retrieving all customers could be */customers*.</span></span> <span data-ttu-id="2f03a-138">L'invio di una richiesta HTTP GET all'URI */orders* deve restituire un elenco che rappresenta tutti gli ordini nella raccolta, codificato come risposta HTTP:</span><span class="sxs-lookup"><span data-stu-id="2f03a-138">Issuing an HTTP GET request to the */orders* URI should return a list representing all orders in the collection encoded as an HTTP response:</span></span>

```HTTP
GET http://adventure-works.com/orders HTTP/1.1
...
```

<span data-ttu-id="2f03a-139">Nella risposta mostrata di seguito, gli ordini sono codificati come struttura di elenchi JSON:</span><span class="sxs-lookup"><span data-stu-id="2f03a-139">The response shown below encodes the orders as a JSON list structure:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
[{"orderId":1,"orderValue":99.90,"productId":1,"quantity":1},{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2},{"orderId":3,"orderValue":16.60,"productId":2,"quantity":4},{"orderId":4,"orderValue":25.90,"productId":3,"quantity":1},{"orderId":5,"orderValue":99.90,"productId":1,"quantity":1}]
```
<span data-ttu-id="2f03a-140">Per recuperare un singolo ordine è necessario specificarne l'identificatore dalla risorsa *orders*, ad esempio */orders/2*:</span><span class="sxs-lookup"><span data-stu-id="2f03a-140">To fetch an individual order requires specifying the identifier for the order from the *orders* resource, such as */orders/2*:</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
```

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2}
```

> [!NOTE]
> <span data-ttu-id="2f03a-141">Per semplicità, questi esempi mostrano le informazioni nelle risposte restituite come dati di testo JSON.</span><span class="sxs-lookup"><span data-stu-id="2f03a-141">For simplicity, these examples show the information in responses being returned as JSON text data.</span></span> <span data-ttu-id="2f03a-142">Non esiste tuttavia alcuna ragione per cui le risorse non debbano contenere qualsiasi altro tipo di dati supportato da HTTP, ad esempio informazioni binarie o crittografate. Il tipo di contenuto nella risposta HTTP deve specificare il tipo.</span><span class="sxs-lookup"><span data-stu-id="2f03a-142">However, there is no reason why resources should not contain any other type of data supported by HTTP, such as binary or encrypted information; the content-type in the HTTP response should specify the type.</span></span> <span data-ttu-id="2f03a-143">Un modello REST può anche essere in grado di restituire gli stessi dati in formati diversi, ad esempio XML o JSON.</span><span class="sxs-lookup"><span data-stu-id="2f03a-143">Also, a REST model may be able to return the same data in different formats, such as XML or JSON.</span></span> <span data-ttu-id="2f03a-144">In questo caso, il servizio Web deve essere in grado di eseguire la negoziazione del contenuto con il client che effettua la richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-144">In this case, the web service should be able to perform content negotiation with the client making the request.</span></span> <span data-ttu-id="2f03a-145">La richiesta può includere un'intestazione *Accept* che specifica il formato preferito che il client vorrebbe ricevere. Il servizio Web proverà a rispettare questo formato, se possibile.</span><span class="sxs-lookup"><span data-stu-id="2f03a-145">The request can include an *Accept* header which specifies the preferred format that the client would like to receive and the web service should attempt to honor this format if at all possible.</span></span>
>
>

<span data-ttu-id="2f03a-146">Si noti che la risposta da una richiesta REST standard utilizza i codici di stato HTTP standard.</span><span class="sxs-lookup"><span data-stu-id="2f03a-146">Notice that the response from a REST request makes use of the standard HTTP status codes.</span></span> <span data-ttu-id="2f03a-147">Ad esempio, una richiesta che restituisce dati validi deve includere il codice di risposta HTTP 200 (OK), mentre una richiesta che non riesce a trovare o eliminare una risorsa specificata deve restituire una risposta che include il codice di stato HTTP 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="2f03a-147">For example, a request that returns valid data should include the HTTP response code 200 (OK), while a request that fails to find or delete a specified resource should return a response that includes the HTTP status code 404 (Not Found).</span></span>

## <a name="design-and-structure-of-a-restful-web-api"></a><span data-ttu-id="2f03a-148">Progettazione e struttura di un'API Web RESTful</span><span class="sxs-lookup"><span data-stu-id="2f03a-148">Design and structure of a RESTful web API</span></span>
<span data-ttu-id="2f03a-149">Le chiavi per la progettazione di un'API Web efficace sono semplicità e uniformità.</span><span class="sxs-lookup"><span data-stu-id="2f03a-149">The keys to designing a successful web API are simplicity and consistency.</span></span> <span data-ttu-id="2f03a-150">Un'API Web caratterizzata da questi due fattori rende più semplice creare applicazioni client che devono usare l'API.</span><span class="sxs-lookup"><span data-stu-id="2f03a-150">A Web API that exhibits these two factors makes it easier to build client applications that need to consume the API.</span></span>

<span data-ttu-id="2f03a-151">Un'API Web RESTful è incentrata sull’esposizione di un set di risorse connesse e sulla fornitura delle operazioni principali che consentono a un'applicazione di modificare queste risorse e di spostarsi facilmente tra loro.</span><span class="sxs-lookup"><span data-stu-id="2f03a-151">A RESTful web API is focused on exposing a set of connected resources, and providing the core operations that enable an application to manipulate these resources and easily navigate between them.</span></span> <span data-ttu-id="2f03a-152">Per questo motivo, gli URI che costituiscono un'API Web RESTful standard devono essere orientati ai dati che questa espone e utilizzare le funzionalità fornite da HTTP per operare su questi dati.</span><span class="sxs-lookup"><span data-stu-id="2f03a-152">For this reason, the URIs that constitute a typical RESTful web API should be oriented towards the data that it exposes, and use the facilities provided by HTTP to operate on this data.</span></span> <span data-ttu-id="2f03a-153">Questo approccio richiede una prospettiva diversa da quella usata in genere quando si progetta un set di classi in un'API orientata agli oggetti che tende a essere più motivata dal comportamento delle classi e degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-153">This approach requires a different mindset from that typically employed when designing a set of classes in an object-oriented API which tends to be more motivated by the behavior of objects and classes.</span></span> <span data-ttu-id="2f03a-154">Inoltre, un'API Web RESTful deve essere senza stato e non deve dipendere dalle operazioni richiamate in una particolare sequenza.</span><span class="sxs-lookup"><span data-stu-id="2f03a-154">Additionally, a RESTful web API should be stateless and not depend on operations being invoked in a particular sequence.</span></span> <span data-ttu-id="2f03a-155">Le sezioni seguenti riepilogano i punti da considerare quando si progetta un'API Web RESTful.</span><span class="sxs-lookup"><span data-stu-id="2f03a-155">The following sections summarize the points you should consider when designing a RESTful web API.</span></span>

### <a name="organizing-the-web-api-around-resources"></a><span data-ttu-id="2f03a-156">Organizzazione dell'API Web in base alle risorse</span><span class="sxs-lookup"><span data-stu-id="2f03a-156">Organizing the web API around resources</span></span>
> [!TIP]
> <span data-ttu-id="2f03a-157">Gli URI esposti da un servizio Web REST devono essere basati sui nomi (i dati a cui l'API Web fornisce l'accesso) e non sui verbi (le operazioni che un'applicazione può eseguire con i dati).</span><span class="sxs-lookup"><span data-stu-id="2f03a-157">The URIs exposed by a REST web service should be based on nouns (the data to which the web API provides access) and not verbs (what an application can do with the data).</span></span>
>
>

<span data-ttu-id="2f03a-158">Concentrarsi sulle entità di business esposte dall'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-158">Focus on the business entities that the web API exposes.</span></span> <span data-ttu-id="2f03a-159">Ad esempio, in un’API Web progettata per supportare il sistema di e-commerce descritto in precedenza, le entità primarie sono customers e orders.</span><span class="sxs-lookup"><span data-stu-id="2f03a-159">For example, in a web API designed to support the ecommerce system described earlier, the primary entities are customers and orders.</span></span> <span data-ttu-id="2f03a-160">Processi quali l'atto di emettere un ordine possono essere eseguiti fornendo un'operazione HTTP POST che aggiunge le informazioni relative all’ordine all'elenco di ordini per il cliente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-160">Processes such as the act of placing an order can be achieved by providing an HTTP POST operation that takes the order information and adds it to the list of orders for the customer.</span></span> <span data-ttu-id="2f03a-161">Internamente, questa operazione POST può eseguire attività quali il controllo dei livelli di scorte e la fatturazione del cliente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-161">Internally, this POST operation can perform tasks such as checking stock levels, and billing the customer.</span></span> <span data-ttu-id="2f03a-162">La risposta HTTP può indicare se l'ordine è stato inserito correttamente o meno.</span><span class="sxs-lookup"><span data-stu-id="2f03a-162">The HTTP response can indicate whether the order was placed successfully or not.</span></span> <span data-ttu-id="2f03a-163">Si noti inoltre che non è necessario che una risorsa sia basata su un singolo elemento di dati fisici.</span><span class="sxs-lookup"><span data-stu-id="2f03a-163">Also note that a resource does not have to be based on a single physical data item.</span></span> <span data-ttu-id="2f03a-164">Ad esempio, una risorsa ordine può essere implementata internamente usano le informazioni aggregate da molte righe distribuite in varie tabelle in un database relazionale, ma presentate al client come una singola entità.</span><span class="sxs-lookup"><span data-stu-id="2f03a-164">As an example, an order resource might be implemented internally by using information aggregated from many rows spread across several tables in a relational database but presented to the client as a single entity.</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-165">Evitare di progettare un'interfaccia REST che rispecchi o dipenda dalla struttura interna dei dati esposti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-165">Avoid designing a REST interface that mirrors or depends on the internal structure of the data that it exposes.</span></span> <span data-ttu-id="2f03a-166">REST consiste in qualcosa di più della semplice implementazione di operazioni CRUD (Create, Retrieve, Update, Delete) in tabelle separate in un database relazionale.</span><span class="sxs-lookup"><span data-stu-id="2f03a-166">REST is about more than implementing simple CRUD (Create, Retrieve, Update, Delete) operations over separate tables in a relational database.</span></span> <span data-ttu-id="2f03a-167">Lo scopo di REST è eseguire il mapping delle entità business e delle operazioni che un'applicazione può eseguire su tali entità all'implementazione fisica di queste entità, ma un client non deve essere esposto a questi dettagli fisici.</span><span class="sxs-lookup"><span data-stu-id="2f03a-167">The purpose of REST is to map business entities and the operations that an application can perform on these entities to the physical implementation of these entities, but a client should not be exposed to these physical details.</span></span>
>
>

<span data-ttu-id="2f03a-168">L’esistenza di singole entità business in isolamento è rara (sebbene esistano alcuni oggetti singleton), piuttosto queste entità tendono a essere raggruppate in raccolte.</span><span class="sxs-lookup"><span data-stu-id="2f03a-168">Individual business entities rarely exist in isolation (although some singleton objects may exist), but instead tend to be grouped together into collections.</span></span> <span data-ttu-id="2f03a-169">Nella terminologia REST, ogni entità e ogni raccolta costituiscono una risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-169">In REST terms, each entity and each collection are resources.</span></span> <span data-ttu-id="2f03a-170">In un’API Web RESTful, ogni raccolta ha un URI specifico all'interno del servizio Web, e l'esecuzione di una richiesta HTTP GET tramite un URI per una raccolta recupera un elenco di elementi in tale raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-170">In a RESTful web API, each collection has its own URI within the web service, and performing an HTTP GET request over a URI for a collection retrieves a list of items in that collection.</span></span> <span data-ttu-id="2f03a-171">Anche ogni singolo elemento ha un URI specifico, e un'applicazione può inviare un'altra richiesta HTTP GET con lo stesso URI per recuperare i dettagli di tale elemento.</span><span class="sxs-lookup"><span data-stu-id="2f03a-171">Each individual item also has its own URI, and an application can submit another HTTP GET request using that URI to retrieve the details of that item.</span></span> <span data-ttu-id="2f03a-172">È necessario organizzare gli URI per le raccolte e gli elementi in modo gerarchico.</span><span class="sxs-lookup"><span data-stu-id="2f03a-172">You should organize the URIs for collections and items in a hierarchical manner.</span></span> <span data-ttu-id="2f03a-173">Nel sistema di e-commerce, l'URI */customers* indica la raccolta dei clienti e */customers/5* recupera i dettagli per il singolo cliente con ID 5 da questa raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-173">In the ecommerce system, the URI */customers* denotes the customer’s collection, and */customers/5* retrieves the details for the single customer with the ID 5 from this collection.</span></span> <span data-ttu-id="2f03a-174">Questo approccio consente di mantenere l'API Web intuitiva.</span><span class="sxs-lookup"><span data-stu-id="2f03a-174">This approach helps to keep the web API intuitive.</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-175">Adottare una convenzione di denominazione coerente all’interno degli URI. In generale, per gli URI che fanno riferimento alle raccolte è utile usare nomi plurali.</span><span class="sxs-lookup"><span data-stu-id="2f03a-175">Adopt a consistent naming convention in URIs; in general it helps to use plural nouns for URIs that reference collections.</span></span>
>
>

<span data-ttu-id="2f03a-176">È anche necessario prendere in considerazione le relazioni tra diversi tipi di risorse e il modo in cui esporre queste associazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-176">You also need to consider the relationships between different types of resources and how you might expose these associations.</span></span> <span data-ttu-id="2f03a-177">Ad esempio, i clienti possono effettuare zero o più ordini.</span><span class="sxs-lookup"><span data-stu-id="2f03a-177">For example, customers may place zero or more orders.</span></span> <span data-ttu-id="2f03a-178">Un modo semplice per rappresentare questa relazione è un URI come */customers/5/orders* per trovare tutti gli ordini per il cliente 5.</span><span class="sxs-lookup"><span data-stu-id="2f03a-178">A natural way to represent this relationship would be through a URI such as */customers/5/orders* to find all the orders for customer 5.</span></span> <span data-ttu-id="2f03a-179">È anche possibile prendere in considerazione l'idea di rappresentare l'associazione da un ordine a un cliente specifico tramite un URI come */orders/99/customer* per trovare il cliente dell'ordine 99. Un'estensione eccessiva di questo modello, tuttavia, può risultare complessa da implementare.</span><span class="sxs-lookup"><span data-stu-id="2f03a-179">You might also consider representing the association from an order back to a specific customer through a URI such as */orders/99/customer* to find the customer for order 99, but extending this model too far can become cumbersome to implement.</span></span> <span data-ttu-id="2f03a-180">Una soluzione migliore consiste nel fornire collegamenti esplorabili alle risorse associate, ad esempio il cliente, nel corpo del messaggio di risposta HTTP restituito quando viene eseguita una query sull'ordine.</span><span class="sxs-lookup"><span data-stu-id="2f03a-180">A better solution is to provide navigable links to associated resources, such as the customer, in the body of the HTTP response message returned when the order is queried.</span></span> <span data-ttu-id="2f03a-181">Questo meccanismo viene descritto in maggiore dettaglio nella sezione Uso dell’approccio HATEOAS per consentire lo spostamento a risorse correlate, più avanti in queste linee guida.</span><span class="sxs-lookup"><span data-stu-id="2f03a-181">This mechanism is described in more detail in the section Using the HATEOAS Approach to Enable Navigation To Related Resources later in this guidance.</span></span>

<span data-ttu-id="2f03a-182">Nei sistemi più complessi possono essere presenti molti altri tipi di entità e si può essere tentati di fornire URI che consentono a un'applicazione client di spostarsi tra diversi livelli di relazioni, ad esempio */customers/1/orders/99/products* per ottenere l'elenco dei prodotti nell'ordine 99 effettuato dal cliente 1.</span><span class="sxs-lookup"><span data-stu-id="2f03a-182">In more complex systems there may be many more types of entity, and it can be tempting to provide URIs that enable a client application to navigate through several levels of relationships, such as */customers/1/orders/99/products* to obtain the list of products in order 99 placed by customer 1.</span></span> <span data-ttu-id="2f03a-183">Tuttavia questo livello di complessità può essere difficile da mantenere e non è flessibile se le relazioni tra le risorse cambiano in futuro.</span><span class="sxs-lookup"><span data-stu-id="2f03a-183">However, this level of complexity can be difficult to maintain and is inflexible if the relationships between resources change in the future.</span></span> <span data-ttu-id="2f03a-184">Cercare invece di mantenere gli URI relativamente semplici.</span><span class="sxs-lookup"><span data-stu-id="2f03a-184">Rather, you should seek to keep URIs relatively simple.</span></span> <span data-ttu-id="2f03a-185">Tenere presente che, una volta che un'applicazione contiene un riferimento a una risorsa, è possibile usare questo riferimento per trovare gli elementi correlati a tale risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-185">Bear in mind that once an application has a reference to a resource, it should be possible to use this reference to find items related to that resource.</span></span> <span data-ttu-id="2f03a-186">È possibile sostituire la query precedente con l'URI */customers/1/orders* per trovare tutti gli ordini per il cliente 1 e quindi eseguire una query sull'URI */orders/99/products* per trovare i prodotti di questo ordine (presupponendo che l'ordine 99 sia stato effettuato dal cliente 1).</span><span class="sxs-lookup"><span data-stu-id="2f03a-186">The preceding query can be replaced with the URI */customers/1/orders* to find all the orders for customer 1, and then query the URI */orders/99/products* to find the products in this order (assuming order 99 was placed by customer 1).</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-187">Evitare di richiedere URI di risorse più complessi di *raccolta/elemento/raccolta*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-187">Avoid requiring resource URIs more complex than *collection/item/collection*.</span></span>
>
>

<span data-ttu-id="2f03a-188">Un altro punto da considerare è che tutte le richieste Web impongono un carico sul server Web e che il carico aumenta in modo proporzionale alle richieste.</span><span class="sxs-lookup"><span data-stu-id="2f03a-188">Another point to consider is that all web requests impose a load on the web server, and the greater the number of requests the bigger the load.</span></span> <span data-ttu-id="2f03a-189">È necessario provare a definire le risorse in modo da evitare API Web "frammentate" che espongono un numero elevato di risorse piccole.</span><span class="sxs-lookup"><span data-stu-id="2f03a-189">You should attempt to define your resources to avoid “chatty” web APIs that expose a large number of small resources.</span></span> <span data-ttu-id="2f03a-190">Questo tipo di API può richiedere che un'applicazione client invii più richieste per trovare tutti i dati che richiede.</span><span class="sxs-lookup"><span data-stu-id="2f03a-190">Such an API may require a client application to submit multiple requests to find all the data that it requires.</span></span> <span data-ttu-id="2f03a-191">Può essere utile denormalizzare i dati e combinare le informazioni correlate tra loro in risorse più grandi che possono essere recuperate tramite l'esecuzione di una singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-191">It may be beneficial to denormalize data and combine related information together into bigger resources that can be retrieved by issuing a single request.</span></span> <span data-ttu-id="2f03a-192">Tuttavia, è necessario bilanciare questo approccio rispetto al sovraccarico del recupero di dati che potrebbero non essere richiesti spesso dal client.</span><span class="sxs-lookup"><span data-stu-id="2f03a-192">However, you need to balance this approach against the overhead of fetching data that might not be frequently required by the client.</span></span> <span data-ttu-id="2f03a-193">Il recupero di oggetti di grandi dimensioni può aumentare la latenza di una richiesta e comportare costi di larghezza di banda aggiuntivi a fronte di un piccolo vantaggio se i dati aggiuntivi non vengono utilizzati spesso.</span><span class="sxs-lookup"><span data-stu-id="2f03a-193">Retrieving large objects can increase the latency of a request and incur additional bandwidth costs for little advantage if the additional data is not often used.</span></span>

<span data-ttu-id="2f03a-194">Evitare di introdurre dipendenze tra l'API Web e la struttura, il tipo o il percorso delle origini dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-194">Avoid introducing dependencies between the web API to the structure, type, or location of the underlying data sources.</span></span> <span data-ttu-id="2f03a-195">Ad esempio, se i dati si trovano in un database relazionale, non è necessario che l'API Web esponga ogni tabella come raccolta di risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-195">For example, if your data is located in a relational database, the web API does not need to expose each table as a collection of resources.</span></span> <span data-ttu-id="2f03a-196">Considerare l'API Web come un'astrazione del database e, se necessario, introdurre un livello di mapping tra il database e l'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-196">Think of the web API as an abstraction of the database, and if necessary introduce a mapping layer between the database and the web API.</span></span> <span data-ttu-id="2f03a-197">In questo modo, se viene modificata la progettazione o l’implementazione del database (ad esempio, si passa da un database relazionale contenente una raccolta di tabelle normalizzate a un sistema di archiviazione NoSQL denormalizzato, come un database di documenti) le applicazioni client sono isolate da tali modifiche.</span><span class="sxs-lookup"><span data-stu-id="2f03a-197">In this way, if the design or implementation of the database changes (for example, you move from a relational database containing a collection of normalized tables to a denormalized NoSQL storage system such as a document database) client applications are insulated from these changes.</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-198">Non è necessario che l'origine dei dati che supporta un'API Web sia un archivio dati. Potrebbe essere un altro servizio o un’applicazione line-of-business o persino un'applicazione legacy in esecuzione in locale all'interno di un’organizzazione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-198">The source of the data that underpins a web API does not have to be a data store; it could be another service or line-of-business application or even a legacy application running on-premises within an organization.</span></span>
>
>

<span data-ttu-id="2f03a-199">Infine, potrebbe non essere possibile eseguire il mapping di ogni operazione implementata da un'API Web a una risorsa specifica.</span><span class="sxs-lookup"><span data-stu-id="2f03a-199">Finally, it might not be possible to map every operation implemented by a web API to a specific resource.</span></span> <span data-ttu-id="2f03a-200">È possibile gestire tali scenari *non corrispondenti a una risorsa* tramite richieste HTTP GET che richiamano una parte di funzionalità e restituiscono i risultati come messaggio di risposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f03a-200">You can handle such *non-resource* scenarios through HTTP GET requests that invoke a piece of functionality and return the results as an HTTP response message.</span></span> <span data-ttu-id="2f03a-201">Un’API Web che implementa semplici operazioni in stile calcolatrice, ad esempio addizioni e sottrazioni, potrebbe fornire URI che espongono queste operazioni come pseudo risorse e utilizzare la stringa di query per specificare i parametri richiesti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-201">A web API that implements simple calculator-style operations such as add and subtract could provide URIs that expose these operations as pseudo resources and utilize the query string to specify the parameters required.</span></span> <span data-ttu-id="2f03a-202">Ad esempio, una richiesta GET all'URI */add?operand1=99&operand2=1* può restituire un messaggio di risposta con un valore 100 all'interno del corpo e una richiesta GET all'URI */subtract?operand1=50&operand2=20* può restituire un messaggio di risposta con un valore 30 all'interno del corpo.</span><span class="sxs-lookup"><span data-stu-id="2f03a-202">For example a GET request to the URI */add?operand1=99&operand2=1* could return a response message with the body containing the value 100, and GET request to the URI */subtract?operand1=50&operand2=20* could return a response message with the body containing the value 30.</span></span> <span data-ttu-id="2f03a-203">Utilizzare tuttavia questi formati di URI solo in casi limitati.</span><span class="sxs-lookup"><span data-stu-id="2f03a-203">However, only use these forms of URIs sparingly.</span></span>

### <a name="defining-operations-in-terms-of-http-methods"></a><span data-ttu-id="2f03a-204">Definizione delle operazioni in termini di metodi HTTP</span><span class="sxs-lookup"><span data-stu-id="2f03a-204">Defining operations in terms of HTTP methods</span></span>
<span data-ttu-id="2f03a-205">Il protocollo HTTP definisce una serie di metodi che assegnano un significato semantico a una richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-205">The HTTP protocol defines a number of methods that assign semantic meaning to a request.</span></span> <span data-ttu-id="2f03a-206">I metodi HTTP usati dalla maggior parte delle API Web RESTful sono:</span><span class="sxs-lookup"><span data-stu-id="2f03a-206">The common HTTP methods used by most RESTful web APIs are:</span></span>

* <span data-ttu-id="2f03a-207">**GET**, per recuperare una copia della risorsa nell’URI specificato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-207">**GET**, to retrieve a copy of the resource at the specified URI.</span></span> <span data-ttu-id="2f03a-208">Il corpo del messaggio di risposta contiene i dettagli della risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-208">The body of the response message contains the details of the requested resource.</span></span>
* <span data-ttu-id="2f03a-209">**POST**, per creare una nuova risorsa nell’URI specificato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-209">**POST**, to create a new resource at the specified URI.</span></span> <span data-ttu-id="2f03a-210">Il corpo del messaggio di richiesta fornisce i dettagli della nuova risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-210">The body of the request message provides the details of the new resource.</span></span> <span data-ttu-id="2f03a-211">Si noti che POST può anche essere usato per avviare operazioni che in realtà non creano risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-211">Note that POST can also be used to trigger operations that don't actually create resources.</span></span>
* <span data-ttu-id="2f03a-212">**PUT**, per sostituire o aggiornare la risorsa nell’URI specificato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-212">**PUT**, to replace or update the resource at the specified URI.</span></span> <span data-ttu-id="2f03a-213">Il corpo del messaggio di richiesta specifica la risorsa da modificare e i valori da applicare.</span><span class="sxs-lookup"><span data-stu-id="2f03a-213">The body of the request message specifies the resource to be modified and the values to be applied.</span></span>
* <span data-ttu-id="2f03a-214">**DELETE**, per rimuovere la risorsa nell’URI specificato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-214">**DELETE**, to remove the resource at the specified URI.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-215">Il protocollo HTTP definisce anche altri metodi usati meno comunemente, ad esempio PATCH che viene usato per richiedere aggiornamenti selettivi a una risorsa, HEAD che viene utilizzato per richiedere una descrizione di una risorsa, OPTIONS che consente a un client di ottenere informazioni sulle opzioni di comunicazione supportate dal server e TRACE che consente a un client di richiedere informazioni utilizzabili a scopo di test e di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="2f03a-215">The HTTP protocol also defines other less commonly-used methods, such as PATCH which is used to request selective updates to a resource, HEAD which is used to request a description of a resource, OPTIONS which enables a client information to obtain information about the communication options supported by the server, and TRACE which allows a client to request information that it can use for testing and diagnostics purposes.</span></span>
>
>

<span data-ttu-id="2f03a-216">L'effetto di una richiesta specifica è diverso a seconda che la risorsa a cui viene applicata sia una raccolta o un singolo elemento.</span><span class="sxs-lookup"><span data-stu-id="2f03a-216">The effect of a specific request should depend on whether the resource to which it is applied is a collection or an individual item.</span></span> <span data-ttu-id="2f03a-217">La tabella seguente riepiloga le convenzioni comuni adottate dalla maggior parte delle implementazioni RESTful usando l’esempio dell’e-commerce.</span><span class="sxs-lookup"><span data-stu-id="2f03a-217">The following table summarizes the common conventions adopted by most RESTful implementations using the ecommerce example.</span></span> <span data-ttu-id="2f03a-218">Si noti che potrebbe non essere possibile implementare tutte queste richieste. L’implementazione dipende dallo scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="2f03a-218">Note that not all of these requests might be implemented; it depends on the specific scenario.</span></span>

| <span data-ttu-id="2f03a-219">**Risorsa**</span><span class="sxs-lookup"><span data-stu-id="2f03a-219">**Resource**</span></span> | <span data-ttu-id="2f03a-220">**POST**</span><span class="sxs-lookup"><span data-stu-id="2f03a-220">**POST**</span></span> | <span data-ttu-id="2f03a-221">**GET**</span><span class="sxs-lookup"><span data-stu-id="2f03a-221">**GET**</span></span> | <span data-ttu-id="2f03a-222">**PUT**</span><span class="sxs-lookup"><span data-stu-id="2f03a-222">**PUT**</span></span> | <span data-ttu-id="2f03a-223">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="2f03a-223">**DELETE**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="2f03a-224">/customers.</span><span class="sxs-lookup"><span data-stu-id="2f03a-224">/customers</span></span> |<span data-ttu-id="2f03a-225">Creare un nuovo cliente</span><span class="sxs-lookup"><span data-stu-id="2f03a-225">Create a new customer</span></span> |<span data-ttu-id="2f03a-226">Recuperare tutti i clienti</span><span class="sxs-lookup"><span data-stu-id="2f03a-226">Retrieve all customers</span></span> |<span data-ttu-id="2f03a-227">Eseguire l'aggiornamento in blocco dei clienti (*se implementato*)</span><span class="sxs-lookup"><span data-stu-id="2f03a-227">Bulk update of customers (*if implemented*)</span></span> |<span data-ttu-id="2f03a-228">Rimuovere tutti i clienti</span><span class="sxs-lookup"><span data-stu-id="2f03a-228">Remove all customers</span></span> |
| <span data-ttu-id="2f03a-229">/customers/1</span><span class="sxs-lookup"><span data-stu-id="2f03a-229">/customers/1</span></span> |<span data-ttu-id="2f03a-230">Errore</span><span class="sxs-lookup"><span data-stu-id="2f03a-230">Error</span></span> |<span data-ttu-id="2f03a-231">Recuperare i dettagli per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="2f03a-231">Retrieve the details for customer 1</span></span> |<span data-ttu-id="2f03a-232">Aggiornare i dettagli del cliente 1 se esiste, in caso contrario restituire un errore</span><span class="sxs-lookup"><span data-stu-id="2f03a-232">Update the details of customer 1 if it exists, otherwise return an error</span></span> |<span data-ttu-id="2f03a-233">Rimuovere il cliente 1</span><span class="sxs-lookup"><span data-stu-id="2f03a-233">Remove customer 1</span></span> |
| <span data-ttu-id="2f03a-234">/customers/1/orders</span><span class="sxs-lookup"><span data-stu-id="2f03a-234">/customers/1/orders</span></span> |<span data-ttu-id="2f03a-235">Creare un nuovo ordine per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="2f03a-235">Create a new order for customer 1</span></span> |<span data-ttu-id="2f03a-236">Recuperare tutti gli ordini per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="2f03a-236">Retrieve all orders for customer 1</span></span> |<span data-ttu-id="2f03a-237">Eseguire l'aggiornamento in blocco degli ordini per il cliente 1 (*se implementato*)</span><span class="sxs-lookup"><span data-stu-id="2f03a-237">Bulk update of orders for customer 1 (*if implemented*)</span></span> |<span data-ttu-id="2f03a-238">Rimuovere tutti gli ordini per il cliente 1 (*se implementato*)</span><span class="sxs-lookup"><span data-stu-id="2f03a-238">Remove all orders for customer 1(*if implemented*)</span></span> |

<span data-ttu-id="2f03a-239">Sebbene lo scopo delle richieste GET e DELETE sia relativamente semplice, la finalità e gli effetti delle richieste POST e PUT possono generare confusione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-239">The purpose of GET and DELETE requests are relatively straightforward, but there is scope for confusion concerning the purpose and effects of POST and PUT requests.</span></span>

<span data-ttu-id="2f03a-240">Una richiesta POST ha lo scopo di creare una nuova risorsa con dati forniti nel corpo della richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-240">A POST request should create a new resource with data provided in the body of the request.</span></span> <span data-ttu-id="2f03a-241">Nel modello REST spesso le richieste POST si applicano alle risorse costituite da raccolte. La nuova risorsa viene aggiunta alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-241">In the REST model, you frequently apply POST requests to resources that are collections; the new resource is added to the collection.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-242">È anche possibile definire richieste POST che attivano alcune funzionalità e che non necessariamente restituiscono dati. Questi tipi di richieste possono essere applicati alle raccolte.</span><span class="sxs-lookup"><span data-stu-id="2f03a-242">You can also define POST requests that trigger some functionality (and that don't necessarily return data), and these types of request can be applied to collections.</span></span> <span data-ttu-id="2f03a-243">È possibile, ad esempio, usare una richiesta POST per passare una scheda attività a un servizio di elaborazione delle retribuzioni e ottenere le tasse calcolate come risposta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-243">For example you could use a POST request to pass a timesheet to a payroll processing service and get the calculated taxes back as a response.</span></span>
>
>

<span data-ttu-id="2f03a-244">Lo scopo di una richiesta PUT è modificare una risorsa esistente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-244">A PUT request is intended to modify an existing resource.</span></span> <span data-ttu-id="2f03a-245">Se la risorsa specificata non esiste, la richiesta PUT può restituire un errore (in alcuni casi potrebbe effettivamente creare la risorsa).</span><span class="sxs-lookup"><span data-stu-id="2f03a-245">If the specified resource does not exist, the PUT request could return an error (in some cases, it might actually create the resource).</span></span> <span data-ttu-id="2f03a-246">Le richieste PUT vengono applicate con maggiore frequenza a risorse costituite da singoli elementi, ad esempio un cliente o un ordine specifico, ma possono essere applicate anche alle raccolte, sebbene questo scenario sia meno frequente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-246">PUT requests are most frequently applied to resources that are individual items (such as a specific customer or order), although they can be applied to collections, although this is less-commonly implemented.</span></span> <span data-ttu-id="2f03a-247">Si noti che le richieste PUT sono idempotenti, mentre le richieste POST non lo sono. Se un'applicazione invia la stessa richiesta PUT più volte i risultati saranno gli stessi (la stessa risorsa verrà modificata con gli stessi valori), ma se un'applicazione ripete la stessa richiesta POST il risultato sarà la creazione di più risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-247">Note that PUT requests are idempotent whereas POST requests are not; if an application submits the same PUT request multiple times the results should always be the same (the same resource will be modified with the same values), but if an application repeats the same POST request the result will be the creation of multiple resources.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-248">In modo più specifico, una richiesta HTTP PUT sostituisce una risorsa esistente con la risorsa specificata nel corpo della richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-248">Strictly speaking, an HTTP PUT request replaces an existing resource with the resource specified in the body of the request.</span></span> <span data-ttu-id="2f03a-249">Se si intende modificare una selezione di proprietà in una risorsa, lasciando però invariate le altre proprietà, questa operazione deve essere implementata mediante una richiesta HTTP PATCH.</span><span class="sxs-lookup"><span data-stu-id="2f03a-249">If the intention is to modify a selection of properties in a resource but leave other properties unchanged, then this should be implemented by using an HTTP PATCH request.</span></span> <span data-ttu-id="2f03a-250">Tuttavia, molte implementazioni RESTful non applicano questa regola in modo rigido e usano PUT per entrambi i casi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-250">However, many RESTful implementations relax this rule and use PUT for both situations.</span></span>
>
>

### <a name="processing-http-requests"></a><span data-ttu-id="2f03a-251">Elaborazione di richieste HTTP</span><span class="sxs-lookup"><span data-stu-id="2f03a-251">Processing HTTP requests</span></span>
<span data-ttu-id="2f03a-252">I dati inclusi da un'applicazione client in molte richieste HTTP e i corrispondenti messaggi di risposta dal server Web possono essere presentati in diversi formati o tipi di supporti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-252">The data included by a client application in many HTTP requests, and the corresponding response messages from the web server, could be presented in a variety of formats (or media types).</span></span> <span data-ttu-id="2f03a-253">I dati che specificano i dettagli per un cliente o un ordine, ad esempio, possono essere forniti come XML, JSON o un altro formato codificato e compresso.</span><span class="sxs-lookup"><span data-stu-id="2f03a-253">For example, the data that specifies the details for a customer or order could be provided as XML, JSON, or some other encoded and compressed format.</span></span> <span data-ttu-id="2f03a-254">Un'API Web RESTful deve supportare tipi di supporti diversi, come richiesto dall'applicazione client che invia una richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-254">A RESTful web API should support different media types as requested by the client application that submits a request.</span></span>

<span data-ttu-id="2f03a-255">Quando un'applicazione client invia una richiesta che restituisce i dati nel corpo di un messaggio, può specificare i tipi di supporti che è in grado di gestire nell'intestazione Accept della richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-255">When a client application sends a request that returns data in the body of a message, it can specify the media types it can handle in the Accept header of the request.</span></span> <span data-ttu-id="2f03a-256">Il codice seguente illustra una richiesta HTTP GET che recupera i dettagli dell'ordine 2 e richiede che il risultato sia restituito nel formato JSON. Il client deve comunque esaminare il tipo di supporto dei dati nella risposta per verificare il formato dei dati restituiti:</span><span class="sxs-lookup"><span data-stu-id="2f03a-256">The following code illustrates an HTTP GET request that retrieves the details of order 2 and requests the result to be returned as JSON (the client should still examine the media type of the data in the response to verify the format of the data returned):</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="2f03a-257">Se il server Web supporta questo tipo di supporto, può rispondere con una risposta che include l'intestazione Content-Type che specifica il formato dei dati nel corpo del messaggio:</span><span class="sxs-lookup"><span data-stu-id="2f03a-257">If the web server supports this media type, it can reply with a response that includes Content-Type header that specifies the format of the data in the body of the message:</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-258">Per garantire la massima interoperabilità, i tipi di supporti cui si fa riferimento nelle intestazioni Accept e Content-Type devono essere tipi MIME riconosciuti piuttosto che un tipo di supporto personalizzato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-258">For maximum interoperability, the media types referenced in the Accept and Content-Type headers should be recognized MIME types rather than some custom media type.</span></span>
>
>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

<span data-ttu-id="2f03a-259">Se il server Web non supporta il tipo di supporto richiesto, può inviare i dati in un formato diverso.</span><span class="sxs-lookup"><span data-stu-id="2f03a-259">If the web server does not support the requested media type, it can send the data in a different format.</span></span> <span data-ttu-id="2f03a-260">In tutti i casi è necessario specificare il tipo di supporto (ad esempio *application/json*) nell'intestazione Content-Type.</span><span class="sxs-lookup"><span data-stu-id="2f03a-260">IN all cases it must specify the media type (such as *application/json*) in the Content-Type header.</span></span> <span data-ttu-id="2f03a-261">È responsabilità dell'applicazione client analizzare il messaggio di risposta e interpretare in modo appropriato i risultati nel corpo del messaggio.</span><span class="sxs-lookup"><span data-stu-id="2f03a-261">It is the responsibility of the client application to parse the response message and interpret the results in the message body appropriately.</span></span>

<span data-ttu-id="2f03a-262">Si noti che in questo esempio, il server Web recupera correttamente i dati richiesti e indica l'esito positivo mediante il passaggio di un codice di stato 200 nell'intestazione della risposta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-262">Note that in this example, the web server successfully retrieves the requested data and indicates success by passing back a status code of 200 in the response header.</span></span> <span data-ttu-id="2f03a-263">Se non vengono trovati dati corrispondenti, restituisce invece un codice di stato 404 (non trovato) e il corpo del messaggio di risposta può contenere informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="2f03a-263">If no matching data is found, it should instead return a status code of 404 (not found) and the body of the response message can contain additional information.</span></span> <span data-ttu-id="2f03a-264">Il formato di queste informazioni è specificato dall'intestazione Content-Type, come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="2f03a-264">The format of this information is specified by the Content-Type header, as shown in the following example:</span></span>

```HTTP
GET http://adventure-works.com/orders/222 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="2f03a-265">L’ordine 222 non esiste, quindi il messaggio di risposta è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="2f03a-265">Order 222 does not exist, so the response message looks like this:</span></span>

```HTTP
HTTP/1.1 404 Not Found
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"message":"No such order"}
```

<span data-ttu-id="2f03a-266">Quando un'applicazione invia una richiesta HTTP PUT per aggiornare una risorsa, specifica l'URI della risorsa e fornisce i dati da modificare nel corpo del messaggio di richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-266">When an application sends an HTTP PUT request to update a resource, it specifies the URI of the resource and provides the data to be modified in the body of the request message.</span></span> <span data-ttu-id="2f03a-267">Deve anche specificare il formato di questi dati tramite l'intestazione Content-Type.</span><span class="sxs-lookup"><span data-stu-id="2f03a-267">It should also specify the format of this data by using the Content-Type header.</span></span> <span data-ttu-id="2f03a-268">Un formato comune usato per le informazioni basate su testo è *application/x-www-form-urlencoded*, costituito da un set di coppie nome/valore separate dal carattere &.</span><span class="sxs-lookup"><span data-stu-id="2f03a-268">A common format used for text-based information is *application/x-www-form-urlencoded*, which comprises a set of name/value pairs separated by the & character.</span></span> <span data-ttu-id="2f03a-269">L'esempio seguente illustra una richiesta PUT HTTP che consente di modificare le informazioni nell'ordine 1:</span><span class="sxs-lookup"><span data-stu-id="2f03a-269">The next example shows an HTTP PUT request that modifies the information in order 1:</span></span>

```HTTP
PUT http://adventure-works.com/orders/1 HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
ProductID=3&Quantity=5&OrderValue=250
```

<span data-ttu-id="2f03a-270">Se la modifica ha esito positivo, teoricamente la risposta dovrebbe essere un codice di stato HTTP 204, che indica che il processo è stato gestito correttamente, ma che il corpo della risposta non contiene altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-270">If the modification is successful, it should ideally respond with an HTTP 204 status code, indicating that the process has been successfully handled, but that the response body contains no further information.</span></span> <span data-ttu-id="2f03a-271">L'intestazione Location nella risposta contiene l'URI della risorsa appena aggiornata:</span><span class="sxs-lookup"><span data-stu-id="2f03a-271">The Location header in the response contains the URI of the newly updated resource:</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Location: http://adventure-works.com/orders/1
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

> [!TIP]
> <span data-ttu-id="2f03a-272">Se i dati in un messaggio di richiesta HTTP PUT includono informazioni su data e ora, verificare che il servizio Web accetti la data e l’ora formattate in base allo standard ISO 8601.</span><span class="sxs-lookup"><span data-stu-id="2f03a-272">If the data in an HTTP PUT request message includes date and time information, make sure that your web service accepts dates and times formatted following the ISO 8601 standard.</span></span>
>
>

<span data-ttu-id="2f03a-273">Se la risorsa da aggiornare non esiste, il server Web può rispondere con una risposta Non trovato, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="2f03a-273">If the resource to be updated does not exist, the web server can respond with a Not Found response as described earlier.</span></span> <span data-ttu-id="2f03a-274">In alternativa, se il server crea effettivamente l'oggetto stesso può restituire i codici di stato HTTP 200 (OK) o HTTP 201 (Creato) e il corpo della risposta può contenere i dati per la nuova risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-274">Alternatively, if the server actually creates the object itself it could return the status codes HTTP 200 (OK) or HTTP 201 (Created) and the response body could contain the data for the new resource.</span></span> <span data-ttu-id="2f03a-275">Se nell’intestazione Content-Type della richiesta è specificato un formato di dati che il server Web non è in grado di gestire, risponderà con il codice di stato HTTP 415 (Tipo di supporto non utilizzabile).</span><span class="sxs-lookup"><span data-stu-id="2f03a-275">If the Content-Type header of the request specifies a data format that the web server cannot handle, it should respond with HTTP status code 415 (Unsupported Media Type).</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-276">Prendere in considerazione l’implementazione di operazioni HTTP PUT in blocco in grado di eseguire aggiornamenti in batch di più risorse in una raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-276">Consider implementing bulk HTTP PUT operations that can batch updates to multiple resources in a collection.</span></span> <span data-ttu-id="2f03a-277">La richiesta PUT deve specificare l'URI della raccolta e il corpo della richiesta deve specificare i dettagli delle risorse da modificare.</span><span class="sxs-lookup"><span data-stu-id="2f03a-277">The PUT request should specify the URI of the collection, and the request body should specify the details of the resources to be modified.</span></span> <span data-ttu-id="2f03a-278">Questo approccio consente di ridurre la frammentarietà e migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-278">This approach can help to reduce chattiness and improve performance.</span></span>
>
>

<span data-ttu-id="2f03a-279">Il formato delle richieste HTTP POST che consentono di creare nuove risorse è simile a quello delle richieste PUT. Il corpo del messaggio contiene i dettagli della nuova risorsa da aggiungere.</span><span class="sxs-lookup"><span data-stu-id="2f03a-279">The format of an HTTP POST requests that create new resources are similar to those of PUT requests; the message body contains the details of the new resource to be added.</span></span> <span data-ttu-id="2f03a-280">Tuttavia, in genere l’URI specifica la raccolta a cui deve essere aggiunta la risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-280">However, the URI typically specifies the collection to which the resource should be added.</span></span> <span data-ttu-id="2f03a-281">L'esempio seguente crea un nuovo ordine che viene aggiunto alla raccolta di ordini:</span><span class="sxs-lookup"><span data-stu-id="2f03a-281">The following example creates a new order and adds it to the orders collection:</span></span>

```HTTP
POST http://adventure-works.com/orders HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
productID=5&quantity=15&orderValue=400
```

<span data-ttu-id="2f03a-282">Se la richiesta ha esito positivo, il server Web deve rispondere con un codice di messaggio con codice di stato HTTP 201 (Creato).</span><span class="sxs-lookup"><span data-stu-id="2f03a-282">If the request is successful, the web server should respond with a message code with HTTP status code 201 (Created).</span></span> <span data-ttu-id="2f03a-283">L'intestazione Location deve contenere l'URI della risorsa appena creata e il corpo della risposta deve contenere una copia della nuova risorsa; l'intestazione Content-Type specifica il formato di questi dati:</span><span class="sxs-lookup"><span data-stu-id="2f03a-283">The Location header should contain the URI of the newly created resource, and the body of the response should contain a copy of the new resource; the Content-Type header specifies the format of this data:</span></span>

```HTTP
HTTP/1.1 201 Created
...
Content-Type: application/json; charset=utf-8
Location: http://adventure-works.com/orders/99
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":99,"productID":5,"quantity":15,"orderValue":400}
```

> [!TIP]
> <span data-ttu-id="2f03a-284">Se i dati forniti da una richiesta PUT o POST non sono validi, il server Web deve rispondere con un messaggio con codice di stato HTTP 400 (Richiesta errata).</span><span class="sxs-lookup"><span data-stu-id="2f03a-284">If the data provided by a PUT or POST request is invalid, the web server should respond with a message with HTTP status code 400 (Bad Request).</span></span> <span data-ttu-id="2f03a-285">Il corpo di questo messaggio può contenere informazioni aggiuntive sul problema con la richiesta e i formati attesi oppure può contenere un collegamento a un URL in cui vengono forniti altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="2f03a-285">The body of this message can contain additional information about the problem with the request and the formats expected, or it can contain a link to a URL that provides more details.</span></span>
>
>

<span data-ttu-id="2f03a-286">Per rimuovere una risorsa, una richiesta HTTP DELETE fornisce semplicemente l'URI della risorsa da eliminare.</span><span class="sxs-lookup"><span data-stu-id="2f03a-286">To remove a resource, an HTTP DELETE request simply provides the URI of the resource to be deleted.</span></span> <span data-ttu-id="2f03a-287">L'esempio seguente prova a rimuovere l’ordine 99:</span><span class="sxs-lookup"><span data-stu-id="2f03a-287">The following example attempts to remove order 99:</span></span>

```HTTP
DELETE http://adventure-works.com/orders/99 HTTP/1.1
...
```

<span data-ttu-id="2f03a-288">Se l'operazione di eliminazione ha esito positivo, il server Web deve rispondere con codice di stato HTTP 204, che indica che il processo è stato gestito correttamente, ma che il corpo della risposta non contiene ulteriori informazioni. Si tratta della stessa risposta restituita da un'operazione PUT completata correttamente, ma senza un'intestazione Location, in quanto la risorsa non esiste più. È anche possibile, per una richiesta DELETE, restituire il codice di stato HTTP 200 (OK) o 202 (Accettato) se l'eliminazione viene eseguita in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="2f03a-288">If the delete operation is successful, the web server should respond with HTTP status code 204, indicating that the process has been successfully handled, but that the response body contains no further information (this is the same response returned by a successful PUT operation, but without a Location header as the resource no longer exists.) It is also possible for a DELETE request to return HTTP status code 200 (OK) or 202 (Accepted) if the deletion is performed asynchronously.</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

<span data-ttu-id="2f03a-289">Se la risorsa non viene trovata, il server Web deve restituire, invece, un messaggio 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="2f03a-289">If the resource is not found, the web server should return a 404 (Not Found) message instead.</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-290">Se tutte le risorse in una raccolta devono essere eliminate, consentire di specificare una richiesta HTTP DELETE per l'URI della raccolta piuttosto che forzare un'applicazione a rimuovere ciascuna risorsa, a turno, dalla raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-290">If all the resources in a collection need to be deleted, enable an HTTP DELETE request to be specified for the URI of the collection rather than forcing an application to remove each resource in turn from the collection.</span></span>
>
>

### <a name="filtering-and-paginating-data"></a><span data-ttu-id="2f03a-291">Filtro e paginazione dei dati</span><span class="sxs-lookup"><span data-stu-id="2f03a-291">Filtering and paginating data</span></span>
<span data-ttu-id="2f03a-292">È necessario cercare di mantenere gli URI semplici e intuitivi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-292">You should endeavor to keep the URIs simple and intuitive.</span></span> <span data-ttu-id="2f03a-293">L’esposizione di una raccolta di risorse tramite un unico URI aiuta a questo proposito, ma può causare il recupero di grandi quantità di dati da parte delle applicazioni quando è necessario solo un sottoinsieme di informazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-293">Exposing a collection of resources through a single URI assists in this respect, but it can lead to applications fetching large amounts of data when only a subset of the information is required.</span></span> <span data-ttu-id="2f03a-294">La generazione di un grande volume di traffico influisce non solo sulle prestazioni e sulla scalabilità del server Web, ma compromette anche la velocità di risposta delle applicazioni client che richiedono i dati.</span><span class="sxs-lookup"><span data-stu-id="2f03a-294">Generating a large volume of traffic impacts not only the performance and scalability of the web server but also adversely affect the responsiveness of client applications requesting the data.</span></span>

<span data-ttu-id="2f03a-295">Se gli ordini contengono il prezzo pagato per l'ordine, ad esempio, per un'applicazione client che deve recuperare tutti gli ordini con un costo al di sopra di un valore specifico potrebbe essere necessario recuperare tutti gli ordini dall'URI */orders* e quindi filtrare tali ordini localmente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-295">For example, if orders contain the price paid for the order, a client application that needs to retrieve all orders that have a cost over a specific value might need to retrieve all orders from the */orders* URI and then filter these orders locally.</span></span> <span data-ttu-id="2f03a-296">Ovviamente questo processo è particolarmente inefficiente, perché comporta uno spreco di potenza di elaborazione e larghezza di banda di rete nel server che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-296">Clearly this process is highly inefficient; it wastes network bandwidth and processing power on the server hosting the web API.</span></span>

<span data-ttu-id="2f03a-297">Una soluzione può consistere nello specificare uno schema URI come */orders/ordervalue_greater_than_n*, in cui *n* è il prezzo dell'ordine, ma un approccio di questo tipo è pratico solo per un numero limitato di prezzi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-297">One solution may be to provide a URI scheme such as */orders/ordervalue_greater_than_n* where *n* is the order price, but for all but a limited number of prices such an approach is impractical.</span></span> <span data-ttu-id="2f03a-298">Inoltre, se è necessario eseguire query sugli ordini in base ad altri criteri, potrebbe essere necessario fornire un lungo elenco di URI con nomi probabilmente non intuitivi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-298">Additionally, if you need to query orders based on other criteria, you can end up being faced with providing with a long list of URIs with possibly non-intuitive names.</span></span>

<span data-ttu-id="2f03a-299">Una strategia migliore per filtrare i dati consiste nello specificare criteri di filtro nella stringa di query passata all'API Web, ad esempio */orders?ordervaluethreshold=n*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-299">A better strategy to filtering data is to provide the filter criteria in the query string that is passed to the web API, such as */orders?ordervaluethreshold=n*.</span></span> <span data-ttu-id="2f03a-300">In questo esempio, l'operazione corrispondente nell'API Web è responsabile della gestione e dell'analisi del `ordervaluethreshold` parametro nella stringa di query e della restituzione dei risultati filtrati nella risposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="2f03a-300">In this example, the corresponding operation in the web API is responsible for parsing and handling the `ordervaluethreshold` parameter in the query string and returning the filtered results in the HTTP response.</span></span>

<span data-ttu-id="2f03a-301">Alcune richieste HTTP GET semplici sulle risorse della raccolta potrebbero restituire un numero elevato di elementi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-301">Some simple HTTP GET requests over collection resources could potentially return a large number of items.</span></span> <span data-ttu-id="2f03a-302">Per evitare la possibilità di tale inconveniente, è necessario progettare l'API Web in modo da limitare la quantità di dati restituiti da ogni singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-302">To combat the possibility of this occurring you should design the web API to limit the amount of data returned by any single request.</span></span> <span data-ttu-id="2f03a-303">È possibile ottenere questo risultato mediante il supporto di stringhe di query che consentano all'utente di specificare il numero massimo di elementi da recuperare (che potrebbe essere soggetto a un limite estremo superiore per impedire attacchi di tipo Denial of Service) e un offset iniziale nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-303">You can achieve this by supporting query strings that enable the user to specify the maximum number of items to be retrieved (which could itself be subject to an upperbound limit to help prevent Denial of Service attacks), and a starting offset into the collection.</span></span> <span data-ttu-id="2f03a-304">Ad esempio, la stringa di query nell'URI */orders?limit=25&offset=50* recupererà 25 ordini a partire dal cinquantesimo ordine trovato nella raccolta degli ordini.</span><span class="sxs-lookup"><span data-stu-id="2f03a-304">For example, the query string in the URI */orders?limit=25&offset=50* should retrieve 25 orders starting with the 50th order found in the orders collection.</span></span> <span data-ttu-id="2f03a-305">Come accade con il filtro dei dati, l’operazione che implementa la richiesta GET nell’API Web è responsabile dell’analisi e della gestione dei parametri `limit` e `offset` nella stringa di query.</span><span class="sxs-lookup"><span data-stu-id="2f03a-305">As with filtering data, the operation that implements the GET request in the web API is responsible for parsing and handling the `limit` and `offset` parameters in the query string.</span></span> <span data-ttu-id="2f03a-306">Per agevolare le applicazioni client, le richieste GET che restituiscono i dati impaginati devono includere anche un tipo di metadati che indichino il numero totale delle risorse disponibili nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-306">To assist client applications, GET requests that return paginated data should also include some form of metadata that indicate the total number of resources available in the collection.</span></span> <span data-ttu-id="2f03a-307">È anche possibile prendere in considerazione altre strategie di paging intelligente. Per altre informazioni, vedere [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging) (Note sulla progettazione di API: paging intelligente).</span><span class="sxs-lookup"><span data-stu-id="2f03a-307">You might also consider other intelligent paging strategies; for more information, see [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging)</span></span>

<span data-ttu-id="2f03a-308">Una strategia simile può essere seguita per ordinare i dati mentre vengono recuperati. È possibile specificare un parametro sort che accetta un nome di campo come valore, ad esempio */orders?sort=ProductID*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-308">You can follow a similar strategy for sorting data as it is fetched; you could provide a sort parameter that takes a field name as the value, such as */orders?sort=ProductID*.</span></span> <span data-ttu-id="2f03a-309">Si noti, tuttavia, che questo approccio può avere un effetto deleterio sulla memorizzazione nella cache (i parametri della stringa di query formano parte dell'identificatore di risorsa utilizzato da molte implementazioni della cache come chiave per i dati memorizzati nella cache).</span><span class="sxs-lookup"><span data-stu-id="2f03a-309">However, note that this approach can have a deleterious effect on caching (query string parameters form part of the resource identifier used by many cache implementations as the key to cached data).</span></span>

<span data-ttu-id="2f03a-310">È possibile estendere questo approccio per limitare (proiettare) i campi restituiti se un singolo elemento risorsa contiene una grande quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="2f03a-310">You can extend this approach to limit (project) the fields returned if a single resource item contains a large amount of data.</span></span> <span data-ttu-id="2f03a-311">Si può usare, ad esempio, un parametro di stringa di query che accetta un elenco di campi delimitato da virgole, come */orders?fields=ProductID,Quantity*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-311">For example, you could use a query string parameter that accepts a comma-delimited list of fields, such as */orders?fields=ProductID,Quantity*.</span></span>

> [!TIP]
> <span data-ttu-id="2f03a-312">Assegnare valori predefiniti significativi a tutti i parametri facoltativi nelle stringhe di query.</span><span class="sxs-lookup"><span data-stu-id="2f03a-312">Give all optional parameters in query strings meaningful defaults.</span></span> <span data-ttu-id="2f03a-313">Ad esempio, impostare il parametro `limit` su 10 e il parametro `offset` su 0 se si implementa la paginazione, impostare il parametro Sort sulla chiave della risorsa se si implementa l’ordinamento e impostare il parametro `fields` su tutti i campi della risorsa se si supportano le proiezioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-313">For example, set the `limit` parameter to 10 and the `offset` parameter to 0 if you implement pagination, set the sort parameter to the key of the resource if you implement ordering, and set the `fields` parameter to all fields in the resource if you support projections.</span></span>
>
>

### <a name="handling-large-binary-resources"></a><span data-ttu-id="2f03a-314">Gestione di risorse binarie di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="2f03a-314">Handling large binary resources</span></span>
<span data-ttu-id="2f03a-315">Una singola risorsa può contenere campi binari di grandi dimensioni, come file o immagini.</span><span class="sxs-lookup"><span data-stu-id="2f03a-315">A single resource may contain large binary fields, such as files or images.</span></span> <span data-ttu-id="2f03a-316">Per superare i problemi causati da connessioni non affidabili e intermittenti e per migliorare i tempi di risposta, considerare la possibilità di fornire operazioni che consentano a tali risorse di essere recuperate in blocchi dall'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="2f03a-316">To overcome the transmission problems caused by unreliable and intermittent connections and to improve response times, consider providing operations that enable such resources to be retrieved in chunks by the client application.</span></span> <span data-ttu-id="2f03a-317">A questo scopo, l'API Web deve supportare l'intestazione Accept-Ranges per le richieste GET per le risorse di grandi dimensioni e possibilmente implementare le richieste HTTP HEAD per tali risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-317">To do this, the web API should support the Accept-Ranges header for GET requests for large resources, and ideally implement HTTP HEAD requests for these resources.</span></span> <span data-ttu-id="2f03a-318">L’intestazione Accept-Ranges indica che l’operazione GET supporta risultati parziali e che un’applicazione client può inviare richieste GET che restituiscono un sottoinsieme di una risorsa specificata come intervallo di byte.</span><span class="sxs-lookup"><span data-stu-id="2f03a-318">The Accept-Ranges header indicates that the GET operation supports partial results, and that a client application can submit GET requests that return a subset of a resource specified as a range of bytes.</span></span> <span data-ttu-id="2f03a-319">Una richiesta HEAD è simile a una richiesta GET tranne per il fatto che restituisce solo un’intestazione che descrive la risorsa e un corpo del messaggio vuoto.</span><span class="sxs-lookup"><span data-stu-id="2f03a-319">A HEAD request is similar to a GET request except that it only returns a header that describes the resource and an empty message body.</span></span> <span data-ttu-id="2f03a-320">Un'applicazione client può inviare una richiesta HEAD per determinare se recuperare una risorsa tramite richieste GET parziali.</span><span class="sxs-lookup"><span data-stu-id="2f03a-320">A client application can issue a HEAD request to determine whether to fetch a resource by using partial GET requests.</span></span> <span data-ttu-id="2f03a-321">Nell'esempio seguente viene illustrata una richiesta HEAD che ottiene informazioni su un'immagine del prodotto:</span><span class="sxs-lookup"><span data-stu-id="2f03a-321">The following example shows a HEAD request that obtains information about a product image:</span></span>

```HTTP
HEAD http://adventure-works.com/products/10?fields=productImage HTTP/1.1
...
```

<span data-ttu-id="2f03a-322">Il messaggio di risposta contiene un’intestazione che include le dimensioni della risorsa (4580 byte) e l’intestazione Accept-Ranges, in cui l’operazione GET corrispondente supporta risultati parziali:</span><span class="sxs-lookup"><span data-stu-id="2f03a-322">The response message contains a header that includes the size of the resource (4580 bytes), and the Accept-Ranges header that the corresponding GET operation supports partial results:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4580
...
```

<span data-ttu-id="2f03a-323">L'applicazione client può usare queste informazioni per costruire una serie di operazioni GET per recuperare l'immagine in blocchi più piccoli.</span><span class="sxs-lookup"><span data-stu-id="2f03a-323">The client application can use this information to construct a series of GET operations to retrieve the image in smaller chunks.</span></span> <span data-ttu-id="2f03a-324">La prima richiesta recupera i primi 2500 byte mediante l'intestazione Range:</span><span class="sxs-lookup"><span data-stu-id="2f03a-324">The first request fetches the first 2500 bytes by using the Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=0-2499
...
```

<span data-ttu-id="2f03a-325">Il codice di stato HTTP 206 restituito nel messaggio di risposta indica che si tratta di una risposta parziale.</span><span class="sxs-lookup"><span data-stu-id="2f03a-325">The response message indicates that this is a partial response by returning HTTP status code 206.</span></span> <span data-ttu-id="2f03a-326">L'intestazione Content-Length specifica il numero effettivo di byte restituiti nel corpo del messaggio (non le dimensioni della risorsa) e l'intestazione Content-Range indica di quale parte della risorsa si tratta (byte 0-2499 di 4580):</span><span class="sxs-lookup"><span data-stu-id="2f03a-326">The Content-Length header specifies the actual number of bytes returned in the message body (not the size of the resource), and the Content-Range header indicates which part of the resource this is (bytes 0-2499 out of 4580):</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2500
Content-Range: bytes 0-2499/4580
...
_{binary data not shown}_
```

<span data-ttu-id="2f03a-327">Una successiva richiesta dall'applicazione client può recuperare la parte restante della risorsa tramite un'intestazione Range appropriata:</span><span class="sxs-lookup"><span data-stu-id="2f03a-327">A subsequent request from the client application can retrieve the remainder of the resource by using an appropriate Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=2500-
...
```

<span data-ttu-id="2f03a-328">Il messaggio del risultato corrispondente dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="2f03a-328">The corresponding result message should look like this:</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2080
Content-Range: bytes 2500-4580/4580
...
```

## <a name="using-the-hateoas-approach-to-enable-navigation-to-related-resources"></a><span data-ttu-id="2f03a-329">Utilizzo dell'approccio HATEOAS per consentire lo spostamento a risorse correlate</span><span class="sxs-lookup"><span data-stu-id="2f03a-329">Using the HATEOAS approach to enable navigation to related resources</span></span>
<span data-ttu-id="2f03a-330">Una delle principali motivazioni alla base dell’approccio REST è che dovrebbe essere possibile spostarsi nell'intero set di risorse senza conoscere a priori lo schema URI.</span><span class="sxs-lookup"><span data-stu-id="2f03a-330">One of the primary motivations behind REST is that it should be possible to navigate the entire set of resources without requiring prior knowledge of the URI scheme.</span></span> <span data-ttu-id="2f03a-331">Ogni richiesta HTTP GET deve restituire le informazioni necessarie a trovare le risorse correlate direttamente all'oggetto richiesto tramite collegamenti ipertestuali inclusi nella risposta e deve anche contenere informazioni che descrivono le operazioni disponibili in ciascuna di queste risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-331">Each HTTP GET request should return the information necessary to find the resources related directly to the requested object through hyperlinks included in the response, and it should also be provided with information that describes the operations available on each of these resources.</span></span> <span data-ttu-id="2f03a-332">Tale principio è noto come HATEOAS o Hypertext as the Engine of Application State.</span><span class="sxs-lookup"><span data-stu-id="2f03a-332">This principle is known as HATEOAS, or Hypertext as the Engine of Application State.</span></span> <span data-ttu-id="2f03a-333">Il sistema è in realtà una macchina a stati finiti e la risposta a ogni richiesta contiene le informazioni necessarie per passare da uno stato all’altro. Non dovrebbero essere necessarie altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="2f03a-333">The system is effectively a finite state machine, and the response to each request contains the information necessary to move from one state to another; no other information should be necessary.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-334">Attualmente non esistono standard o specifiche che definiscono come modellare il principio HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="2f03a-334">Currently there are no standards or specifications that define how to model the HATEOAS principle.</span></span> <span data-ttu-id="2f03a-335">Gli esempi mostrati in questa sezione illustrano una possibile soluzione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-335">The examples shown in this section illustrate one possible solution.</span></span>
>
>

<span data-ttu-id="2f03a-336">Ad esempio, per gestire la relazione tra clienti e ordini, i dati restituiti nella risposta per un ordine specifico devono contenere gli URI sotto forma di un collegamento ipertestuale che identifica il cliente che ha effettuato l'ordine e le operazioni che possono essere eseguite su tale cliente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-336">As an example, to handle the relationship between customers and orders, the data returned in the response for a specific order should contain URIs in the form of a hyperlink identifying the customer that placed the order, and the operations that can be performed on that customer.</span></span>

```HTTP
GET http://adventure-works.com/orders/3 HTTP/1.1
Accept: application/json
...
```

<span data-ttu-id="2f03a-337">Il corpo del messaggio di risposta contiene una matrice `links` (evidenziata nell'esempio di codice) che specifica la natura della relazione (*Customer*), l'URI del cliente (*http://adventure-works.com/customers/3*), come recuperare i dettagli di questo cliente (*GET*) e i tipi MIME supportati dal server Web per il recupero di queste informazioni (*text/xml* e *application/json*).</span><span class="sxs-lookup"><span data-stu-id="2f03a-337">The body of the response message contains a `links` array (highlighted in the code example) that specifies the nature of the relationship (*Customer*), the URI of the customer (*http://adventure-works.com/customers/3*), how to retrieve the details of this customer (*GET*), and the MIME types that the web server supports for retrieving this information (*text/xml* and *application/json*).</span></span> <span data-ttu-id="2f03a-338">Si tratta di tutte le informazioni di cui necessita un'applicazione client per essere in grado di recuperare i dettagli del cliente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-338">This is all the information that a client application needs to be able to fetch the details of the customer.</span></span> <span data-ttu-id="2f03a-339">La matrice Links include anche collegamenti per le altre operazioni che è possibile eseguire, come PUT (per modificare il cliente, insieme al formato che il server Web prevede che il client fornisca), e DELETE.</span><span class="sxs-lookup"><span data-stu-id="2f03a-339">Additionally, the Links array also includes links for the other operations that can be performed, such as PUT (to modify the customer, together with the format that the web server expects the client to provide), and DELETE.</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[(some links omitted){"rel":"customer","href":" http://adventure-works.com/customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":"
customer","href":" http://adventure-works.com /customers/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"customer","href":" http://adventure-works.com /customers/3","action":"DELETE","types":[]}]}
```

<span data-ttu-id="2f03a-340">Per motivi di completezza, la matrice Links deve includere anche informazioni autoreferenziali riguardanti la risorsa che è stata recuperata.</span><span class="sxs-lookup"><span data-stu-id="2f03a-340">For completeness, the Links array should also include self-referencing information pertaining to the resource that has been retrieved.</span></span> <span data-ttu-id="2f03a-341">Questi collegamenti sono stati omessi dall'esempio precedente, ma vengono evidenziati nel codice seguente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-341">These links have been omitted from the previous example, but are highlighted in the following code.</span></span> <span data-ttu-id="2f03a-342">Si noti che in questi collegamenti è stata usata la relazione *self* per indicare che si tratta di un riferimento alla risorsa restituita dall'operazione:</span><span class="sxs-lookup"><span data-stu-id="2f03a-342">Notice that in these links, the relationship *self* has been used to indicate that this is a reference to the resource being returned by the operation:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[{"rel":"self","href":" http://adventure-works.com/orders/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" self","href":" http://adventure-works.com /orders/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"self","href":" http://adventure-works.com /orders/3", "action":"DELETE","types":[]},{"rel":"customer",
"href":" http://adventure-works.com /customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" customer" (customer links omitted)}]}
```

<span data-ttu-id="2f03a-343">Affinché l'approccio sia efficace, le applicazioni client devono essere preparate a recuperare e analizzare le informazioni aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="2f03a-343">For this approach to be effective, client applications must be prepared to retrieve and parse this additional information.</span></span>

## <a name="versioning-a-restful-web-api"></a><span data-ttu-id="2f03a-344">Controllo delle versioni di un'API Web RESTful</span><span class="sxs-lookup"><span data-stu-id="2f03a-344">Versioning a RESTful web API</span></span>
<span data-ttu-id="2f03a-345">È molto improbabile che un'API Web rimanga statica in tutte le situazioni, tranne le più semplici.</span><span class="sxs-lookup"><span data-stu-id="2f03a-345">It is highly unlikely that in all but the simplest of situations that a web API will remain static.</span></span> <span data-ttu-id="2f03a-346">Man mano che i requisiti aziendali cambiano, è possibile che vengano aggiunte nuove raccolte di risorse, che le relazioni tra le risorse cambino e che la struttura dei dati nelle risorse venga modificata.</span><span class="sxs-lookup"><span data-stu-id="2f03a-346">As business requirements change new collections of resources may be added, the relationships between resources might change, and the structure of the data in resources might be amended.</span></span> <span data-ttu-id="2f03a-347">Sebbene l'aggiornamento di un'API Web per gestire requisiti nuovi o diversi sia un processo relativamente semplice, è necessario considerare gli effetti delle modifiche sulle applicazioni client che utilizzano l'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-347">While updating a web API to handle new or differing requirements is a relatively straightforward process, you must consider the effects that such changes will have on client applications consuming the web API.</span></span> <span data-ttu-id="2f03a-348">Il problema è che nonostante lo sviluppatore che progetta e implementa un'API Web abbia il controllo completo su tale API, non ha lo stesso livello di controllo sulle applicazioni client che possono essere compilate da organizzazioni di terze parti che operano in modalità remota.</span><span class="sxs-lookup"><span data-stu-id="2f03a-348">The issue is that although the developer designing and implementing a web API has full control over that API, the developer does not have the same degree of control over client applications which may be built by third party organizations operating remotely.</span></span> <span data-ttu-id="2f03a-349">L’imperativo è consentire alle applicazioni client esistenti di continuare a funzionare senza modifiche e allo stesso tempo permettere alle nuove applicazioni client di avvalersi di nuove funzionalità e risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-349">The primary imperative is to enable existing client applications to continue functioning unchanged while allowing new client applications to take advantage of new features and resources.</span></span>

<span data-ttu-id="2f03a-350">Il controllo delle versioni consente a un’API Web di indicare le funzionalità e le risorse esposte e a un’applicazione client di inviare richieste dirette a una versione specifica di una funzionalità o di una risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-350">Versioning enables a web API to indicate the features and resources that it exposes, and a client application can submit requests that are directed to a specific version of a feature or resource.</span></span> <span data-ttu-id="2f03a-351">Le sezioni seguenti descrivono diversi approcci differenti, ognuno dei quali presenta vantaggi e compromessi.</span><span class="sxs-lookup"><span data-stu-id="2f03a-351">The following sections describe several different approaches, each of which has its own benefits and trade-offs.</span></span>

### <a name="no-versioning"></a><span data-ttu-id="2f03a-352">Nessun controllo delle versioni</span><span class="sxs-lookup"><span data-stu-id="2f03a-352">No versioning</span></span>
<span data-ttu-id="2f03a-353">Si tratta dell'approccio più semplice e può essere accettabile per alcune API interne.</span><span class="sxs-lookup"><span data-stu-id="2f03a-353">This is the simplest approach, and may be acceptable for some internal APIs.</span></span> <span data-ttu-id="2f03a-354">Grandi cambiamenti potrebbero essere rappresentati come nuove risorse o nuovi collegamenti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-354">Big changes could be represented as new resources or new links.</span></span>  <span data-ttu-id="2f03a-355">L’aggiunta di contenuto alle risorse esistenti potrebbe non presentare una modifica sostanziale in quanto le applicazioni client che non prevedono di visualizzare che questo contenuto lo ignoreranno semplicemente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-355">Adding content to existing resources might not present a breaking change as client applications that are not expecting to see this content will simply ignore it.</span></span>

<span data-ttu-id="2f03a-356">Una richiesta all'URI *http://adventure-works.com/customers/3*, ad esempio, restituirà i dettagli di un singolo cliente contenente i campi `id`, `name`, e `address` previsti dall'applicazione client:</span><span class="sxs-lookup"><span data-stu-id="2f03a-356">For example, a request to the URI *http://adventure-works.com/customers/3* should return the details of a single customer containing `id`, `name`, and `address` fields expected by the client application:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

> [!NOTE]
> <span data-ttu-id="2f03a-357">Ai fini della semplicità e della chiarezza, le risposte di esempio illustrate in questa sezione non includono collegamenti HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="2f03a-357">For the purposes of simplicity and clarity, the example responses shown in this section do not include HATEOAS links.</span></span>
>
>

<span data-ttu-id="2f03a-358">Se il campo `DateCreated` viene aggiunto allo schema della risorsa customer, la risposta sarà simile alla seguente:</span><span class="sxs-lookup"><span data-stu-id="2f03a-358">If the `DateCreated` field is added to the schema of the customer resource, then the response would look like this:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="2f03a-359">Le applicazioni client esistenti potrebbero continuare a funzionare correttamente se riescono a ignorare i campi non riconosciuti, mentre le nuove applicazioni client possono essere progettate per gestire questo nuovo campo.</span><span class="sxs-lookup"><span data-stu-id="2f03a-359">Existing client applications might continue functioning correctly if they are capable of ignoring unrecognized fields, while new client applications can be designed to handle this new field.</span></span> <span data-ttu-id="2f03a-360">Tuttavia, modifiche più radicali allo schema di risorse (ad esempio, la rimozione o la ridenominazione dei campi) o cambiamenti nelle relazioni tra le risorse possono costituire modifiche sostanziali che impediscono alle applicazioni client esistenti di funzionare correttamente.</span><span class="sxs-lookup"><span data-stu-id="2f03a-360">However, if more radical changes to the schema of resources occur (such as removing or renaming fields) or the relationships between resources change then these may constitute breaking changes that prevent existing client applications from functioning correctly.</span></span> <span data-ttu-id="2f03a-361">In tali situazioni è necessario considerare uno degli approcci seguenti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-361">In these situations you should consider one of the following approaches.</span></span>

### <a name="uri-versioning"></a><span data-ttu-id="2f03a-362">Controllo delle versioni tramite l’URI</span><span class="sxs-lookup"><span data-stu-id="2f03a-362">URI versioning</span></span>
<span data-ttu-id="2f03a-363">Ogni volta che si modifica l'API Web o che si cambia lo schema di risorse, viene aggiunto un numero di versione all'URI per ciascuna risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-363">Each time you modify the web API or change the schema of resources, you add a version number to the URI for each resource.</span></span> <span data-ttu-id="2f03a-364">Gli URI già esistenti continueranno a funzionare come prima, restituendo risorse conformi al relativo schema originale.</span><span class="sxs-lookup"><span data-stu-id="2f03a-364">The previously existing URIs should continue to operate as before, returning resources that conform to their original schema.</span></span>

<span data-ttu-id="2f03a-365">Estendendo l'esempio precedente, se il campo `address` viene ristrutturato in campi secondari contenenti le singole parti che costituiscono l'indirizzo (ad esempio `streetAddress`, `city`, `state` e `zipCode`), questa versione della risorsa potrebbe essere esposta tramite un URI contenente un numero di versione, ad esempio http://adventure-works.com/v2/customers/3:</span><span class="sxs-lookup"><span data-stu-id="2f03a-365">Extending the previous example, if the `address` field is restructured into sub-fields containing each constituent part of the address (such as `streetAddress`, `city`, `state`, and `zipCode`), this version of the resource could be exposed through a URI containing a version number, such as http://adventure-works.com/v2/customers/3:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="2f03a-366">Questo meccanismo di controllo delle versioni è molto semplice, ma dipende dal server che esegue il routing della richiesta all'endpoint appropriato.</span><span class="sxs-lookup"><span data-stu-id="2f03a-366">This versioning mechanism is very simple but depends on the server routing the request to the appropriate endpoint.</span></span> <span data-ttu-id="2f03a-367">Tuttavia, può diventare scomodo man mano che l’API Web matura attraverso diverse iterazioni e il server deve supportare un numero elevato di versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-367">However, it can become unwieldy as the web API matures through several iterations and the server has to support a number of different versions.</span></span> <span data-ttu-id="2f03a-368">Inoltre, dal punto di vista di un purista, in tutti i casi le applicazioni client recuperano gli stessi dati (cliente 3), quindi l'URI non deve essere effettivamente diverso a seconda della versione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-368">Also, from a purist’s point of view, in all cases the client applications are fetching the same data (customer 3), so the URI should not really be different depending on the version.</span></span> <span data-ttu-id="2f03a-369">Questo schema complica anche l'implementazione di HATEOAS perché tutti i collegamenti dovranno includere il numero di versione nei relativi URI.</span><span class="sxs-lookup"><span data-stu-id="2f03a-369">This scheme also complicates implementation of HATEOAS as all links will need to include the version number in their URIs.</span></span>

### <a name="query-string-versioning"></a><span data-ttu-id="2f03a-370">Controllo delle versioni tramite la stringa di query</span><span class="sxs-lookup"><span data-stu-id="2f03a-370">Query string versioning</span></span>
<span data-ttu-id="2f03a-371">Anziché fornire più URI, è possibile specificare la versione della risorsa usando un parametro all'interno della stringa di query aggiunta alla richiesta HTTP, ad esempio *http://adventure-works.com/customers/3?version=2*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-371">Rather than providing multiple URIs, you can specify the version of the resource by using a parameter within the query string appended to the HTTP request, such as *http://adventure-works.com/customers/3?version=2*.</span></span> <span data-ttu-id="2f03a-372">Il parametro della versione deve essere impostato su un valore predefinito significativo, ad esempio 1 se viene omesso dalle applicazioni client meno recenti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-372">The version parameter should default to a meaningful value such as 1 if it is omitted by older client applications.</span></span>

<span data-ttu-id="2f03a-373">Questo approccio ha il vantaggio semantico che la stessa risorsa viene sempre recuperata dallo stesso URI, ma dipende dal codice che gestisce la richiesta analizzare la stringa di query e inviare la risposta HTTP appropriata.</span><span class="sxs-lookup"><span data-stu-id="2f03a-373">This approach has the semantic advantage that the same resource is always retrieved from the same URI, but it depends on the code that handles the request to parse the query string and send back the appropriate HTTP response.</span></span> <span data-ttu-id="2f03a-374">Questo approccio presenta anche le stesse complicazioni per l'implementazione di HATEOAS del meccanismo di controllo delle versioni tramite URI.</span><span class="sxs-lookup"><span data-stu-id="2f03a-374">This approach also suffers from the same complications for implementing HATEOAS as the URI versioning mechanism.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-375">Alcuni Web browser e proxy Web meno recenti non memorizzano nella cache le risposte per le richieste che includono una stringa di query nell'URL.</span><span class="sxs-lookup"><span data-stu-id="2f03a-375">Some older web browsers and web proxies will not cache responses for requests that include a query string in the URL.</span></span> <span data-ttu-id="2f03a-376">Ciò può avere un impatto negativo sulle prestazioni per le applicazioni Web che utilizzano un'API Web e che vengono eseguite dall'interno di questo tipo di Web browser.</span><span class="sxs-lookup"><span data-stu-id="2f03a-376">This can have an adverse impact on performance for web applications that use a web API and that run from within such a web browser.</span></span>
>
>

### <a name="header-versioning"></a><span data-ttu-id="2f03a-377">Controllo delle versioni tramite l’intestazione</span><span class="sxs-lookup"><span data-stu-id="2f03a-377">Header versioning</span></span>
<span data-ttu-id="2f03a-378">Anziché aggiungere il numero di versione come parametro di stringa di query, è possibile implementare un'intestazione personalizzata che indica la versione della risorsa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-378">Rather than appending the version number as a query string parameter, you could implement a custom header that indicates the version of the resource.</span></span> <span data-ttu-id="2f03a-379">Questo approccio richiede l’aggiunta, da parte dell'applicazione client, dell'intestazione appropriata a tutte le richieste, nonostante il codice che gestisce la richiesta del client possa usare un valore predefinito (versione 1) se l'intestazione della versione viene omessa.</span><span class="sxs-lookup"><span data-stu-id="2f03a-379">This approach requires that the client application adds the appropriate header to any requests, although the code handling the client request could use a default value (version 1) if the version header is omitted.</span></span> <span data-ttu-id="2f03a-380">Nell'esempio seguente viene usata un'intestazione personalizzata denominata *Custom-Header*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-380">The following examples utilize a custom header named *Custom-Header*.</span></span> <span data-ttu-id="2f03a-381">Il valore di questa intestazione indica la versione dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-381">The value of this header indicates the version of web API.</span></span>

<span data-ttu-id="2f03a-382">Versione 1:</span><span class="sxs-lookup"><span data-stu-id="2f03a-382">Version 1:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=1
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="2f03a-383">Versione 2:</span><span class="sxs-lookup"><span data-stu-id="2f03a-383">Version 2:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=2
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="2f03a-384">Si noti che, come con i due approcci precedenti, l’implementazione di HATEOAS richiede l’inclusione dell'intestazione personalizzata appropriata in tutti i collegamenti.</span><span class="sxs-lookup"><span data-stu-id="2f03a-384">Note that as with the previous two approaches, implementing HATEOAS requires including the appropriate custom header in any links.</span></span>

### <a name="media-type-versioning"></a><span data-ttu-id="2f03a-385">Controllo delle versioni tramite il tipo di supporto</span><span class="sxs-lookup"><span data-stu-id="2f03a-385">Media type versioning</span></span>
<span data-ttu-id="2f03a-386">Quando un'applicazione client invia una richiesta HTTP GET a un server Web, è necessario stabilire il formato del contenuto che è possibile gestire tramite un'intestazione Accept, come descritto in precedenza in queste linee guida.</span><span class="sxs-lookup"><span data-stu-id="2f03a-386">When a client application sends an HTTP GET request to a web server it should stipulate the format of the content that it can handle by using an Accept header, as described earlier in this guidance.</span></span> <span data-ttu-id="2f03a-387">L'intestazione *Accept* ha spesso lo scopo di consentire all'applicazione client di specificare se il corpo della risposta deve essere in formato XML, JSON o in un altro formato comune analizzabile dal client.</span><span class="sxs-lookup"><span data-stu-id="2f03a-387">Frequently the purpose of the *Accept* header is to allow the client application to specify whether the body of the response should be XML, JSON, or some other common format that the client can parse.</span></span> <span data-ttu-id="2f03a-388">Tuttavia, è possibile definire tipi di supporti personalizzati che includono informazioni che consentono all'applicazione client di indicare la versione di una risorsa prevista.163</span><span class="sxs-lookup"><span data-stu-id="2f03a-388">However, it is possible to define custom media types that include information enabling the client application to indicate which version of a resource it is expecting.</span></span> <span data-ttu-id="2f03a-389">Nell'esempio seguente viene illustrata una richiesta che specifica un'intestazione *Accept* con il valore *application/vnd.adventure-works.v1+json*.</span><span class="sxs-lookup"><span data-stu-id="2f03a-389">The following example shows a request that specifies an *Accept* header with the value *application/vnd.adventure-works.v1+json*.</span></span> <span data-ttu-id="2f03a-390">L'elemento *vnd.adventure works.v1* indica al server Web che deve restituire la versione 1 della risorsa, mentre l'elemento *json* specifica che il corpo della risposta deve essere in formato JSON:</span><span class="sxs-lookup"><span data-stu-id="2f03a-390">The *vnd.adventure-works.v1* element indicates to the web server that it should return version 1 of the resource, while the *json* element specifies that the format of the response body should be JSON:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Accept: application/vnd.adventure-works.v1+json
...
```

<span data-ttu-id="2f03a-391">Il codice che gestisce la richiesta è responsabile dell'elaborazione dell'intestazione *Accept* rispettandola per quanto possibile. L'applicazione client può specificare più formati nell'intestazione *Accept* e in questo caso il server Web può scegliere il formato più appropriato per il corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="2f03a-391">The code handling the request is responsible for processing the *Accept* header and honoring it as far as possible (the client application may specify multiple formats in the *Accept* header, in which case the web server can choose the most appropriate format for the response body).</span></span> <span data-ttu-id="2f03a-392">Il server Web conferma il formato dei dati nel corpo della risposta mediante l'intestazione Content-Type:</span><span class="sxs-lookup"><span data-stu-id="2f03a-392">The web server confirms the format of the data in the response body by using the Content-Type header:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/vnd.adventure-works.v1+json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="2f03a-393">Se l'intestazione Accept non specifica alcun tipo di supporto noto, il server Web potrebbe generare un messaggio di risposta HTTP 406 (Pagina non valida) o restituire un messaggio con un tipo di supporto predefinito.</span><span class="sxs-lookup"><span data-stu-id="2f03a-393">If the Accept header does not specify any known media types, the web server could generate an HTTP 406 (Not Acceptable) response message or return a message with a default media type.</span></span>

<span data-ttu-id="2f03a-394">Questo approccio è senza dubbio il meccanismo di controllo delle versioni più puro e si presta naturalmente a HATEOAS, che può includere il tipo MIME dei dati correlati nei collegamenti alle risorse.</span><span class="sxs-lookup"><span data-stu-id="2f03a-394">This approach is arguably the purest of the versioning mechanisms and lends itself naturally to HATEOAS, which can include the MIME type of related data in resource links.</span></span>

> [!NOTE]
> <span data-ttu-id="2f03a-395">Quando si seleziona una strategia di controllo delle versioni, è consigliabile tenere in considerazione anche le implicazioni sulle prestazioni, soprattutto la memorizzazione nella cache sul server Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-395">When you select a versioning strategy, you should also consider the implications on performance, especially caching on the web server.</span></span> <span data-ttu-id="2f03a-396">Il controllo delle versioni tramite URI e gli schemi di controllo delle versioni tramite la stringa di query sono adatti alla cache perché la stessa combinazione URI/stringa di query fa riferimento ogni volta agli stessi dati.</span><span class="sxs-lookup"><span data-stu-id="2f03a-396">The URI versioning and Query String versioning schemes are cache-friendly inasmuch as the same URI/query string combination refers to the same data each time.</span></span>
>
> <span data-ttu-id="2f03a-397">I meccanismi di controllo delle versioni tramite intestazione e tipo di supporto in genere richiedono logica aggiuntiva per esaminare i valori nell’intestazione personalizzata o nell'intestazione Accept.</span><span class="sxs-lookup"><span data-stu-id="2f03a-397">The Header versioning and Media Type versioning mechanisms typically require additional logic to examine the values in the custom header or the Accept header.</span></span> <span data-ttu-id="2f03a-398">In un ambiente su larga scala, la presenza di molti client che usano versioni diverse di un'API Web può comportare una notevole quantità di dati duplicati in una cache lato server.</span><span class="sxs-lookup"><span data-stu-id="2f03a-398">In a large-scale environment, many clients using different versions of a web API can result in a significant amount of duplicated data in a server-side cache.</span></span> <span data-ttu-id="2f03a-399">Questo problema può diventare evidente se un'applicazione client comunica con un server Web tramite un proxy che implementa la memorizzazione nella cache e che inoltra una richiesta al server Web solo se attualmente non mantiene una copia dei dati richiesti nella propria cache.</span><span class="sxs-lookup"><span data-stu-id="2f03a-399">This issue can become acute if a client application communicates with a web server through a proxy that implements caching, and that only forwards a request to the web server if it does not currently hold a copy of the requested data in its cache.</span></span>
>
>

## <a name="open-api-initiative"></a><span data-ttu-id="2f03a-400">Iniziativa OpenAPI</span><span class="sxs-lookup"><span data-stu-id="2f03a-400">Open API Initiative</span></span>
<span data-ttu-id="2f03a-401">L'[Iniziativa OpenAPI](https://www.openapis.org/) è stata creata da un consorzio di settore per standardizzare le descrizioni dell'API REST tra i fornitori.</span><span class="sxs-lookup"><span data-stu-id="2f03a-401">The [Open API Initiative](https://www.openapis.org/) was created by an industry consortium to standardize REST API descriptions across vendors.</span></span> <span data-ttu-id="2f03a-402">Come parte di questa iniziativa, la specifica di Swagger 2.0 è stata rinominata Specifica OpenAPI ed è stata inserita nell'Iniziativa OpenAPI.</span><span class="sxs-lookup"><span data-stu-id="2f03a-402">As part of this initiative, the Swagger 2.0 specification was renamed the OpenAPI Specification (OAS) and brought under the Open API Initiative.</span></span>

<span data-ttu-id="2f03a-403">Si consiglia di adottare OpenAPI per le API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-403">You may want to adopt OpenAPI for your web APIs.</span></span> <span data-ttu-id="2f03a-404">Alcune informazioni da considerare:</span><span class="sxs-lookup"><span data-stu-id="2f03a-404">Some points to consider:</span></span>

- <span data-ttu-id="2f03a-405">La Specifica OpenAPI comprende una serie di linee guida dettagliate su come progettare un'API REST.</span><span class="sxs-lookup"><span data-stu-id="2f03a-405">The OpenAPI Specification comes with with a set of opinionated guidelines on how a REST API should be designed.</span></span> <span data-ttu-id="2f03a-406">Questo presenta dei vantaggi per quanto riguarda l'interoperabilità, ma richiede una maggiore attenzione quando si progetta l'API in conformità con la specifica.</span><span class="sxs-lookup"><span data-stu-id="2f03a-406">That has advantages for interoperability, but requires more care when designing your API to conform to the specification.</span></span>
- <span data-ttu-id="2f03a-407">OpenAPI promuove un approccio con priorità al contratto, anziché un approccio con priorità all'implementazione.</span><span class="sxs-lookup"><span data-stu-id="2f03a-407">OpenAPI promotes a contract-first approach, rather than an implementation-first approach.</span></span> <span data-ttu-id="2f03a-408">Priorità al contratto vuol dire che l'utente progetta prima di tutto il contratto dell'API, ovvero l'interfaccia, e poi scrive il codice che implementa il contratto.</span><span class="sxs-lookup"><span data-stu-id="2f03a-408">Contract-first means you design the API contract (the interface) first and then write code that implements the contract.</span></span> 
- <span data-ttu-id="2f03a-409">Strumenti come Swagger possono generare librerie o documentazione client dai contratti API.</span><span class="sxs-lookup"><span data-stu-id="2f03a-409">Tools like Swagger can generate client libraries or documentation from API contracts.</span></span> <span data-ttu-id="2f03a-410">Ad esempio, vedere [Pagine della guida dell'API Web ASP.NET con Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="2f03a-410">For example, see [ASP.NET Web API Help Pages using Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span>

## <a name="more-information"></a><span data-ttu-id="2f03a-411">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="2f03a-411">More information</span></span>
* <span data-ttu-id="2f03a-412">[Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) (Linee guida dell'API REST di Microsoft) contiene indicazioni dettagliate sulla progettazione delle API REST pubbliche.</span><span class="sxs-lookup"><span data-stu-id="2f03a-412">The [Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) contain detailed recommendations for designing public REST APIs.</span></span>
* <span data-ttu-id="2f03a-413">La [guida di riferimento dettagliata relativa a RESTful](http://restcookbook.com/) contiene un’introduzione alla creazione delle API RESTful.</span><span class="sxs-lookup"><span data-stu-id="2f03a-413">The [RESTful Cookbook](http://restcookbook.com/) contains an introduction to building RESTful APIs.</span></span>
* <span data-ttu-id="2f03a-414">L'[elenco di controllo delle API Web](https://mathieu.fenniak.net/the-api-checklist/) contiene un utile elenco di elementi da considerare durante la progettazione e l'implementazione di un'API Web.</span><span class="sxs-lookup"><span data-stu-id="2f03a-414">The [Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/) contains a useful list of items to consider when designing and implementing a web API.</span></span>
* <span data-ttu-id="2f03a-415">Il sito sull'[Iniziativa OpenAPI](https://www.openapis.org/) contiene tutta la documentazione e le informazioni di implementazione relative a OpenAPI.</span><span class="sxs-lookup"><span data-stu-id="2f03a-415">The [Open API Initiative](https://www.openapis.org/) site, contains all related documentation and implementation details on Open API.</span></span>

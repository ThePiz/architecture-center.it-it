---
title: Linee guida per la progettazione di un’API
description: Linee guida su come creare un'API Web progettata correttamente.
author: dragon119
ms.date: 01/12/2018
pnp.series.title: Best Practices
ms.openlocfilehash: 68ed3f59e1fd63ae754ceabf27a182daa0de0e5d
ms.sourcegitcommit: c4106b58ad08f490e170e461009a4693578294ea
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 08/10/2018
ms.locfileid: "43016013"
---
# <a name="api-design"></a><span data-ttu-id="a9632-103">Progettazione API</span><span class="sxs-lookup"><span data-stu-id="a9632-103">API design</span></span>

<span data-ttu-id="a9632-104">La maggior parte delle applicazioni Web moderne espone API che possono essere usate dai client per interagire con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-104">Most modern web applications expose APIs that clients can use to interact with the application.</span></span> <span data-ttu-id="a9632-105">Un'API Web progettata in modo adeguato deve supportare:</span><span class="sxs-lookup"><span data-stu-id="a9632-105">A well-designed web API should aim to support:</span></span>

* <span data-ttu-id="a9632-106">**Indipendenza dalla piattaforma**.</span><span class="sxs-lookup"><span data-stu-id="a9632-106">**Platform independence**.</span></span> <span data-ttu-id="a9632-107">Qualsiasi client deve poter chiamare l'API indipendentemente da come è implementata internamente.</span><span class="sxs-lookup"><span data-stu-id="a9632-107">Any client should be able to call the API, regardless of how the API is implemented internally.</span></span> <span data-ttu-id="a9632-108">A questo scopo è necessario usare protocolli standard e un meccanismo che consenta al client e al servizio Web di concordare il formato dei dati da scambiare.</span><span class="sxs-lookup"><span data-stu-id="a9632-108">This requires using standard protocols, and having a mechanism whereby the client and the web service can agree on the format of the data to exchange.</span></span>

* <span data-ttu-id="a9632-109">**Evoluzione del servizio**.</span><span class="sxs-lookup"><span data-stu-id="a9632-109">**Service evolution**.</span></span> <span data-ttu-id="a9632-110">L'API Web deve avere la possibilità di evolversi e aggiungere funzionalità indipendentemente dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="a9632-110">The web API should be able to evolve and add functionality independently from client applications.</span></span> <span data-ttu-id="a9632-111">Con l'evoluzione dell'API, le applicazioni client dovranno continuare a funzionare senza modifiche.</span><span class="sxs-lookup"><span data-stu-id="a9632-111">As the API evolves, existing client applications should continue to function without modification.</span></span> <span data-ttu-id="a9632-112">Tutte le funzionalità dovranno essere individuabili per poter essere utilizzate appieno dalle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="a9632-112">All functionality should be discoverable, so that client applications can fully utilize it.</span></span>

<span data-ttu-id="a9632-113">Queste linee guida descrivono gli aspetti da considerare durante la progettazione di un'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-113">This guidance describes issues that you should consider when designing a web API.</span></span>

## <a name="introduction-to-rest"></a><span data-ttu-id="a9632-114">Introduzione a REST</span><span class="sxs-lookup"><span data-stu-id="a9632-114">Introduction to REST</span></span>

<span data-ttu-id="a9632-115">Nel 2000, Roy Fielding ha proposto REST (Representational State Transfer) come approccio di architettura per la progettazione di servizi Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-115">In 2000, Roy Fielding proposed Representational State Transfer (REST) as an architectural approach to designing web services.</span></span> <span data-ttu-id="a9632-116">REST è uno stile architetturale per la creazione di sistemi distribuiti basati su ipermedia.</span><span class="sxs-lookup"><span data-stu-id="a9632-116">REST is an architectural style for building distributed systems based on hypermedia.</span></span> <span data-ttu-id="a9632-117">REST è indipendente da qualsiasi protocollo sottostante e non è necessariamente collegato a HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-117">REST is independent of any underlying protocol and is not necessarily tied to HTTP.</span></span> <span data-ttu-id="a9632-118">Le implementazioni REST più comuni, tuttavia, usano HTTP come protocollo applicativo e questa guida è incentrata sulla progettazione di API REST per HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-118">However, most common REST implementations use HTTP as the application protocol, and this guide focuses on designing REST APIs for HTTP.</span></span>

<span data-ttu-id="a9632-119">Uno dei vantaggi principali di REST su HTTP è costituito dal fatto che usa standard aperti e non vincola l'implementazione dell'API o le applicazioni client a un'implementazione specifica.</span><span class="sxs-lookup"><span data-stu-id="a9632-119">A primary advantage of REST over HTTP is that it uses open standards, and does not bind the implementation of the API or the client applications to any specific implementation.</span></span> <span data-ttu-id="a9632-120">Per un servizio Web REST scritto in ASP.NET, ad esempio, le applicazioni client possono usare qualsiasi linguaggio o set di strumenti che può generare richieste HTTP e analizzare risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-120">For example, a REST web service could be written in ASP.NET, and client applications can use any language or toolset that can generate HTTP requests and parse HTTP responses.</span></span>

<span data-ttu-id="a9632-121">Di seguito sono riportati alcuni fondamentali principi di progettazione delle API RESTful che usano HTTP:</span><span class="sxs-lookup"><span data-stu-id="a9632-121">Here are some of the main design principles of RESTful APIs using HTTP:</span></span>

- <span data-ttu-id="a9632-122">Le API REST sono progettate in base a *risorse*, che possono essere costituite da qualsiasi tipologia di oggetto, servizio o dati accessibile dal client.</span><span class="sxs-lookup"><span data-stu-id="a9632-122">REST APIs are designed around *resources*, which are any kind of object, data, or service that can be accessed by the client.</span></span> 

- <span data-ttu-id="a9632-123">Una risorsa ha un *identificatore*, costituito da un URI che identifica in modo univoco la risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-123">A resource has an *identifier*, which is a URI that uniquely identifies that resource.</span></span> <span data-ttu-id="a9632-124">L'URI per uno specifico ordine cliente può essere ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a9632-124">For example, the URI for a particular customer order might be:</span></span> 
 
    ```http
    http://adventure-works.com/orders/1
    ```
 
- <span data-ttu-id="a9632-125">I client interagiscono con un servizio scambiando *rappresentazioni* delle risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-125">Clients interact with a service by exchanging *representations* of resources.</span></span> <span data-ttu-id="a9632-126">Molte API Web usano JSON come formato di scambio.</span><span class="sxs-lookup"><span data-stu-id="a9632-126">Many web APIs use JSON as the exchange format.</span></span> <span data-ttu-id="a9632-127">Una richiesta GET all'URI riportato sopra, ad esempio, potrebbe restituire questo corpo della risposta:</span><span class="sxs-lookup"><span data-stu-id="a9632-127">For example, a GET request to the URI listed above might return this response body:</span></span>

    ```json
    {"orderId":1,"orderValue":99.90,"productId":1,"quantity":1}
    ```

- <span data-ttu-id="a9632-128">Le API REST usano un'interfaccia uniforme che consente di separare le implementazioni del client e del servizio.</span><span class="sxs-lookup"><span data-stu-id="a9632-128">REST APIs use a uniform interface, which helps to decouple the client and service implementations.</span></span> <span data-ttu-id="a9632-129">Per le API REST basate su HTTP, l'interfaccia uniforme include l'uso di verbi HTTP standard per l'esecuzione di operazioni sulle risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-129">For REST APIs built on HTTP, the uniform interface includes using standard HTTP verbs to perform operations on resources.</span></span> <span data-ttu-id="a9632-130">Le operazioni più comuni sono GET, POST, PUT, PATCH e DELETE.</span><span class="sxs-lookup"><span data-stu-id="a9632-130">The most common operations are GET, POST, PUT, PATCH, and DELETE.</span></span> 

- <span data-ttu-id="a9632-131">Le API REST usano un modello di richiesta senza stato.</span><span class="sxs-lookup"><span data-stu-id="a9632-131">REST APIs use a stateless request model.</span></span> <span data-ttu-id="a9632-132">Le richieste HTTP devono essere indipendenti e possono essere eseguite in qualsiasi ordine, di conseguenza non è possibile mantenere informazioni temporanee sullo stato tra le richieste.</span><span class="sxs-lookup"><span data-stu-id="a9632-132">HTTP requests should be independent and may occur in any order, so keeping transient state information between requests is not feasible.</span></span> <span data-ttu-id="a9632-133">L'unico punto in cui sono memorizzate le informazioni sono le risorse stesse e ogni richiesta deve essere un'operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="a9632-133">The only place where information is stored is in the resources themselves, and each request should be an atomic operation.</span></span> <span data-ttu-id="a9632-134">Questo vincolo garantisce ai servizi Web un'elevata scalabilità, perché non è necessario mantenere alcuna affinità tra i client e server specifici.</span><span class="sxs-lookup"><span data-stu-id="a9632-134">This constraint enables web services to be highly scalable, because there is no need to retain any affinity between clients and specific servers.</span></span> <span data-ttu-id="a9632-135">Qualsiasi server può gestire qualsiasi richiesta proveniente da qualsiasi client.</span><span class="sxs-lookup"><span data-stu-id="a9632-135">Any server can handle any request from any client.</span></span> <span data-ttu-id="a9632-136">La scalabilità può tuttavia essere limitata da altri fattori.</span><span class="sxs-lookup"><span data-stu-id="a9632-136">That said, other factors can limit scalability.</span></span> <span data-ttu-id="a9632-137">Molti servizi Web, ad esempio, eseguono la scrittura in un archivio dati back-end di cui potrebbe essere difficile aumentare il numero di istanze. Le strategie per aumentare il numero di istanze di un archivio dati sono descritte nell'articolo [Partizionamento dei dati](./data-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="a9632-137">For example, many web services write to a backend data store, which may be hard to scale out. (The article [Data Partitioning](./data-partitioning.md) describes strategies to scale out a data store.)</span></span>

- <span data-ttu-id="a9632-138">Le API REST si basano su collegamenti ipermediali contenuti nella rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-138">REST APIs are driven by hypermedia links that are contained in the representation.</span></span> <span data-ttu-id="a9632-139">Di seguito viene ad esempio illustrata una rappresentazione JSON di un ordine</span><span class="sxs-lookup"><span data-stu-id="a9632-139">For example, the following shows a JSON representation of an order.</span></span> <span data-ttu-id="a9632-140">che contiene collegamenti per recuperare o aggiornare il cliente associato all'ordine.</span><span class="sxs-lookup"><span data-stu-id="a9632-140">It contains links to get or update the customer associated with the order.</span></span> 
 
    ```json
    {
        "orderID":3,
        "productID":2,
        "quantity":4,
        "orderValue":16.60,
        "links": [
            {"rel":"product","href":"http://adventure-works.com/customers/3", "action":"GET" },
            {"rel":"product","href":"http://adventure-works.com/customers/3", "action":"PUT" } 
        ]
    } 
    ```


<span data-ttu-id="a9632-141">Nel 2008, Leonard Richardson ha proposto per le API Web il [modello di maturità](https://martinfowler.com/articles/richardsonMaturityModel.html) seguente.</span><span class="sxs-lookup"><span data-stu-id="a9632-141">In 2008, Leonard Richardson proposed the following [maturity model](https://martinfowler.com/articles/richardsonMaturityModel.html) for web APIs:</span></span>

- <span data-ttu-id="a9632-142">Livello 0: definizione di un URI e operazioni interamente costituite da richieste POST a tale URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-142">Level 0: Define one URI, and all operations are POST requests to this URI.</span></span>
- <span data-ttu-id="a9632-143">Livello 1: creazione di URI separati per le singole risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-143">Level 1: Create separate URIs for individual resources.</span></span>
- <span data-ttu-id="a9632-144">Livello 2: uso di metodi HTTP per definire le operazioni sulle risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-144">Level 2: Use HTTP methods to define operations on resources.</span></span>
- <span data-ttu-id="a9632-145">Livello 3: uso di ipermedia (principio HATEOAS descritto di seguito).</span><span class="sxs-lookup"><span data-stu-id="a9632-145">Level 3: Use hypermedia (HATEOAS, described below).</span></span>

<span data-ttu-id="a9632-146">Il livello 3 corrisponde a un'API realmente RESTful in base alla definizione di Fielding.</span><span class="sxs-lookup"><span data-stu-id="a9632-146">Level 3 corresponds to a truly RESTful API according to Fielding's definition.</span></span> <span data-ttu-id="a9632-147">In pratica, molte API Web pubblicate rientrano all'incirca nel livello 2.</span><span class="sxs-lookup"><span data-stu-id="a9632-147">In practice, many  published web APIs fall somewhere around level 2.</span></span>  

## <a name="organize-the-api-around-resources"></a><span data-ttu-id="a9632-148">Organizzare l'API in base alle risorse</span><span class="sxs-lookup"><span data-stu-id="a9632-148">Organize the API around resources</span></span>

<span data-ttu-id="a9632-149">Concentrarsi sulle entità di business esposte dall'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-149">Focus on the business entities that the web API exposes.</span></span> <span data-ttu-id="a9632-150">In un sistema di e-commerce, ad esempio, le entità primarie potrebbero essere i clienti e gli ordini.</span><span class="sxs-lookup"><span data-stu-id="a9632-150">For example, in an e-commerce system, the primary entities might be customers and orders.</span></span> <span data-ttu-id="a9632-151">Un ordine può essere creato inviando una richiesta HTTP POST contenente le informazioni dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="a9632-151">Creating an order can be achieved by sending an HTTP POST request that contains the order information.</span></span> <span data-ttu-id="a9632-152">La risposta HTTP indica se l'ordine è stato inserito correttamente o meno.</span><span class="sxs-lookup"><span data-stu-id="a9632-152">The HTTP response indicates whether the order was placed successfully or not.</span></span> <span data-ttu-id="a9632-153">Quando possibile, gli URI delle risorse devono essere basati su sostantivi (ovvero sulla risorsa) e non su verbi (ossia sulle operazioni sulla risorsa).</span><span class="sxs-lookup"><span data-stu-id="a9632-153">When possible, resource URIs should be based on nouns (the resource) and not verbs (the operations on the resource).</span></span> 

```HTTP
http://adventure-works.com/orders // Good

http://adventure-works.com/create-order // Avoid
```

<span data-ttu-id="a9632-154">Non è necessario che una risorsa sia basata su un singolo elemento fisico di dati.</span><span class="sxs-lookup"><span data-stu-id="a9632-154">A resource does not have to be based on a single physical data item.</span></span> <span data-ttu-id="a9632-155">Una risorsa ordine, ad esempio, potrebbe essere implementata internamente in diverse tabelle di un database relazionale, ma essere presentata al client come una singola entità.</span><span class="sxs-lookup"><span data-stu-id="a9632-155">For example, an order resource might be implemented internally as several tables in a relational database, but presented to the client as a single entity.</span></span> <span data-ttu-id="a9632-156">Evitare di creare API che rispecchiano semplicemente la struttura interna di un database.</span><span class="sxs-lookup"><span data-stu-id="a9632-156">Avoid creating APIs that simply mirror the internal structure of a database.</span></span> <span data-ttu-id="a9632-157">Lo scopo di REST è modellare entità e le operazioni che possono essere eseguite da un'applicazione su tali entità.</span><span class="sxs-lookup"><span data-stu-id="a9632-157">The purpose of REST is to model entities and the operations that an application can perform on those entities.</span></span> <span data-ttu-id="a9632-158">L'implementazione interna non dovrebbe essere esposta a un client.</span><span class="sxs-lookup"><span data-stu-id="a9632-158">A client should not be exposed to the internal implementation.</span></span>

<span data-ttu-id="a9632-159">Le entità sono spesso raggruppate in raccolte (ad esempio, ordini e clienti).</span><span class="sxs-lookup"><span data-stu-id="a9632-159">Entities are often grouped together into collections (orders, customers).</span></span> <span data-ttu-id="a9632-160">Una raccolta è una risorsa separata dall'elemento al suo interno e deve avere un proprio URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-160">A collection is a separate resource from the item within the collection, and should have its own URI.</span></span> <span data-ttu-id="a9632-161">L'URI seguente, ad esempio, potrebbe rappresentare la raccolta degli ordini:</span><span class="sxs-lookup"><span data-stu-id="a9632-161">For example, the following URI might represent the collection of orders:</span></span> 

```HTTP
http://adventure-works.com/orders
```

<span data-ttu-id="a9632-162">Inviando una richiesta HTTP GET all'URI della raccolta viene recuperato un elenco degli elementi al suo interno.</span><span class="sxs-lookup"><span data-stu-id="a9632-162">Sending an HTTP GET request to the collection URI retrieves a list of items in the collection.</span></span> <span data-ttu-id="a9632-163">Ogni elemento della raccolta ha anche un proprio URI univoco.</span><span class="sxs-lookup"><span data-stu-id="a9632-163">Each item in the collection also has its own unique URI.</span></span> <span data-ttu-id="a9632-164">Una richiesta HTTP GET all'URI di un elemento restituisce i dettagli di tale elemento.</span><span class="sxs-lookup"><span data-stu-id="a9632-164">An HTTP GET request to the item's URI returns the details of that item.</span></span> 

<span data-ttu-id="a9632-165">Adottare una convenzione di denominazione coerente negli URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-165">Adopt a consistent naming convention in URIs.</span></span> <span data-ttu-id="a9632-166">In generale, per gli URI che fanno riferimento alle raccolte è utile usare sostantivi plurali.</span><span class="sxs-lookup"><span data-stu-id="a9632-166">In general, it helps to use plural nouns for URIs that reference collections.</span></span> <span data-ttu-id="a9632-167">È consigliabile organizzare gli URI per le raccolte e gli elementi in una gerarchia.</span><span class="sxs-lookup"><span data-stu-id="a9632-167">It's a good practice to organize URIs for collections and items into a hierarchy.</span></span> <span data-ttu-id="a9632-168">Se `/customers` è il percorso della raccolta dei clienti, ad esempio, `/customers/5` sarà il percorso del cliente il cui ID è 5.</span><span class="sxs-lookup"><span data-stu-id="a9632-168">For example, `/customers` is the path to the customers collection, and `/customers/5` is the path to the customer with ID equal to 5.</span></span> <span data-ttu-id="a9632-169">Questo approccio consente di mantenere l'API Web intuitiva.</span><span class="sxs-lookup"><span data-stu-id="a9632-169">This approach helps to keep the web API intuitive.</span></span> <span data-ttu-id="a9632-170">Molti framework API Web, inoltre, possono indirizzare le richieste in base a percorsi URI con parametri ed è quindi possibile definire una route per il percorso `/customers/{id}`.</span><span class="sxs-lookup"><span data-stu-id="a9632-170">Also, many web API frameworks can route requests based on parameterized URI paths, so you could define a route for the path `/customers/{id}`.</span></span>

<span data-ttu-id="a9632-171">Considerare anche le relazioni tra i diversi tipi di risorse e come si potrebbero esporre tali associazioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-171">Also consider the relationships between different types of resources and how you might expose these associations.</span></span> <span data-ttu-id="a9632-172">Ad esempio, `/customers/5/orders` potrebbe rappresentare tutti gli ordini per il cliente 5.</span><span class="sxs-lookup"><span data-stu-id="a9632-172">For example, the `/customers/5/orders` might represent all of the orders for customer 5.</span></span> <span data-ttu-id="a9632-173">Si potrebbe procedere anche nella direzione opposta e rappresentare l'associazione da un ordine a un cliente con un URI come `/orders/99/customer`.</span><span class="sxs-lookup"><span data-stu-id="a9632-173">You could also go in the other direction, and represent the association from an order back to a customer with a URI such as `/orders/99/customer`.</span></span> <span data-ttu-id="a9632-174">Se questo modello viene esteso eccessivamente, tuttavia, la relativa implementazione può diventare complessa.</span><span class="sxs-lookup"><span data-stu-id="a9632-174">However, extending this model too far can become cumbersome to implement.</span></span> <span data-ttu-id="a9632-175">È preferibile fornire collegamenti esplorabili alle risorse associate nel corpo del messaggio di risposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-175">A better solution is to provide navigable links to associated resources in the body of the HTTP response message.</span></span> <span data-ttu-id="a9632-176">Questo meccanismo viene descritto in modo più dettagliato nella sezione [Usare HATEOAS per consentire lo spostamento alle risorse correlate](#using-the-hateoas-approach-to-enable-navigation-to-related-resources) più avanti.</span><span class="sxs-lookup"><span data-stu-id="a9632-176">This mechanism is described in more detail in the section [Using the HATEOAS Approach to Enable Navigation To Related Resources later](#using-the-hateoas-approach-to-enable-navigation-to-related-resources).</span></span>

<span data-ttu-id="a9632-177">Nei sistemi più complessi si può essere tentati di fornire URI che consentono a un client di spostarsi tra diversi livelli di relazioni, ad esempio `/customers/1/orders/99/products`.</span><span class="sxs-lookup"><span data-stu-id="a9632-177">In more complex systems, it can be tempting to provide URIs that enable a client to navigate through several levels of relationships, such as `/customers/1/orders/99/products`.</span></span> <span data-ttu-id="a9632-178">Tuttavia questo livello di complessità può essere difficile da mantenere e non è flessibile se le relazioni tra le risorse cambiano in futuro.</span><span class="sxs-lookup"><span data-stu-id="a9632-178">However, this level of complexity can be difficult to maintain and is inflexible if the relationships between resources change in the future.</span></span> <span data-ttu-id="a9632-179">Provare invece a mantenere gli URI relativamente semplici.</span><span class="sxs-lookup"><span data-stu-id="a9632-179">Instead, try to keep URIs relatively simple.</span></span> <span data-ttu-id="a9632-180">Quando un'applicazione contiene un riferimento a una risorsa, dovrebbe essere possibile usare questo riferimento per trovare gli elementi correlati a tale risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-180">Once an application has a reference to a resource, it should be possible to use this reference to find items related to that resource.</span></span> <span data-ttu-id="a9632-181">La query precedente può essere sostituita con l'URI `/customers/1/orders` per trovare tutti gli ordini per il cliente 1 e quindi `/orders/99/products` per trovare i prodotti in tale ordine.</span><span class="sxs-lookup"><span data-stu-id="a9632-181">The preceding query can be replaced with the URI `/customers/1/orders` to find all the orders for customer 1, and then `/orders/99/products` to find the products in this order.</span></span>

> [!TIP]
> <span data-ttu-id="a9632-182">Evitare di richiedere URI di risorse più complessi di *raccolta/elemento/raccolta*.</span><span class="sxs-lookup"><span data-stu-id="a9632-182">Avoid requiring resource URIs more complex than *collection/item/collection*.</span></span>

<span data-ttu-id="a9632-183">Un altro fattore è che tutte le richieste Web impongono un carico sul server Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-183">Another factor is that all web requests impose a load on the web server.</span></span> <span data-ttu-id="a9632-184">Maggiore è il numero di richieste, maggiore è il carico.</span><span class="sxs-lookup"><span data-stu-id="a9632-184">The more requests, the bigger the load.</span></span> <span data-ttu-id="a9632-185">Provare quindi a evitare API Web "frammentate" che espongono un numero elevato di risorse di piccole dimensioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-185">Therefore, try to avoid "chatty" web APIs that expose a large number of small resources.</span></span> <span data-ttu-id="a9632-186">Un'API di questo tipo può richiedere che un'applicazione client invii più richieste per trovare tutti i dati necessari.</span><span class="sxs-lookup"><span data-stu-id="a9632-186">Such an API may require a client application to send multiple requests to find all of the data that it requires.</span></span> <span data-ttu-id="a9632-187">Potrebbe essere invece opportuno denormalizzare i dati e combinare le informazioni correlate in risorse di maggiori dimensioni recuperabili con una singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-187">Instead, you might want to denormalize the data and combine related information into bigger resources that can be retrieved with a single request.</span></span> <span data-ttu-id="a9632-188">Questo approccio deve tuttavia essere bilanciato rispetto al sovraccarico associato al recupero di dati non necessari al client.</span><span class="sxs-lookup"><span data-stu-id="a9632-188">However, you need to balance this approach against the overhead of fetching data that the client doesn't need.</span></span> <span data-ttu-id="a9632-189">Il recupero di oggetti di grandi dimensioni può aumentare la latenza di una richiesta e comportare costi aggiuntivi in termini di larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="a9632-189">Retrieving large objects can increase the latency of a request and incur additional bandwidth costs.</span></span> <span data-ttu-id="a9632-190">Per altre informazioni su questi anti-modelli delle prestazioni, vedere gli articoli relativi a [I/O frammentato](../antipatterns/chatty-io/index.md) e [recupero estraneo](../antipatterns/extraneous-fetching/index.md).</span><span class="sxs-lookup"><span data-stu-id="a9632-190">For more information about these performance antipatterns, see [Chatty I/O](../antipatterns/chatty-io/index.md) and [Extraneous Fetching](../antipatterns/extraneous-fetching/index.md).</span></span>

<span data-ttu-id="a9632-191">Evitare di introdurre dipendenze tra l'API Web e le origini dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="a9632-191">Avoid introducing dependencies between the web API and the underlying data sources.</span></span> <span data-ttu-id="a9632-192">Se i dati sono archiviati in un database relazionale, ad esempio, non è necessario che l'API Web esponga ogni tabella come raccolta di risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-192">For example, if your data is stored in a relational database, the web API doesn't need to expose each table as a collection of resources.</span></span> <span data-ttu-id="a9632-193">Questo potrebbe probabilmente rivelarsi un errore di progettazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-193">In fact, that's probably a poor design.</span></span> <span data-ttu-id="a9632-194">Considerare invece l'API Web come un'astrazione del database.</span><span class="sxs-lookup"><span data-stu-id="a9632-194">Instead, think of the web API as an abstraction of the database.</span></span> <span data-ttu-id="a9632-195">Se necessario, introdurre un livello di mapping tra il database e l'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-195">If necessary, introduce a mapping layer between the database and the web API.</span></span> <span data-ttu-id="a9632-196">In questo modo, le applicazioni client vengono isolate dalle modifiche allo schema di database sottostante.</span><span class="sxs-lookup"><span data-stu-id="a9632-196">That way, client applications are isolated from changes to the underlying database scheme.</span></span>

<span data-ttu-id="a9632-197">Infine, potrebbe non essere possibile eseguire il mapping di ogni operazione implementata da un'API Web a una risorsa specifica.</span><span class="sxs-lookup"><span data-stu-id="a9632-197">Finally, it might not be possible to map every operation implemented by a web API to a specific resource.</span></span> <span data-ttu-id="a9632-198">È possibile gestire tali scenari *non corrispondenti a una risorsa* tramite richieste HTTP che richiamano una funzione e restituiscono i risultati come messaggio di risposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-198">You can handle such *non-resource* scenarios through HTTP requests that invoke a function and return the results as an HTTP response message.</span></span> <span data-ttu-id="a9632-199">Un'API Web che implementa semplici operazioni aritmetiche come addizione e sottrazione, ad esempio, potrebbe fornire URI che espongono tali operazioni come pseudo-risorse e usare la stringa di query per specificare i parametri necessari.</span><span class="sxs-lookup"><span data-stu-id="a9632-199">For example, a web API that implements simple calculator operations such as add and subtract could provide URIs that expose these operations as pseudo resources and use the query string to specify the parameters required.</span></span> <span data-ttu-id="a9632-200">Una richiesta GET all'URI */add?operand1=99&operand2=1* restituirà ad esempio un messaggio di risposta il cui corpo contiene il valore 100.</span><span class="sxs-lookup"><span data-stu-id="a9632-200">For example a GET request to the URI */add?operand1=99&operand2=1* would return a response message with the body containing the value 100.</span></span> <span data-ttu-id="a9632-201">Utilizzare tuttavia questi formati di URI solo in casi limitati.</span><span class="sxs-lookup"><span data-stu-id="a9632-201">However, only use these forms of URIs sparingly.</span></span>

## <a name="define-operations-in-terms-of-http-methods"></a><span data-ttu-id="a9632-202">Definire le operazioni in termini di metodi HTTP</span><span class="sxs-lookup"><span data-stu-id="a9632-202">Define operations in terms of HTTP methods</span></span>

<span data-ttu-id="a9632-203">Il protocollo HTTP definisce una serie di metodi che assegnano un significato semantico a una richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-203">The HTTP protocol defines a number of methods that assign semantic meaning to a request.</span></span> <span data-ttu-id="a9632-204">I metodi HTTP usati dalla maggior parte delle API Web RESTful sono:</span><span class="sxs-lookup"><span data-stu-id="a9632-204">The common HTTP methods used by most RESTful web APIs are:</span></span>

* <span data-ttu-id="a9632-205">**GET** recupera una rappresentazione della risorsa nell'URI specificato.</span><span class="sxs-lookup"><span data-stu-id="a9632-205">**GET** retrieves a representation of the resource at the specified URI.</span></span> <span data-ttu-id="a9632-206">Il corpo del messaggio di risposta contiene i dettagli della risorsa richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-206">The body of the response message contains the details of the requested resource.</span></span>
* <span data-ttu-id="a9632-207">**POST** crea una nuova risorsa nell'URI specificato.</span><span class="sxs-lookup"><span data-stu-id="a9632-207">**POST** creates a new resource at the specified URI.</span></span> <span data-ttu-id="a9632-208">Il corpo del messaggio di richiesta fornisce i dettagli della nuova risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-208">The body of the request message provides the details of the new resource.</span></span> <span data-ttu-id="a9632-209">Si noti che POST può anche essere usato per avviare operazioni che in realtà non creano risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-209">Note that POST can also be used to trigger operations that don't actually create resources.</span></span>
* <span data-ttu-id="a9632-210">**PUT** crea o sostituisce la risorsa nell'URI specificato.</span><span class="sxs-lookup"><span data-stu-id="a9632-210">**PUT** either creates or replaces the resource at the specified URI.</span></span> <span data-ttu-id="a9632-211">Il corpo del messaggio di richiesta specifica la risorsa da creare o aggiornare.</span><span class="sxs-lookup"><span data-stu-id="a9632-211">The body of the request message specifies the resource to be created or updated.</span></span>
* <span data-ttu-id="a9632-212">**PATCH** esegue un aggiornamento parziale di una risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-212">**PATCH** performs a partial update of a resource.</span></span> <span data-ttu-id="a9632-213">Il corpo della richiesta specifica il set di modifiche da applicare alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-213">The request body specifies the set of changes to apply to the resource.</span></span>
* <span data-ttu-id="a9632-214">**DELETE** rimuove la risorsa nell'URI specificato.</span><span class="sxs-lookup"><span data-stu-id="a9632-214">**DELETE** removes the resource at the specified URI.</span></span>

<span data-ttu-id="a9632-215">L'effetto di una specifica richiesta varia a seconda che la risorsa sia una raccolta o un singolo elemento.</span><span class="sxs-lookup"><span data-stu-id="a9632-215">The effect of a specific request should depend on whether the resource is a collection or an individual item.</span></span> <span data-ttu-id="a9632-216">La tabella seguente riepiloga le convenzioni comuni adottate dalla maggior parte delle implementazioni RESTful usando l’esempio dell’e-commerce.</span><span class="sxs-lookup"><span data-stu-id="a9632-216">The following table summarizes the common conventions adopted by most RESTful implementations using the ecommerce example.</span></span> <span data-ttu-id="a9632-217">Si noti che potrebbe non essere possibile implementare tutte queste richieste. L’implementazione dipende dallo scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="a9632-217">Note that not all of these requests might be implemented; it depends on the specific scenario.</span></span>

| <span data-ttu-id="a9632-218">**Risorsa**</span><span class="sxs-lookup"><span data-stu-id="a9632-218">**Resource**</span></span> | <span data-ttu-id="a9632-219">**POST**</span><span class="sxs-lookup"><span data-stu-id="a9632-219">**POST**</span></span> | <span data-ttu-id="a9632-220">**GET**</span><span class="sxs-lookup"><span data-stu-id="a9632-220">**GET**</span></span> | <span data-ttu-id="a9632-221">**PUT**</span><span class="sxs-lookup"><span data-stu-id="a9632-221">**PUT**</span></span> | <span data-ttu-id="a9632-222">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="a9632-222">**DELETE**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="a9632-223">/customers.</span><span class="sxs-lookup"><span data-stu-id="a9632-223">/customers</span></span> |<span data-ttu-id="a9632-224">Creare un nuovo cliente</span><span class="sxs-lookup"><span data-stu-id="a9632-224">Create a new customer</span></span> |<span data-ttu-id="a9632-225">Recuperare tutti i clienti</span><span class="sxs-lookup"><span data-stu-id="a9632-225">Retrieve all customers</span></span> |<span data-ttu-id="a9632-226">Eseguire l'aggiornamento in blocco dei clienti</span><span class="sxs-lookup"><span data-stu-id="a9632-226">Bulk update of customers</span></span> |<span data-ttu-id="a9632-227">Rimuovere tutti i clienti</span><span class="sxs-lookup"><span data-stu-id="a9632-227">Remove all customers</span></span> |
| <span data-ttu-id="a9632-228">/customers/1</span><span class="sxs-lookup"><span data-stu-id="a9632-228">/customers/1</span></span> |<span data-ttu-id="a9632-229">Tipi di errore</span><span class="sxs-lookup"><span data-stu-id="a9632-229">Error</span></span> |<span data-ttu-id="a9632-230">Recuperare i dettagli per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-230">Retrieve the details for customer 1</span></span> |<span data-ttu-id="a9632-231">Aggiornare i dettagli del cliente 1, se esistente</span><span class="sxs-lookup"><span data-stu-id="a9632-231">Update the details of customer 1 if it exists</span></span> |<span data-ttu-id="a9632-232">Rimuovere il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-232">Remove customer 1</span></span> |
| <span data-ttu-id="a9632-233">/customers/1/orders</span><span class="sxs-lookup"><span data-stu-id="a9632-233">/customers/1/orders</span></span> |<span data-ttu-id="a9632-234">Creare un nuovo ordine per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-234">Create a new order for customer 1</span></span> |<span data-ttu-id="a9632-235">Recuperare tutti gli ordini per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-235">Retrieve all orders for customer 1</span></span> |<span data-ttu-id="a9632-236">Eseguire l'aggiornamento in blocco degli ordini per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-236">Bulk update of orders for customer 1</span></span> |<span data-ttu-id="a9632-237">Rimuovere tutti gli ordini per il cliente 1</span><span class="sxs-lookup"><span data-stu-id="a9632-237">Remove all orders for customer 1</span></span> |

<span data-ttu-id="a9632-238">Le differenze tra POST, PUT e PATCH possono risultare poco chiare.</span><span class="sxs-lookup"><span data-stu-id="a9632-238">The differences between POST, PUT, and PATCH can be confusing.</span></span>

- <span data-ttu-id="a9632-239">Una richiesta POST crea una risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-239">A POST request creates a resource.</span></span> <span data-ttu-id="a9632-240">Il server assegna un URI per la nuova risorsa e restituisce tale URI al client.</span><span class="sxs-lookup"><span data-stu-id="a9632-240">The server assigns a URI for the new resource, and returns that URI to the client.</span></span> <span data-ttu-id="a9632-241">Nel modello REST, le richieste POST vengono spesso applicate alle raccolte.</span><span class="sxs-lookup"><span data-stu-id="a9632-241">In the REST model, you frequently apply POST requests to collections.</span></span> <span data-ttu-id="a9632-242">La nuova risorsa viene aggiunta alla raccolta.</span><span class="sxs-lookup"><span data-stu-id="a9632-242">The new resource is added to the collection.</span></span> <span data-ttu-id="a9632-243">Una richiesta POST può essere usata anche per inviare dati a una risorsa esistente per l'elaborazione, senza che venga creata una nuova risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-243">A POST request can also be used to submit data for processing to an existing resource, without any new resource being created.</span></span>

- <span data-ttu-id="a9632-244">Una richiesta PUT crea una risorsa *o* aggiorna una risorsa esistente.</span><span class="sxs-lookup"><span data-stu-id="a9632-244">A PUT request creates a resource *or* updates an existing resource.</span></span> <span data-ttu-id="a9632-245">Il client specifica l'URI per la risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-245">The client specifies the URI for the resource.</span></span> <span data-ttu-id="a9632-246">Il corpo della richiesta contiene una rappresentazione completa della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-246">The request body contains a complete representation of the resource.</span></span> <span data-ttu-id="a9632-247">Se esiste già una risorsa con tale URI, viene sostituita.</span><span class="sxs-lookup"><span data-stu-id="a9632-247">If a resource with this URI already exists, it is replaced.</span></span> <span data-ttu-id="a9632-248">In caso contrario viene creata una nuova risorsa, se questa operazione è supportata dal server.</span><span class="sxs-lookup"><span data-stu-id="a9632-248">Otherwise a new resource is created, if the server supports doing so.</span></span> <span data-ttu-id="a9632-249">Le richieste PUT vengono applicate con maggiore frequenza ai singoli elementi, come un cliente specifico, anziché alle raccolte.</span><span class="sxs-lookup"><span data-stu-id="a9632-249">PUT requests are most frequently applied to resources that are individual items, such as a specific customer, rather than collections.</span></span> <span data-ttu-id="a9632-250">Un server potrebbe supportare gli aggiornamenti ma non la creazione tramite PUT.</span><span class="sxs-lookup"><span data-stu-id="a9632-250">A server might support updates but not creation via PUT.</span></span> <span data-ttu-id="a9632-251">Il supporto o meno della creazione tramite PUT dipende dalla possibilità per il client di assegnare un URI significativo a una risorsa non ancora esistente.</span><span class="sxs-lookup"><span data-stu-id="a9632-251">Whether to support creation via PUT depends on whether the client can meaningfully assign a URI to a resource before it exists.</span></span> <span data-ttu-id="a9632-252">Se il client non può, usare POST per creare le risorse e PUT o PATCH per l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a9632-252">If not, then use POST to create resources and PUT or PATCH to update.</span></span>

- <span data-ttu-id="a9632-253">Una richiesta PATCH esegue un *aggiornamento parziale* di una risorsa esistente.</span><span class="sxs-lookup"><span data-stu-id="a9632-253">A PATCH request performs a *partial update* to an existing resource.</span></span> <span data-ttu-id="a9632-254">Il client specifica l'URI per la risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-254">The client specifies the URI for the resource.</span></span> <span data-ttu-id="a9632-255">Il corpo della richiesta specifica un set di *modifiche* da applicare alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-255">The request body specifies a set of *changes* to apply to the resource.</span></span> <span data-ttu-id="a9632-256">Può essere più efficiente rispetto all'uso di PUT, perché il client invia solo le modifiche, non l'intera rappresentazione della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-256">This can be more efficient than using PUT, because the client only sends the changes, not the entire representation of the resource.</span></span> <span data-ttu-id="a9632-257">Tecnicamente, PATCH può anche creare una nuova risorsa, specificando un set di aggiornamenti per una risorsa "Null", se questa operazione è supportata dal server.</span><span class="sxs-lookup"><span data-stu-id="a9632-257">Technically PATCH can also create a new resource (by specifying a set of updates to a "null" resource), if the server supports this.</span></span> 

<span data-ttu-id="a9632-258">Le richieste PUT devono essere idempotenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-258">PUT requests must be idempotent.</span></span> <span data-ttu-id="a9632-259">Se un client invia la stessa richiesta PUT più volte, i risultati dovranno essere sempre uguali, ossia la stessa risorsa verrà modificata con gli stessi valori.</span><span class="sxs-lookup"><span data-stu-id="a9632-259">If a client submits the same PUT request multiple times, the results should always be the same (the same resource will be modified with the same values).</span></span> <span data-ttu-id="a9632-260">Non è invece garantito che le richieste POST e PATCH siano idempotenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-260">POST and PATCH requests are not guaranteed to be idempotent.</span></span>

## <a name="conform-to-http-semantics"></a><span data-ttu-id="a9632-261">Mantenere la conformità alla semantica HTTP</span><span class="sxs-lookup"><span data-stu-id="a9632-261">Conform to HTTP semantics</span></span>

<span data-ttu-id="a9632-262">Questa sezione descrive alcune considerazioni tipiche per la progettazione di un'API conforme alla specifica HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-262">This section describes some typical considerations for designing an API that conforms to the HTTP specification.</span></span> <span data-ttu-id="a9632-263">Non illustra tuttavia ogni possibile dettaglio o scenario.</span><span class="sxs-lookup"><span data-stu-id="a9632-263">However, it doesn't cover every possible detail or scenario.</span></span> <span data-ttu-id="a9632-264">In caso di dubbi, consultare le specifiche HTTP.</span><span class="sxs-lookup"><span data-stu-id="a9632-264">When in doubt, consult the HTTP specifications.</span></span>

### <a name="media-types"></a><span data-ttu-id="a9632-265">Tipi di supporto</span><span class="sxs-lookup"><span data-stu-id="a9632-265">Media types</span></span>

<span data-ttu-id="a9632-266">Come indicato in precedenza, i client e i server si scambiano rappresentazioni delle risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-266">As mentioned earlier, clients and servers exchange representations of resources.</span></span> <span data-ttu-id="a9632-267">In una richiesta POST, ad esempio, il corpo della richiesta contiene una rappresentazione della risorsa da creare.</span><span class="sxs-lookup"><span data-stu-id="a9632-267">For example, in a POST request, the request body contains a representation of the resource to create.</span></span> <span data-ttu-id="a9632-268">In una richiesta GET, il corpo della risposta contiene una rappresentazione della risorsa recuperata.</span><span class="sxs-lookup"><span data-stu-id="a9632-268">In a GET request, the response body contains a representation of the fetched resource.</span></span>

<span data-ttu-id="a9632-269">Nel protocollo HTTP, i formati vengono specificati usando *tipi di supporto*, denominati anche tipi MIME.</span><span class="sxs-lookup"><span data-stu-id="a9632-269">In the HTTP protocol, formats are specified through the use of *media types*, also called MIME types.</span></span> <span data-ttu-id="a9632-270">Per i dati non binari, la maggior parte delle API Web supporta JSON (ovvero il tipo di supporto application/json) ed eventualmente XML (ossia il tipo di supporto application/xml).</span><span class="sxs-lookup"><span data-stu-id="a9632-270">For non-binary data, most web APIs support JSON (media type = application/json) and possibly XML (media type = application/xml).</span></span> 

<span data-ttu-id="a9632-271">L'intestazione Content-Type in una richiesta o una risposta specifica il formato della rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-271">The Content-Type header in a request or response specifies the format of the representation.</span></span> <span data-ttu-id="a9632-272">Di seguito è riportato un esempio di richiesta POST contenente dati JSON:</span><span class="sxs-lookup"><span data-stu-id="a9632-272">Here is an example of a POST request that includes JSON data:</span></span>

```HTTP
POST http://adventure-works.com/orders HTTP/1.1
Content-Type: application/json; charset=utf-8
Content-Length: 57

{"Id":1,"Name":"Gizmo","Category":"Widgets","Price":1.99}
```

<span data-ttu-id="a9632-273">Se il server non supporta il tipo di supporto, deve restituire il codice di stato HTTP 415 (Tipo di supporto non supportato).</span><span class="sxs-lookup"><span data-stu-id="a9632-273">If the server doesn't support the media type, it should return HTTP status code 415 (Unsupported Media Type).</span></span>

<span data-ttu-id="a9632-274">Una richiesta client può includere un'intestazione Accept contenente un elenco dei tipi di supporto accettati dal client nel messaggio di risposta proveniente dal server.</span><span class="sxs-lookup"><span data-stu-id="a9632-274">A client request can include an Accept header that contains a list of media types the client will accept from the server in the response message.</span></span> <span data-ttu-id="a9632-275">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="a9632-275">For example:</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
Accept: application/json
```

<span data-ttu-id="a9632-276">Se il server non può fornire un tipo di supporto corrispondente a quelli elencati, deve restituire il codice di stato HTTP 406 (Pagina non valida).</span><span class="sxs-lookup"><span data-stu-id="a9632-276">If the server cannot match any of the media type(s) listed, it should return HTTP status code 406 (Not Acceptable).</span></span> 

### <a name="get-methods"></a><span data-ttu-id="a9632-277">Metodi GET</span><span class="sxs-lookup"><span data-stu-id="a9632-277">GET methods</span></span>

<span data-ttu-id="a9632-278">Un metodo GET riuscito restituisce in genere il codice di stato HTTP 200 (OK).</span><span class="sxs-lookup"><span data-stu-id="a9632-278">A successful GET method typically returns HTTP status code 200 (OK).</span></span> <span data-ttu-id="a9632-279">Se la risorsa non è stata trovata, il metodo deve restituire 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="a9632-279">If the resource cannot be found, the method should return 404 (Not Found).</span></span>

### <a name="post-methods"></a><span data-ttu-id="a9632-280">Metodi POST</span><span class="sxs-lookup"><span data-stu-id="a9632-280">POST methods</span></span>

<span data-ttu-id="a9632-281">Se un metodo POST crea una nuova risorsa, restituisce il codice di stato HTTP 201 (Creato).</span><span class="sxs-lookup"><span data-stu-id="a9632-281">If a POST method creates a new resource, it returns HTTP status code 201 (Created).</span></span> <span data-ttu-id="a9632-282">L'URI della nuova risorsa è incluso nell'intestazione Location della risposta.</span><span class="sxs-lookup"><span data-stu-id="a9632-282">The URI of the new resource is included in the Location header of the response.</span></span> <span data-ttu-id="a9632-283">Il corpo della risposta contiene una rappresentazione della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-283">The response body contains a representation of the resource.</span></span>

<span data-ttu-id="a9632-284">Se esegue alcune attività di elaborazione ma non crea una nuova risorsa, il metodo può restituire il codice di stato HTTP 200 e includere il risultato dell'operazione nel corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="a9632-284">If the method does some processing but does not create a new resource, the method can return HTTP status code 200 and include the result of the operation in the response body.</span></span> <span data-ttu-id="a9632-285">In alternativa, se non sono presenti risultati, il metodo può restituire il codice di stato HTTP 204 (Nessun contenuto) senza corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="a9632-285">Alternatively, if there is no result to return, the method can return HTTP status code 204 (No Content) with no response body.</span></span>

<span data-ttu-id="a9632-286">Se il client inserisce dati non validi nella richiesta, il server deve restituire il codice di stato HTTP 400 (Richiesta non valida).</span><span class="sxs-lookup"><span data-stu-id="a9632-286">If the client puts invalid data into the request, the server should return HTTP status code 400 (Bad Request).</span></span> <span data-ttu-id="a9632-287">Il corpo della risposta può contenere informazioni aggiuntive sull'errore o un collegamento a un URI che offre maggiori dettagli.</span><span class="sxs-lookup"><span data-stu-id="a9632-287">The response body can contain additional information about the error or a link to a URI that provides more details.</span></span>

### <a name="put-methods"></a><span data-ttu-id="a9632-288">Metodi PUT</span><span class="sxs-lookup"><span data-stu-id="a9632-288">PUT methods</span></span>

<span data-ttu-id="a9632-289">Se un metodo PUT crea una nuova risorsa, restituisce il codice di stato HTTP 201 (Creato), così come un metodo POST.</span><span class="sxs-lookup"><span data-stu-id="a9632-289">If a PUT method creates a new resource, it returns HTTP status code 201 (Created), as with a POST method.</span></span> <span data-ttu-id="a9632-290">Se il metodo aggiorna una risorsa esistente, restituisce 200 (OK) o 204 (Nessun contenuto).</span><span class="sxs-lookup"><span data-stu-id="a9632-290">If the method updates an existing resource, it returns either 200 (OK) or 204 (No Content).</span></span> <span data-ttu-id="a9632-291">In alcuni casi potrebbe non essere possibile aggiornare una risorsa esistente.</span><span class="sxs-lookup"><span data-stu-id="a9632-291">In some cases, it might not be possible to update an existing resource.</span></span> <span data-ttu-id="a9632-292">In tale circostanza, valutare la possibilità di restituire il codice di stato HTTP 409 (Conflitto).</span><span class="sxs-lookup"><span data-stu-id="a9632-292">In that case, consider returning HTTP status code 409 (Conflict).</span></span> 

<span data-ttu-id="a9632-293">Prendere in considerazione l’implementazione di operazioni HTTP PUT in blocco in grado di eseguire aggiornamenti in batch di più risorse in una raccolta.</span><span class="sxs-lookup"><span data-stu-id="a9632-293">Consider implementing bulk HTTP PUT operations that can batch updates to multiple resources in a collection.</span></span> <span data-ttu-id="a9632-294">La richiesta PUT deve specificare l'URI della raccolta e il corpo della richiesta deve specificare i dettagli delle risorse da modificare.</span><span class="sxs-lookup"><span data-stu-id="a9632-294">The PUT request should specify the URI of the collection, and the request body should specify the details of the resources to be modified.</span></span> <span data-ttu-id="a9632-295">Questo approccio consente di ridurre la frammentarietà e migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-295">This approach can help to reduce chattiness and improve performance.</span></span>

### <a name="patch-methods"></a><span data-ttu-id="a9632-296">Metodi PATCH</span><span class="sxs-lookup"><span data-stu-id="a9632-296">PATCH methods</span></span>

<span data-ttu-id="a9632-297">Con una richiesta PATCH, il client invia un set di aggiornamenti a una risorsa esistente, sotto forma di *documento di patch*.</span><span class="sxs-lookup"><span data-stu-id="a9632-297">With a PATCH request, the client sends a set of updates to an existing resource, in the form of a *patch document*.</span></span> <span data-ttu-id="a9632-298">Il server elabora il documento di patch per eseguire l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a9632-298">The server processes the patch document to perform the update.</span></span> <span data-ttu-id="a9632-299">Il documento di patch non descrive l'intera risorsa, ma solo un set di modifiche da applicare.</span><span class="sxs-lookup"><span data-stu-id="a9632-299">The patch document doesn't describe the whole resource, only a set of changes to apply.</span></span> <span data-ttu-id="a9632-300">La specifica per il metodo PATCH ([RFC 5789](https://tools.ietf.org/html/rfc5789)) non definisce un particolare formato per i documenti di patch.</span><span class="sxs-lookup"><span data-stu-id="a9632-300">The specification for the PATCH method ([RFC 5789](https://tools.ietf.org/html/rfc5789)) doesn't define a particular format for patch documents.</span></span> <span data-ttu-id="a9632-301">Il formato deve essere dedotto dal tipo di supporto nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-301">The format must be inferred from the media type in the request.</span></span>

<span data-ttu-id="a9632-302">Il formato di dati più comune per le API Web è probabilmente JSON.</span><span class="sxs-lookup"><span data-stu-id="a9632-302">JSON is probably the most common data format for web APIs.</span></span> <span data-ttu-id="a9632-303">Esistono due formati principali di patch basati su JSON, denominati *patch JSON* e *patch JSON di tipo merge*.</span><span class="sxs-lookup"><span data-stu-id="a9632-303">There are two main JSON-based patch formats, called *JSON patch* and *JSON merge patch*.</span></span>

<span data-ttu-id="a9632-304">La patch JSON di tipo merge è un po' più semplice.</span><span class="sxs-lookup"><span data-stu-id="a9632-304">JSON merge patch is somewhat simpler.</span></span> <span data-ttu-id="a9632-305">Il documento di patch presenta la stessa struttura della risorsa JSON originale, ma include solo il subset di campi da modificare o aggiungere.</span><span class="sxs-lookup"><span data-stu-id="a9632-305">The patch document has the same structure as the original JSON resource, but includes just the subset of fields that should be changed or added.</span></span> <span data-ttu-id="a9632-306">È anche possibile eliminare un campo specificando `null` come valore del campo nel documento di patch.</span><span class="sxs-lookup"><span data-stu-id="a9632-306">In addition, a field can be deleted by specifying `null` for the field value in the patch document.</span></span> <span data-ttu-id="a9632-307">La patch di tipo merge non è quindi adatta se la risorsa originale può contenere valori Null espliciti.</span><span class="sxs-lookup"><span data-stu-id="a9632-307">(That means merge patch is not suitable if the original resource can have explicit null values.)</span></span>

<span data-ttu-id="a9632-308">Si supponga ad esempio che la risorsa originale abbia la rappresentazione JSON seguente:</span><span class="sxs-lookup"><span data-stu-id="a9632-308">For example, suppose the original resource has the following JSON representation:</span></span>

```json
{ 
    "name":"gizmo",
    "category":"widgets",
    "color":"blue",
    "price":10
}
```

<span data-ttu-id="a9632-309">Di seguito è riportata una possibile patch JSON di tipo merge per tale risorsa:</span><span class="sxs-lookup"><span data-stu-id="a9632-309">Here is a possible JSON merge patch for this resource:</span></span>

```json
{ 
    "price":12,
    "color":null,
    "size":"small"
}
```

<span data-ttu-id="a9632-310">Questa patch indica al server di aggiornare "price", eliminare "color" e aggiungere "size".</span><span class="sxs-lookup"><span data-stu-id="a9632-310">This tells the server to update "price", delete "color", and add "size".</span></span> <span data-ttu-id="a9632-311">I campi "name" e "category" non vengono modificati.</span><span class="sxs-lookup"><span data-stu-id="a9632-311">"Name" and "category" are not modified.</span></span> <span data-ttu-id="a9632-312">Per informazioni dettagliate precise sulla patch JSON di tipo merge, vedere la specifica [RFC 7396](https://tools.ietf.org/html/rfc7396).</span><span class="sxs-lookup"><span data-stu-id="a9632-312">For the exact details of JSON merge patch, see [RFC 7396](https://tools.ietf.org/html/rfc7396).</span></span> <span data-ttu-id="a9632-313">Il tipo di supporto per la patch JSON di tipo merge è "application/merge-patch+json".</span><span class="sxs-lookup"><span data-stu-id="a9632-313">The media type for JSON merge patch is "application/merge-patch+json".</span></span>

<span data-ttu-id="a9632-314">La patch di tipo merge non è adatta se la risorsa originale può contenere valori Null espliciti, a causa del significato speciale di `null` nel documento di patch.</span><span class="sxs-lookup"><span data-stu-id="a9632-314">Merge patch is not suitable if the original resource can contain explicit null values, due to the special meaning of `null` in the patch document.</span></span> <span data-ttu-id="a9632-315">Il documento di patch, inoltre, non specifica l'ordine con cui il server dovrà applicare gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-315">Also, the patch document doesn't specify the order that the server should apply the updates.</span></span> <span data-ttu-id="a9632-316">Tale ordine può essere importante o meno a seconda dei dati e del dominio.</span><span class="sxs-lookup"><span data-stu-id="a9632-316">That may or may not matter, depending on the data and the domain.</span></span> <span data-ttu-id="a9632-317">La patch JSON, definita in [RFC 6902](https://tools.ietf.org/html/rfc6902), è più flessibile</span><span class="sxs-lookup"><span data-stu-id="a9632-317">JSON patch, defined in [RFC 6902](https://tools.ietf.org/html/rfc6902), is more flexible.</span></span> <span data-ttu-id="a9632-318">e specifica le modifiche come sequenza di operazioni da applicare.</span><span class="sxs-lookup"><span data-stu-id="a9632-318">It specifies the changes as a sequence of operations to apply.</span></span> <span data-ttu-id="a9632-319">Le operazioni includono aggiunta, rimozione, sostituzione, copia e test (per convalidare i valori).</span><span class="sxs-lookup"><span data-stu-id="a9632-319">Operations include add, remove, replace, copy, and test (to validate values).</span></span> <span data-ttu-id="a9632-320">Il tipo di supporto per la patch JSON è "application/json-patch+json".</span><span class="sxs-lookup"><span data-stu-id="a9632-320">The media type for JSON patch is "application/json-patch+json".</span></span>

<span data-ttu-id="a9632-321">Di seguito sono riportate alcune condizioni di errore tipiche che si possono verificare durante l'elaborazione di una richiesta PATCH, con il codice di stato HTTP appropriato.</span><span class="sxs-lookup"><span data-stu-id="a9632-321">Here are some typical error conditions that might be encountered when processing a PATCH request, along with the appropriate HTTP status code.</span></span>

| <span data-ttu-id="a9632-322">Condizione di errore</span><span class="sxs-lookup"><span data-stu-id="a9632-322">Error condition</span></span> | <span data-ttu-id="a9632-323">Stato codice HTTP</span><span class="sxs-lookup"><span data-stu-id="a9632-323">HTTP status code</span></span> |
|-----------|------------|
| <span data-ttu-id="a9632-324">Il formato del documento di patch non è supportato.</span><span class="sxs-lookup"><span data-stu-id="a9632-324">The patch document format isn't supported.</span></span> | <span data-ttu-id="a9632-325">415 (Tipo di supporto non supportato)</span><span class="sxs-lookup"><span data-stu-id="a9632-325">415 (Unsupported Media Type)</span></span> |
| <span data-ttu-id="a9632-326">Il formato del documento di patch non è valido.</span><span class="sxs-lookup"><span data-stu-id="a9632-326">Malformed patch document.</span></span> | <span data-ttu-id="a9632-327">400 (Richiesta non valida)</span><span class="sxs-lookup"><span data-stu-id="a9632-327">400 (Bad Request)</span></span> |
| <span data-ttu-id="a9632-328">Il documento di patch è valido, ma le modifiche non possono essere applicate alla risorsa nello stato corrente.</span><span class="sxs-lookup"><span data-stu-id="a9632-328">The patch document is valid, but the changes can't be applied to the resource in its current state.</span></span> | <span data-ttu-id="a9632-329">409 (Conflitto)</span><span class="sxs-lookup"><span data-stu-id="a9632-329">409 (Conflict)</span></span>

### <a name="delete-methods"></a><span data-ttu-id="a9632-330">Metodi DELETE</span><span class="sxs-lookup"><span data-stu-id="a9632-330">DELETE methods</span></span>

<span data-ttu-id="a9632-331">Se l'operazione di eliminazione ha esito positivo, il server Web risponderà con il codice di stato HTTP 204, che indica che il processo è stato gestito correttamente, ma il corpo della risposta non conterrà altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-331">If the delete operation is successful, the web server should respond with HTTP status code 204, indicating that the process has been successfully handled, but that the response body contains no further information.</span></span> <span data-ttu-id="a9632-332">Se la risorsa non esiste, il server Web può restituire il codice di stato HTTP 404 (Non trovato).</span><span class="sxs-lookup"><span data-stu-id="a9632-332">If the resource doesn't exist, the web server can return HTTP 404 (Not Found).</span></span>

### <a name="asynchronous-operations"></a><span data-ttu-id="a9632-333">Operazioni asincrone</span><span class="sxs-lookup"><span data-stu-id="a9632-333">Asynchronous operations</span></span>

<span data-ttu-id="a9632-334">Un'operazione POST, PUT, PATCH o DELETE comporta talvolta attività di elaborazione il cui completamento richiede tempo.</span><span class="sxs-lookup"><span data-stu-id="a9632-334">Sometimes a POST, PUT, PATCH, or DELETE operation might require processing that takes awhile to complete.</span></span> <span data-ttu-id="a9632-335">Attendere il completamento prima di inviare una risposta al client può causare una latenza inaccettabile.</span><span class="sxs-lookup"><span data-stu-id="a9632-335">If you wait for completion before sending a response to the client, it may cause unacceptable latency.</span></span> <span data-ttu-id="a9632-336">In tal caso, valutare la possibilità di rendere l'operazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="a9632-336">If so, consider making the operation asynchronous.</span></span> <span data-ttu-id="a9632-337">Restituire il codice di stato HTTP 202 (Accettato) per indicare che la richiesta è stata accettata per l'elaborazione ma non è stata completata.</span><span class="sxs-lookup"><span data-stu-id="a9632-337">Return HTTP status code 202 (Accepted) to indicate the request was accepted for processing but is not completed.</span></span> 

<span data-ttu-id="a9632-338">È consigliabile esporre un endpoint che restituisce lo stato di una richiesta asincrona, in modo che il client possa monitorare lo stato eseguendo il polling sull'endpoint di stato.</span><span class="sxs-lookup"><span data-stu-id="a9632-338">You should expose an endpoint that returns the status of an asynchronous request, so the client can monitor the status by polling the status endpoint.</span></span> <span data-ttu-id="a9632-339">Includere l'URI dell'endpoint di stato nell'intestazione Location della risposta 202.</span><span class="sxs-lookup"><span data-stu-id="a9632-339">Include the URI of the status endpoint in the Location header of the 202 response.</span></span> <span data-ttu-id="a9632-340">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="a9632-340">For example:</span></span>

```http
HTTP/1.1 202 Accepted
Location: /api/status/12345
```

<span data-ttu-id="a9632-341">Se il client invia una richiesta GET a questo endpoint, la risposta dovrà contenere lo stato corrente della richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-341">If the client sends a GET request to this endpoint, the response should contain the current status of the request.</span></span> <span data-ttu-id="a9632-342">Facoltativamente, potrà includere anche il tempo di completamento stimato o un collegamento per annullare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-342">Optionally, it could also include an estimated time to completion or a link to cancel the operation.</span></span> 

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
    "status":"In progress",
    "link": { "rel":"cancel", "method":"delete", "href":"/api/status/12345" }
}
```

<span data-ttu-id="a9632-343">Se l'operazione asincrona crea una nuova risorsa, l'endpoint di stato deve restituire il codice di stato 303 (Vedi altro) al termine dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-343">If the asynchronous operation creates a new resource, the status endpoint should return status code 303 (See Other) after the operation completes.</span></span> <span data-ttu-id="a9632-344">Nella risposta 303 includere un'intestazione Location contenente l'URI della nuova risorsa:</span><span class="sxs-lookup"><span data-stu-id="a9632-344">In the 303 response, include a Location header that gives the URI of the new resource:</span></span>

```http
HTTP/1.1 303 See Other
Location: /api/orders/12345
```

<span data-ttu-id="a9632-345">Per altre informazioni, vedere [Asynchronous operations in REST](https://www.adayinthelifeof.nl/2011/06/02/asynchronous-operations-in-rest/) (Operazioni asincrone in REST).</span><span class="sxs-lookup"><span data-stu-id="a9632-345">For more information, see [Asynchronous operations in REST](https://www.adayinthelifeof.nl/2011/06/02/asynchronous-operations-in-rest/).</span></span>

## <a name="filter-and-paginate-data"></a><span data-ttu-id="a9632-346">Filtrare e impaginare i dati</span><span class="sxs-lookup"><span data-stu-id="a9632-346">Filter and paginate data</span></span>

<span data-ttu-id="a9632-347">Esponendo una raccolta di risorse tramite un singolo URI, le applicazioni potrebbero recuperare grandi quantità di dati quando è necessario solo un subset delle informazioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-347">Exposing a collection of resources through a single URI can lead to applications fetching large amounts of data when only a subset of the information is required.</span></span> <span data-ttu-id="a9632-348">Si supponga ad esempio che un'applicazione client debba trovare tutti gli ordini con un costo superiore a un valore specificato.</span><span class="sxs-lookup"><span data-stu-id="a9632-348">For example, suppose a client application needs to find all orders with a cost over a specific value.</span></span> <span data-ttu-id="a9632-349">Potrebbe recuperare tutti gli ordini dall'URI */orders* e quindi filtrare tali ordini sul lato client.</span><span class="sxs-lookup"><span data-stu-id="a9632-349">It might retrieve all orders from the */orders* URI and then filter these orders on the client side.</span></span> <span data-ttu-id="a9632-350">Questo processo è chiaramente molto inefficiente,</span><span class="sxs-lookup"><span data-stu-id="a9632-350">Clearly this process is highly inefficient.</span></span> <span data-ttu-id="a9632-351">perché comporta uno spreco di larghezza di banda di rete e di potenza di elaborazione nel server che ospita l'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-351">It wastes network bandwidth and processing power on the server hosting the web API.</span></span>

<span data-ttu-id="a9632-352">L'API può invece consentire di passare un filtro nella stringa di query dell'URI, ad esempio */orders?minCost=n*.</span><span class="sxs-lookup"><span data-stu-id="a9632-352">Instead, the API can allow passing a filter in the query string of the URI, such as */orders?minCost=n*.</span></span> <span data-ttu-id="a9632-353">L'API Web sarà quindi responsabile dell'analisi e della gestione del parametro `minCost` nella stringa di query e della restituzione dei risultati filtrati sul lato server.</span><span class="sxs-lookup"><span data-stu-id="a9632-353">The web API is then responsible for parsing and handling the `minCost` parameter in the query string and returning the filtered results on the sever side.</span></span> 

<span data-ttu-id="a9632-354">Le richieste GET su risorse raccolta potrebbero restituire un numero elevato di elementi.</span><span class="sxs-lookup"><span data-stu-id="a9632-354">GET requests over collection resources can potentially return a large number of items.</span></span> <span data-ttu-id="a9632-355">È consigliabile progettare un'API Web in modo da limitare la quantità di dati restituita da ogni singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="a9632-355">You should design a web API to limit the amount of data returned by any single request.</span></span> <span data-ttu-id="a9632-356">Valutare la possibilità di supportare stringhe di query che specificano il numero massimo di elementi da recuperare e un offset iniziale nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="a9632-356">Consider supporting query strings that specify the maximum number of items to retrieve and a starting offset into the collection.</span></span> <span data-ttu-id="a9632-357">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="a9632-357">For example:</span></span>

```
/orders?limit=25&offset=50
```

<span data-ttu-id="a9632-358">Valutare anche la possibilità di imporre un limite massimo al numero di elementi restituiti, per prevenire attacchi Denial of Service.</span><span class="sxs-lookup"><span data-stu-id="a9632-358">Also consider imposing an upper limit on the number of items returned, to help prevent Denial of Service attacks.</span></span> <span data-ttu-id="a9632-359">Per agevolare le applicazioni client, le richieste GET che restituiscono i dati impaginati devono includere anche un tipo di metadati che indichino il numero totale delle risorse disponibili nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="a9632-359">To assist client applications, GET requests that return paginated data should also include some form of metadata that indicate the total number of resources available in the collection.</span></span> <span data-ttu-id="a9632-360">È anche possibile prendere in considerazione altre strategie di paging intelligente. Per altre informazioni, vedere [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging) (Note sulla progettazione di API: paging intelligente).</span><span class="sxs-lookup"><span data-stu-id="a9632-360">You might also consider other intelligent paging strategies; for more information, see [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging)</span></span>

<span data-ttu-id="a9632-361">È possibile usare una strategia simile per ordinare i dati mentre vengono recuperati, specificando un parametro sort che accetta il nome di un campo come valore, ad esempio */orders?sort=ProductID*.</span><span class="sxs-lookup"><span data-stu-id="a9632-361">You can use a similar strategy to sort data as it is fetched, by providing a sort parameter that takes a field name as the value, such as */orders?sort=ProductID*.</span></span> <span data-ttu-id="a9632-362">Questo approccio, tuttavia, può avere un effetto negativo sulla memorizzazione nella cache, perché i parametri della stringa di query formano parte dell'identificatore di risorsa usato da molte implementazioni di cache come chiave per i dati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="a9632-362">However, this approach can have a negative effect on caching, because query string parameters form part of the resource identifier used by many cache implementations as the key to cached data.</span></span>

<span data-ttu-id="a9632-363">È possibile estendere questo approccio per limitare i campi restituiti per ogni elemento, se ognuno contiene una grande quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="a9632-363">You can extend this approach to limit the fields returned for each item, if each item contains a large amount of data.</span></span> <span data-ttu-id="a9632-364">Si può usare, ad esempio, un parametro di stringa di query che accetta un elenco di campi delimitato da virgole, come */orders?fields=ProductID,Quantity*.</span><span class="sxs-lookup"><span data-stu-id="a9632-364">For example, you could use a query string parameter that accepts a comma-delimited list of fields, such as */orders?fields=ProductID,Quantity*.</span></span> 

<span data-ttu-id="a9632-365">Assegnare valori predefiniti significativi a tutti i parametri facoltativi nelle stringhe di query.</span><span class="sxs-lookup"><span data-stu-id="a9632-365">Give all optional parameters in query strings meaningful defaults.</span></span> <span data-ttu-id="a9632-366">Ad esempio, impostare il parametro `limit` su 10 e il parametro `offset` su 0 se si implementa la paginazione, impostare il parametro Sort sulla chiave della risorsa se si implementa l’ordinamento e impostare il parametro `fields` su tutti i campi della risorsa se si supportano le proiezioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-366">For example, set the `limit` parameter to 10 and the `offset` parameter to 0 if you implement pagination, set the sort parameter to the key of the resource if you implement ordering, and set the `fields` parameter to all fields in the resource if you support projections.</span></span>

## <a name="support-partial-responses-for-large-binary-resources"></a><span data-ttu-id="a9632-367">Supportare risposte parziali per risorse binarie di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="a9632-367">Support partial responses for large binary resources</span></span>

<span data-ttu-id="a9632-368">Una risorsa può contenere campi binari di grandi dimensioni, come file o immagini.</span><span class="sxs-lookup"><span data-stu-id="a9632-368">A resource may contain large binary fields, such as files or images.</span></span> <span data-ttu-id="a9632-369">Per superare i problemi causati da connessioni intermittenti e inaffidabili e migliorare i tempi di risposta, valutare la possibilità di consentire il recupero di tali risorse in blocchi.</span><span class="sxs-lookup"><span data-stu-id="a9632-369">To overcome problems caused by unreliable and intermittent connections and to improve response times, consider enabling such resources to be retrieved in chunks.</span></span> <span data-ttu-id="a9632-370">A tale scopo, l'API Web deve supportare l'intestazione Accept-Ranges per le richieste GET relative a risorse di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-370">To do this, the web API should support the Accept-Ranges header for GET requests for large resources.</span></span> <span data-ttu-id="a9632-371">Questa intestazione indica che l'operazione GET supporta richieste parziali.</span><span class="sxs-lookup"><span data-stu-id="a9632-371">This header indicates that the GET operation supports partial requests.</span></span> <span data-ttu-id="a9632-372">L'applicazione client può inviare richieste GET che restituiscono un subset di una risorsa, specificato come un intervallo di byte.</span><span class="sxs-lookup"><span data-stu-id="a9632-372">The client application can submit GET requests that return a subset of a resource, specified as a range of bytes.</span></span> 

<span data-ttu-id="a9632-373">Valutare anche la possibilità di implementare richieste HTTP HEAD per queste risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-373">Also, consider implementing HTTP HEAD requests for these resources.</span></span> <span data-ttu-id="a9632-374">Una richiesta HEAD è simile a una richiesta GET tranne per il fatto che restituisce solo le intestazioni HTTP che descrivono la risorsa, con un corpo del messaggio vuoto.</span><span class="sxs-lookup"><span data-stu-id="a9632-374">A HEAD request is similar to a GET request, except that it only returns the HTTP headers that describe the resource, with an empty message body.</span></span> <span data-ttu-id="a9632-375">Un'applicazione client può inviare una richiesta HEAD per determinare se recuperare una risorsa tramite richieste GET parziali.</span><span class="sxs-lookup"><span data-stu-id="a9632-375">A client application can issue a HEAD request to determine whether to fetch a resource by using partial GET requests.</span></span> <span data-ttu-id="a9632-376">Ad esempio: </span><span class="sxs-lookup"><span data-stu-id="a9632-376">For example:</span></span>

```HTTP
HEAD http://adventure-works.com/products/10?fields=productImage HTTP/1.1
```

<span data-ttu-id="a9632-377">Di seguito è riportato un messaggio di risposta di esempio:</span><span class="sxs-lookup"><span data-stu-id="a9632-377">Here is an example response message:</span></span> 

```HTTP
HTTP/1.1 200 OK

Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4580
```

<span data-ttu-id="a9632-378">L'intestazione Content-Length contiene le dimensioni totali della risorsa e l'intestazione Accept-Ranges indica che l'operazione GET corrispondente supporta risultati parziali.</span><span class="sxs-lookup"><span data-stu-id="a9632-378">The Content-Length header gives the total size of the resource, and the Accept-Ranges header indicates that the corresponding GET operation supports partial results.</span></span> <span data-ttu-id="a9632-379">L'applicazione client può usare queste informazioni per recuperare l'immagine in blocchi più piccoli.</span><span class="sxs-lookup"><span data-stu-id="a9632-379">The client application can use this information to retrieve the image in smaller chunks.</span></span> <span data-ttu-id="a9632-380">La prima richiesta recupera i primi 2500 byte mediante l'intestazione Range:</span><span class="sxs-lookup"><span data-stu-id="a9632-380">The first request fetches the first 2500 bytes by using the Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=0-2499
```

<span data-ttu-id="a9632-381">Il codice di stato HTTP 206 restituito nel messaggio di risposta indica che si tratta di una risposta parziale.</span><span class="sxs-lookup"><span data-stu-id="a9632-381">The response message indicates that this is a partial response by returning HTTP status code 206.</span></span> <span data-ttu-id="a9632-382">L'intestazione Content-Length specifica il numero effettivo di byte restituiti nel corpo del messaggio (non le dimensioni della risorsa) e l'intestazione Content-Range indica di quale parte della risorsa si tratta (byte 0-2499 di 4580):</span><span class="sxs-lookup"><span data-stu-id="a9632-382">The Content-Length header specifies the actual number of bytes returned in the message body (not the size of the resource), and the Content-Range header indicates which part of the resource this is (bytes 0-2499 out of 4580):</span></span>

```HTTP
HTTP/1.1 206 Partial Content

Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2500
Content-Range: bytes 0-2499/4580

[...]
```

<span data-ttu-id="a9632-383">Una richiesta successiva dall'applicazione client può recuperare la parte restante della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-383">A subsequent request from the client application can retrieve the remainder of the resource.</span></span>

## <a name="use-hateoas-to-enable-navigation-to-related-resources"></a><span data-ttu-id="a9632-384">Usare HATEOAS per consentire lo spostamento alle risorse correlate</span><span class="sxs-lookup"><span data-stu-id="a9632-384">Use HATEOAS to enable navigation to related resources</span></span>

<span data-ttu-id="a9632-385">Una delle principali motivazioni alla base dell’approccio REST è che dovrebbe essere possibile spostarsi nell'intero set di risorse senza conoscere a priori lo schema URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-385">One of the primary motivations behind REST is that it should be possible to navigate the entire set of resources without requiring prior knowledge of the URI scheme.</span></span> <span data-ttu-id="a9632-386">Ogni richiesta HTTP GET deve restituire le informazioni necessarie a trovare le risorse correlate direttamente all'oggetto richiesto tramite collegamenti ipertestuali inclusi nella risposta e deve anche contenere informazioni che descrivono le operazioni disponibili in ciascuna di queste risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-386">Each HTTP GET request should return the information necessary to find the resources related directly to the requested object through hyperlinks included in the response, and it should also be provided with information that describes the operations available on each of these resources.</span></span> <span data-ttu-id="a9632-387">Tale principio è noto come HATEOAS o Hypertext as the Engine of Application State.</span><span class="sxs-lookup"><span data-stu-id="a9632-387">This principle is known as HATEOAS, or Hypertext as the Engine of Application State.</span></span> <span data-ttu-id="a9632-388">Il sistema è in realtà una macchina a stati finiti e la risposta a ogni richiesta contiene le informazioni necessarie per passare da uno stato all’altro. Non dovrebbero essere necessarie altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="a9632-388">The system is effectively a finite state machine, and the response to each request contains the information necessary to move from one state to another; no other information should be necessary.</span></span>

> [!NOTE]
> <span data-ttu-id="a9632-389">Attualmente non esistono standard o specifiche che definiscono come modellare il principio HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="a9632-389">Currently there are no standards or specifications that define how to model the HATEOAS principle.</span></span> <span data-ttu-id="a9632-390">Gli esempi mostrati in questa sezione illustrano una possibile soluzione.</span><span class="sxs-lookup"><span data-stu-id="a9632-390">The examples shown in this section illustrate one possible solution.</span></span>
>
>

<span data-ttu-id="a9632-391">Per gestire la relazione tra un ordine e un cliente, ad esempio, la rappresentazione di un ordine potrebbe includere collegamenti che identificano le operazioni disponibili per il cliente dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="a9632-391">For example, to handle the relationship between an order and a customer, the representation of an order could include links that identify the available operations for the customer of the order.</span></span> <span data-ttu-id="a9632-392">Di seguito è riportata una possibile rappresentazione:</span><span class="sxs-lookup"><span data-stu-id="a9632-392">Here is a possible representation:</span></span> 

```json
{
  "orderID":3,
  "productID":2,
  "quantity":4,
  "orderValue":16.60,
  "links":[
    {
      "rel":"customer",
      "href":"http://adventure-works.com/customers/3", 
      "action":"GET",
      "types":["text/xml","application/json"] 
    },
    {
      "rel":"customer",
      "href":"http://adventure-works.com/customers/3", 
      "action":"PUT",
      "types":["application/x-www-form-urlencoded"]
    },
    {
      "rel":"customer",
      "href":"http://adventure-works.com/customers/3",
      "action":"DELETE",
      "types":[]
    },
    {
      "rel":"self",
      "href":"http://adventure-works.com/orders/3", 
      "action":"GET",
      "types":["text/xml","application/json"]
    },
    {
      "rel":"self",
      "href":"http://adventure-works.com/orders/3", 
      "action":"PUT",
      "types":["application/x-www-form-urlencoded"]
    },
    {
      "rel":"self",
      "href":"http://adventure-works.com/orders/3", 
      "action":"DELETE",
      "types":[]
    }]
}
```

<span data-ttu-id="a9632-393">In questo esempio, la matrice `links` contiene un set di collegamenti,</span><span class="sxs-lookup"><span data-stu-id="a9632-393">In this example, the `links` array has a set of links.</span></span> <span data-ttu-id="a9632-394">ognuno dei quali rappresenta un'operazione su un'entità correlata.</span><span class="sxs-lookup"><span data-stu-id="a9632-394">Each link represents an operation on a related entity.</span></span> <span data-ttu-id="a9632-395">I dati per ogni collegamento includono la relazione ("customer"), l'URI (`http://adventure-works.com/customers/3`), il metodo HTTP e i tipi MIME supportati.</span><span class="sxs-lookup"><span data-stu-id="a9632-395">The data for each link includes the relationship ("customer"), the URI (`http://adventure-works.com/customers/3`), the HTTP method, and the supported MIME types.</span></span> <span data-ttu-id="a9632-396">Queste sono tutte le informazioni necessarie a un'applicazione client per poter richiamare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-396">This is all the information that a client application needs to be able to invoke the operation.</span></span> 

<span data-ttu-id="a9632-397">La matrice `links` include anche informazioni autoreferenziali sulla risorsa che è stata recuperata.</span><span class="sxs-lookup"><span data-stu-id="a9632-397">The `links` array also includes self-referencing information about the resource itself that has been retrieved.</span></span> <span data-ttu-id="a9632-398">Queste informazioni presentano la relazione *self*.</span><span class="sxs-lookup"><span data-stu-id="a9632-398">These have the relationship *self*.</span></span>

<span data-ttu-id="a9632-399">Il set di collegamenti restituito può variare a seconda dello stato della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-399">The set of links that are returned may change, depending on the state of the resource.</span></span> <span data-ttu-id="a9632-400">È per questo motivo che l'ipertesto viene definito il "motore dello stato dell'applicazione" (Hypertext as the Engine of Application State).</span><span class="sxs-lookup"><span data-stu-id="a9632-400">This is what is meant by hypertext being the "engine of application state."</span></span>

## <a name="versioning-a-restful-web-api"></a><span data-ttu-id="a9632-401">Controllo delle versioni di un'API Web RESTful</span><span class="sxs-lookup"><span data-stu-id="a9632-401">Versioning a RESTful web API</span></span>

<span data-ttu-id="a9632-402">È altamente improbabile che un'API Web rimanga statica.</span><span class="sxs-lookup"><span data-stu-id="a9632-402">It is highly unlikely that a web API will remain static.</span></span> <span data-ttu-id="a9632-403">Man mano che i requisiti aziendali cambiano, è possibile che vengano aggiunte nuove raccolte di risorse, che le relazioni tra le risorse cambino e che la struttura dei dati nelle risorse venga modificata.</span><span class="sxs-lookup"><span data-stu-id="a9632-403">As business requirements change new collections of resources may be added, the relationships between resources might change, and the structure of the data in resources might be amended.</span></span> <span data-ttu-id="a9632-404">Sebbene l'aggiornamento di un'API Web per gestire requisiti nuovi o diversi sia un processo relativamente semplice, è necessario considerare gli effetti delle modifiche sulle applicazioni client che utilizzano l'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-404">While updating a web API to handle new or differing requirements is a relatively straightforward process, you must consider the effects that such changes will have on client applications consuming the web API.</span></span> <span data-ttu-id="a9632-405">Il problema è che nonostante lo sviluppatore che progetta e implementa un'API Web abbia il controllo completo su tale API, non ha lo stesso livello di controllo sulle applicazioni client che possono essere compilate da organizzazioni di terze parti che operano in modalità remota.</span><span class="sxs-lookup"><span data-stu-id="a9632-405">The issue is that although the developer designing and implementing a web API has full control over that API, the developer does not have the same degree of control over client applications which may be built by third party organizations operating remotely.</span></span> <span data-ttu-id="a9632-406">L’imperativo è consentire alle applicazioni client esistenti di continuare a funzionare senza modifiche e allo stesso tempo permettere alle nuove applicazioni client di avvalersi di nuove funzionalità e risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-406">The primary imperative is to enable existing client applications to continue functioning unchanged while allowing new client applications to take advantage of new features and resources.</span></span>

<span data-ttu-id="a9632-407">Il controllo delle versioni consente a un’API Web di indicare le funzionalità e le risorse esposte e a un’applicazione client di inviare richieste dirette a una versione specifica di una funzionalità o di una risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-407">Versioning enables a web API to indicate the features and resources that it exposes, and a client application can submit requests that are directed to a specific version of a feature or resource.</span></span> <span data-ttu-id="a9632-408">Le sezioni seguenti descrivono diversi approcci differenti, ognuno dei quali presenta vantaggi e compromessi.</span><span class="sxs-lookup"><span data-stu-id="a9632-408">The following sections describe several different approaches, each of which has its own benefits and trade-offs.</span></span>

### <a name="no-versioning"></a><span data-ttu-id="a9632-409">Nessun controllo delle versioni</span><span class="sxs-lookup"><span data-stu-id="a9632-409">No versioning</span></span>
<span data-ttu-id="a9632-410">Si tratta dell'approccio più semplice e può essere accettabile per alcune API interne.</span><span class="sxs-lookup"><span data-stu-id="a9632-410">This is the simplest approach, and may be acceptable for some internal APIs.</span></span> <span data-ttu-id="a9632-411">Grandi cambiamenti potrebbero essere rappresentati come nuove risorse o nuovi collegamenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-411">Big changes could be represented as new resources or new links.</span></span>  <span data-ttu-id="a9632-412">L’aggiunta di contenuto alle risorse esistenti potrebbe non presentare una modifica sostanziale in quanto le applicazioni client che non prevedono di visualizzare che questo contenuto lo ignoreranno semplicemente.</span><span class="sxs-lookup"><span data-stu-id="a9632-412">Adding content to existing resources might not present a breaking change as client applications that are not expecting to see this content will simply ignore it.</span></span>

<span data-ttu-id="a9632-413">Una richiesta all'URI *http://adventure-works.com/customers/3*, ad esempio, restituirà i dettagli di un singolo cliente contenente i campi `id`, `name` e `address` previsti dall'applicazione client:</span><span class="sxs-lookup"><span data-stu-id="a9632-413">For example, a request to the URI *http://adventure-works.com/customers/3* should return the details of a single customer containing `id`, `name`, and `address` fields expected by the client application:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

> [!NOTE]
> <span data-ttu-id="a9632-414">Per semplicità, le risposte di esempio illustrate in questa sezione non includono collegamenti HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="a9632-414">For simplicity, the example responses shown in this section do not include HATEOAS links.</span></span>
>
>

<span data-ttu-id="a9632-415">Se il campo `DateCreated` viene aggiunto allo schema della risorsa customer, la risposta sarà simile alla seguente:</span><span class="sxs-lookup"><span data-stu-id="a9632-415">If the `DateCreated` field is added to the schema of the customer resource, then the response would look like this:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="a9632-416">Le applicazioni client esistenti potrebbero continuare a funzionare correttamente se riescono a ignorare i campi non riconosciuti, mentre le nuove applicazioni client possono essere progettate per gestire questo nuovo campo.</span><span class="sxs-lookup"><span data-stu-id="a9632-416">Existing client applications might continue functioning correctly if they are capable of ignoring unrecognized fields, while new client applications can be designed to handle this new field.</span></span> <span data-ttu-id="a9632-417">Tuttavia, modifiche più radicali allo schema di risorse (ad esempio, la rimozione o la ridenominazione dei campi) o cambiamenti nelle relazioni tra le risorse possono costituire modifiche sostanziali che impediscono alle applicazioni client esistenti di funzionare correttamente.</span><span class="sxs-lookup"><span data-stu-id="a9632-417">However, if more radical changes to the schema of resources occur (such as removing or renaming fields) or the relationships between resources change then these may constitute breaking changes that prevent existing client applications from functioning correctly.</span></span> <span data-ttu-id="a9632-418">In tali situazioni è necessario considerare uno degli approcci seguenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-418">In these situations you should consider one of the following approaches.</span></span>

### <a name="uri-versioning"></a><span data-ttu-id="a9632-419">Controllo delle versioni tramite l’URI</span><span class="sxs-lookup"><span data-stu-id="a9632-419">URI versioning</span></span>
<span data-ttu-id="a9632-420">Ogni volta che si modifica l'API Web o che si cambia lo schema di risorse, viene aggiunto un numero di versione all'URI per ciascuna risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-420">Each time you modify the web API or change the schema of resources, you add a version number to the URI for each resource.</span></span> <span data-ttu-id="a9632-421">Gli URI già esistenti continueranno a funzionare come prima, restituendo risorse conformi al relativo schema originale.</span><span class="sxs-lookup"><span data-stu-id="a9632-421">The previously existing URIs should continue to operate as before, returning resources that conform to their original schema.</span></span>

<span data-ttu-id="a9632-422">Estendendo l'esempio precedente, se il campo `address` viene ristrutturato in campi secondari contenenti le singole parti che costituiscono l'indirizzo (ad esempio `streetAddress`, `city`, `state` e `zipCode`), questa versione della risorsa potrebbe essere esposta tramite un URI contenente un numero di versione, ad esempio http://adventure-works.com/v2/customers/3:</span><span class="sxs-lookup"><span data-stu-id="a9632-422">Extending the previous example, if the `address` field is restructured into sub-fields containing each constituent part of the address (such as `streetAddress`, `city`, `state`, and `zipCode`), this version of the resource could be exposed through a URI containing a version number, such as http://adventure-works.com/v2/customers/3:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="a9632-423">Questo meccanismo di controllo delle versioni è molto semplice, ma dipende dal server che esegue il routing della richiesta all'endpoint appropriato.</span><span class="sxs-lookup"><span data-stu-id="a9632-423">This versioning mechanism is very simple but depends on the server routing the request to the appropriate endpoint.</span></span> <span data-ttu-id="a9632-424">Tuttavia, può diventare scomodo man mano che l’API Web matura attraverso diverse iterazioni e il server deve supportare un numero elevato di versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="a9632-424">However, it can become unwieldy as the web API matures through several iterations and the server has to support a number of different versions.</span></span> <span data-ttu-id="a9632-425">Inoltre, dal punto di vista di un purista, in tutti i casi le applicazioni client recuperano gli stessi dati (cliente 3), quindi l'URI non deve essere effettivamente diverso a seconda della versione.</span><span class="sxs-lookup"><span data-stu-id="a9632-425">Also, from a purist’s point of view, in all cases the client applications are fetching the same data (customer 3), so the URI should not really be different depending on the version.</span></span> <span data-ttu-id="a9632-426">Questo schema complica anche l'implementazione di HATEOAS perché tutti i collegamenti dovranno includere il numero di versione nei relativi URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-426">This scheme also complicates implementation of HATEOAS as all links will need to include the version number in their URIs.</span></span>

### <a name="query-string-versioning"></a><span data-ttu-id="a9632-427">Controllo delle versioni tramite la stringa di query</span><span class="sxs-lookup"><span data-stu-id="a9632-427">Query string versioning</span></span>
<span data-ttu-id="a9632-428">Anziché fornire più URI, è possibile specificare la versione della risorsa usando un parametro all'interno della stringa di query aggiunta alla richiesta HTTP, ad esempio *http://adventure-works.com/customers/3?version=2*.</span><span class="sxs-lookup"><span data-stu-id="a9632-428">Rather than providing multiple URIs, you can specify the version of the resource by using a parameter within the query string appended to the HTTP request, such as *http://adventure-works.com/customers/3?version=2*.</span></span> <span data-ttu-id="a9632-429">Il parametro della versione deve essere impostato su un valore predefinito significativo, ad esempio 1 se viene omesso dalle applicazioni client meno recenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-429">The version parameter should default to a meaningful value such as 1 if it is omitted by older client applications.</span></span>

<span data-ttu-id="a9632-430">Questo approccio ha il vantaggio semantico che la stessa risorsa viene sempre recuperata dallo stesso URI, ma dipende dal codice che gestisce la richiesta analizzare la stringa di query e inviare la risposta HTTP appropriata.</span><span class="sxs-lookup"><span data-stu-id="a9632-430">This approach has the semantic advantage that the same resource is always retrieved from the same URI, but it depends on the code that handles the request to parse the query string and send back the appropriate HTTP response.</span></span> <span data-ttu-id="a9632-431">Questo approccio presenta anche le stesse complicazioni per l'implementazione di HATEOAS del meccanismo di controllo delle versioni tramite URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-431">This approach also suffers from the same complications for implementing HATEOAS as the URI versioning mechanism.</span></span>

> [!NOTE]
> <span data-ttu-id="a9632-432">Alcuni Web browser e proxy Web meno recenti non memorizzano nella cache le risposte per le richieste che includono una stringa di query nell'URI.</span><span class="sxs-lookup"><span data-stu-id="a9632-432">Some older web browsers and web proxies will not cache responses for requests that include a query string in the URI.</span></span> <span data-ttu-id="a9632-433">Ciò può avere un impatto negativo sulle prestazioni per le applicazioni Web che utilizzano un'API Web e che vengono eseguite dall'interno di questo tipo di Web browser.</span><span class="sxs-lookup"><span data-stu-id="a9632-433">This can have an adverse impact on performance for web applications that use a web API and that run from within such a web browser.</span></span>
>
>

### <a name="header-versioning"></a><span data-ttu-id="a9632-434">Controllo delle versioni tramite l’intestazione</span><span class="sxs-lookup"><span data-stu-id="a9632-434">Header versioning</span></span>
<span data-ttu-id="a9632-435">Anziché aggiungere il numero di versione come parametro di stringa di query, è possibile implementare un'intestazione personalizzata che indica la versione della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a9632-435">Rather than appending the version number as a query string parameter, you could implement a custom header that indicates the version of the resource.</span></span> <span data-ttu-id="a9632-436">Questo approccio richiede l’aggiunta, da parte dell'applicazione client, dell'intestazione appropriata a tutte le richieste, nonostante il codice che gestisce la richiesta del client possa usare un valore predefinito (versione 1) se l'intestazione della versione viene omessa.</span><span class="sxs-lookup"><span data-stu-id="a9632-436">This approach requires that the client application adds the appropriate header to any requests, although the code handling the client request could use a default value (version 1) if the version header is omitted.</span></span> <span data-ttu-id="a9632-437">Nell'esempio seguente viene usata un'intestazione personalizzata denominata *Custom-Header*.</span><span class="sxs-lookup"><span data-stu-id="a9632-437">The following examples utilize a custom header named *Custom-Header*.</span></span> <span data-ttu-id="a9632-438">Il valore di questa intestazione indica la versione dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-438">The value of this header indicates the version of web API.</span></span>

<span data-ttu-id="a9632-439">Versione 1:</span><span class="sxs-lookup"><span data-stu-id="a9632-439">Version 1:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
Custom-Header: api-version=1
```

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="a9632-440">Versione 2:</span><span class="sxs-lookup"><span data-stu-id="a9632-440">Version 2:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
Custom-Header: api-version=2
```

```HTTP
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="a9632-441">Si noti che, come con i due approcci precedenti, l’implementazione di HATEOAS richiede l’inclusione dell'intestazione personalizzata appropriata in tutti i collegamenti.</span><span class="sxs-lookup"><span data-stu-id="a9632-441">Note that as with the previous two approaches, implementing HATEOAS requires including the appropriate custom header in any links.</span></span>

### <a name="media-type-versioning"></a><span data-ttu-id="a9632-442">Controllo delle versioni tramite il tipo di supporto</span><span class="sxs-lookup"><span data-stu-id="a9632-442">Media type versioning</span></span>
<span data-ttu-id="a9632-443">Quando un'applicazione client invia una richiesta HTTP GET a un server Web, è necessario stabilire il formato del contenuto che è possibile gestire tramite un'intestazione Accept, come descritto in precedenza in queste linee guida.</span><span class="sxs-lookup"><span data-stu-id="a9632-443">When a client application sends an HTTP GET request to a web server it should stipulate the format of the content that it can handle by using an Accept header, as described earlier in this guidance.</span></span> <span data-ttu-id="a9632-444">L'intestazione *Accept* ha spesso lo scopo di consentire all'applicazione client di specificare se il corpo della risposta deve essere in formato XML, JSON o in un altro formato comune analizzabile dal client.</span><span class="sxs-lookup"><span data-stu-id="a9632-444">Frequently the purpose of the *Accept* header is to allow the client application to specify whether the body of the response should be XML, JSON, or some other common format that the client can parse.</span></span> <span data-ttu-id="a9632-445">Tuttavia, è possibile definire tipi di supporti personalizzati che includono informazioni che consentono all'applicazione client di indicare la versione di una risorsa prevista.163</span><span class="sxs-lookup"><span data-stu-id="a9632-445">However, it is possible to define custom media types that include information enabling the client application to indicate which version of a resource it is expecting.</span></span> <span data-ttu-id="a9632-446">Nell'esempio seguente viene illustrata una richiesta che specifica un'intestazione *Accept* con il valore *application/vnd.adventure-works.v1+json*.</span><span class="sxs-lookup"><span data-stu-id="a9632-446">The following example shows a request that specifies an *Accept* header with the value *application/vnd.adventure-works.v1+json*.</span></span> <span data-ttu-id="a9632-447">L'elemento *vnd.adventure works.v1* indica al server Web che deve restituire la versione 1 della risorsa, mentre l'elemento *json* specifica che il corpo della risposta deve essere in formato JSON:</span><span class="sxs-lookup"><span data-stu-id="a9632-447">The *vnd.adventure-works.v1* element indicates to the web server that it should return version 1 of the resource, while the *json* element specifies that the format of the response body should be JSON:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
Accept: application/vnd.adventure-works.v1+json
```

<span data-ttu-id="a9632-448">Il codice che gestisce la richiesta è responsabile dell'elaborazione dell'intestazione *Accept* rispettandola per quanto possibile. L'applicazione client può specificare più formati nell'intestazione *Accept* e in questo caso il server Web può scegliere il formato più appropriato per il corpo della risposta.</span><span class="sxs-lookup"><span data-stu-id="a9632-448">The code handling the request is responsible for processing the *Accept* header and honoring it as far as possible (the client application may specify multiple formats in the *Accept* header, in which case the web server can choose the most appropriate format for the response body).</span></span> <span data-ttu-id="a9632-449">Il server Web conferma il formato dei dati nel corpo della risposta mediante l'intestazione Content-Type:</span><span class="sxs-lookup"><span data-stu-id="a9632-449">The web server confirms the format of the data in the response body by using the Content-Type header:</span></span>

```HTTP
HTTP/1.1 200 OK
Content-Type: application/vnd.adventure-works.v1+json; charset=utf-8

{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="a9632-450">Se l'intestazione Accept non specifica alcun tipo di supporto noto, il server Web potrebbe generare un messaggio di risposta HTTP 406 (Pagina non valida) o restituire un messaggio con un tipo di supporto predefinito.</span><span class="sxs-lookup"><span data-stu-id="a9632-450">If the Accept header does not specify any known media types, the web server could generate an HTTP 406 (Not Acceptable) response message or return a message with a default media type.</span></span>

<span data-ttu-id="a9632-451">Questo approccio è senza dubbio il meccanismo di controllo delle versioni più puro e si presta naturalmente a HATEOAS, che può includere il tipo MIME dei dati correlati nei collegamenti alle risorse.</span><span class="sxs-lookup"><span data-stu-id="a9632-451">This approach is arguably the purest of the versioning mechanisms and lends itself naturally to HATEOAS, which can include the MIME type of related data in resource links.</span></span>

> [!NOTE]
> <span data-ttu-id="a9632-452">Quando si seleziona una strategia di controllo delle versioni, è consigliabile tenere in considerazione anche le implicazioni sulle prestazioni, soprattutto la memorizzazione nella cache sul server Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-452">When you select a versioning strategy, you should also consider the implications on performance, especially caching on the web server.</span></span> <span data-ttu-id="a9632-453">Il controllo delle versioni tramite URI e gli schemi di controllo delle versioni tramite la stringa di query sono adatti alla cache perché la stessa combinazione URI/stringa di query fa riferimento ogni volta agli stessi dati.</span><span class="sxs-lookup"><span data-stu-id="a9632-453">The URI versioning and Query String versioning schemes are cache-friendly inasmuch as the same URI/query string combination refers to the same data each time.</span></span>
>
> <span data-ttu-id="a9632-454">I meccanismi di controllo delle versioni tramite intestazione e tipo di supporto in genere richiedono logica aggiuntiva per esaminare i valori nell’intestazione personalizzata o nell'intestazione Accept.</span><span class="sxs-lookup"><span data-stu-id="a9632-454">The Header versioning and Media Type versioning mechanisms typically require additional logic to examine the values in the custom header or the Accept header.</span></span> <span data-ttu-id="a9632-455">In un ambiente su larga scala, la presenza di molti client che usano versioni diverse di un'API Web può comportare una notevole quantità di dati duplicati in una cache lato server.</span><span class="sxs-lookup"><span data-stu-id="a9632-455">In a large-scale environment, many clients using different versions of a web API can result in a significant amount of duplicated data in a server-side cache.</span></span> <span data-ttu-id="a9632-456">Questo problema può diventare evidente se un'applicazione client comunica con un server Web tramite un proxy che implementa la memorizzazione nella cache e che inoltra una richiesta al server Web solo se attualmente non mantiene una copia dei dati richiesti nella propria cache.</span><span class="sxs-lookup"><span data-stu-id="a9632-456">This issue can become acute if a client application communicates with a web server through a proxy that implements caching, and that only forwards a request to the web server if it does not currently hold a copy of the requested data in its cache.</span></span>
>
>

## <a name="open-api-initiative"></a><span data-ttu-id="a9632-457">Iniziativa OpenAPI</span><span class="sxs-lookup"><span data-stu-id="a9632-457">Open API Initiative</span></span>
<span data-ttu-id="a9632-458">L'[Iniziativa OpenAPI](https://www.openapis.org/) è stata creata da un consorzio di settore per standardizzare le descrizioni dell'API REST tra i fornitori.</span><span class="sxs-lookup"><span data-stu-id="a9632-458">The [Open API Initiative](https://www.openapis.org/) was created by an industry consortium to standardize REST API descriptions across vendors.</span></span> <span data-ttu-id="a9632-459">Come parte di questa iniziativa, la specifica di Swagger 2.0 è stata rinominata Specifica OpenAPI ed è stata inserita nell'Iniziativa OpenAPI.</span><span class="sxs-lookup"><span data-stu-id="a9632-459">As part of this initiative, the Swagger 2.0 specification was renamed the OpenAPI Specification (OAS) and brought under the Open API Initiative.</span></span>

<span data-ttu-id="a9632-460">Si consiglia di adottare OpenAPI per le API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-460">You may want to adopt OpenAPI for your web APIs.</span></span> <span data-ttu-id="a9632-461">Alcune informazioni da considerare:</span><span class="sxs-lookup"><span data-stu-id="a9632-461">Some points to consider:</span></span>

- <span data-ttu-id="a9632-462">La specifica OpenAPI include un set di dettagliate linee guida su come dovrebbe essere progettata un'API REST.</span><span class="sxs-lookup"><span data-stu-id="a9632-462">The OpenAPI Specification comes with a set of opinionated guidelines on how a REST API should be designed.</span></span> <span data-ttu-id="a9632-463">Questo presenta dei vantaggi per quanto riguarda l'interoperabilità, ma richiede una maggiore attenzione quando si progetta l'API in conformità con la specifica.</span><span class="sxs-lookup"><span data-stu-id="a9632-463">That has advantages for interoperability, but requires more care when designing your API to conform to the specification.</span></span>
- <span data-ttu-id="a9632-464">OpenAPI promuove un approccio con priorità al contratto, anziché un approccio con priorità all'implementazione.</span><span class="sxs-lookup"><span data-stu-id="a9632-464">OpenAPI promotes a contract-first approach, rather than an implementation-first approach.</span></span> <span data-ttu-id="a9632-465">Priorità al contratto vuol dire che l'utente progetta prima di tutto il contratto dell'API, ovvero l'interfaccia, e poi scrive il codice che implementa il contratto.</span><span class="sxs-lookup"><span data-stu-id="a9632-465">Contract-first means you design the API contract (the interface) first and then write code that implements the contract.</span></span> 
- <span data-ttu-id="a9632-466">Strumenti come Swagger possono generare librerie o documentazione client dai contratti API.</span><span class="sxs-lookup"><span data-stu-id="a9632-466">Tools like Swagger can generate client libraries or documentation from API contracts.</span></span> <span data-ttu-id="a9632-467">Ad esempio, vedere [Pagine della guida dell'API Web ASP.NET con Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="a9632-467">For example, see [ASP.NET Web API Help Pages using Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span>

## <a name="more-information"></a><span data-ttu-id="a9632-468">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="a9632-468">More information</span></span>
* <span data-ttu-id="a9632-469">[Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) (Linee guida per API REST Microsoft):</span><span class="sxs-lookup"><span data-stu-id="a9632-469">[Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md).</span></span> <span data-ttu-id="a9632-470">suggerimenti dettagliati per la progettazione di API REST pubbliche.</span><span class="sxs-lookup"><span data-stu-id="a9632-470">Detailed recommendations for designing public REST APIs.</span></span>
* <span data-ttu-id="a9632-471">[Guida di riferimento dettagliata su REST](http://restcookbook.com/):</span><span class="sxs-lookup"><span data-stu-id="a9632-471">[The REST Cookbook](http://restcookbook.com/).</span></span> <span data-ttu-id="a9632-472">introduzione alla creazione di API RESTful.</span><span class="sxs-lookup"><span data-stu-id="a9632-472">Introduction to building RESTful APIs.</span></span>
* <span data-ttu-id="a9632-473">[Elenco di controllo per le API Web](https://mathieu.fenniak.net/the-api-checklist/):</span><span class="sxs-lookup"><span data-stu-id="a9632-473">[Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/).</span></span> <span data-ttu-id="a9632-474">utile elenco degli elementi da considerare durante la progettazione e l'implementazione di un'API Web.</span><span class="sxs-lookup"><span data-stu-id="a9632-474">A useful list of items to consider when designing and implementing a web API.</span></span>
* <span data-ttu-id="a9632-475">[Iniziativa OpenAPI](https://www.openapis.org/):</span><span class="sxs-lookup"><span data-stu-id="a9632-475">[Open API Initiative](https://www.openapis.org/).</span></span> <span data-ttu-id="a9632-476">documentazione e dettagli di implementazione per OpenAPI.</span><span class="sxs-lookup"><span data-stu-id="a9632-476">Documentation and implementation details on Open API.</span></span>

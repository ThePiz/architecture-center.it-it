---
title: Indicazioni generali per la ripetizione di tentativi
description: Indicazioni su come implementare un meccanismo di ripetizione dei tentativi per gestire gli errori temporanei.
author: dragon119
ms.date: 07/13/2016
pnp.series.title: Best Practices
ms.openlocfilehash: 9562e3447b2219fe2f3df96cfca24b845efa39b0
ms.sourcegitcommit: c53adf50d3a787956fc4ebc951b163a10eeb5d20
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/23/2017
---
# <a name="transient-fault-handling"></a><span data-ttu-id="012aa-103">Gestione degli errori temporanei</span><span class="sxs-lookup"><span data-stu-id="012aa-103">Transient fault handling</span></span>

[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="012aa-104">Tutte le applicazioni che comunicano con servizi e risorse remoti devono essere sensibili agli errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="012aa-104">All applications that communicate with remote services and resources must be sensitive to transient faults.</span></span> <span data-ttu-id="012aa-105">Questa considerazione è valida soprattutto per le applicazioni in esecuzione nel cloud, in cui la natura dell'ambiente e la connettività su Internet aumentano le probabilità che si verifichino questi tipi di errore.</span><span class="sxs-lookup"><span data-stu-id="012aa-105">This is especially the case for applications that run in the cloud, where the nature of the environment and connectivity over the Internet means these types of faults are likely to be encountered more often.</span></span> <span data-ttu-id="012aa-106">Tra gli errori temporanei sono inclusi la perdita temporanea della connettività di rete per componenti e servizi, l'indisponibilità temporanea di un servizio o i timeout generati perché un servizio è occupato.</span><span class="sxs-lookup"><span data-stu-id="012aa-106">Transient faults include the momentary loss of network connectivity to components and services, the temporary unavailability of a service, or timeouts that arise when a service is busy.</span></span> <span data-ttu-id="012aa-107">In molti casi, questi errori si risolvono automaticamente e, se l'azione viene ripetuta dopo un intervallo di tempo appropriato, è probabile che abbia esito positivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-107">These faults are often self-correcting, and if the action is repeated after a suitable delay it is likely succeed.</span></span>

<span data-ttu-id="012aa-108">Questo documento include indicazioni generali per la gestione degli errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="012aa-108">This document covers general guidance for transient fault handling.</span></span> <span data-ttu-id="012aa-109">Per informazioni sulla gestione degli errori temporanei quando si usano i servizi di Microsoft Azure, vedere [Linee guida per la ripetizione di tentativi con i servizi di Azure](./retry-service-specific.md).</span><span class="sxs-lookup"><span data-stu-id="012aa-109">For information about handling transient faults when using Microsoft Azure services, see [Azure service-specific retry guidelines](./retry-service-specific.md).</span></span>

## <a name="why-do-transient-faults-occur-in-the-cloud"></a><span data-ttu-id="012aa-110">Perché si verificano errori temporanei nel cloud?</span><span class="sxs-lookup"><span data-stu-id="012aa-110">Why do transient faults occur in the cloud?</span></span>
<span data-ttu-id="012aa-111">Gli errori temporanei possono verificarsi in qualsiasi ambiente, su qualsiasi piattaforma o sistema operativo e in ogni tipo di applicazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-111">Transient faults can occur in any environment, on any platform or operating system, and in any kind of application.</span></span> <span data-ttu-id="012aa-112">Nelle soluzioni eseguite in un'infrastruttura locale, le prestazioni e la disponibilità dell'applicazione e dei relativi componenti vengono generalmente mantenute tramite costosi sistemi hardware con ridondanza, spesso sottoutilizzati, e i componenti e le risorse si trovano in posizioni vicine.</span><span class="sxs-lookup"><span data-stu-id="012aa-112">In solutions that run on local, on-premises infrastructure, performance and availability of the application and its components is typically maintained through expensive and often under-used hardware redundancy, and components and resources are located close to each another.</span></span> <span data-ttu-id="012aa-113">Un'infrastruttura di questo tipo riduce le probabilità di errore, ma può comunque comportare errori temporanei e persino un'interruzione del servizio a causa di eventi imprevisti, ad esempio problemi di rete o all'alimentatore esterno o altri scenari di emergenza.</span><span class="sxs-lookup"><span data-stu-id="012aa-113">While this makes a failure less likely, it can still result in transient faults - and even an outage through unforeseen events such as external power supply or network issues, or other disaster scenarios.</span></span>

<span data-ttu-id="012aa-114">L'hosting nel cloud, anche in sistemi cloud privati, può offrire una maggiore disponibilità complessiva attraverso risorse condivise, ridondanza, failover automatico e allocazione dinamica delle risorse su un numero elevato di specifici nodi di calcolo.</span><span class="sxs-lookup"><span data-stu-id="012aa-114">Cloud hosting, including private cloud systems, can offer a higher overall availability by using shared resources, redundancy, automatic failover, and dynamic resource allocation across a huge number of commodity compute nodes.</span></span> <span data-ttu-id="012aa-115">La natura di questi ambienti, tuttavia, può favorire la generazione di errori temporanei</span><span class="sxs-lookup"><span data-stu-id="012aa-115">However, the nature of these environments can mean that transient faults are more likely to occur.</span></span> <span data-ttu-id="012aa-116">per vari motivi:</span><span class="sxs-lookup"><span data-stu-id="012aa-116">There are several reasons for this:</span></span>

* <span data-ttu-id="012aa-117">In un ambiente cloud molte risorse sono condivise e l'accesso a tali risorse è soggetto a limitazione per garantirne la protezione.</span><span class="sxs-lookup"><span data-stu-id="012aa-117">Many resources in a cloud environment are shared, and access to these resources is subject to throttling in order to protect the resource.</span></span> <span data-ttu-id="012aa-118">Alcuni servizi rifiutano le connessioni nel momento in cui il carico raggiunge un determinato livello o viene raggiunta la massima velocità effettiva, in modo da consentire l'elaborazione delle richieste esistenti e mantenere le prestazioni del servizio per tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="012aa-118">Some services will refuse connections when the load rises to a specific level, or a maximum throughput rate is reached, in order to allow processing of existing requests and to maintain performance of the service for all users.</span></span> <span data-ttu-id="012aa-119">La limitazione permette quindi di mantenere la qualità del servizio per gli elementi vicini e altri tenant che usano la risorsa condivisa.</span><span class="sxs-lookup"><span data-stu-id="012aa-119">Throttling helps to maintain the quality of service for neighbors and other tenants using the shared resource.</span></span>
* <span data-ttu-id="012aa-120">Gli ambienti cloud vengono creati usando un elevato numero di apposite unità hardware.</span><span class="sxs-lookup"><span data-stu-id="012aa-120">Cloud environments are built using vast numbers of commodity hardware units.</span></span> <span data-ttu-id="012aa-121">Garantiscono le prestazioni distribuendo il carico in modo dinamico tra più unità di elaborazione e componenti di infrastruttura e assicurano l'affidabilità riciclando o sostituendo le unità guaste in modo automatico.</span><span class="sxs-lookup"><span data-stu-id="012aa-121">They deliver performance by dynamically distributing the load across multiple computing units and infrastructure components, and deliver reliability by automatically recycling or replacing failed units.</span></span> <span data-ttu-id="012aa-122">Questa natura dinamica fa sì che, in alcuni casi, possano verificarsi errori temporanei di connessione e altro tipo.</span><span class="sxs-lookup"><span data-stu-id="012aa-122">This dynamic nature means that transient faults and temporary connection failures may occasionally occur.</span></span>
* <span data-ttu-id="012aa-123">Spesso sono presenti più componenti hardware, inclusi elementi dell'infrastruttura di rete come router o servizi di bilanciamento del carico, tra l'applicazione e le risorse e i servizi di cui si avvale.</span><span class="sxs-lookup"><span data-stu-id="012aa-123">There are often more hardware components, including network infrastructure such as routers and load balancers, between the application and the resources and services it uses.</span></span> <span data-ttu-id="012aa-124">Questa infrastruttura aggiuntiva può talvolta introdurre ulteriore latenza di connessione ed errori di connessione temporanei.</span><span class="sxs-lookup"><span data-stu-id="012aa-124">This additional infrastructure can occasionally introduce additional connection latency and transient connection faults.</span></span>
* <span data-ttu-id="012aa-125">Le condizioni di rete tra il client e il server possono essere variabili, soprattutto quando le comunicazioni avvengono tramite Internet.</span><span class="sxs-lookup"><span data-stu-id="012aa-125">Network conditions between the client and the server may be variable, especially when communication crosses the Internet.</span></span> <span data-ttu-id="012aa-126">Anche in percorsi locali, i carichi di traffico molto elevati possono rallentare le comunicazioni e causare errori di connessione intermittente.</span><span class="sxs-lookup"><span data-stu-id="012aa-126">Even in on-premises locations, very heavy traffic loads may slow communication and cause intermittent connection failures.</span></span>

## <a name="challenges"></a><span data-ttu-id="012aa-127">Problematiche</span><span class="sxs-lookup"><span data-stu-id="012aa-127">Challenges</span></span>
<span data-ttu-id="012aa-128">Gli errori temporanei possono avere un forte impatto sulla disponibilità percepita di un'applicazione, anche se è stata accuratamente testata in tutte le circostanze prevedibili.</span><span class="sxs-lookup"><span data-stu-id="012aa-128">Transient faults can have a huge impact on the perceived availability of an application, even if it has been thoroughly tested under all foreseeable circumstances.</span></span> <span data-ttu-id="012aa-129">Per poter funzionare in modo affidabile, le applicazioni ospitate sul cloud devono essere in grado di affrontare le difficoltà seguenti:</span><span class="sxs-lookup"><span data-stu-id="012aa-129">To ensure that cloud-hosted applications operate reliably, they must be able to respond to the following challenges:</span></span>

* <span data-ttu-id="012aa-130">L'applicazione deve essere in grado di rilevare eventuali errori nel momento in cui si verificano e determinare se si tratta di errori temporanei, di lunga durata o terminali.</span><span class="sxs-lookup"><span data-stu-id="012aa-130">The application must be able to detect faults when they occur, and determine if these faults are likely to be transient, more long-lasting, or are terminal failures.</span></span> <span data-ttu-id="012aa-131">In caso di errore temporaneo, è probabile che risorse diverse restituiscano risposte differenti, anche a seconda del contesto dell'operazione. La risposta a un errore durante la lettura dall'unità di archiviazione, ad esempio, può essere diversa dalla risposta allo stesso errore durante la scrittura nell'unità di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-131">Different resources are likely to return different responses when a fault occurs, and these responses may also vary depending on the context of the operation; for example, the response for an error when reading from storage may be different from response for an error when writing to storage.</span></span> <span data-ttu-id="012aa-132">Per molti servizi e risorse sono previsti contratti di gestione degli errori temporanei ben documentati.</span><span class="sxs-lookup"><span data-stu-id="012aa-132">Many resources and services have well-documented transient failure contracts.</span></span> <span data-ttu-id="012aa-133">Nel caso in cui queste informazioni non siano disponibili, tuttavia, può essere difficile individuare la natura dell'errore e stabilire se si tratta di un errore temporaneo.</span><span class="sxs-lookup"><span data-stu-id="012aa-133">However, where such information is not available, it may be difficult to discover the nature of the fault and whether it is likely to be transient.</span></span>
* <span data-ttu-id="012aa-134">L'applicazione deve essere in grado di ripetere l'operazione se stabilisce che si tratta di un errore temporaneo e deve tenere traccia del numero di tentativi di esecuzione dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-134">The application must be able to retry the operation if it determines that the fault is likely to be transient and keep track of the number of times the operation was retried.</span></span>
* <span data-ttu-id="012aa-135">L'applicazione deve adottare una strategia appropriata per la ripetizione dei tentativi,</span><span class="sxs-lookup"><span data-stu-id="012aa-135">The application must use an appropriate strategy for the retries.</span></span> <span data-ttu-id="012aa-136">che consenta di specificare il numero di tentativi, l'intervallo di attesa tra i tentativi e le azioni da intraprendere dopo ogni tentativo non riuscito.</span><span class="sxs-lookup"><span data-stu-id="012aa-136">This strategy specifies the number of times it should retry, the delay between each attempt, and the actions to take after a failed attempt.</span></span> <span data-ttu-id="012aa-137">Il numero appropriato di tentativi e l'intervallo di attesa tra di essi sono parametri spesso difficili da determinare e variano in base al tipo di risorsa e alle condizioni operative della risorsa e dell'applicazione stessa.</span><span class="sxs-lookup"><span data-stu-id="012aa-137">The appropriate number of attempts and the delay between each one are often difficult to determine, and vary based on the type of resource as well as the current operating conditions of the resource and the application itself.</span></span>

## <a name="general-guidelines"></a><span data-ttu-id="012aa-138">Linee guida generali</span><span class="sxs-lookup"><span data-stu-id="012aa-138">General guidelines</span></span>
<span data-ttu-id="012aa-139">Le linee guida seguenti consentono di definire un meccanismo di gestione degli errori temporanei adeguato alle applicazioni:</span><span class="sxs-lookup"><span data-stu-id="012aa-139">The following guidelines will help you to design a suitable transient fault handing mechanism for your applications:</span></span>

* <span data-ttu-id="012aa-140">**Determinare se esiste un meccanismo di ripetizione dei tentativi incorporato:**</span><span class="sxs-lookup"><span data-stu-id="012aa-140">**Determine if there is a built-in retry mechanism:**</span></span>
  * <span data-ttu-id="012aa-141">Molti servizi forniscono una libreria client o SDK che include un meccanismo di gestione degli errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="012aa-141">Many services provide an SDK or client library that contains a transient fault handling mechanism.</span></span> <span data-ttu-id="012aa-142">I criteri di ripetizione usati si basano in genere sulla natura e sui requisiti del servizio di destinazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-142">The retry policy it uses is typically tailored to the nature and requirements of the target service.</span></span> <span data-ttu-id="012aa-143">In alternativa, le interfacce REST di alcuni servizi possono restituire informazioni utili per determinare se un nuovo tentativo è appropriato e l'intervallo di attesa prima del tentativo successivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-143">Alternatively, REST interfaces for services may return information that is useful in determining whether a retry is appropriate, and how long to wait before the next retry attempt.</span></span>
  * <span data-ttu-id="012aa-144">Usare il meccanismo di ripetizione dei tentativi incorporato, se disponibile, a meno che non siano presenti requisiti specifici ed evidenti per i quali può essere più appropriato un sistema di ripetizione dei tentativi diverso.</span><span class="sxs-lookup"><span data-stu-id="012aa-144">Use the built-in retry mechanism where one is available unless you have specific and well-understood requirements that mean a different retry behavior is more appropriate.</span></span>
* <span data-ttu-id="012aa-145">**Determinare se l'operazione è adatta alla ripetizione di tentativi**:</span><span class="sxs-lookup"><span data-stu-id="012aa-145">**Determine if the operation is suitable for retrying**:</span></span>
  * <span data-ttu-id="012aa-146">L'esecuzione di un'operazione dovrebbe essere ritentata solo in caso di errori temporanei (stato desumibile dalla natura dell'errore) e se c'è qualche probabilità che l'operazione abbia esito positivo con un nuovo tentativo.</span><span class="sxs-lookup"><span data-stu-id="012aa-146">You should only retry operations where the faults are transient (typically indicated by the nature of the error), and if there is at least some likelihood that the operation will succeed when reattempted.</span></span> <span data-ttu-id="012aa-147">Sarebbe inutile, infatti, ritentare un'operazione che sussiste in un'operazione non valida, ad esempio l'aggiornamento di un database a un elemento non esistente o una richiesta inviata a un servizio o una risorsa in cui si è verificato un errore irreversibile.</span><span class="sxs-lookup"><span data-stu-id="012aa-147">There is no point in reattempting operations that indicate an invalid operation such as a database update to an item that does not exist, or requests to a service or resource that has suffered a fatal error</span></span>
  * <span data-ttu-id="012aa-148">In generale, è consigliabile ripetere i tentativi solo se è possibile determinarne l'impatto con esattezza e se le condizioni sono ben comprese e possono essere convalidate.</span><span class="sxs-lookup"><span data-stu-id="012aa-148">In general, you should implement retries only where the full impact of this can be determined, and the conditions are well understood and can be validated.</span></span> <span data-ttu-id="012aa-149">In caso contrario, lasciare che sia il codice chiamante a ripetere i tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-149">If not, leave it to the calling code to implement retries.</span></span> <span data-ttu-id="012aa-150">Tenere presente che gli errori restituiti da risorse e servizi al di fuori del proprio controllo possono evolversi nel tempo e determinare la necessità di rivedere la logica di rilevamento degli errori temporanei.</span><span class="sxs-lookup"><span data-stu-id="012aa-150">Remember that the errors returned from resources and services outside your control may evolve over time, and you may need to revisit your transient fault detection logic.</span></span>
  * <span data-ttu-id="012aa-151">Quando si creano servizi o componenti, prendere in considerazione l'introduzione di messaggi e codici di errore che possano aiutare i client a determinare se è opportuno ritentare operazioni non riuscite.</span><span class="sxs-lookup"><span data-stu-id="012aa-151">When you create services or components, consider implementing error codes and messages that will help clients determine whether they should retry failed operations.</span></span> <span data-ttu-id="012aa-152">In particolare, indicare se il client deve ritentare l'operazione (ad esempio restituendo un valore **isTransient** ) e suggerire un intervallo di tempo adeguato prima del tentativo successivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-152">In particular, indicate if the client should retry the operation (perhaps by returning an **isTransient** value) and suggest a suitable delay before the next retry attempt.</span></span> <span data-ttu-id="012aa-153">Se si compila un servizio Web, valutare la possibilità di restituire errori personalizzati definiti all'interno dei contratti di servizio.</span><span class="sxs-lookup"><span data-stu-id="012aa-153">If you build a web service, consider returning custom errors defined within your service contracts.</span></span> <span data-ttu-id="012aa-154">Anche se è possibile che i client generici non siano in grado di leggerli, saranno comunque utili durante la creazione di client personalizzati.</span><span class="sxs-lookup"><span data-stu-id="012aa-154">Even though generic clients may not be able to read these, they will be useful when building custom clients.</span></span>
* <span data-ttu-id="012aa-155">**Determinare un numero di tentativi e un intervallo di tempo appropriati:**</span><span class="sxs-lookup"><span data-stu-id="012aa-155">**Determine an appropriate retry count and interval:**</span></span>
  * <span data-ttu-id="012aa-156">Questo elemento è essenziale per ottimizzare il numero di tentativi e l'intervallo di tempo in base al tipo di caso d'uso.</span><span class="sxs-lookup"><span data-stu-id="012aa-156">It is vital to optimize the retry count and the interval to the type of use case.</span></span> <span data-ttu-id="012aa-157">Se non si ripete il tentativo un numero sufficiente di volte, l'applicazione non sarà in grado di completare l'operazione e potrebbe verificarsi un errore.</span><span class="sxs-lookup"><span data-stu-id="012aa-157">If you do not retry a sufficient number of times, the application will be unable to complete the operation and is likely to experience a failure.</span></span> <span data-ttu-id="012aa-158">D'altra parte, se si eseguono troppi tentativi o si definisce un intervallo eccessivo tra di essi, è possibile che l'applicazione trattenga le risorse (ad esempio thread, connessioni e memoria) per un periodo troppo lungo, influendo negativamente sull'integrità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-158">If you retry too many times, or with too short an interval between tries, the application can potentially hold resources such as threads, connections, and memory for long periods, which will adversely affect the health of the application.</span></span>
  * <span data-ttu-id="012aa-159">I valori appropriati per l'intervallo di tempo e il numero di tentativi dipendono dal tipo di operazione che si tenta di eseguire.</span><span class="sxs-lookup"><span data-stu-id="012aa-159">The appropriate values for the time interval and the number of retry attempts depend on the type of operation being attempted.</span></span> <span data-ttu-id="012aa-160">Ad esempio, se l'operazione fa parte di un'interazione utente, l'intervallo deve essere breve e devono essere eseguiti solo alcuni tentativi, per evitare che gli utenti restino a lungo in attesa di una risposta (intervallo durante il quale vengono mantenute connessioni aperte e la disponibilità può risultare ridotta per gli altri utenti).</span><span class="sxs-lookup"><span data-stu-id="012aa-160">For example, if the operation is part of a user interaction, the interval should be short and only a few retries attempted to avoid making users wait for a response (which holds open connections and can reduce availability for other users).</span></span> <span data-ttu-id="012aa-161">Se invece l'operazione fa parte di un flusso di lavoro critico o di lunga durata, in cui annullare e riavviare il processo risulterebbe molto costoso o richiederebbe molto tempo, è opportuno aumentare l'intervallo di tempo tra i tentativi e ripeterli un maggior numero di volte.</span><span class="sxs-lookup"><span data-stu-id="012aa-161">If the operation is part of a long running or critical workflow, where cancelling and restarting the process is expensive or time-consuming, it is appropriate to wait longer between attempts and retry more times.</span></span>
  * <span data-ttu-id="012aa-162">Determinare un intervallo di tempo appropriato tra i tentativi è l'aspetto più difficile nella definizione di una strategia corretta.</span><span class="sxs-lookup"><span data-stu-id="012aa-162">Determining the appropriate intervals between retries is the most difficult part of designing a successful strategy.</span></span> <span data-ttu-id="012aa-163">Le strategie più comuni usano i seguenti tipi di intervallo tra tentativi:</span><span class="sxs-lookup"><span data-stu-id="012aa-163">Typical strategies use the following types of retry interval:</span></span>
    * <span data-ttu-id="012aa-164">**Backoff esponenziale**.</span><span class="sxs-lookup"><span data-stu-id="012aa-164">**Exponential back-off**.</span></span> <span data-ttu-id="012aa-165">L'applicazione attende un breve intervallo di tempo prima di ripetere il primo tentativo e aumenta in modo esponenziale il tempo di attesa prima di ogni tentativo successivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-165">The application waits a short time before the first retry, and then exponentially increasing times between each subsequent retry.</span></span> <span data-ttu-id="012aa-166">Ad esempio, può ritentare l'operazione dopo 3 secondi, 12 secondi, 30 secondi e così via.</span><span class="sxs-lookup"><span data-stu-id="012aa-166">For example, it may retry the operation after 3 seconds, 12 seconds, 30 seconds, and so on.</span></span>
    * <span data-ttu-id="012aa-167">**Intervalli incrementali**.</span><span class="sxs-lookup"><span data-stu-id="012aa-167">**Incremental intervals**.</span></span> <span data-ttu-id="012aa-168">L'applicazione attende un breve intervallo di tempo prima di ripetere il primo tentativo e aumenta in modo incrementale il tempo di attesa prima di ogni tentativo successivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-168">The application waits a short time before the first retry, and then incrementally increasing times between each subsequent retry.</span></span> <span data-ttu-id="012aa-169">Ad esempio, può ritentare l'operazione dopo 3 secondi, 7 secondi, 13 secondi e così via.</span><span class="sxs-lookup"><span data-stu-id="012aa-169">For example, it may retry the operation after 3 seconds, 7 seconds, 13 seconds, and so on.</span></span>
    * <span data-ttu-id="012aa-170">**Intervalli regolari**.</span><span class="sxs-lookup"><span data-stu-id="012aa-170">**Regular intervals**.</span></span> <span data-ttu-id="012aa-171">L'applicazione attende lo stesso intervallo di tempo prima di ripetere ogni nuovo tentativo.</span><span class="sxs-lookup"><span data-stu-id="012aa-171">The application waits for the same period of time between each attempt.</span></span> <span data-ttu-id="012aa-172">Ad esempio, può ripetere l'operazione ogni 3 secondi.</span><span class="sxs-lookup"><span data-stu-id="012aa-172">For example, it may retry the operation every 3 seconds.</span></span>
    * <span data-ttu-id="012aa-173">**Tentativo immediato**.</span><span class="sxs-lookup"><span data-stu-id="012aa-173">**Immediate retry**.</span></span> <span data-ttu-id="012aa-174">In alcuni casi un errore temporaneo può avere una durata molto breve, soprattutto se causato da singoli eventi come una collisione di pacchetti di rete o un picco in un componente hardware.</span><span class="sxs-lookup"><span data-stu-id="012aa-174">Sometimes a transient fault is extremely short, perhaps caused by an event such as a network packet collision or a spike in a hardware component.</span></span> <span data-ttu-id="012aa-175">In questo caso, è opportuno ripetere immediatamente l'operazione perché è possibile che abbia esito positivo se l'errore si è risolto nell'intervallo di tempo necessario all'applicazione per assemblare e inviare la richiesta successiva.</span><span class="sxs-lookup"><span data-stu-id="012aa-175">In this case, retrying the operation immediately is appropriate because it may succeed if the fault has cleared in the time it takes the application to assemble and send the next request.</span></span> <span data-ttu-id="012aa-176">Tuttavia, è consigliabile non ripetere più di un tentativo immediato e, in caso di esito negativo, passare piuttosto a strategie alternative, come il backoff esponenziale o azioni di fallback.</span><span class="sxs-lookup"><span data-stu-id="012aa-176">However, there should never be more than one immediate retry attempt, and you should switch to alternative strategies, such as such as exponential back-off or fallback actions, if the immediate retry fails.</span></span>
    * <span data-ttu-id="012aa-177">**Sequenza casuale**.</span><span class="sxs-lookup"><span data-stu-id="012aa-177">**Randomization**.</span></span> <span data-ttu-id="012aa-178">Tutte le precedenti strategie di ripetizione dei tentativi possono includere una sequenza casuale per impedire a più istanze del client di inviare contemporaneamente nuovi tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-178">Any of the retry strategies listed above may include a randomization to prevent multiple instances of the client sending subsequent retry attempts at the same time.</span></span> <span data-ttu-id="012aa-179">Ad esempio, un'istanza può ripetere l'operazione dopo 3 secondi, 11 secondi, 28 secondi e così via, mentre un'altra istanza può ripetere l'operazione dopo 4 secondi, 12 secondi, 26 secondi e così via.</span><span class="sxs-lookup"><span data-stu-id="012aa-179">For example, one instance may retry the operation after 3 seconds, 11 seconds, 28 seconds, and so on while another instance may retry the operation after 4 seconds, 12 seconds, 26 seconds, and so on.</span></span> <span data-ttu-id="012aa-180">La sequenza casuale è una tecnica molto utile, soprattutto se combinata con altre strategie.</span><span class="sxs-lookup"><span data-stu-id="012aa-180">Randomization is a useful technique that may be combined with other strategies.</span></span>  
  * <span data-ttu-id="012aa-181">Come regola generale, è consigliabile usare una strategia di backoff esponenziale per le operazioni in background e strategie di ripetizione immediata o a intervalli regolari per le operazioni interattive.</span><span class="sxs-lookup"><span data-stu-id="012aa-181">As a general guideline, use an exponential back-off strategy for background operations, and immediate or regular interval retry strategies for interactive operations.</span></span> <span data-ttu-id="012aa-182">In entrambi i casi è necessario scegliere l'intervallo di tempo e il numero di tentativi in modo che la latenza massima per tutti i tentativi non superi i requisiti di latenza end-to-end previsti.</span><span class="sxs-lookup"><span data-stu-id="012aa-182">In both cases, you should choose the delay and the retry count so that the maximum latency for all retry attempts is within the required end-to-end latency requirement.</span></span>
  * <span data-ttu-id="012aa-183">Tenere sempre presente l'insieme dei fattori che concorrono a formare il timeout massimo complessivo per l'operazione che si tenta di eseguire.</span><span class="sxs-lookup"><span data-stu-id="012aa-183">Take into account the combination of all the factors that contribute to the overall maximum timeout for a retried operation.</span></span> <span data-ttu-id="012aa-184">Questi fattori includono il tempo necessario a una connessione non riuscita per produrre una risposta (in genere impostato da un valore di timeout nel client), l'intervallo di tempo tra i tentativi e il numero massimo di tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-184">These factors include the time taken for a failed connection to produce a response (typically set by a timeout value in the client) as well as the delay between retry attempts and the maximum number of retries.</span></span> <span data-ttu-id="012aa-185">L'insieme di tutti i tentativi può risultare in un tempo di esecuzione complessivo molto lungo, soprattutto se si adotta una strategia di backoff esponenziale in cui l'intervallo di tempo tra i tentativi aumenta rapidamente dopo ogni errore.</span><span class="sxs-lookup"><span data-stu-id="012aa-185">The total of all these times can result in very large overall operation times, especially when using an exponential delay strategy where the interval between retries grows rapidly after each failure.</span></span> <span data-ttu-id="012aa-186">Se un processo deve soddisfare un contratto di servizio specifico, la durata complessiva dell'operazione, inclusi tutti i timeout e gli intervalli, deve soddisfare i requisiti definiti nel contratto di servizio.</span><span class="sxs-lookup"><span data-stu-id="012aa-186">If a process must meet a specific service level agreement (SLA), the overall operation time, including all timeouts and delays, must be within that defined in the SLA</span></span>
  * <span data-ttu-id="012aa-187">Strategie di ripetizione dei tentativi eccessivamente aggressive, che prevedono intervalli troppo brevi o un numero molto elevato di tentativi, possono influire negativamente sul servizio o sulla risorsa di destinazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-187">Over-aggressive retry strategies, which have too short intervals or too may retries, can have an adverse effect on the target resource or service.</span></span> <span data-ttu-id="012aa-188">Possono, ad esempio, impedire alla risorsa o al servizio di uscire dallo stato di overload, continuando a bloccare o rifiutare le richieste.</span><span class="sxs-lookup"><span data-stu-id="012aa-188">This may prevent the resource or service from recovering from its overloaded state, and it will continue to block or refuse requests.</span></span> <span data-ttu-id="012aa-189">Si instaura così un circolo vizioso in cui viene inviata una quantità sempre maggiore di richieste alla risorsa o al servizio, la cui capacità di recupero risulta, pertanto, ulteriormente ridotta.</span><span class="sxs-lookup"><span data-stu-id="012aa-189">This results in a vicious circle where more and more requests are sent to the resource or service, and consequently its ability to recover is further reduced.</span></span>
  * <span data-ttu-id="012aa-190">Quando si sceglie l'intervallo tra tentativi, tenere conto del timeout delle operazioni per evitare che venga immediatamente avviato un nuovo tentativo (ad esempio, se il periodo di timeout è simile all'intervallo tra i tentativi).</span><span class="sxs-lookup"><span data-stu-id="012aa-190">Take into account the timeout of the operations when choosing the retry intervals to avoid launching a subsequent attempt immediately (for example, if the timeout period is similar to the retry interval).</span></span> <span data-ttu-id="012aa-191">Valutare anche l'eventuale necessità di mantenere il periodo possibile complessivo (il timeout e l'intervallo tra tentativi) al di sotto di un determinato intervallo complessivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-191">Also consider if you need to keep the total possible period (the timeout plus the retry intervals) to below a specific total time.</span></span> <span data-ttu-id="012aa-192">Le operazioni con timeout molto lunghi o insolitamente brevi possono influire sul tempo di attesa e sulla frequenza con cui viene ripetuta l'operazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-192">Operations that have unusually short or very long timeouts may influence how long to wait, and how often to retry the operation.</span></span>
  * <span data-ttu-id="012aa-193">Usare il tipo di eccezione e i dati contenuti al suo interno, oppure i codici di errore e i messaggi restituiti dal servizio, per ottimizzare l'intervallo e il numero di tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-193">Use the type of the exception and any data it contains, or the error codes and messages returned from the service, to optimize the interval and the number of retries.</span></span> <span data-ttu-id="012aa-194">Alcune eccezioni o codici di errore, come il codice HTTP 503 (Service Unavailable) con intestazione Retry-After nella risposta, possono indicare, ad esempio, la durata approssimativa del servizio o che il servizio ha avuto esito negativo e non risponderà a eventuali tentativi successivi.</span><span class="sxs-lookup"><span data-stu-id="012aa-194">For example, some exceptions or error codes (such as the HTTP code 503 Service Unavailable with a Retry-After header in the response) may indicate how long the error might last, or that the service has failed and will not respond to any subsequent attempt.</span></span>
* <span data-ttu-id="012aa-195">**Evitare gli anti-modelli**:</span><span class="sxs-lookup"><span data-stu-id="012aa-195">**Avoid anti-patterns**:</span></span>
  * <span data-ttu-id="012aa-196">Nella maggior parte dei casi è consigliabile evitare implementazioni che includono livelli duplicati del codice per la ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-196">In the vast majority of cases, you should avoid implementations that include duplicated layers of retry code.</span></span> <span data-ttu-id="012aa-197">Evitare di progettare codice che includa meccanismi di ripetizione dei tentativi a cascata o che implementi questa logica in ogni fase di un'operazione che comporta una gerarchia di richieste, a meno che non siano previsti requisiti specifici al riguardo.</span><span class="sxs-lookup"><span data-stu-id="012aa-197">Avoid designs that include cascading retry mechanisms, or that implement retry at every stage of an operation that involves a hierarchy of requests, unless you have specific requirements that demand this.</span></span> <span data-ttu-id="012aa-198">In questi casi eccezionali usare criteri che impediscono un numero eccessivo di tentativi e periodi di attesa e accertarsi di comprendere le conseguenze di questo tipo di progettazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-198">In these exceptional circumstances, use policies that prevent excessive numbers of retries and delay periods, and make sure you understand the consequences.</span></span> <span data-ttu-id="012aa-199">Ad esempio, se un componente invia una richiesta a un altro, che a sua volta accede al servizio di destinazione, e si implementa una logica basata su tre tentativi per entrambe le chiamate, vi saranno in totale nove tentativi di accesso al servizio.</span><span class="sxs-lookup"><span data-stu-id="012aa-199">For example, if one component makes a request to another, which then accesses the target service, and you implement retry with a count of three on both calls there will be nine retry attempts in total against the service.</span></span> <span data-ttu-id="012aa-200">Molti servizi e risorse implementano un meccanismo di ripetizione dei tentativi incorporato ed è opportuno determinare come disabilitare o modificare questo meccanismo se è necessario implementare la ripetizione dei tentativi a un livello superiore.</span><span class="sxs-lookup"><span data-stu-id="012aa-200">Many services and resources implement a built-in retry mechanism and you should investigate how you can disable or modify this if you need to implement retries at a higher level.</span></span>
  * <span data-ttu-id="012aa-201">Non implementare mai un meccanismo a ciclo infinito.</span><span class="sxs-lookup"><span data-stu-id="012aa-201">Never implement an endless retry mechanism.</span></span> <span data-ttu-id="012aa-202">Questo può impedire alla risorsa o al servizio di uscire dallo stato di overload e di conseguenza causare la limitazione delle richieste e il rifiuto delle connessioni per un periodo di tempo più lungo.</span><span class="sxs-lookup"><span data-stu-id="012aa-202">This is likely to prevent the resource or service recovering from overload situations, and cause throttling and refused connections to continue for a longer period.</span></span> <span data-ttu-id="012aa-203">Usare un numero finito di ripetizioni dei tentativi o implementare un modello, ad esempio un [interruttore](http://msdn.microsoft.com/library/dn589784.aspx) , per consentire il ripristino del servizio.</span><span class="sxs-lookup"><span data-stu-id="012aa-203">Use a finite number or retries, or implement a pattern such as [Circuit Breaker](http://msdn.microsoft.com/library/dn589784.aspx) to allow the service to recover.</span></span>
  * <span data-ttu-id="012aa-204">Evitare di eseguire più volte una ripetizione di tentativo immediata.</span><span class="sxs-lookup"><span data-stu-id="012aa-204">Never perform an immediate retry more than once.</span></span>
  * <span data-ttu-id="012aa-205">Evitare di usare un intervallo tra tentativi regolare, soprattutto nel caso di un numero elevato di tentativi, quando si accede ai servizi e alle risorse in Azure.</span><span class="sxs-lookup"><span data-stu-id="012aa-205">Avoid using a regular retry interval, especially when you have a large number of retry attempts, when accessing services and resources in Azure.</span></span> <span data-ttu-id="012aa-206">L'approccio ottimale per questo scenario consiste in una strategia di backoff esponenziale con una funzionalità di interruzione del circuito.</span><span class="sxs-lookup"><span data-stu-id="012aa-206">The optimum approach is this scenario is an exponential back-off strategy with a circuit-breaking capability.</span></span>
  * <span data-ttu-id="012aa-207">Evitare che più istanze dello stesso client, o più istanze di client diversi, eseguano contemporaneamente ripetizioni di tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-207">Prevent multiple instances of the same client, or multiple instances of different clients, from sending retries at the same times.</span></span> <span data-ttu-id="012aa-208">Se può verificarsi un caso di questo tipo, introdurre la tecnica di sequenza casuale negli intervalli tra tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-208">If this is likely to occur, introduce randomization into the retry intervals.</span></span>
* <span data-ttu-id="012aa-209">**Testare la strategia e l'implementazione del meccanismo di ripetizione dei tentativi:**</span><span class="sxs-lookup"><span data-stu-id="012aa-209">**Test your retry strategy and implementation:**</span></span>
  * <span data-ttu-id="012aa-210">Assicurarsi di testare l'intera implementazione della strategia di ripetizione dei tentativi in un'ampia serie di condizioni possibili, soprattutto quando l'applicazione e le risorse o i servizi di destinazione usati sono sottoposti a un carico particolarmente intenso.</span><span class="sxs-lookup"><span data-stu-id="012aa-210">Ensure you fully test your retry strategy implementation under as wide a set of circumstances as possible, especially when both the application and the target resources or services it uses are under extreme load.</span></span> <span data-ttu-id="012aa-211">Per controllare il comportamento durante il test, è possibile:</span><span class="sxs-lookup"><span data-stu-id="012aa-211">To check behavior during testing, you can:</span></span>
    * <span data-ttu-id="012aa-212">Inserire nel servizio errori temporanei e non.</span><span class="sxs-lookup"><span data-stu-id="012aa-212">Inject transient and non-transient faults into the service.</span></span> <span data-ttu-id="012aa-213">Ad esempio, inviare richieste non valide o aggiungere il codice che rileva le richieste di test e risponde con diversi tipi di errori.</span><span class="sxs-lookup"><span data-stu-id="012aa-213">For example, send invalid requests or add code that detects test requests and responds with different types of errors.</span></span> <span data-ttu-id="012aa-214">Per un esempio d'uso di TestApi, vedere [Esecuzione di test con inserimento di errori mediante TestApi](http://msdn.microsoft.com/magazine/ff898404.aspx) e il post di blog [Introduction to TestApi – Part 5: Managed Code Fault Injection APIs](http://blogs.msdn.com/b/ivo_manolov/archive/2009/11/25/9928447.aspx) (Introduzione a TestApi – Parte 5: API gestite per l'inserimento di errori nel codice).</span><span class="sxs-lookup"><span data-stu-id="012aa-214">For an example using TestApi, see [Fault Injection Testing with TestApi](http://msdn.microsoft.com/magazine/ff898404.aspx) and [Introduction to TestApi – Part 5: Managed Code Fault Injection APIs](http://blogs.msdn.com/b/ivo_manolov/archive/2009/11/25/9928447.aspx).</span></span>
    * <span data-ttu-id="012aa-215">Creare una simulazione della risorsa o del servizio che restituisce un intervallo di errori possibili in un contesto reale.</span><span class="sxs-lookup"><span data-stu-id="012aa-215">Create a mock of the resource or service that returns a range of errors that the real service may return.</span></span> <span data-ttu-id="012aa-216">Assicurarsi di coprire tutti i tipi di errore che la strategia di ripetizione dei tentativi prevede di rilevare.</span><span class="sxs-lookup"><span data-stu-id="012aa-216">Ensure you cover all the types of error that your retry strategy is designed to detect.</span></span>
    * <span data-ttu-id="012aa-217">Forzare la generazione di errori temporanei tramite la disabilitazione o l'overload del servizio, se si tratta di un servizio personalizzato creato e distribuito personalmente (ovviamente non provare a eseguire l'overload di risorse o servizi condivisi all'interno di Azure).</span><span class="sxs-lookup"><span data-stu-id="012aa-217">Force transient errors to occur by temporarily disabling or overloading the service if it is a custom service that you created and deployed (you should not, of course, attempt to overload any shared resources or shared services within Azure).</span></span>
    * <span data-ttu-id="012aa-218">Per le API basate su HTTP, valutare l'opportunità di usare la libreria FiddlerCore nei test automatizzati per cambiare l'esito delle richieste HTTP aggiungendo tempi di round trip o cambiando la risposta (ad esempio, il codice di stato HTTP, le intestazioni, il corpo o altri fattori).</span><span class="sxs-lookup"><span data-stu-id="012aa-218">For HTTP-based APIs, consider using the FiddlerCore library in your automated tests to change the outcome of HTTP requests, either by adding extra roundtrip times or by changing the response (such as the HTTP status code, headers, body, or other factors).</span></span> <span data-ttu-id="012aa-219">Questo consente il test deterministico di un sottoinsieme delle condizioni di errore, per errori sia temporanei che di altro tipo.</span><span class="sxs-lookup"><span data-stu-id="012aa-219">This enables deterministic testing of a subset of the failure conditions, whether transient faults or other types of failure.</span></span> <span data-ttu-id="012aa-220">Per altre informazioni, vedere [FiddlerCore](http://www.telerik.com/fiddler/fiddlercore).</span><span class="sxs-lookup"><span data-stu-id="012aa-220">For more information, see [FiddlerCore](http://www.telerik.com/fiddler/fiddlercore).</span></span> <span data-ttu-id="012aa-221">Per esempi di come usare la libreria, in particolare la classe **HttpMangler** , esaminare il [codice sorgente per Azure Storage SDK](https://github.com/Azure/azure-storage-net/tree/master/Test).</span><span class="sxs-lookup"><span data-stu-id="012aa-221">For examples of how to use the library, particularly the **HttpMangler** class, examine the [source code for the Azure Storage SDK](https://github.com/Azure/azure-storage-net/tree/master/Test).</span></span>
    * <span data-ttu-id="012aa-222">Eseguire test simultanei e a fattore di carico elevato per assicurarsi che il meccanismo e la strategia di ripetizione dei tentativi funzionino correttamente in queste condizioni e non abbiano effetti negativi sul funzionamento del client né causino la contaminazione incrociata tra le richieste.</span><span class="sxs-lookup"><span data-stu-id="012aa-222">Perform high load factor and concurrent tests to ensure that the retry mechanism and strategy works correctly under these conditions, and does not have an adverse effect on the operation of the client or cause cross-contamination between requests.</span></span>
* <span data-ttu-id="012aa-223">**Gestire le configurazioni dei criteri di ripetizione dei tentativi:**</span><span class="sxs-lookup"><span data-stu-id="012aa-223">**Manage retry policy configurations:**</span></span>
  * <span data-ttu-id="012aa-224">Un *criterio di ripetizione dei tentativi* è il risultato della combinazione di tutti gli elementi della strategia di ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-224">A *retry policy* is a combination of all of the elements of your retry strategy.</span></span> <span data-ttu-id="012aa-225">Questo criterio definisce il meccanismo di rilevamento che determina se un errore è presumibilmente temporaneo, il tipo di intervallo da usare (ad esempio, normale, esponenziale, di backoff e a sequenza casuale), uno o più valori di intervallo effettivi e il numero di volte in cui vengono ripetuti i tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-225">It defines the detection mechanism that determines whether a fault is likely to be transient, the type of interval to use (such as regular, exponential back-off, and randomization), the actual interval value(s), and the number of times to retry.</span></span>
  * <span data-ttu-id="012aa-226">Il meccanismo di ripetizione dei tentativi deve essere implementato in molti punti all'interno della più semplice applicazione e in ogni livello delle applicazioni più complesse.</span><span class="sxs-lookup"><span data-stu-id="012aa-226">Retries must be implemented in many places within even the simplest application, and in every layer of more complex applications.</span></span> <span data-ttu-id="012aa-227">Anziché impostare come hardcoded gli elementi di ogni criterio in più punti del codice, può essere opportuno usare un punto centrale per l'archiviazione di tutti i criteri.</span><span class="sxs-lookup"><span data-stu-id="012aa-227">Rather than hard-coding the elements of each policy at multiple locations, consider using a central point for storing all the policies.</span></span> <span data-ttu-id="012aa-228">Ad esempio, archiviare valori come l'intervallo e il numero di tentativi nei file di configurazione dell'applicazione, leggerli in fase di esecuzione e compilare a livello di codice i criteri di ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-228">For example, store the values such as the interval and retry count in application configuration files, read them at runtime, and programmatically build the retry policies.</span></span> <span data-ttu-id="012aa-229">In questo modo è più semplice gestire le impostazioni e ottimizzare i valori in modo da soddisfare scenari e requisiti variabili.</span><span class="sxs-lookup"><span data-stu-id="012aa-229">This makes it easier to manage the settings, and to modify and fine tune the values in order to respond to changing requirements and scenarios.</span></span> <span data-ttu-id="012aa-230">È tuttavia opportuno progettare il sistema in modo da archiviare i valori anziché rileggere ogni volta un file di configurazione e verificare che vengano usati i valori predefiniti idonei, se non possono essere ottenuti dalla configurazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-230">However, design the system to store the values rather than rereading a configuration file every time, and ensure suitable defaults are used if the values cannot be obtained from configuration.</span></span>
  * <span data-ttu-id="012aa-231">In un'applicazione di servizi cloud di Azure è consigliabile archiviare nel file di configurazione del servizio i valori usati per creare i criteri di ripetizione dei tentativi in fase di esecuzione, in modo che possano essere modificati senza il riavvio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-231">In an Azure Cloud Services application, consider storing the values that are used to build the retry policies at runtime in the service configuration file so that they can be changed without needing to restart the application.</span></span>
  * <span data-ttu-id="012aa-232">Sfruttare le strategie di ripetizione dei tentativi incorporate o predefinite disponibili nelle API client in uso, ma solo se sono adatte allo scenario.</span><span class="sxs-lookup"><span data-stu-id="012aa-232">Take advantage of built-in or default retry strategies available in the client APIs you use, but only where they are appropriate for your scenario.</span></span> <span data-ttu-id="012aa-233">Queste strategie sono normalmente progettate per finalità generiche.</span><span class="sxs-lookup"><span data-stu-id="012aa-233">These strategies are typically general-purpose.</span></span> <span data-ttu-id="012aa-234">In alcuni scenari possono soddisfare tutti i requisiti, mentre in altri possono non offrire l'intera gamma di opzioni necessaria per soddisfare requisiti specifici.</span><span class="sxs-lookup"><span data-stu-id="012aa-234">In some scenarios they may be all that is required, but in other scenarios they may not offer the full range of options to suit your specific requirements.</span></span> <span data-ttu-id="012aa-235">È necessario comprendere come le impostazioni avranno effetto sull'applicazione eseguendo test per determinare i valori più appropriati.</span><span class="sxs-lookup"><span data-stu-id="012aa-235">You must understand how the settings will affect your application through testing to determine the most appropriate values.</span></span>
* <span data-ttu-id="012aa-236">**Tenere traccia degli errori temporanei e non:**</span><span class="sxs-lookup"><span data-stu-id="012aa-236">**Log and track transient and non-transient faults:**</span></span>
  * <span data-ttu-id="012aa-237">Come parte della strategia di ripetizione dei tentativi, includere la gestione delle eccezioni e altra strumentazione in grado di registrare i tentativi effettuati.</span><span class="sxs-lookup"><span data-stu-id="012aa-237">As part of your retry strategy, include exception handling and other instrumentation that logs when retry attempts are made.</span></span> <span data-ttu-id="012aa-238">Se un errore temporaneo e una ripetizione di tentativo occasionale sono possibili e non rivelano la presenza di problemi, un numero di tentativi in costante crescita è spesso indicativo di un problema che può generare un errore o che influisce sulle prestazioni e sulla disponibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="012aa-238">While an occasional transient failure and retry are to be expected, and do not indicate a problem, regular and increasing numbers of retries are often an indicator of an issue that may cause a failure, or is currently impacting application performance and availability.</span></span>
  * <span data-ttu-id="012aa-239">Registrare gli errori temporanei come voci di avviso anziché di errore per evitare che i sistemi di monitoraggio non rilevino tali voci come errori dell'applicazione generando falsi allarmi.</span><span class="sxs-lookup"><span data-stu-id="012aa-239">Log transient faults as Warning entries rather than Error entries so that monitoring systems do not detect them as application errors that may trigger false alerts.</span></span>
  * <span data-ttu-id="012aa-240">Può essere opportuno archiviare nelle voci di log un valore che indica se la ripetizione dei tentativi è stata causata dalla limitazione del servizio o da altri tipi di errore, ad esempio errori di connessione, in modo da poterli differenziare durante l'analisi dei dati.</span><span class="sxs-lookup"><span data-stu-id="012aa-240">Consider storing a value in your log entries that indicates if the retries were caused by throttling in the service, or by other types of faults such as connection failures, so that you can differentiate them during analysis of the data.</span></span> <span data-ttu-id="012aa-241">Un aumento del numero di errori di limitazione è spesso indicativo di un problema di progettazione nell'applicazione o della necessità di passare a un servizio premium in grado di offrire hardware dedicato.</span><span class="sxs-lookup"><span data-stu-id="012aa-241">An increase in the number of throttling errors is often an indicator of a design flaw in the application or the need to switch to a premium service that offers dedicated hardware.</span></span>  
  * <span data-ttu-id="012aa-242">Può essere utile misurare e registrare il tempo totale impiegato per le operazioni che includono un meccanismo di ripetizione dei tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-242">Consider measuring and logging the overall time taken for operations that include a retry mechanism.</span></span> <span data-ttu-id="012aa-243">Questo tempo è un buon indicatore dell'impatto complessivo degli errori temporanei sui tempi di risposta degli utenti, sulla latenza dei processi e sull'efficienza dei casi d'uso delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="012aa-243">This is a good indicator of the overall effect of transient faults on user response times, process latency, and the efficiency of the application use cases.</span></span> <span data-ttu-id="012aa-244">Registrare anche il numero di tentativi che si sono verificati per comprendere i fattori che hanno influito sul tempo di risposta.</span><span class="sxs-lookup"><span data-stu-id="012aa-244">Also log the number of retries occurred in order to understand the factors that contributed to the response time.</span></span>
  * <span data-ttu-id="012aa-245">Prendere in considerazione l'opportunità di implementare un sistema di telemetria e monitoraggio in grado di generare avvisi quando il numero e la frequenza di errori, il numero medio di tentativi o il tempo complessivo per il completamento delle operazioni risulta in aumento.</span><span class="sxs-lookup"><span data-stu-id="012aa-245">Consider implementing a telemetry and monitoring system that can raise alerts when the number and rate of failures, the average number of retries, or the overall times taken for operations to succeed, is increasing.</span></span>
* <span data-ttu-id="012aa-246">**Gestire le operazioni che continuano ad avere esito negativo:**</span><span class="sxs-lookup"><span data-stu-id="012aa-246">**Manage operations that continually fail:**</span></span>
  
  * <span data-ttu-id="012aa-247">In alcune circostanze l'operazione continua ad avere esito negativo a ogni tentativo ed è molto importante determinare la modalità di gestione appropriata per questa situazione:</span><span class="sxs-lookup"><span data-stu-id="012aa-247">There will be circumstances where the operation continues to fail at every attempt, and it is vital to consider how you will handle this situation:</span></span>
    * <span data-ttu-id="012aa-248">Anche se una strategia di ripetizione dei tentativi definisce il numero massimo di volte in cui deve essere ripetuto il tentativo di esecuzione di un'operazione, tale strategia non impedisce un'ulteriore ripetizione dell'operazione, con lo stesso numero di tentativi.</span><span class="sxs-lookup"><span data-stu-id="012aa-248">Although a retry strategy will define the maximum number of times that an operation should be retried, it does not prevent the application repeating the operation again, with the same number of retries.</span></span> <span data-ttu-id="012aa-249">Ad esempio, se un servizio di elaborazione degli ordini ha esito negativo con un errore irreversibile che lo rende inutilizzabile in modo permanente, la strategia di ripetizione dei tentativi potrebbe rilevare un timeout della connessione e valutare che si tratta di un errore temporaneo.</span><span class="sxs-lookup"><span data-stu-id="012aa-249">For example, if an order processing service fails with a fatal error that puts it out of action permanently, the retry strategy may detect a connection timeout and consider it to be a transient fault.</span></span> <span data-ttu-id="012aa-250">Il codice ripeterà l'operazione il numero di volte specificato e quindi rinuncerà a completarla.</span><span class="sxs-lookup"><span data-stu-id="012aa-250">The code will retry the operation a specified number of times and then give up.</span></span> <span data-ttu-id="012aa-251">Tuttavia, quando un altro cliente eseguirà un ordine, l'operazione verrà ritentata, anche se è sicuro che l'esito sarà sempre negativo.</span><span class="sxs-lookup"><span data-stu-id="012aa-251">However, when another customer places an order, the operation will be attempted again - even though it is sure to fail every time.</span></span>
    * <span data-ttu-id="012aa-252">Per evitare tentativi continui per operazioni che hanno sempre esito negativo, può essere opportuno implementare il [modello di interruttore](http://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="012aa-252">To prevent continual retries for operations that continually fail, consider implementing the [Circuit Breaker pattern](http://msdn.microsoft.com/library/dn589784.aspx).</span></span> <span data-ttu-id="012aa-253">In questo modello, se il numero di errori entro un intervallo di tempo specificato supera la soglia, le richieste vengono restituite immediatamente al chiamante come errori, senza provare ad accedere alla risorsa o al servizio non riuscito.</span><span class="sxs-lookup"><span data-stu-id="012aa-253">In this pattern, if the number of failures within a specified time window exceeds the threshold, requests are returned to the caller immediately as errors, without attempting to access the failed resource or service.</span></span>
    * <span data-ttu-id="012aa-254">L'applicazione può testare periodicamente il servizio, in modo intermittente e a intervalli di tempo molto lunghi tra le richieste, per rilevare quando diventa disponibile.</span><span class="sxs-lookup"><span data-stu-id="012aa-254">The application can periodically test the service, on an intermittent basis and with very long intervals between requests, to detect when it becomes available.</span></span> <span data-ttu-id="012aa-255">La durata appropriata dell'intervallo di tempo dipende dallo scenario, ad esempio l'importanza dell'operazione e la natura del servizio, e può variare da pochi minuti a diverse ore.</span><span class="sxs-lookup"><span data-stu-id="012aa-255">An appropriate interval will depend on the scenario, such as the criticality of the operation and the nature of the service, and might be anything between a few minutes and several hours.</span></span> <span data-ttu-id="012aa-256">Nel momento in cui il test ha esito positivo, l'applicazione può riprendere le normali operazioni e passare richieste al servizio appena ripristinato.</span><span class="sxs-lookup"><span data-stu-id="012aa-256">At the point where the test succeeds, the application can resume normal operations and pass requests to the newly recovered service.</span></span>
    * <span data-ttu-id="012aa-257">Nel frattempo può essere possibile eseguire il fallback a un'altra istanza del servizio (ad esempio in un'applicazione o un data center diverso), usare un servizio simile in grado di offrire funzionalità compatibili (magari più semplici) o eseguire operazioni alternative nella speranza che il servizio diventi presto disponibile.</span><span class="sxs-lookup"><span data-stu-id="012aa-257">In the meantime, it may be possible to fall back to another instance of the service (perhaps in a different datacenter or application), use a similar service that offers compatible (perhaps simpler) functionality, or perform some alternative operations in the hope that the service will become available soon.</span></span> <span data-ttu-id="012aa-258">Ad esempio, può essere opportuno archiviare le richieste relative al servizio in una coda o un archivio dati e riprodurle in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="012aa-258">For example, it may be appropriate to store requests for the service in a queue or data store and replay them later.</span></span> <span data-ttu-id="012aa-259">In alternativa, è possibile reindirizzare l'utente a un'altra istanza dell'applicazione, ridurre le prestazioni dell'applicazione offrendo comunque una funzionalità accettabile o semplicemente restituire un messaggio all'utente per segnalare che l'applicazione non è al momento disponibile.</span><span class="sxs-lookup"><span data-stu-id="012aa-259">Otherwise you might be able to redirect the user to an alternative instance of the application, degrade the performance of the application but still offer acceptable functionality, or just return a message to the user indicating that the application is not available at present.</span></span>
* <span data-ttu-id="012aa-260">**Altre considerazioni**</span><span class="sxs-lookup"><span data-stu-id="012aa-260">**Other considerations**</span></span>
  
  * <span data-ttu-id="012aa-261">Quando si scelgono i valori relativi al numero di ripetizioni dei tentativi e agli intervalli tra tentativi per  criteri, è necessario valutare se l'operazione eseguita sul servizio o sulla risorsa fa parte di un'operazione di lunga durata o articolata in più fasi.</span><span class="sxs-lookup"><span data-stu-id="012aa-261">When deciding on the values for the number of retries and the retry intervals for a policy, consider if the operation on the service or resource is part of a long-running or multi-step operation.</span></span> <span data-ttu-id="012aa-262">Può essere difficile o dispendioso controbilanciare tutte le altre fasi operative che hanno già avuto esito positivo quando una fase non viene completata.</span><span class="sxs-lookup"><span data-stu-id="012aa-262">It may be difficult or expensive to compensate all the other operational steps that have already succeeded when one fails.</span></span> <span data-ttu-id="012aa-263">In questo caso, un intervallo molto lungo e un numero elevato di tentativi può essere accettabile, purché non impedisca l'esecuzione di altre operazioni bloccando le risorse.</span><span class="sxs-lookup"><span data-stu-id="012aa-263">In this case, a very long interval and a large number of retries may be acceptable as long as it does not block other operations by holding or locking scarce resources.</span></span>
  * <span data-ttu-id="012aa-264">Valutare se la ripetizione della stessa operazione può causare incoerenze nei dati.</span><span class="sxs-lookup"><span data-stu-id="012aa-264">Consider if retrying the same operation may cause inconsistencies in data.</span></span> <span data-ttu-id="012aa-265">Se alcune parti di un processo in più fasi vengono ripetute e le operazioni non sono idempotenti, può verificarsi un'incoerenza.</span><span class="sxs-lookup"><span data-stu-id="012aa-265">If some parts of a multi-step process are repeated, and the operations are not idempotent, it may result in an inconsistency.</span></span> <span data-ttu-id="012aa-266">Ad esempio, se un'operazione incrementa un valore e viene ripetuta, genererà un risultato non valido.</span><span class="sxs-lookup"><span data-stu-id="012aa-266">For example, an operation that increments a value, if repeated, will produce an invalid result.</span></span> <span data-ttu-id="012aa-267">La ripetizione di un'operazione che invia un messaggio a una coda può causare un'incoerenza nel consumer di messaggi se non riesce a rilevare i messaggi duplicati.</span><span class="sxs-lookup"><span data-stu-id="012aa-267">Repeating an operation that sends a message to a queue may cause an inconsistency in the message consumer if it cannot detect duplicate messages.</span></span> <span data-ttu-id="012aa-268">Per evitare questo problema, assicurarsi di progettare ogni fase come un'operazione idempotente.</span><span class="sxs-lookup"><span data-stu-id="012aa-268">To prevent this, ensure that you design each step as an idempotent operation.</span></span> <span data-ttu-id="012aa-269">Per altre informazioni sull'idempotenza, vedere [Idempotency Patterns][idempotency-patterns] (Modelli di idempotenza).</span><span class="sxs-lookup"><span data-stu-id="012aa-269">For more information about idempotency, see [Idempotency Patterns][idempotency-patterns].</span></span>
  * <span data-ttu-id="012aa-270">Valutare l'ambito delle operazioni per cui verrà ripetuto il tentativo di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="012aa-270">Consider the scope of the operations that will be retried.</span></span> <span data-ttu-id="012aa-271">Ad esempio, potrebbe essere più facile implementare il codice di ripetizione dei tentativi a un livello che include più operazioni e quindi ripeterle tutte se qualcuna ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="012aa-271">For example, it may be easier to implement retry code at a level that encompasses several operations, and retry them all if one fails.</span></span> <span data-ttu-id="012aa-272">Tuttavia, questa operazione può causare problemi di idempotenza o operazioni di rollback non necessarie.</span><span class="sxs-lookup"><span data-stu-id="012aa-272">However, doing this may result in idempotency issues or unnecessary rollback operations.</span></span>
  * <span data-ttu-id="012aa-273">Se si sceglie un ambito che comprende più operazioni, è opportuno prendere in considerazione la latenza totale di tutte le operazioni nel determinare gli intervalli tra tentativi, nel monitorare il tempo impiegato e prima di generare avvisi per gli errori.</span><span class="sxs-lookup"><span data-stu-id="012aa-273">If you choose a retry scope that encompasses several operations, take into account the total latency of all of them when determining the retry intervals, when monitoring the time taken, and before raising alerts for failures.</span></span>
  * <span data-ttu-id="012aa-274">Valutare come le strategia di ripetizione dei tentativi può influire sui vicini e su altri tenant in un'applicazione condivisa o quando si usano risorse e servizi condivisi.</span><span class="sxs-lookup"><span data-stu-id="012aa-274">Consider how your retry strategy may affect neighbors and other tenants in a shared application, or when using shared resources and services.</span></span> <span data-ttu-id="012aa-275">L'adozione di criteri aggressivi di ripetizione dei tentativi possono causare un numero crescente di errori temporanei si verifichi per gli altri utenti e per le applicazioni che condividono le risorse e i servizi.</span><span class="sxs-lookup"><span data-stu-id="012aa-275">Aggressive retry policies can cause an increasing number of transient faults to occur for these other users and for applications that share the resources and services.</span></span> <span data-ttu-id="012aa-276">Analogamente, l'applicazione può essere influenzata dai criteri di ripetizione dei tentativi implementati da altri utenti dei servizi e delle risorse.</span><span class="sxs-lookup"><span data-stu-id="012aa-276">Likewise, your application may be affected by the retry policies implemented by other users of the resources and services.</span></span> <span data-ttu-id="012aa-277">Per le applicazioni mission-critical, è possibile decidere di usare servizi premium non condivisi.</span><span class="sxs-lookup"><span data-stu-id="012aa-277">For mission-critical applications, you may decide to use premium services that are not shared.</span></span> <span data-ttu-id="012aa-278">Ciò consente un maggiore controllo sul carico e la conseguente limitazione delle richieste di tali risorse e servizi, giustificando così il costo aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="012aa-278">This provides you with much more control over the load and consequent throttling of these resources and services, which can help to justify the additional cost.</span></span>

## <a name="more-information"></a><span data-ttu-id="012aa-279">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="012aa-279">More information</span></span>
* [<span data-ttu-id="012aa-280">Linee guida per la ripetizione di tentativi con i servizi di Azure</span><span class="sxs-lookup"><span data-stu-id="012aa-280">Azure service-specific retry guidelines</span></span>](./retry-service-specific.md)
* [<span data-ttu-id="012aa-281">Blocco di applicazioni per la gestione degli errori temporanei</span><span class="sxs-lookup"><span data-stu-id="012aa-281">The Transient Fault Handling Application Block</span></span>](http://msdn.microsoft.com/library/hh680934.aspx)
* [<span data-ttu-id="012aa-282">Modello di interruttore</span><span class="sxs-lookup"><span data-stu-id="012aa-282">Circuit Breaker Pattern</span></span>](http://msdn.microsoft.com/library/dn589784.aspx)
* [<span data-ttu-id="012aa-283">Modello di transazioni di compensazione</span><span class="sxs-lookup"><span data-stu-id="012aa-283">Compensating Transaction Pattern</span></span>](http://msdn.microsoft.com/library/dn589804.aspx)
* <span data-ttu-id="012aa-284">[Idempotency Patterns][idempotency-patterns] (Modelli di idempotenza)</span><span class="sxs-lookup"><span data-stu-id="012aa-284">[Idempotency Patterns][idempotency-patterns]</span></span>

[idempotency-patterns]: http://blog.jonathanoliver.com/idempotency-patterns/

